repo,number,title,body,labels,state,created_at,closed_at,predicted_label,actual_labels,is_mismatched,resolution_days,url
marmelab/react-admin,10667,Currency mismatch in dashboard revenue chart,"On the dashboard, the ""30 Day Revenue History"" chart displays the Y-axis in euros (€), but the tooltip and data values are shown in US dollars ($). This inconsistency can confuse users about which currency is being reported.
Expected:
The chart should use the same currency symbol throughout.



![Image](https://github.com/user-attachments/assets/12f0525c-bb62-4f61-baa5-8182874b5976)",['bug'],closed,2025-04-15T22:18:27Z,2025-04-16T09:59:03Z,bug,['bug'],False,0.0,
marmelab/react-admin,10651,a typo in the codebase! In packages/ra-ui-materialui/src/layout/Error.tsx,"**What you were expecting:**
The Error component's class names should be consistently spelled, with ""panelSummary"" being the correct spelling.

**What happened instead:**
The Error component in `packages/ra-ui-materialui/src/layout/Error.tsx` has a typo in the class name `panelSumary` (missing 'm'). This inconsistency appears in multiple places:
- Line 64: `className={ErrorClasses.panelSumary}`
- Line 148: `panelSumary: ${PREFIX}-panelSumary`
- Line 184: ``[`& .${ErrorClasses.panelSumary}`]``

**Steps to reproduce:**
1. Open `packages/ra-ui-materialui/src/layout/Error.tsx`
2. Look for the class name `panelSumary`
3. Notice the misspelling (missing 'm')

**Related code:**
```typescript
// Current incorrect spelling
className={ErrorClasses.panelSumary}
panelSumary: `${PREFIX}-panelSumary`
[`& .${ErrorClasses.panelSumary}`]

// Should be
className={ErrorClasses.panelSummary}
panelSummary: `${PREFIX}-panelSummary`
[`& .${ErrorClasses.panelSummary}`]
```

**Other information:**
- This is a simple typo fix that doesn't affect functionality
- The correct spelling ""panelSummary"" is more consistent with Material-UI's naming conventions
- This fix will improve code consistency and maintainability

**Environment**
* React-admin version: [current version]
* React version: [current version]
* Browser: Any",['bug'],closed,2025-04-09T11:39:23Z,2025-04-16T08:00:12Z,bug,['bug'],False,6.0,
marmelab/react-admin,10613,"When Inputs have prop disabled={false}, SaveButton is disabled and dirtyFields is not working as expected.","When Input have prop as disabled={false} , it renders component again , reset defaultValues . It is causing a bug , dirtyFields are not working as expected.

**What you were expecting:**
SaveButton should work as expected.When form input is touched , savebutton should be enabled.

**What happened instead:**
SaveButton is disabled when there is touched input.

**Steps to reproduce:**
Add disabled={false} to Inputs in Create page .Then write to this input , you will see that SaveButton is disabled in Create page. You can see it in image that i added. It is also causing a bug in Edit page too.

![Image](https://github.com/user-attachments/assets/8f691a6a-f703-4753-a240-dc408045304c)

* Preferably, a sandbox forked from 
https://stackblitz.com/github/marmelab/react-admin/tree/master/examples/simple v5


**Other information:**
<!-- List any other information that is relevant to your issue. Stack traces, related issues, suggestions on how to fix, Stack Overflow links, forum links, etc. For visual or layout problems, please include images or animated gifs.-->

**Environment**

* React-admin version:5.6.4
* Last version that did not exhibit the issue (if applicable):
* React version:18
* Browser:Chrome
* Stack trace (in case of a JS error):
",['bug'],open,2025-03-24T10:36:52Z,,bug,['bug'],False,,
marmelab/react-admin,10602,Enterprise Search component has no placeholder,"<!-- Please do not submit support requests or ""How to"" questions here. For that, 
- go to Stack Overflow: https://stackoverflow.com/questions/tagged/react-admin),  or
  go to the react-admin discord server https://discord.gg/GeZF9sqh3N for community support or
- use the Professional Support (https://react-admin-ee.marmelab.com/#support) if you're an Enterprise Edition subscriber. -->

When using enterprise version of Search component it is impossible to change placeholder.

**What you were expecting:**
Possibility to change placeholder especially keeping in mind the fact that Enterprise Search is a wrapper around SearchInput that does have placeholder. And even Enterprise Search has placeholder prop, it just does not work.

**What happened instead:**
The default placeholder is shown

**Steps to reproduce:**
Create a search component using enterprise search and pass placeholder there like that:
```
export const GlobalSearch: FC<SearchProps> = (props) => {
  return (
    <Search
      {...props}
      placeholder={'Type anything'}
    >
      <CustomSearchResultsPanel />
    </Search>
  );
};
```

**Environment**

* React-admin version: 5.1.5
* React version: 18.3.1
* Browser: Chrome

",['bug'],closed,2025-03-20T13:02:00Z,2025-03-24T13:04:44Z,bug,['bug'],False,4.0,
marmelab/react-admin,10512,Issue with parse prop in filters after update (5.3.4 → 5.4.2),"
**What you were expecting:**
When clicking the clear button, the input value should reset.
The state should be updated accordingly.
The filter should be removed from both the input and the URL.

**What happened instead:**
Clicking the clear button does not update the input state.
The filter remains in both the input field and the URL.
The list view does not refresh as expected.

**Steps to reproduce:**

1. Use a filter input with the parse prop.
2. Apply a filter.
3. Click the clear button.
4. Observe that the input state is not updated and the filter remains applied.

**Related code:**
https://codesandbox.io/p/github/BrenoWii/react-admin-sandbox/find-unexpected-behavior

**Other information:**

![Image](https://github.com/user-attachments/assets/9b3e5051-fe2d-4a3d-a3f0-4e2357cbe41a)

**Environment**

* React-admin version: 5.4.2
* Last version that did not exhibit the issue (if applicable): 5.3.4
* React version: N/A
* Browser: Chrome 
",['bug'],closed,2025-02-13T14:38:52Z,2025-02-17T14:53:53Z,bug,['bug'],False,4.0,
marmelab/react-admin,10492,Pass the original mouse click event to the Datagrid's onClick function.,"**Is your feature request related to a problem? Please describe.**
When rowClick function is used in the Datagrid, it becomes difficult to copy content from the table. I would like to be able to use `CTRL + mouse click` to select text from the table without triggering redirect.

**Describe the solution you'd like**
Pass the original event to the RowClickFunction. This will allow us to detect when CTRL key was pressed by the user (using `e.ctrlKey` attribute), so we can disable the redirect and users will be able to select text to copy.

```ts
export type RowClickFunction = (
    id: Identifier,
    resource: string,
    record: RaRecord,
    e: React.MouseEvent<HTMLElement>
) => string | false | Promise<string | false>;
```

P.S.
If you could also allow RowClickFunction return an object  `{to: To, options?: NavigateOptions}`, this will allow us to better control navigation triggered row clicks without writing custom rowClick functions",['enhancement'],closed,2025-02-04T19:39:13Z,2025-02-07T13:07:01Z,bug,['enhancement'],True,2.0,
marmelab/react-admin,10489,Invalid redirect with callback to absolute URI,"**What you were expecting:**
Im using custom routes, passing `redirect` property to `Create` component

```tsx
<Create
      redirect={(resource, id, data) => `/resourceA/<raId1>/resourceB/<rbId2>/resourceC/${id}`}
      mutationOptions={{ meta: { ... } }}
      resource=""resourceC""
    >
...
</Create>
```

Expected to redirect to the absolute uri returned from the callback `/resourceA/1/resourceB/2/resourceC/3`

**What happened instead:**
instead I was redirected to `/1/resourceB/2/resourceC/3` , according to the code of `redirect` function from `ra-core`

```js
            } else if (typeof redirectTo === 'function') {
                const target: To = redirectTo(resource, id, data);
                const absoluteTarget =
                    typeof target === 'string'
                        ? `${basename}/${target}`
                        : {
                              pathname: `${basename}/${target.pathname}`,
                              ...target,
                          };
                navigate(absoluteTarget, {
                    state: { _scrollToTop: true, ...state },
                });
                return;
```

the result will be `<basename>//resourceA/1/resourceB/2/resourceC/3` the double slash is causing the issue I belive, I would expect the check for leading slash before concatination

**Environment**

* React-admin version: 5.4.3
* Browser: Edge
",['bug'],closed,2025-02-01T19:25:45Z,2025-03-06T17:13:36Z,bug,['bug'],False,32.0,
marmelab/react-admin,10488,Using Datagrid in dashboard requires resource.,"Hi 

Datagrid seems to be looking for resource which isnt available in this sample code.
Code copied from here: https://marmelab.com/react-admin/useList.html

Please see the project here. 
[https://stackblitz.com/edit/github-8jwzr8vw?file=src%2Findex.tsx,src%2FdashBoard.tsx](url)

I get the following error:
""useCanAccess must be used inside a <Resource> component or provide a resource prop""

Is this expected behavior. Thank you for your time.

```import {
    useList,
    ListContextProvider,
    Datagrid,
    TextField
} from 'react-admin';

const data = [
    { id: 1, name: 'Arnold' },
    { id: 2, name: 'Sylvester' },
    { id: 3, name: 'Jean-Claude' },
];

const MyComponent = () => {
    const listContext = useList({ data });
    return (
        <ListContextProvider value={listContext}>
            <Datagrid>
                <TextField source=""id"" />
                <TextField source=""name"" />
            </Datagrid>
        </ListContextProvider>
    );
};

```


",['documentation'],closed,2025-02-01T14:52:39Z,2025-02-03T08:37:04Z,bug,['documentation'],True,1.0,
TanStack/table,5567,Table doesn’t re-render with new React Compiler + React 19,"### TanStack Table version

v8.17.3

### Framework/Library version

React 19 + React Compiler

### Describe the bug and the steps to reproduce it

In the repo provided, run `bun install` and then `bun dev`. 

Then, add some text to the input and click add. Observe that the table doesn’t re-render when the data passed in has changed (`table.getRowModel().rows` doesn’t seem to be updated). 

### Your Minimal, Reproducible Example - (Sandbox Highly Recommended)

https://github.com/erikshestopal/react-compiler-bug/blob/a92305ca44ee81b6d7ece76c96aacf163fe83970/src/App.tsx#L38

### Screenshots or Videos (Optional)

_No response_

### Do you intend to try to help solve this bug with your own PR?

None

### Terms & Code of Conduct

- [X] I agree to follow this project's Code of Conduct
- [X] I understand that if my bug cannot be reliable reproduced in a debuggable environment, it will probably not be fixed and this issue may even be closed.","['v8', 'react']",open,2024-05-18T22:04:24Z,,bug,"['v8', 'react']",True,,
TanStack/table,5475,"""regeneratorRuntime is not defined"" error in documentation example","### TanStack Table version

as shown in documentation

### Framework/Library version

as shown in documentation

### Describe the bug and the steps to reproduce it

The filtering example provided in the page https://react-table-v7-docs.netlify.app/docs/examples/filtering triggers an error ""regeneratorRuntime is not defined""


### Your Minimal, Reproducible Example - (Sandbox Highly Recommended)

https://react-table-v7-docs.netlify.app/docs/examples/filtering

### Screenshots or Videos (Optional)

![2024-04-09_15-50-05](https://github.com/TanStack/table/assets/104996435/2356d749-ec45-4ce3-baf8-44d525d4992a)


### Do you intend to try to help solve this bug with your own PR?

None

### Terms & Code of Conduct

- [X] I agree to follow this project's Code of Conduct
- [X] I understand that if my bug cannot be reliable reproduced in a debuggable environment, it will probably not be fixed and this issue may even be closed.",['v7'],closed,2024-04-09T13:52:39Z,2024-06-30T17:12:55Z,bug,['v7'],True,82.0,
TanStack/table,5459,autoResetPageIndex not resetting properly,"### TanStack Table version

8.15.0

### Framework/Library version

^18.2.0

### Describe the bug

Hello, Im running into a issue with the `autoResetPageIndex` showing/processing the incorrect page Index when using client side pagination and changing the rows per page. 


### Steps to reproduce

1. Click next page 2 times so you see `Page 3 of 10,000`
2. Click the rows per page option
3. Select option `show 20`

You will now see the incorrect number `Page 2 of 5,000`

### Expected behavior

1. Click next page 2 times so you see `Page 3 of 10,000`
2. Click the rows per page option
3. Select option `show 20`

You should now see `Page 1 of 5,000`

### How often does this bug happen?

Every time

### Platform

- macOS 14.4.1
- Chrome 123.0.6312.87 (Official Build) (x86_64)


### TypeScript version

5.1.6


### Your Minimal, Reproducible Example - (Sandbox Highly Recommended)

 https://stackblitz.com/edit/tanstack-table-csasqf?file=src%2Fmain.tsx

### Screenshots or Videos (Optional)

https://github.com/TanStack/query/assets/35247622/969eb333-4b99-499a-85b9-4b9415224ca9

### Do you intend to try to help solve this bug with your own PR?

No, because I do not know how

### Terms & Code of Conduct

- [X] I agree to follow this project's Code of Conduct
- [X] I understand that if my bug cannot be reliable reproduced in a debuggable environment, it will probably not be fixed and this issue may even be closed.",['wontfix'],closed,2024-04-02T16:22:25Z,2024-04-02T23:07:06Z,bug,['wontfix'],True,0.0,
react-hook-form/react-hook-form,12900,"issue: React Hook Form (with Zod, Redux) not working anymore after save the formData from handleSubmit to redux","### Version Number

7.54.2

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/87j5mr



**Describe the bug:**

I have an input, registeredto the react-hook-form, a submit button which implement the `form.handleSubmit`. The submit function saves the formData to the redux by an action. After that, when re-enter the input, the application show's the error `Cannot assign to read only property 'username' of object '#<Object>'`.

**Work around**
After doing some try and error, i realized that the form will work as expected when I remove the `resolver` or use clone function to clone object like `lodash.cloneDeep` before dispatch it to redux.

### Steps to reproduce
1. Go to: https://codesandbox.io/p/sandbox/87j5mr
2. Input any thing
3. Click Submit
4. Edit the input
5.  See error

<details>
<summary>Screen shot</summary>

![Image](https://github.com/user-attachments/assets/3279455e-b7e6-4524-8e14-67f614dff78d)

</details>

**More information**
Actually I met this error when I was working with `react-native + expo` project. The screen is not crash like the website. But after dispatch the action, all fields was not registed to the form anymore. When `form.handleSubmit` called, the formData's value was not updated.

Hope someone can explain or maybe fix this ""strage"" error.

Thank you very much

### Expected behaviour

The formData from `handleSubmit` should be the `snapshot` of the form's value, not the reference or anything like that, so there will be no problem when saving it to redux","['status: under investigation', 'regression']",closed,2025-06-20T05:59:34Z,2025-06-21T02:33:00Z,bug,"['status: under investigation', 'regression']",True,0.0,
react-hook-form/react-hook-form,12894,Scroll into view on error,"**Is your feature request related to a problem? Please describe.**
shouldFocusError is fantastic, but we have issues where the form Element where the error occurs is hidden behind a footer or a header.


**Describe the solution you'd like**
Abiliity to extend behaviour to scrollIntoView

**Describe alternatives you've considered**
Currently we turn off the shouldFocusError behavior and manage scrolling and focus ourselves for the single reason we don't want items to be hidden to the user that are errored as this is  poor UX. The form is huge so having to manage the order of focus and scroll is difficult to maintain but it works and does the right thing

**Additional context**
Would love to have a conversation of the ramifications of such a change as I would be happy to drive this and push a PR. (As on the face of it would be easier than the current maintenance).
","['waiting-up-vote', 'feature request']",open,2025-06-18T07:36:06Z,,bug,"['waiting-up-vote', 'feature request']",True,,
react-hook-form/react-hook-form,12882,reset() does not clear inputs wrapped with useController unless defaultValues are set,"### sandbox: https://codesandbox.io/p/devbox/v23s9q

## Describe the bug

When using `useController` to wrap input fields in react-hook-form, calling `reset()` without arguments does not clear the input fields unless `defaultValues` are explicitly set for those fields in `useForm`. This behavior can be unintuitive and inconvenient for large forms where setting default values for every field is impractical.

## Steps to reproduce

1. Create a form with one or more fields wrapped in a custom input component using `useController`.
2. Do not provide `defaultValues` in `useForm`.
3. Call `reset()` without any arguments.
4. Observe that the input values do not clear/reset as expected.

## Expected behavior

Calling `reset()` without arguments should clear all input fields (i.e., reset their values to empty or undefined), regardless of whether `defaultValues` were provided.

## Workarounds

- Providing explicit `defaultValues` for each field works but can be cumbersome.
- Calling `reset({ fieldName: '' })` with empty values per field is tedious for large forms.
- Handling `undefined` values inside custom inputs by defaulting to empty string is possible but adds boilerplate.

## Additional context

It would be helpful if react-hook-form’s `reset()` either:

- Resets fields to empty by default if no `defaultValues` were provided,
- Or provides a clear way to reset all fields to empty values without requiring explicit defaults.

This would improve usability for large and dynamic forms using controlled components wrapped by `useController`.
","['waiting-up-vote', 'feature request']",closed,2025-06-11T08:42:25Z,2025-06-12T04:47:53Z,bug,"['waiting-up-vote', 'feature request']",True,0.0,
react-hook-form/react-hook-form,12873,issue: Submit works differently between 7.54.2 and 7.56.4,"### Version Number

7.56.4

### Codesandbox/Expo snack

https://codesandbox.io/p/devbox/rhf-submit-default-value-754-forked-r77xx3?workspaceId=ws_Aw1xaaGRKNw2v27euU6aAp

### Steps to reproduce

Hi

I tried upgrading RHF from version 7.54.2 to 7.56.4 and noticed one test failure. It seems that the behavior of the library has unexpectedly changed between these versions. Here is how:

I have a Form with a single field `firstName`. It has a default value of `""Seppo""`. If I reset `firstName` to `undefined` using `reset`, it becomes `undefined` in the form state. Then I submit this data.

What happens next works differently between versions.

---

In version **7.54.2**, the following data is submitted:

`{firstName: ""Seppo""`}

Even if the data in form state is `undefined`, it seems that React Hook Form automatically replaces the value from `defaultValues` when submitting the form.

Here is an example: https://codesandbox.io/p/devbox/rhf-test1-forked-tkn7rs?file=%2Fsrc%2FApp.tsx&workspaceId=ws_Aw1xaaGRKNw2v27euU6aAp

Click ""Clear Seppo"" and then ""Submit query"". You get:
```
Form state: {""firstName"":""seppo""}
Submitted data: {""firstName"":""seppo""}
```

---

In version **77.56.4**, the following data is submitted:

`{firstName: undefined`}

In this version, the Form does not fill `firstName` from `defaultValues` but submits the value as it is in form state.

Here is an example: https://codesandbox.io/p/devbox/rhf-submit-default-value-754-forked-r77xx3?workspaceId=ws_Aw1xaaGRKNw2v27euU6aAp

Again, click ""Clear Seppo"" and then ""Submit query"". You get:
```
Form state: {}
Submitted data: {}
```


### Expected behaviour

No functional changes between patch/minor versions. I.e. we should get:
```
Form state: {""firstName"":""seppo""}
Submitted data: {""firstName"":""seppo""}
```

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct","['status: under investigation', 'regression']",closed,2025-06-06T12:11:29Z,2025-06-21T00:47:07Z,bug,"['status: under investigation', 'regression']",True,14.0,
react-hook-form/react-hook-form,12862,issue: Field with Map object is not dirty when not equal to default value,"### Version Number

7.57.0

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/react-hook-form-map-dirty-fields-xl2v3y

### Steps to reproduce

1. Open Codesandbox example
2. Enter text in both inputs
3. Only the string field is dirty

### Expected behaviour

Field with Map object should be dirty when not equal to default value

### What browsers are you seeing the problem on?

Firefox, Chrome, Edge

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['not valid'],closed,2025-06-02T12:57:58Z,2025-06-05T22:21:41Z,bug,['not valid'],True,3.0,
react-hook-form/react-hook-form,12857,issue: missing formControl in UseFormReturn,"### Version Number

7.56.4

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/rddx84

### Steps to reproduce

useForm() returns `formControl`, even though it isn't listed as an existing prop for UseFormReturn. 

### Expected behaviour

I'm not entirely sure if the type should be updated or the formControl prop removed, but happy to contribute with the desired fix if needed.

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct","['bug', 'TS']",closed,2025-05-30T16:16:03Z,2025-06-09T01:00:11Z,bug,"['bug', 'ts']",False,9.0,
react-hook-form/react-hook-form,12838,Feature: return defaultValue from getFieldState in order to have opportunity reset dependent field correctly,"**Is your feature request related to a problem? Please describe.**
I have a business requirement to make dependent selects. E.g., 2 selects - second is disabled while value is not chosen in the 1st one. When value of 1st has chosen, the 2nd select enables and fetches options for it (for example). Also I have requirement to reset value in the 2nd select after I has resetted value in the 1st one.

This is pretty simple example, but there are 8-10 dependent selects in my production code.

It will be very nice and convenient to make opportunity to get default value of field in order to reset dependent field to its default value correctly.

Now I pass 2 custom props for solving business req: `deps` with `resetOptionsForDeps`. These are arrays. In custom component during `onChange` fn call I iterates through `deps` and then find reset config in `resetOptionsForDeps` by current index. The disadvantage of the solution is that we need to provide `defaultValue` for each dependent field in `resetOptionsForDeps` within `deps` prop always. This causes appearing many duplications of code, need to give unique name for `resetOptionsForDeps`, write typescript typing for it (we move away them from react component to helper file) and etc.

I tried to solve this another way: in custom component I took `defaultValues` from `formState`, then I found default value by key like const `defaultValue = defaultValues[dependantName]` and this works, but unfortunatelly except for fields which were defined via `useFieldArray`: usually for this array-like fields we set default value as empty array (`[]`) in order to user add entity to array if he wants. Most of the cases, we keep objects in array-like fields - they represent some business entity (like identity document or others), so default value got as `undefined`.

Here is example:
```
/** helper file*/
const docEntityDefaultValues = {
  dateFrom: '',
  dateTo: ''
};

/** high-level component */
const methods = useForm({
  defaultValues: {
    docs: [],
  }
});
const { fields,append } = useFieldArray({
  name: ""docs""
})
...
return (
  <form>
    // fields mapping

    <button onClick={() => append(docEntityDefaultValues)}>
  </form>
);

/** select (custom component)*/
...
const {resetField} = useFormContext();

 <Controller
    name={name}
    render={({ field, formState }) => {
      const { defaultValues } = formState;

      return (
         <select onChange={(e) => {
           deps?.forEach((item, index) => {
             // current solution
             const  options = resetOptionsForDeps ? resetOptionsForDeps[index] : undefined;
             resetField(item, options);
            
             // solution which I try, but the problem with fieldArray occured
            const options = defaultValues ? { defaultValue: defaultValues[item] } : undefined;
            resetField(item, options);
           });
          ... other code
         }}>
          // options
        </select>
);
    }}
  />
```

**Describe the solution you'd like**
`getFieldState` API could return `defaultValue` with which the field was registered. Maybe `getFieldState` is not possible in current implementation (because returned obj from `getFieldState` is calculated based on `defaultValues` from `formState`), so maybe it needs to provide `useFieldArray` with own default values (for entity), create obj which will keep default values in respect that fieldArray's defaultValues (e.g. `exhaustiveDefaultValues`),  calculate `defaultValue` and return it from `getFieldState`.

**Describe alternatives you've considered**
Any other

**Additional context**
[Sandbox](https://codesandbox.io/p/sandbox/feat-return-defaultvalue-from-getfieldstate-in-order-to-have-opportunity-reset-dep-field-correctly-forked-53tn73)","['waiting-up-vote', 'feature request']",open,2025-05-22T16:09:12Z,,security,"['waiting-up-vote', 'feature request']",True,,
react-hook-form/react-hook-form,12835,issue: regression: setting errors to empty object no longer clears errors,"### Version Number

7.55.0-next.5 

### Codesandbox/Expo snack

https://codesandbox.io/p/devbox/6kr773

### Steps to reproduce

1. Create form, add errors
2. Update state so that `{}` is passed to the form state's errors property
3. Note that error state is not removed/reset


### Expected behaviour

Previously error state could always be reset to any desired value by passing a new value to the `errors` property of the form. However, as of https://github.com/react-hook-form/react-hook-form/pull/12622 empty object is now ignored. Prior to this update, passing empty object could be used to clear any errors from the form.

If I understand the [original issue](https://github.com/react-hook-form/react-hook-form/issues/12599) correctly, this would be an issue passing _any_ static object through, not just with empty object. As long as the object is referentially different, it'll cause the rerender loop. In which case, I'm not sure if filtering out empty object really accomplishes the goal.

Perhaps the bigger issue is that the error property is treated as a mutable object and that passing new values are reflected in the form? I've run into many infinite rerendering issues due to that, where I'm taking errors out of the form, storing them somewhere, and then loading a different reference back into the form, retriggering the original logic and looping. I wonder if a longer-term resolution here would be to treat `errors` more like `defaultErrors` and ignore any changes to the property after form is created?

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct","['status: under investigation', 'improve documentation']",closed,2025-05-21T23:55:29Z,2025-05-24T23:53:20Z,bug,"['status: under investigation', 'improve documentation']",True,2.0,
react-hook-form/react-hook-form,12829,`zodResolver` for zod V4 support,"```ts
import { zodResolver } from ""@hookform/resolvers/zod"";
```
","['waiting-up-vote', 'feature request']",closed,2025-05-19T18:43:53Z,2025-05-19T23:25:11Z,bug,"['waiting-up-vote', 'feature request']",True,0.0,
react-hook-form/react-hook-form,12815,issue: fields with value `null` are no longer submitted when using `useForm({ values })`,"### Version Number

7.56.2

### Codesandbox/Expo snack

https://codesandbox.io/p/devbox/usecontroller-forked-cyj47p

### Steps to reproduce

1. Open browser DevTools to see the console
2. Submit the form
3. See submitted data: `{}` (empty object)


### Expected behaviour

Expected submitted data should have been `{ views: null }`

## Additional Info

This seems to be a regression brought by version 7.55.0.

The same sandbox in version 7.54.2 shows the expected behavior: https://codesandbox.io/p/devbox/usecontroller-forked-gnn7m2

It's also interesting to note that the issue only happens when using `useForm({ values: {} })`.
Using `useForm({ defaultValues: {} })` instead does not show the issue.

## Use case context

We are building a `NumberInput` component and would like this component to submit a `null` value in the form when the input is not filled.
Hence we set `defaultValue: null` when calling `useController`.

We can control the parsing of the value by overriding `onChange`, but we need to be able to set the value to `null` by default so that it submits `null` also when the input is empty and untouched.

### What browsers are you seeing the problem on?

Firefox

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['status: under investigation'],open,2025-05-13T14:28:57Z,,bug,['status: under investigation'],True,,
react-hook-form/react-hook-form,12761,issue: `watch()` usage resets `isReady` back to `false`,"### Version Number

7.56.0

### Codesandbox/Expo snack

https://codesandbox.io/p/devbox/eloquent-cerf-wp3drg?workspaceId=ws_Xiveoo82cHE265B4dA9r9C

### Steps to reproduce

1. Create a basic form with `useForm`
2. Log the value of `isReady`
3. Subscribe to any field value with `watch`
4. Observed that `isReady` is reset back to `false` after the watched value is changed

### Expected behaviour

`isReady` should remain `true` regardless of subscribed value changes

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['bug'],closed,2025-04-20T15:54:51Z,2025-04-21T03:02:59Z,bug,['bug'],False,0.0,
react-hook-form/react-hook-form,12747,issue: `validate` does not work with `resolver`,"### Version Number

7.55

### Codesandbox/Expo snack

https://stackblitz.com/edit/rhf-dep-val-issue-zvdputes?file=src%2FApp.tsx

### Steps to reproduce

1. Attempt to submit the form using the ‘submit’ button
2. See the error that should be from `validate`.
3. Comment out `resolver`
4. will see the error that should have occurred in `validate`


### Expected behaviour

That there would be an error if it matches the email that is passed to the component.

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['work as designed'],closed,2025-04-12T10:59:12Z,2025-04-12T12:01:17Z,bug,['work as designed'],True,0.0,
react-hook-form/react-hook-form,12741,issue: Unable to type into `<input>` after using `move` with `Controller` and `useFieldArray`,"### Version Number

7.55.0

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/hungry-feynman-rv5dlw

### Steps to reproduce

1. Go to https://codesandbox.io/p/sandbox/hungry-feynman-rv5dlw
2. Click the ""Change Index"" button
3. You will no longer be able to type into the first `<input>`

The issue was not present in v7.54.2 and appears to have been introduced in v7.55.0.

### Expected behaviour

Able to type correctly into the first `<input>`

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

```shell

```

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['regression'],closed,2025-04-11T05:36:45Z,2025-04-13T00:32:38Z,bug,['regression'],True,1.0,
react-hook-form/react-hook-form,12572,issue: disabled field value is not omitted from the submission data when passing resolver to useForm,"### Version Number

7.54.2

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/qjjcln

### Steps to reproduce

1. Go to 'Codesandbox'
2. check the ""Is input disabled"" checkbox
3. click ""submit"" button
4. The disabled field value is not omitted from the submission data.


### Expected behaviour

Disabled field values should be omitted from the submission data.

### What browsers are you seeing the problem on?

Chrome


### More Info

When using a resolver in `useForm`, the `disabled` prop of `Controller` and `register(..., {disabled})` is not functioning as expected. 

I read the source code and found that in `createFormControl.ts` `handleSubmit` function, 
`fieldValues` is created from `_formValues`, and then disabled values are removed. 
However, if a resolver exists, it uses `_formValues` instead of the processed `fieldValues`, causing the disabled values to reappear in the submission data.

### Possible Fix
Refer to [commit](https://github.com/meouwu-dev/react-hook-form/commit/fe14337048de6836dbcf9514261d40f582183cf0). 
The solution involves passing `fieldValues` to `_runSchema(name)` instead of using `_formValues`.

I am happy to create a pull request. Thank you for this amazing project!

### Code of Conduct

- [x] I agree to follow this project's Code of Conduct",['bug'],closed,2025-01-31T14:08:40Z,2025-01-31T23:28:49Z,bug,['bug'],False,0.0,
react-hook-form/react-hook-form,12415,"issue: isObjectType(obj[key]) returns true on null, tries to recurse on null values","### Version Number

7.53.2

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/condescending-mcclintock-ndy5wx

### Steps to reproduce

The flatten code from this commit: https://github.com/react-hook-form/react-hook-form/commit/087433d0045af612a2b45fe52b85bf66f4a369d6
crashes if you have a null value in defaultValues, or presumably in form values at the time of submission.

It throws because typeof null === ""object"" is true. To reproduce, you can submit on the codesandbox. If you remove the null defaultValue & reset the form it works fine.  I feel like explicitly checking if it's isObjectType && !== null would be good here.

### Expected behaviour

It should not attempt to flatten nulls.

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['bug'],closed,2024-11-15T03:44:13Z,2024-11-15T23:29:01Z,bug,['bug'],False,0.0,
react-hook-form/react-hook-form,12414,Allow to add an extra context to `handleSubmit` function,"**Is your feature request related to a problem? Please describe.**
A clear and concise description of what the problem is. Ex. I'm always frustrated when [...]

There is a case that users want to create validation schemes with dynamic params when validating. 
Check out this ticket for further information: https://github.com/jquense/yup/issues/337

```ts
// file: schema.js
// create the schema once
yup = require('yup');
const schema = yup.mixed().test(
  'my-test-name',
  'cannot be an existing value',
  function test(value) {
    return !this.options.context.myArray.includes(value)
  } 
);
module.exports = schema;


// other file:
schema = require('./schema.js');
let myArray = ['blue', 'green'];
schema.validateSync('yellow', { context: { myArray: myArray });
```

**Describe the solution you'd like**
A clear and concise description of what you want to happen.

```tsx
const myArray = useState([ ... ]);
// ...

<form onSubmit={handleSubmit(onSubmit, { context: { myArray } })}>
```

**Describe alternatives you've considered**
A clear and concise description of any alternative solutions or features you've considered.

**Additional context**
Add any other context or screenshots about the feature request here.
","['waiting-up-vote', 'feature request']",closed,2024-11-15T03:11:56Z,2024-11-15T23:23:47Z,bug,"['waiting-up-vote', 'feature request']",True,0.0,
react-hook-form/react-hook-form,12407,issue: useFieldArray does not work correctly when setting disabled in useForm,"### Version Number

7.53.2

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/cool-paper-32mxml?workspaceId=3a4ca9db-0b86-4678-90ae-b21ed8bdd8d6

### Steps to reproduce

https://github.com/react-hook-form/react-hook-form/issues/12249

1. Go to sandbox
2. Click on ""Append Item"" button several times
3. Not added to items


### Expected behaviour

addition of items correctly

---

- v7.52.2 does not have this problem
- It probably does not occur if disabled is not set

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['status: under investigation'],closed,2024-11-11T07:48:03Z,2024-11-16T01:41:06Z,bug,['status: under investigation'],True,4.0,
react-hook-form/react-hook-form,12400,issue: Warning: Cannot update a component while rendering a different component.,"### Version Number

7.53.1

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/react-hook-form-render-error-usecontroller-2-f29fdq

### Steps to reproduce

1. Go to https://codesandbox.io/p/sandbox/react-hook-form-render-error-usecontroller-2-f29fdq
2. Click on the submit button
3. Wait 500ms
4. See error in console

Other way to reproduce the bug :
1. Go to the same codesandbox https://codesandbox.io/p/sandbox/react-hook-form-render-error-usecontroller-2-f29fdq
2. Open ""MyFormProvider.tsx""
3. Comment the lines 34 to 39
4. Uncomment the line 47
5. Reload the app
6. See error in console at start

### Relevant informations

For the bug to appear you need :
- A controlled field using `useController`
- Both `isValidating` and `isValid` from a component using `useFormState`

### Expected behaviour

Not seeing the warning

### What browsers are you seeing the problem on?

Chrome, Edge

### Relevant log output

```shell
onSubmit {foo: ''}
onSubmit {foo: ''}
onSubmit finished {foo: ''}
onSubmit finished {foo: ''}
 Warning: Cannot update a component (`IsValidating`) while rendering a different component (`MyControlledTextField`). To locate the bad setState() call inside `MyControlledTextField`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render
    at MyControlledTextField (https://f29fdq.csb.app/src/MyFormContent.tsx:26:5)
    at MyFormContent
    at exports.FormProvider (https://f29fdq.csb.app/node_modules/react-hook-form/dist/index.cjs.js:1:24805)
    at form
    at MyFormProvider (https://f29fdq.csb.app/src/MyFormProvider.tsx:16:5)
    at App
console.<computed> @ index.js:9
p @ preview-protocol.js:57
console.<computed> @ index.js:9
printWarning @ 
error @ 
warnAboutRenderPhaseUpdatesInDEV @ 
scheduleUpdateOnFiber @ 
dispatchSetState @ 
next @ 
next @ 
T @ 
R @ 
O @ 
U @ 
oe @ 
R @ 
MyControlledTextField @ 
renderWithHooks @ 
updateFunctionComponent @ 
beginWork @ 
beginWork$1 @ 
performUnitOfWork @ 
workLoopSync @ 
renderRootSync @ 
performConcurrentWorkOnRoot @ 
workLoop @ 
flushWork @ 
performWorkUntilDeadline @ 
 Warning: Cannot update a component (`IsValidating`) while rendering a different component (`MyControlledTextField`). To locate the bad setState() call inside `MyControlledTextField`, follow the stack trace as described in https://reactjs.org/link/setstate-in-render
    at MyControlledTextField (https://f29fdq.csb.app/src/MyFormContent.tsx:26:5)
    at MyFormContent
    at exports.FormProvider (https://f29fdq.csb.app/node_modules/react-hook-form/dist/index.cjs.js:1:24805)
    at form
    at MyFormProvider (https://f29fdq.csb.app/src/MyFormProvider.tsx:16:5)
    at App
```


### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['wont be worked on'],closed,2024-11-06T11:03:41Z,2024-12-07T01:37:45Z,bug,['wont be worked on'],True,30.0,
react-hook-form/react-hook-form,12398,issue: field value empty in submit data when having dynamic disabled in useForm,"### Version Number

7.53.1

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/kgxnwq

### Steps to reproduce

1. Go to the sandbox
2. Click on Set editable button
3. Fill in the required field
4. Submit the form
5. See console - the first field (has default value) is empty in submit data
6. Also try to edit the first field and submit again, the value is still empty


### Expected behaviour

the first field will have correct value in submit data and it will be possible to edit correctly when using dynamic disabled prop on the whole form

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['bug'],closed,2024-11-05T22:08:47Z,2024-11-08T22:11:57Z,bug,['bug'],False,3.0,
react-hook-form/react-hook-form,12388,issue: FieldError is not correct on nested fields inside controller,"### Version Number

7.53.0

### Codesandbox/Expo snack

https://stackblitz.com/edit/react-hook-form-error-type?file=src%2FApp.tsx

### Steps to reproduce

1. Open the provided reproduction code.
2. Look at the structure of the scheme.
3. See line 48, you will notice that the type of `error` in the Controller is different from the type at run time.


### Expected behaviour

In my opinion, the type of *error* should match the type in runtime.
It is important to note that I know that we won't have to put several fields under the same Controller most of the time, instead, we will define one per field.
I came across this in an edge issue that I was messing with and it doesn't seem right to me.
WDYT? 🤔

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct","['TS', 'design limitation']",closed,2024-10-31T09:39:33Z,2024-12-07T01:28:41Z,bug,"['ts', 'design limitation']",True,36.0,
react-hook-form/react-hook-form,12385,issue: Nested Array Field width validate rule report validation error on removed rows,"### Version Number

7.53.1

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/calc-forked-93m7f3?workspaceId=3123472d-a31f-4ddf-a4e0-79c596270dc0

### Steps to reproduce

1. Go to https://codesandbox.io/p/sandbox/calc-forked-93m7f3?workspaceId=3123472d-a31f-4ddf-a4e0-79c596270dc0
2. The form should show a cart with 3 items, each of which has one or more variants. This uses two nested field arrays. 
3. Click on any of the ""Delete Item"" buttons to remove a row
4. See the error message at the bottom of the form: ""The form is invalid"". 


### Expected behaviour

When removing a row, react-hook-form should not validate the inputs of that row anymore. Yet it does: if you look at the console, you will see that it tries to validate 'cart.2.variants' field, which is undefined as soon as we've removed a row. The error message should not appear in this case. 

*Note*: The problem only seems to occur if we use a `rules: { validate }` in the nested array field. It doesn't occur if we use a `rules: { required }`.

*Note*: I've checked that this is not the same bug as https://github.com/react-hook-form/react-hook-form/issues/12291, as the sandbox uses react-hook-form v7.53.1, where this bug is supposed to be fixed. 

This problem was originally noticed on react-admin (see https://github.com/marmelab/react-admin/issues/9961)

### What browsers are you seeing the problem on?

Firefox, Chrome, Safari, Edge

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['bug'],closed,2024-10-29T15:03:41Z,2024-11-09T10:24:41Z,bug,['bug'],False,10.0,
react-hook-form/react-hook-form,12291,issue: FormData returned by Form component lists fields that have been deleted,"### Version Number

7.53.0

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/damp-snow-td7pff

### Steps to reproduce

1. Create a form that uses `useFieldArray`, add some mockup fields as default values
2. Call remove on one of the fields
3. Submit the form using the new `Form` component
4. The FormData still contains entries for the deleted form, just with its contents set to ""undefined""

This might be related to some of the options I'm using in my code (e.g. `keyName`), so check out the codesandbox for that.

### Expected behaviour

After removing a field, the previous field should no longer be present in the `FormData`

### What browsers are you seeing the problem on?

Firefox

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['bug'],closed,2024-10-02T10:45:56Z,2024-10-07T00:05:15Z,bug,['bug'],False,4.0,
react-hook-form/react-hook-form,12176,"issue: When calling `getValues`, nested array values in the returned object appear to be returned by reference","### Version Number

7.52.2

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/funny-fog-5tc9s8

### Steps to reproduce

When retrieving the values for a form using `getValues` the object appears to be a shallow clone.

The outer object is a copy, but nested arrays are references.  If the nested array inside is manipulated it also changes the form state.

### Expected behaviour

When the nested array in an object retrieved from `getValues` is manipulated those changes should not reflect in form state.

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['enhancement'],open,2024-08-14T11:56:32Z,,bug,['enhancement'],True,,
react-hook-form/react-hook-form,12168,issue: subscribing to isValidating unexpectedly causes number of renders to increase,"### Version Number

7.51.1 - latest

### Codesandbox/Expo snack

https://codesandbox.io/p/sandbox/is-validating-issue-ngdy7s?layout=%257B%2522sidebarPanel%2522%253A%2522EXPLORER%2522%252C%2522rootPanelGroup%2522%253A%257B%2522direction%2522%253A%2522horizontal%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522id%2522%253A%2522ROOT_LAYOUT%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522UNKNOWN%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522clzliznno00063b6i68cykl8r%2522%252C%2522sizes%2522%253A%255B100%252C0%255D%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522EDITOR%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522EDITOR%2522%252C%2522id%2522%253A%2522clzliznnn00023b6iyba2hs46%2522%257D%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522direction%2522%253A%2522horizontal%2522%252C%2522id%2522%253A%2522SHELLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522SHELLS%2522%252C%2522id%2522%253A%2522clzliznnn00033b6iwexhzqde%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%257D%252C%257B%2522type%2522%253A%2522PANEL_GROUP%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522direction%2522%253A%2522vertical%2522%252C%2522id%2522%253A%2522DEVTOOLS%2522%252C%2522panels%2522%253A%255B%257B%2522type%2522%253A%2522PANEL%2522%252C%2522contentType%2522%253A%2522DEVTOOLS%2522%252C%2522id%2522%253A%2522clzliznnn00053b6is14h022r%2522%257D%255D%252C%2522sizes%2522%253A%255B100%255D%257D%255D%252C%2522sizes%2522%253A%255B50%252C50%255D%257D%252C%2522tabbedPanels%2522%253A%257B%2522clzliznnn00023b6iyba2hs46%2522%253A%257B%2522tabs%2522%253A%255B%257B%2522id%2522%253A%2522clzliznnn00013b6iz2ddxcjk%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522type%2522%253A%2522FILE%2522%252C%2522filepath%2522%253A%2522%252Fsrc%252Findex.tsx%2522%252C%2522state%2522%253A%2522IDLE%2522%257D%255D%252C%2522id%2522%253A%2522clzliznnn00023b6iyba2hs46%2522%252C%2522activeTabId%2522%253A%2522clzliznnn00013b6iz2ddxcjk%2522%257D%252C%2522clzliznnn00053b6is14h022r%2522%253A%257B%2522tabs%2522%253A%255B%257B%2522id%2522%253A%2522clzliznnn00043b6ifjw98j5z%2522%252C%2522mode%2522%253A%2522permanent%2522%252C%2522type%2522%253A%2522UNASSIGNED_PORT%2522%252C%2522port%2522%253A0%252C%2522path%2522%253A%2522%252F%2522%257D%255D%252C%2522id%2522%253A%2522clzliznnn00053b6is14h022r%2522%252C%2522activeTabId%2522%253A%2522clzliznnn00043b6ifjw98j5z%2522%257D%252C%2522clzliznnn00033b6iwexhzqde%2522%253A%257B%2522tabs%2522%253A%255B%255D%252C%2522id%2522%253A%2522clzliznnn00033b6iwexhzqde%2522%257D%257D%252C%2522showDevtools%2522%253Atrue%252C%2522showShells%2522%253Afalse%252C%2522showSidebar%2522%253Atrue%252C%2522sidebarPanelSize%2522%253A15%257D

### Steps to reproduce

1. In the Sandbox, click on submit with `isValidating` destructured (ie subscribed). Notice the re-render count is almost 19 every time. In the console you can see the value of `isValidating` repeatedly switch between true and false throughout the submit.
https://github.com/user-attachments/assets/7bf892e2-b1af-4d93-9c58-49173f550fe4
1. In the Sandbox, click on submit without `isValidating` destructured (ie not subscribed). Notice the re-render count is only 4-5 every time.
https://github.com/user-attachments/assets/e67564d2-84ba-4188-adb6-5a23967349cf

### Expected behaviour

The `isValidating` value should only toggle once during the submit process:
- It should change to true when the form starts validating all of the fields
- It should change to false when all of the fields are done validating

Based on the documentation, I do not expect the value of `isValidating` to repeatedly change during the submit process. What is the use case?

This issue started occurring in v7.51.1. I am trying to update one of my projects from v7.50.2 and this issue started causing long timeouts in one of our bigger forms, because of the high number of re-renders. I think we can safely switch to `isSubmitting` for our use case, but either way v7.51.1 is a breaking change because it substantially changes the behavior of `isValidating`.

Feel free to close this issue as expected behavior, but I think the current documentation of `isValidating` is insufficient. Specifically, it's not clear that the value will toggle between true and false for individual fields during a submission, rather than toggling just once for the entire submission.

### What browsers are you seeing the problem on?

Firefox, Chrome, Safari

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['enhancement'],closed,2024-08-08T17:33:42Z,2024-08-18T07:34:15Z,performance,['enhancement'],True,9.0,
react-hook-form/react-hook-form,12167,IntelliSense hangs infinitely in VSCode after installing react-hook-form,"### Version Number

IntelliSense to hang infinitely in VSCode

### Codesandbox/Expo snack

7.52.2

### Steps to reproduce

- Install the latest `react-hook-form`
- Try triggering IntelliSense autocompletion with control + space (on mac):
```
import React, { useEffect, [CONTROL + SPACE HERE] } from ""react"";
```
- IntelliSense hangs infinitely: ""Loading...""

### Expected behaviour

IntelliSense should work. 

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['TS'],open,2024-08-08T15:41:10Z,,bug,['ts'],True,,
react-hook-form/react-hook-form,12165,Unexpected dirtyFields Output When Using keepDefaultValues Option with reset,"### Version Number

7.31.0 - 7.52.2

### Codesandbox/Expo snack

https://codesandbox.io/s/react-hook-form-issue-xfdpzq?file=/index.js

### Steps to reproduce

**This issue does not occur starting from version 7.31.0; in versions below, everything works correctly.**

1. Go to [Example](https://codesandbox.io/s/react-hook-form-issue-xfdpzq?file=/index.js)
2. Click on **Reset**
3. Look at console
4. In the console, we observe the output `dirtyFields {firstName: false, gender: Array(0)}`




### Expected behaviour

We expect `dirtyFields {firstName: false, gender: false}`. If we remove the `keepDefaultValues` option from `reset`, we get the expected behavior.  
As I understand, the problem is that `rhf` perceives an array of values for `Select` as an array of fields in this case, and the issue arises in the following location:
![image](https://github.com/user-attachments/assets/0ce77a88-5f8d-4748-8b56-c8110f60345f)

### What browsers are you seeing the problem on?

_No response_

### Relevant log output

```shell
dirtyFields {firstName: false, gender: Array(0)}
```


### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['design limitation'],closed,2024-08-08T14:06:31Z,2024-08-18T02:05:10Z,bug,['design limitation'],True,9.0,
react-hook-form/react-hook-form,12164,Pass rules to the render function of a Controller,"First of all, love this library! Here's a suggestion for a small improvement.

When using a `<Controller />` I am setting the `rules` prop to include `required: true` on some form elements. I want to render required inputs differently to non-required ones. Currently I have to set `required: true` in the rules _and_ pass a prop to the rendered component and these two need to always be in-sync.

## Proposed solution
I would like the `render` prop to pass the provided rules as an argument

```tsx
<Controller
  control={control}
  rules={{
    required: true,
  }}
  render={({ field: { onChange, value }, rules: { required } }) => (
    <MyInput value={value} onChange={onChange} required={required} />
  )}
/>
```

This would mean there is only one place where I have to define whether an input is required or not.

This is a small improvement but nevertheless I think it would provide a better developer experience and it will prevent bugs where a field's required state is changed but the UI is not changed to reflect this.
","['waiting-up-vote', 'feature request']",closed,2024-08-08T08:56:14Z,2024-08-15T23:45:46Z,bug,"['waiting-up-vote', 'feature request']",True,7.0,
react-hook-form/react-hook-form,12160,Feature Request: I want to make the validation rules conditional on button clicks.,"## **Is your feature request related to a problem? Please describe.**

I want to switch validation when there are multiple buttons on one form.
For example, if I have ""Save Draft"" and ""Finalize"", I want to make only the ""Finalize"" one ""Required"".

## **Describe the solution you'd like**

Allow multiple validation resolvers to be registered, so that the validation can be selected and executed by a button clicked.

## **Describe alternatives you've considered**

Functionality to register validations with id in useForm and switch between validations by passing the id of the validation as an argument to the handleSubmit function.","['waiting-up-vote', 'feature request']",closed,2024-08-07T01:57:11Z,2024-08-15T23:46:45Z,performance,"['waiting-up-vote', 'feature request']",True,8.0,
react-hook-form/react-hook-form,12158,issue: removing an element from a field array causes unexpected behavior in multi-select dirty fields,"### Version Number

7.52.2

### Codesandbox/Expo snack

https://codesandbox.io/s/mantine-v7-forked-5fstfp?file=/src/App.jsx

### Steps to reproduce

1. Go to https://codesandbox.io/s/mantine-v7-forked-5fstfp?file=/src/App.jsx
2. Change the 2nd line fields and see the dirtyfields being updated correctly
3. Remove the last row -> for some reason the dirtyStates on the multiselects are now converted to arrays
4. Change the multi-select on the first row -> the dirtyState is not updated
5. Change the text input on the first row -> the dirtyState is now updated, and the dirtyState on the multiselect is changed back to a simple boolean

https://github.com/user-attachments/assets/410e4c88-3e9d-4cfa-bc5b-f8d80b1cc2e8




### Expected behaviour

DirtyFields should still always be updated and keep a stable structure (always be a boolean or an array of booleans)

### What browsers are you seeing the problem on?

Chrome

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['design limitation'],closed,2024-08-06T13:30:01Z,2024-08-16T10:45:41Z,bug,['design limitation'],True,9.0,
react-hook-form/react-hook-form,12157,issue: React Compiler RHF Reset Unresponsive Form,"### Version Number

7.52.2

### Codesandbox/Expo snack

cannot get react compiler to work in sandbox

### Steps to reproduce

1. set up project to use react compiler. I am using nextjs canary version and Shadcn.
2. Add code
page.tsx
```typescript
import { TestForm } from './TestForm';

export default function Test() {
  const defaultValues = {
    name: 'John Doe',
  };
  return <TestForm defaultValues={defaultValues} />;
}

```
TestForm.tsx
```typescript
'use client';

import { useEffect, useTransition } from 'react';
import { useForm } from 'react-hook-form';
import { z } from 'zod';
import { zodResolver } from '@hookform/resolvers/zod';

import { Form, FormInput } from '~/components/ui/form';
import { Input } from '~/components/ui/input';

export const userProfileSchema = z.object({
  name: z.string().min(2),
});

export type UserProfileSchema = z.infer<typeof userProfileSchema>;

export const TestForm = ({ defaultValues }: { defaultValues?: Partial<UserProfileSchema> }) => {
  const [loading, startTransaction] = useTransition();

  const form = useForm<UserProfileSchema>({
    resolver: zodResolver(userProfileSchema),
    defaultValues,
  });

  const { handleSubmit, control, reset } = form;

  useEffect(() => {
    reset(defaultValues);
    // eslint-disable-next-line react-compiler/react-compiler
    // eslint-disable-next-line react-hooks/exhaustive-deps
  }, [defaultValues]);

  async function submitHandler(formData: FormData) {
    console.log('submitHandler', formData);
    return Promise.resolve();
  }

  const onSubmit = (data: UserProfileSchema) => {
    startTransaction(async () => {
      const formData = new FormData();
      formData.append('data', JSON.stringify(data));
      await submitHandler(formData);
    });
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit, console.log)}>
        {loading && <div>Loading...</div>}

        <FormInput
          control={control}
          name=""name""
          label=""Full Name""
          description=""Your full legal name.""
          render={({ field }) => (
            <Input {...field} className=""w-full"" placeholder=""Enter your full name"" />
          )}
        />
      </form>
    </Form>
  );
};

```

3. Notice how the input box works. Now try again with this modified code that includes reset in the useEffect dependencies.
```typescript
'use client';

import { useEffect, useTransition } from 'react';
import { useForm } from 'react-hook-form';
import { z } from 'zod';
import { zodResolver } from '@hookform/resolvers/zod';

import { Form, FormInput } from '~/components/ui/form';
import { Input } from '~/components/ui/input';

export const userProfileSchema = z.object({
  name: z.string().min(2),
});

export type UserProfileSchema = z.infer<typeof userProfileSchema>;

export const TestForm = ({ defaultValues }: { defaultValues?: Partial<UserProfileSchema> }) => {
  const [loading, startTransaction] = useTransition();

  const form = useForm<UserProfileSchema>({
    resolver: zodResolver(userProfileSchema),
    defaultValues,
  });

  const { handleSubmit, control, reset } = form;

  useEffect(() => {
    reset(defaultValues);
  }, [defaultValues, reset]);

  async function submitHandler(formData: FormData) {
    console.log('submitHandler', formData);
    return Promise.resolve();
  }

  const onSubmit = (data: UserProfileSchema) => {
    startTransaction(async () => {
      const formData = new FormData();
      formData.append('data', JSON.stringify(data));
      await submitHandler(formData);
    });
  };

  return (
    <Form {...form}>
      <form onSubmit={handleSubmit(onSubmit, console.log)}>
        {loading && <div>Loading...</div>}

        <FormInput
          control={control}
          name=""name""
          label=""Full Name""
          description=""Your full legal name.""
          render={({ field }) => (
            <Input {...field} className=""w-full"" placeholder=""Enter your full name"" />
          )}
        />
      </form>
    </Form>
  );
};
```
4. Notice how the input value doesn't change as you type text. The state is frozen.

### Expected behaviour

Currently when react compiler is enabled the reset prevents the value from updating as the user types. It seems like `eslint-disable-next-line react-compiler/react-compiler` opts out of using the react compiler allowing the code to function as expected.

### What browsers are you seeing the problem on?

Edge

### Relevant log output

_No response_

### Code of Conduct

- [X] I agree to follow this project's Code of Conduct",['wont be worked on'],closed,2024-08-05T20:38:24Z,2024-08-18T09:03:11Z,performance,['wont be worked on'],True,12.0,
mui/material-ui,45913,Babel-plugin-import plugin results in every component returning undefined,"### Steps to reproduce

Steps:
1. Open this link to live example: https://stackblitz.com/edit/github-rga63amd?file=vite.config.ts
2. Let it run.


### Current behavior

Following the docs [here](https://mui.com/material-ui/guides/minimizing-bundle-size/#option-two-use-a-babel-plugin), I tried setting up bundle minimizing. However, every component becomes undefined.

```ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

// https://vite.dev/config/
export default defineConfig({
  plugins: [
    react({
      babel: {
        plugins: [
          [
            'babel-plugin-import',
            {
              libraryName: '@mui/material',
              libraryDirectory: '',
              camel2DashComponentName: false,
            },
            'core',
          ],
          [
            'babel-plugin-import',
            {
              libraryName: '@mui/icons-material',
              libraryDirectory: '',
              camel2DashComponentName: false,
            },
            'icons',
          ],
        ],
      },
    }),
  ],
});
```

`Uncaught ReferenceError: CssBaseline is not defined` and so on.

Tested on v7.0.2, on both Firefox and Chrome.

### Expected behavior

_No response_

### Context

_No response_

### Your environment

<details>
  <summary><code>npx @mui/envinfo</code></summary>

```
  Don't forget to mention which browser you used.
  Output from `npx @mui/envinfo` goes here.
```
</details>


**Search keywords**: babel, bundle, vite",['docs'],closed,2025-04-14T15:28:34Z,2025-05-09T19:43:19Z,bug,['docs'],True,25.0,
mui/material-ui,45908,[ask] sx callback value between mui/system and mui/material,"## description

I notice the [sx callback value in `mui system`](https://v6.mui.com/system/getting-started/the-sx-prop/#callback-values) said I should use as entire value, not as value in style property.

<img width=""829"" alt=""Image"" src=""https://github.com/user-attachments/assets/ba35a733-5798-4d4c-b4ea-ff8239894f69"" />

but I don't find this in `material ui` doc.

I wonder know if it's deprecated in material too?

should I update my code  to the entire value version when I use material component (not component from system)?

## my code

they all show the correct style.

```tsx
import {Box} from '@mui/material';
import {Box as SystemBox} from '@mui/system';

export default function Content() {
    return (
        <>
            <Box
                sx={{
                    width: 100,
                    height: 100,
                    backgroundColor: (theme) => theme.palette.primary.main,
                }}
            ></Box>
            <Box
                sx={(theme) => ({
                    width: 100,
                    height: 100,
                    backgroundColor: theme.palette.primary.main,
                })}
            ></Box>
            <SystemBox
                sx={{
                    width: 100,
                    height: 100,
                    backgroundColor: (theme) => theme.palette.primary.main,
                }}
            ></SystemBox>
            <SystemBox
                sx={(theme) => ({
                    width: 100,
                    height: 100,
                    backgroundColor: theme.palette.primary.main,
                })}
            ></SystemBox>
        </>
    );
}
```

## environment

<details>
  <summary><code>npx @mui/envinfo</code></summary>

```
  System:
    OS: macOS 15.2
  Binaries:
    Node: 20.9.0 - ~/.nvm/versions/node/v20.9.0/bin/node
    npm: 10.1.0 - ~/.nvm/versions/node/v20.9.0/bin/npm
    pnpm: Not Found
  Browsers:
    Chrome: 135.0.7049.85
    Edge: Not Found
    Safari: 18.2
  npmPackages:
    @emotion/react: ^11.14.0 => 11.14.0 
    @emotion/styled: ^11.14.0 => 11.14.0 
    @mui/base:  5.0.0-beta.42 
    @mui/core-downloads-tracker:  6.4.11 
    @mui/icons-material: ^6.0.0 => 6.4.11 
    @mui/lab: ^6.0.0-beta => 6.0.0-dev.240424162023-9968b4889d 
    @mui/material: ^6.0.0 => 6.4.11 
    @mui/private-theming:  6.4.9 
    @mui/styled-engine:  6.4.11 
    @mui/system: ^6.0.0 => 6.4.11 
    @mui/types:  7.2.24 
    @mui/utils:  6.4.9 
    @mui/x-date-pickers: 6.20.2 => 6.20.2 
    @types/react: ^18.0.25 => 18.0.25 
    react: ^18.2.0 => 18.2.0 
    react-dom: ^18.2.0 => 18.2.0 
    styled-components: ^5.3.5 => 5.3.5 
    typescript: ^5.5.3 => 5.5.3 
```
</details>

**Search keywords**: ","['support: question', 'package: system']",closed,2025-04-14T06:25:54Z,2025-04-15T02:57:07Z,security,"['support: question', 'package: system']",True,0.0,
mui/material-ui,45904,[docs] Dynamic value is used in sx prop incorrectly,"### Related page

https://v6.mui.com/material-ui/migration/migrating-to-pigment-css/#sx-prop

### Kind of issue

Broken demo

### Issue description

Docks suggest ""If a value depends on a variable, you need to move it to a CSS variable inside inline styles."" but **AFTER** example includes the usage of a dynamic value in `sx` which actually throws an error:

```
<div>
  {items.map((item, index) => (
    <Box
      key={index}
      sx={{
        borderRadius: '50%',
        width: `max(6px - var(--offset), 3px)`,
        height: `max(6px - var(--offset), 3px)`,
        --> bgcolor: index === 0 ? 'primary.solidBg' : 'background.level3', <--
      }}
      style={{
        '--offset': `${index}px`,
      }}
    />
  ))}
</div>
```

I think the demo should be overwritten leveraging array syntax like this:
```
<div>
  {items.map((item, index) => (
    <Box
      key={index}
      sx={[
        {
          borderRadius: '50%',
          width: `max(6px - var(--offset), 3px)`,
          height: `max(6px - var(--offset), 3px)`,
        },
        index === 0 ? { backgroundColor: 'primary.solidBg' } : { backgroundColor: 'background.level3' }
      ]}
      style={{
        '--offset': `${index}px`,
      }}
    />
  ))}
</div>
```

### Context

_No response_

**Search keywords**: pigment-css","['bug 🐛', 'docs', 'ready to take', 'support: docs-feedback']",closed,2025-04-13T15:07:59Z,2025-04-29T03:30:30Z,bug,"['bug 🐛', 'docs', 'ready to take', 'support: docs-feedback']",True,15.0,
mui/material-ui,45884,MUI Text flickers on firefox,"### Steps to reproduce

Steps:
1. Setup MUI
2.Notice the text flickers when opening things like a Select
3.Notice if you use the virtualization examples on the MUI documentation, things flicker like crazy


### Current behavior

Text seems to be arbitrarily reloaded.  Setting the font with a css important override seems to help somewhat

### Expected behavior

The text shouldn't flicker

### Context

_No response_

### Your environment

<details>
  <summary><code>npx @mui/envinfo</code></summary>

```
  Don't forget to mention which browser you used.
  Output from `npx @mui/envinfo` goes here.
```
</details>


**Search keywords**: font flicker","['external dependency', 'component: select', 'package: material-ui', 'browser: Firefox']",closed,2025-04-12T02:19:01Z,2025-05-03T05:17:49Z,bug,"['external dependency', 'component: select', 'package: material-ui', 'browser: firefox']",True,21.0,
mui/material-ui,45882,Arbitrary scaling of the MUI default theme,"Hi,

My application needs a highly compact, almost a miniaturized version of the default MUI theme.

I've read the customization/theming sections of the official MUI docs a few times already but it still isn't clear what the minimum set of styles along with their values is that the new theme must include or override so that it can uniformly scale all components and their subcomponents down (or even up, if needed!) by an arbitrary scaling factor, 'S'.

Because most components are composed of subcomponents, the scaled theme should also appropriately reposition (and adjust all aspects of) the latter as a function of S, as also e.g. any and all margins and paddings (or, gaps in case of flex containers).

For example, when a TextField is scaled down, its input labels, helper text etc would need not only scaling but also a little repositioning to preserve an aspect of the aesthetics offered in the MUI default theme.

Would greatly appreciate if someone could:
  1. Either make available a parameterized version of the default theme that covers all MUI and MUI X components;
  
  2. Or share complete and detailed guidance on how to do this oneself -- for all components and subcomponents -- especially, if one isn't familiar with the internals of all MUI/X components! 

Regards,
NS 

Order ID: 111292


**Search keywords**: ","['docs', 'customization: theme']",open,2025-04-11T08:54:51Z,,bug,"['docs', 'customization: theme']",True,,
mui/material-ui,45881,TextField SlotProps types doesn't have support for inputProps,"### Steps to reproduce

Steps:
1. Open this link to live example: (required)
2.
3.


### Current behavior

I'm trying to pass tabIndex: -1 to Autocomplete TextField but slotProps types not contain inputProps

This is my code
```tsx
type CustomAutocompleteProps<
    TData,
    Multiple extends boolean | undefined,
    DisableClearable extends boolean | undefined,
    FreeSolo extends boolean | undefined
> = Omit<AutocompleteProps<TData, Multiple, DisableClearable, FreeSolo>, 'renderInput'> & {
  textFieldProps?: Omit<TextFieldProps, 'label' | 'placeholder' | 'error'>;
}

const CustomAutocomplete = <
>(
 props: CustomAutocompleteProps<TData, Multiple, DisableClearable, FreeSolo>
) => {
   const { textFieldProps, ..rest } = props;
   return (
     <Autocomplete 
         {...rest}
         renderInput={(params) => (
                <TextField
                    {...textFieldProps}
                    {...params}
                    slotProps={{
                        ...textFieldProps?.slotProps,
                        input: {
                            ...params.InputProps,
                            endAdornment: (
                                <>
                                    {props.loading ? (
                                        <CircularProgress
                                            color=""inherit""
                                            size={20}
                                        />
                                    ) : null}
                                    {params.InputProps.endAdornment}
                                </>
                            ),
                            inputProps: {
                                ...params.inputProps,
                                ...textFieldProps?.slotProps?.input?.inputProps // here not working
                            },
                        },
                    }}
                />
            )}
     />
   )
}
```

### Expected behavior

_No response_

### Context

_No response_

### Your environment

<details>
  <summary><code>npx @mui/envinfo</code></summary>

```
  Don't forget to mention which browser you used.
  Output from `npx @mui/envinfo` goes here.
```
</details>


**Search keywords**: TextField SlotProps","['component: text field', 'status: waiting for author']",closed,2025-04-11T08:13:43Z,2025-04-22T00:10:14Z,security,"['component: text field', 'status: waiting for author']",True,10.0,
reduxjs/redux,4713,[Docs] Redux with Next.js Per-route state,"## What docs page needs to be fixed?

- **Section**: Per-route state
- **Page**: https://redux.js.org/usage/nextjs#per-route-state

## What is the problem?

I'm learning Nextjs and want to setup Redux in Nextjs but this section is not very clear to me `Additional Configuration > Per-route state`, also the source code is not available in the documentation. It seems as if the documentation is not updated, it doesn't match with the project `npx create-next-app --example with-redux my-app`.

![image](https://github.com/reduxjs/redux/assets/12045722/9a1e158e-3020-4ca6-be8b-4324e9f6bbea)

## What should be changed to fix the problem?

Adding an example would be useful to understand why I should initialize the store again, and in what situation I should do it.",['docs'],open,2024-06-26T15:55:10Z,,bug,['docs'],True,,
reduxjs/redux,4711,"[Docs] Add a ""Debugging Redux"" page","Really ought to add a usage guide page that talks about debugging Redux:

- Overall mindset of tracing actions
- Using the Redux DevTools
- Using Replay
- links to my ""Debugging JS"" talk and maybe a couple other resources",['docs'],open,2024-06-22T23:08:56Z,,bug,['docs'],True,,
reduxjs/redux,4699,[Docs] Normalizing State Shape: Normalizr no longer maintained,"## What docs page needs to be fixed?

Page: https://redux.js.org/usage/structuring-reducers/normalizing-state-shape

This page is referenced in the [Redux Style Guide](https://redux.js.org/style-guide/).

## What is the problem?

At the end of the article, the library Normalizr is suggested for normalizing nested data into a normalized format. 

Normalizr is [no longer maintained as of March 19, 2022](https://github.com/paularmstrong/normalizr/discussions/493#discussioncomment-2395540).

## What should be changed to fix the problem?

The article should describe a more modern solution to normalizing nested data, such as Redux Toolkit's `createEntityAdapter`.",['docs'],open,2024-04-17T15:34:16Z,,bug,['docs'],True,,
reduxjs/redux,4692,Add first-party support for persistence to redux,"## First-party support for persistence

### What is the new or updated feature that you are suggesting?

Many other state management libraries out there (e.g. jotai, zustand, even tanstack-query) have first-party support for data persistence. Redux recommends some libs that are not maintained at all, the most popular of them being [redux-persist](https://github.com/rt2zz/redux-persist/) which has over 70+ open PRs to fix critical bugs. redux-persist gets downloaded 4.2M times per month.

I think it would be beneficial to discuss if this feature should be implemented in the library itself.

Thoughts?




",['enhancement'],closed,2024-03-30T16:04:00Z,2024-03-30T16:20:59Z,bug,['enhancement'],True,0.0,
reduxjs/redux,4662,Add combineSlices section to Code Splitting page,"## What docs page is being added or updated?

- **Section**: Usage
- **Page**: Code Splitting

## For Updating Existing Content

### What updates should be made to the page?
Now that RTK has its own code-splitting utilities (combineSlices and createDynamicMiddleware), it would be very useful to have an in-depth of how these are intended to be used, separate from the API reference.

### Do these updates change any of the assumptions or target audience? If so, how do they change?
This would avoid the standard ""recipe"" approach in the current docs in favour of depending on an actual library.",['docs'],open,2024-01-12T16:31:46Z,,bug,['docs'],True,,
reduxjs/redux,4658,Redux core example app not working,"## What docs page needs to be fixed?

- **Section**: [Redux Core Example App](https://redux.js.org/tutorials/fundamentals/part-1-overview#redux-core-example-app)
- **Page**: [Redux overview](https://redux.js.org/tutorials/fundamentals/part-1-overview)

## What is the problem?
The demo application is not working because the `script` src is broken.

## What should be changed to fix the problem?
Update the `script` src to a valid url for redux@latest",['docs'],closed,2024-01-10T08:45:26Z,2024-01-10T15:31:00Z,bug,['docs'],True,0.0,
reduxjs/redux,4654,Invalid external image link,"## What docs page needs to be fixed?

- **Section**: [Why isn't my component re-rendering, or my mapStateToProps running?](https://redux.js.org/faq/react-redux#why-isnt-my-component-re-rendering-or-my-mapstatetoprops-running)
- **Page**: [Redux FAQ: React Redux](https://redux.js.org/faq/react-redux)

## What is the problem?
A link for an image is not valid ([state tree mutation diagram](http://arqex.com/wp-content/uploads/2015/02/trees.png))

## What should be changed to fix the problem?
Need to be replaced with valid image link
",['docs'],closed,2024-01-02T13:57:07Z,2024-04-23T16:05:14Z,bug,['docs'],True,112.0,
reduxjs/redux,4647,Missing link in Learning Resources -> Middleware,"## What docs page needs to be fixed?

- **Section**:  https://redux.js.org/introduction/learning-resources
- **Page**: https://redux.js.org/introduction/learning-resources#middleware

## What is the problem?
https://www.pshrmn.com/tutorials/react/redux-middleware/ link points to nonexisting resource

## What should be changed to fix the problem?
",['docs'],closed,2023-12-25T10:08:35Z,2024-01-03T20:31:32Z,bug,['docs'],True,9.0,
reduxjs/redux,4602,TS conflict between AppThunk and createAsyncThunk.withTypes,"## What docs page needs to be fixed?

In the Redux Docs > Usage With Typescript > [Type Checking Redux Thunks](https://redux.js.org/usage/usage-with-typescript#type-checking-redux-thunks), it recommends using the following to type thunks:

```typescript
export type AppThunk<ReturnType = void> = ThunkAction<
  ReturnType, // return type of the thunk function
  RootState, // state type used by getState
  unknown, // any ""extra argument"" injected into the thunk
  UnknownAction // known types of actions that can be dispatched
>
```

In the RTK Docs > Usage with Typescript > [Defining a Pre-Typed createAsyncThunk](https://redux-toolkit.js.org/usage/usage-with-typescript#defining-a-pre-typed-createasyncthunk), it recommends the following to type `createAsyncThunk`:

```typescript
const createAppAsyncThunk = createAsyncThunk.withTypes<{
  state: RootState
  dispatch: AppDispatch
  rejectValue: string
  extra: { s: string; n: number }
}>()
```

I'm using both of these in my apps, but when I try to dispatch a thunk created using `createAppAsyncThunk` from a regular thunk, it's flagging a type error.

## What is the problem?

From what I can see, it seems the two approaches type `dispatch` differently. The first approach (with `AppThunk`) types the `dispatch` parameter as `ThunkDispatch<RootState, unknown, UnknownAction>` but the second approach (with `createAsyncThunk.withTypes`) types the `dispatch` parameter as `ThunkDispatch<RootState, undefined, UnknownAction>` which is causing a problem,

## What should be changed to fix the problem?

I was able to fix the problem like this:

```typescript
export type AppThunk<ReturnType = void> = ThunkAction<
  ReturnType,
  RootState,
  undefined, // changed this from unknown to undefined
  UnknownAction
>
```",['TypeScript'],open,2023-09-21T09:22:06Z,,bug,['typescript'],True,,
reduxjs/redux,4546,Update core lib API docs to mention `createStore` deprecation and point to RTK,"Per [this comment on Stack Overflow](https://stackoverflow.com/questions/71944111/redux-createstore-is-deprecated-cannot-get-state-from-getstate-in-redux-ac/71947129?noredirect=1#comment134420487_71947129), the core lib docs don't mention that `createStore` is deprecated, and they don't talk about RTK at all.

We should fix that.",['docs'],closed,2023-05-11T23:39:04Z,2023-12-11T14:30:14Z,bug,['docs'],True,213.0,
reduxjs/redux,4495,"Improve ""Essentials"" and ""Fundamentals"" tutorial instructions and differentiation","Per Laurie Voss:

- https://mastodon.social/@seldo@alpaca.gold/109973908464601519

> The official ""how to use Redux"" tutorial is literally 7 hours of ""here's how to do it"" followed immediately by a part 8 which is ""j/k you don't need to do any of that stuff we wrote a library"" and I have some feedback on the structure of this documentation.


Further feedback:

- https://mastodon.social/@seldo@alpaca.gold/109976972365346083 and following

> So, coming into it from nowhere, there's little indication about whether ""essentials"" or ""fundamentals"" are a better place to start. The end of the ""quick start"" suggests doing both without saying in what order or how they differ (the tutorials index page does, but I didn't find that page until I was writing this message).
> 
> Google searches for how to do various things in redux kept landing me on Fundamentals and not on Essentials.
> 
> RTK Query was described as ""new"" and ""not essential"" so I avoided the Essentials tutorial on the basis that it was introducing more concepts than I seemed to need at once.
> 
> The introduction section clearly says ""Redux toolkit is how you should learn redux"" (https://redux.js.org/introduction/why-rtk-is-redux-today) (good!) but nowhere does it say ""Redux essentials is the tutorial that teaches you how to use redux toolkit"" and nowhere in the outline of Essentials is the word ""toolkit"" (unless you know in advance what RTK stands for).","['help wanted', 'docs']",closed,2023-03-06T15:19:18Z,2023-03-07T05:00:31Z,bug,"['help wanted', 'docs']",True,0.0,
reduxjs/redux,4480,Tutorials need to show `ReactDOM.createRoot()` to match React 18,"Both the ""Essentials"" and ""Fundamentals"" tutorials are currently showing `ReactDOM.render()`, and that needs to be update to match React 18.",['docs'],open,2023-02-11T16:58:23Z,,bug,['docs'],True,,
reduxjs/redux,4472,Share expectations/best practices for Redux middleware,"As discussed in an [rtk query issue](https://github.com/reduxjs/redux-toolkit/issues/3118#issuecomment-1403784368), there are some implicit assumptions about how middleware should be written to be compatible with other Redux libraries. Even though it is possible to write any kind of middleware, it would be helpful to document these assumptions so that middleware written by different people is compatible.

## For Adding New Content

### What kind of content category is this page (tutorial, how-to, explanation, reference)?

Reference

### Who is the intended target audience?

Devs writing their own middleware

#### What knowledge are we assuming they have?

How to write middleware

### What are the intended results or takeaways from reading this page?

How to write middleware that is compatible with other redux projects like redux toolkit.

### What is the most critical info they should learn?

That the middleware should not change the return value (even to a Promise) and needs to call next with an action.
",['docs'],closed,2023-01-26T21:10:12Z,2023-04-23T12:30:56Z,bug,['docs'],True,86.0,
reduxjs/redux,4464,Document usage of selectFromState thunk,"## What docs page is being updated?

- **Section**: Using Selectors with React-Redux
- **Page**: Deriving Data with Selectors

### What updates should be made to the page?
Adding documentation regarding the `selectFromState` thunk for selecting the most recent value from state when you only have access to `dispatch`, or want a one-time read from state without a subscription.
```ts
const selectFromState = <Selected>(selector: (state: RootState) => Selected): AppThunk<Selected> => (dispatch, getState) => selector(getState());

const users = dispatch(selectFromState(selectUsers));
```

### Do these updates change any of the assumptions or target audience? If so, how do they change?
I don't think so - this is a pattern often advised to use to help people who need a one-shot selection rather than maintaining a subscription.

raising after discussion with @markerikson in Reactiflux :)",['docs'],open,2023-01-16T16:37:16Z,,performance,['docs'],True,,
reduxjs/redux,4421,Redux FAQ: Organizing State Outdated,"## What docs page needs to be fixed?

- **Faq**:
- **Redux FAQ: Organizing State**:

https://redux.js.org/faq/organizing-state

## What is the problem?

I was looking at this today and this FAQ seems outdated.

In particular, it links to two community packages that have been out of date since 2015:

[redux-component](https://github.com/tomchentw/redux-component), [redux-react-local](https://github.com/threepointone/redux-react-local)

It also makes mention of this.setState().

There is no mention of RTK, useSelector, or react hooks.

As a beginner, this is a very confusing page to come across via Google.

## What should be changed to fix the problem?

Ideally - it should be updated. If not - it should be marked as depreciated or removed.",['docs'],open,2022-09-23T14:04:18Z,,bug,['docs'],True,,
reduxjs/redux,4393,"Rewrite ""Redux Essentials"" tutorial to be TS-first and show RTK 2.0 usage","The ""Essentials"" tutorial currently uses _only_ plain JS for all of the examples and content.

If you want to learn how to use Redux with TS, we have two separate pages:

- ""TS Quick Start"", which just gives quick examples of inferring types from the store, defining typed hooks, declaring slice state and action types, and using the hooks
- The longer ""TS Usage"" guide page, which is a laundry list of various use cases

Unfortunately neither of those have any larger context for how TS gets used in practice.

I _want_ the ""Essentials"" tutorial to cover TS usage.  However, some of the suggested approaches are impractical:

- If we rewrite the entire tutorial to be TS-first/only, then it adds an extra barrier to learning for anyone who doesn't know TS yet.  Since we do have a lot of folks still being pushed into Redux fairly early on, this is likely to be a significant number of people who would now have to decipher TS on top of Redux basics
- The next obvious approach is ""use a TS/JS language toggle"".  We already do this in the RTK docs for the examples, and we _did_ just add that same capability to the Redux core docs.  _However_... the tutorial is way more than just some example snippet blocks.  It's an entire app repo with a commit history.  In addition, there's a ton of explanations of ""here's what this code is doing"", and the point of this is to explain how to use TS for as much of the actual app code as possible. If we were to make all the code toggleable, then we'd somehow have to start toggling large chunks of explanation, too.  Technically feasible, but this would be extremely hard to write coherently.

I think the best approach is to add a ""Redux Essentials, Part 9: Redux and TypeScript"" page that would cover the TS material as a capstone to the tutorial sequence.  I'm picturing a page that would run through some of the key code sections and API examples from the earlier pages in the tutorial, and explain how you'd write that same code from scratch with TS.

There was also a great suggestion on Twitter here at https://twitter.com/MikeLunarLandis/status/1551777390447079425 :

> I can see prefacing the JS docs with a ""We'll cover the TS-specific stuff at the end"" note. Then, where it's important in the JS docs for TS folks to know about, say, inference adapters, add a ""TS"" badge that references the relevant section at the end.

I think that strikes a good balance between showing meaningful examples of TS usage, and not having to maintain multiple copies or weird back-and-forths in the main tutorial sequence.",['docs'],closed,2022-07-26T04:08:03Z,2024-08-01T19:01:08Z,security,['docs'],True,737.0,
reduxjs/redux,4389,"[Docs] Add admonitions warning about tutorials teaching ""redux"" vs ""redux toolkit""","## What docs page needs to be fixed?

- Home Page
- Tutorial Pages

## What is the problem?

As both a new developer (1-2 years experience) and new to the redux ecosystem, I'll be the first to admit that I'm guilty of the comment made by @markerikson in his [Twitter post](https://twitter.com/acemarke/status/1213898963679633411). Essentially when I, as I'm sure many (if not most) new devs, want to learn about a way to have a global state or share state across react components, the most vocal solution is always **redux**, leading us to follow these next steps:

1. Google ""redux tutorial"" or ""redux""
2. (sometimes) See the official redux page and click it, then go to the docs site (either the home page or the ""Redux Fundamentals"" page depending on what the first result is)
3. Get ""scared"" at how much information there is on the docs site
4. Click the next-closest blog or video tutorial because they look less intimidating
5. Learn from there...

The obvious (in hindsight) flaw in this plan is that the next-closest tutorials normally use pre-toolkit redux. The only reason I noticed redux toolkit exists is that people kept complaining about the ""boilerplate"" and ""complexity"" that redux has and I had started looking for alternatives (zustand, recoil, jotai, etc).

There's definitely a larger fundamental issue with the documentation community in steps 2 and 3, where beginner devs would historically look at the docs of some library or framework only to realize that the docs don't have enough focus on the practical side of the tool versus a blog or video teaching how to make an example application with the tool. This problem might be a bit too out of scope for this little issue ticket.

Instead I want to focus on the ""pre-toolkit redux tutorials"" issue, hopefully getting people to come to the 2 conclusions stated in the [official documentation](https://redux.js.org/introduction/why-rtk-is-redux-today#why-we-want-you-to-use-redux-toolkit):

> We specifically recommend that our users should use Redux Toolkit (the @reduxjs/toolkit package), and should not use the legacy redux core package for any new Redux code today!

> The redux core package still works, but today we consider it to be obsolete.

## What should be changed to fix the problem?

Place a red ""warning"" admonition on the home page and at the top of tutorial pages saying something along the lines of:

> The redux core package still works, but today we consider it to be **obsolete**. We specifically recommend that our users should use Redux Toolkit (the @reduxjs/toolkit package), and should not use the legacy redux core package for any new Redux code today! Even for existing applications, we recommend at least switching out createStore for configureStore as the dev-mode middleware will also help you catch accidental mutation and serializability errors in existing code bases. If you still want to learn outside the official docs, then unless specifically needed, please prioritize tutorials teaching Redux Toolkit as they are more likely to teach the **simpler** way of using redux.

(Note that I directly copied and pasted most of these sentences from the official docs)

This can hopefully catch a large handful of developers at step 2, at least sending them in a better direction when working on one of two scenarios:

- A developer working on a brand new project who wants to implement a global state or shared state across React components
- A developer working on an established project that is currently using the older way of redux, unaware of the existence of redux toolkit (and so won't consider that an easier way exists!)",['docs'],open,2022-07-20T23:23:54Z,,bug,['docs'],True,,
reduxjs/redux,4375,[tutorial] Reactions update is broken in <SinglePostPage />,"## Steps To Reproduce

1. Click ""View Post"" for any post
2. Click the reactions


Link to code example: The codesandbox [here](https://redux.js.org/tutorials/essentials/part-8-rtk-query-advanced#what-youve-learned)

## The current behavior
Reactions work for the post list page, not for the single post page.

## The expected behavior
1. Reactions work for single post page
2. Reactions sync in both list list page and single post page.",['docs'],open,2022-06-17T09:26:22Z,,bug,['docs'],True,,
reduxjs/redux,4356,"[Docs] Add new ""side effect options and comparison"" page","Basically a docs page version of https://blog.isquaredsoftware.com/2022/05/presentations-evolution-redux-async-logic/



Also, this page is similar: https://nordfjord.io/2020/08/31/async-redux.html",['docs'],closed,2022-05-22T22:05:41Z,2022-12-27T22:35:14Z,bug,['docs'],True,219.0,
reduxjs/redux,4317,"Reducer returns instead of modifying state in ""loading users"" section","## What docs page needs to be fixed?

- **Section**: Loading Users
- **Page**: https://github.com/reduxjs/redux/blob/master/docs/tutorials/essentials/part-5-async-logic.md

## What is the problem?

I am currently going through the essentials tutorial. I feel like I have understood what reducers are for and what they do... until I hit the ""loading users"" section.  

All reducers up to this point do not return anything, but only ""modify"" the state. I understand this is relying on Immer to make turn the mutations into immutable operations on a new object. 

The confusion for me is that the reducer that is passed to `builder.addCase` is returning `action.payload` and does not do anything with `state`.

```
const usersSlice = createSlice({
  name: 'users',
  initialState,
  reducers: {},
  extraReducers(builder) {
    builder.addCase(fetchUsers.fulfilled, (state, action) => {
      return action.payload
    })
  }
})
```

There is no explanation why this reducer is different. I does not seem to be the fact that it is in `builder.addCase`. I infer this because just above in the ""Loading posts"" section the reducers modify state just like anywhere else in the tutorial. 

```
  extraReducers(builder) {
    builder
      .addCase(fetchPosts.pending, (state, action) => {
        state.status = 'loading'
      })
      .addCase(fetchPosts.fulfilled, (state, action) => {
        state.status = 'succeeded'
        // Add any fetched posts to the array
        state.posts = state.posts.concat(action.payload)
      })
      .addCase(fetchPosts.rejected, (state, action) => {
        state.status = 'failed'
        state.error = action.error.message
      })
  }
```

## What should be changed to fix the problem?

An explanation should be added as to why it is necessary in the ""loading user"" section to return something from the reducer instead of just ""modifying"" the state. 

Or change the code example to be consistent with the rest. 
",['docs'],closed,2022-03-22T13:58:20Z,2022-03-23T15:28:18Z,bug,['docs'],True,1.0,
reduxjs/redux,4299,[Docs Fix] Align Tag with Heading in Style Guide,"## What docs page needs to be fixed?

- **Section**: Style Guide
- **Page**: Style Guide

## What is the problem?
The headings aren't aligned with the tags `ESSENTIAL`, `RECOMMENDED` and `STRONGLY RECOMMENDED`, as shown in the screenshots, below.

![Screenshot 2022-02-23 at 11 43 35 PM](https://user-images.githubusercontent.com/55204045/155383080-503fd74b-337d-4f62-aafb-ee041e4ff205.png)
![Screenshot 2022-02-23 at 11 49 32 PM](https://user-images.githubusercontent.com/55204045/155383090-25621a17-08ba-4d51-ad45-838aade24197.png)
![Screenshot 2022-02-23 at 11 53 05 PM](https://user-images.githubusercontent.com/55204045/155383096-e024e977-b156-455c-bcf5-cf7d80fe2d10.png)

## What should be changed to fix the problem?
The alignment property for these tags need to be kept in sync with the heading in order to prevent the distortion.
","['help wanted', 'docs']",closed,2022-02-23T18:25:20Z,2022-02-26T18:30:51Z,bug,"['help wanted', 'docs']",True,3.0,
reduxjs/redux,4266,Redux Essentials RTKQuery can now be updated to mention the released devtools RTKQuery dock,"## What docs page needs to be fixed?

- **Section**: Redux Essentials 
- **Page**: RTKQuery Basic

## What is the problem?

In [RTKQuery basics](https://github.com/reduxjs/redux/blob/master/docs/tutorials/essentials/part-7-rtk-query-basics.md),
the devtools extension to view RTKQuery is mentioned as being a WIP. It has since been released in devtools 3.0.0

## What should be changed to fix the problem?

Replace the mention of WIP with a description of the devtools feature.",['docs'],open,2022-01-16T19:24:31Z,,bug,['docs'],True,,
reduxjs/redux,4234,Normalizing State Shape - Relationships and Tables​ - Join/associative table example,"First of all, I love the new documentation, last time I checked it was years ago and was way more confusing.

## What docs page needs to be fixed?

Using Redux > Redux logic and patterns > Structuring reducers > Nomalizing State Shape:  
- Relationships and Tables​ > Join/associative table example
https://redux.js.org/usage/structuring-reducers/normalizing-state-shape#relationships-and-tables

## What is the problem?

From the documentation, we have this given code:
```javascript
{
    entities: {
        authors : { byId : {}, allIds : [] },
        books : { byId : {}, allIds : [] },
        authorBook : {
            byId : {
                1 : {
                    id : 1,
                    authorId : 5,
                    bookId : 22
                },
                2 : {
                    id : 2,
                    authorId : 5,
                    bookId : 15,
                },
                3 : {
                    id : 3,
                    authorId : 42,
                    bookId : 12
                }
            },
            allIds : [1, 2, 3]

        }
    }
}
```
It is stated:
> Operations like ""Look up all books by this author"", can then be accomplished easily with a single loop over the join table.

If I understood well, the goal is to loop over `authorBook` keys to save all `bookId`s where `authorId` is the one we want.  
I struggle to understand how it is better than retrieving `bookId`s directly with `authors.byId[id].books`?
However, if we didn't want to store `bookId`s inside the `author` schema, we could have used a look up table like this one:
```javascript
booksByAuthorId : {
                5 : {
                    authorId : 5,
                    bookIds : [22, 23]
                },
           }
```
Wouldn't it make more sense?

I asked my backend team and they were also confused about it.

It would be really appreciated if someone could enlighten us.

## What should be changed to fix the problem?

If we couldn't understand it, maybe it's a sign it needs to be more explicit (e.g. more/better examples).",['docs'],open,2021-12-08T14:58:37Z,,bug,['docs'],True,,
angular/angular,61746,Prevent viewport scrolling for particular calls of Router.navigate(),"### Which @angular/* package(s) are relevant/related to the feature request?

_No response_

### Description

It should be possible to block the scrolling of the view to the top of the page after calling the `Router.navigate()` method. This would be especially helpful when we want to update queryParams without unwanted page scrolling to the top. At the moment, a similar effect can be achieved using `Location.go()`. However, in this case, the queryParams update event is not emitted by `ActivatedRoute.queryParams`

### Proposed solution

To the `NavigationExtras` add new option `override preservePosition?: boolean | undefined`

The function call would look like this:
```JavaScript
this.router.navigate([], {
  queryParams: { param1: 'value1', param2: 'value2' },
  queryParamsHandling: 'merge',
  preservePosition: true
});
```

### Alternatives considered

Consider adding a global configuration to prevent scrolling of the viewport after navigation to the `ExtraOptions` or `InMemoryScrollingOptions`",['area: router'],closed,2025-05-29T09:48:19Z,2025-05-29T14:10:15Z,bug,['area: router'],True,0.0,
angular/angular,61742,Navigating to link of route-data-resolvers from Angular routing documentation leads to not-found-page,"### Describe the problem that you experienced

Hit to the [URL](https://angular.dev/guide/routing/define-routes#dynamic-data-with-data-resolvers)

And then click on check out the [guide on route data resolvers](https://angular.dev/guide/router/route-data-resolvers).

It will land to a not found page.

### Enter the URL of the topic with the problem

https://angular.dev/guide/routing/define-routes#dynamic-data-with-data-resolvers

### Describe what you were looking for in the documentation

_No response_

### Describe the actions that led you to experience the problem

_No response_

### Describe what you want to experience that would fix the problem

_No response_

### Add a screenshot if that helps illustrate the problem

https://github.com/user-attachments/assets/5345c6cf-5d9a-464c-b501-dda676999edb

### If this problem caused an exception or error, please paste it here

```true

```

### If the problem is browser-specific, please specify the device, OS, browser, and version

```true

```

### Provide any additional information here in as much as detail as you can

```true

```",['area: docs'],open,2025-05-29T06:02:06Z,,bug,['area: docs'],True,,
angular/angular,61739,Unable to execute ng g @angular/core:control-flow on V20,"### Which @angular/* package(s) are the source of the bug?

core

### Is this a regression?

Yes

### Description

Tried executing ng generate @angular/core:control-flow on angular CLI and i get the error

`Schematic ""control-flow"" not found in collection ""@angular/core"".`

Tried on newly created v20 project and even updating older from v19 to v20

![Image](https://github.com/user-attachments/assets/56d6f080-78d5-4cbe-8ab7-f4c4765252b4)

### Please provide a link to a minimal reproduction of the bug

_No response_

### Please provide the exception or error you saw

```true
Schematic ""control-flow"" not found in collection ""@angular/core"".

```

### Please provide the environment you discovered this bug in (run `ng version`)

```true
Angular CLI: 20.0.0
Node: 22.2.0
Package Manager: npm 10.7.0
OS: win32 x64

Angular: 20.0.0
... build, cli, common, compiler, compiler-cli, core, forms
... platform-browser, router

Package                      Version
------------------------------------------------------
@angular-devkit/architect    0.2000.0
@angular-devkit/core         20.0.0
@angular-devkit/schematics   20.0.0
@schematics/angular          20.0.0
rxjs                         7.8.2
typescript                   5.8.3
zone.js                      0.15.1
```

### Anything else?

_No response_",['area: docs'],open,2025-05-29T04:11:28Z,,bug,['area: docs'],True,,
angular/angular,61725,preserveWhitespaces can break defer placeholder detection,"### Which @angular/* package(s) are the source of the bug?

compiler

### Is this a regression?

No

### Description

If the element inside the placeholder of a defer is not directly adjacent to the opening brace and `preserveWhitespaces` is active, the build fails with `NG5002: ""viewport"" trigger with no parameters can only be placed on an @defer that has a @placeholder block with exactly one root element node`.

Broken:
```
template: `
  @defer (on viewport) {
    <div></div>
  } @placeholder {
    <div></div>
  }
`,
preserveWhitespaces: true,
```

Working:
```
template: `
  @defer (on viewport) {
    <div></div>
  } @placeholder {<div></div>}
`,
preserveWhitespaces: true,
```


### Please provide a link to a minimal reproduction of the bug

https://stackblitz.com/edit/stackblitz-starters-3q3h25jf?file=src%2Fmain.ts

### Please provide the environment you discovered this bug in (run `ng version`)

```true
Angular CLI: 19.2.13
Node: 22.15.0
Package Manager: npm 11.3.0
OS: darwin arm64

Angular: 19.2.13
... cli, common, compiler, compiler-cli, core, forms
... platform-browser, platform-browser-dynamic, router

Package                         Version
---------------------------------------------------------
@angular-devkit/architect       0.1902.13
@angular-devkit/build-angular   19.2.13
@angular-devkit/core            19.2.13
@angular-devkit/schematics      19.2.13
@schematics/angular             19.2.13
rxjs                            7.8.2
typescript                      5.7.3
zone.js                         0.15.1
```

### Anything else?

This behavior was initially found and filed as an issue in angular-eslint since it calls the compiler with `preserveWhitespaces: true`: https://github.com/angular-eslint/angular-eslint/issues/2474","['state: has PR', 'area: compiler']",closed,2025-05-28T14:53:51Z,2025-05-30T17:45:02Z,bug,"['state: has pr', 'area: compiler']",True,2.0,
angular/angular,61721,Feature Request: Hook or API to detect successful completion of initial hydration,"### Which @angular/* package(s) are relevant/related to the feature request?

platform-server

### Description

We've run into issues with hydration from time to time when a new feature would break hydration but we wouldn't notice for a while. 
Currently, we manually check for hydration success by watching for the `angular hydrated n components`  message in the console, which is not ideal for automation or robust testing.
To avoid this, we want to add an additional e2e test to our codebase, that checks whether initial hydration was successful or not.

But there seems to be no straightforward way in Angular to programmatically detect when the initial hydration process has completed and the application has become fully stable for the first time. 

### Proposed solution

Introduce a hook, event, or public api that allows developers to detect when the initial hydration process has completed and the application is stable for the first time. This could be a lifecycle event or a promise that resolves when the initial hydration is done. We don't care about deferred hydration components.
Basically the same as the `angular hydrated n components` message but as api.

### Alternatives considered

We're thinking of using `isStable` for the time being to detect when the app first becomes stable, but because the application has become stable doesn't necessarily mean that hydration was successful. There can be other issues stopping hydration from working properly, like html mismatch etc.","['area: core', 'core: hydration']",open,2025-05-28T13:38:53Z,,bug,"['area: core', 'core: hydration']",True,,
angular/angular,61717,Test wrapped in waitForAsync does not receive parameterized values from jest it.each,"### Which @angular/* package(s) are the source of the bug?

core

### Is this a regression?

Yes

### Description

When a parameterized jest test, with it.each is wrapped in a `waitForAsync` all the parameterized values are passed to the test as`undefined`.

If the test is not wrapped in `waitForAsync` the parameterized values are passed correctly.

```ts
// values are passed as undefined

it.each([
      ['first', 1],
      ['second', 2],
      ['third', 3],
    ])(
      'My Test %s %s',
      waitForAsync((param1: string, param2: number) => {
        console.log('param1', param1) // undefined;
        console.log('param2', param2) // undefined;

        ...
      }),
    );
```

When using a normal array to iterate over parameters it seems to work fine.
```ts
// Values are passed properly

[
      { param1: 'first', param2: 1 },
      { param1: 'second', param2: 2 },
      { param1: 'third', param2: 3 },
    ].forEach(({ param1, param2 }) => {
      it(`My test with params ${param1} and ${param2}`, waitForAsync(() => {
        console.log('param1', param1) // 'first' | 'second' | 'third';
        console.log('param2', param2); // 1 | 2 | 3

        ...
      }))
    });
```

### Please provide a link to a minimal reproduction of the bug

https://github.com/timhonermann/it-each-wait-for-async-issue/blob/main/README.md

### Please provide the exception or error you saw

```true
No error or exception.
```

### Please provide the environment you discovered this bug in (run `ng version`)

```true
Angular CLI: 19.2.13
Node: 22.2.0
Package Manager: npm 10.7.0
OS: linux x64

Angular: 19.2.13
... cli, common, compiler, compiler-cli, core, forms
... platform-browser, platform-browser-dynamic, router

Package                         Version
---------------------------------------------------------
@angular-devkit/architect       0.1902.13
@angular-devkit/build-angular   19.2.13
@angular-devkit/core            19.2.13
@angular-devkit/schematics      19.2.13
@schematics/angular             19.2.13
rxjs                            7.8.2
typescript                      5.7.3
zone.js                         0.15.1
```

### Anything else?

_No response_","['area: testing', 'area: zones']",closed,2025-05-28T10:14:34Z,2025-06-09T18:22:26Z,bug,"['area: testing', 'area: zones']",True,12.0,
angular/angular,61710,Add link with absolute URL to docs on each public API,"### Which @angular/* package(s) are relevant/related to the feature request?

_No response_

### Description

Docs are **not** easily discoverable from the IDE.

### Proposed solution

It would be nice if each public API had a link in its jsdoc pointing to the docs. e.g. `@see {@link https://v20.angular.dev/api/…}`

The link would then be visible to anyone hovering a public API in most IDEs.

It would be useful because:
- it can target the right version directly
- users get less hijacked by other resources by searching or prompting
- users might read the docs more frequently
",['area: docs'],open,2025-05-27T22:20:29Z,,bug,['area: docs'],True,,
angular/angular,61702,"Suggestion: Add ""Updated"" and ""New"" badges in documentation menu to highlight recent changes per Angular version","### Describe the problem that you experienced

Hi Angular team,

First of all, thank you for your continuous work on the Angular framework and its documentation. I’d like to suggest a small but useful improvement to the documentation site that could enhance the developer experience when navigating through versioned docs.

**Suggestion**
It would be incredibly helpful to include visual indicators (badges) such as **""New""** or **""Updated""** next to items in the documentation sidebar/menu that have changed since the previous major Angular release.

**Why it matters**
When developers browse the documentation for a specific version of Angular (e.g., 19.x or 20.x), it's currently difficult to tell what has changed or been added compared to the previous version. Adding badges like:

**""New"" – for entirely new sections/pages**

**""Updated"" – for pages with significant updates or API changes**

...would make it much easier to:

- Quickly locate what's new or updated in a given Angular release
- Stay up to date with best practices and API changes
- Use the docs more effectively without needing to compare changelogs manually

This kind of labeling is already common in the documentation of other major frameworks and tools, and it can significantly improve navigation and the learning experience.

**Implementation idea**
These badges could be displayed for a particular version of the docs and reset or change with each new major version. They could also link to the relevant changelog entry or diff for more context.
I really like how simply **PrimeNG** solved this on their website using exactly these kinds of badges.

![Image](https://github.com/user-attachments/assets/7de14365-9f3b-44a5-9dd9-fecb8468ca0d)

**Example in Angular:**

![Image](https://github.com/user-attachments/assets/629818ec-bf68-42e1-ba9e-b65c38f63985)

![Image](https://github.com/user-attachments/assets/adbbe886-22fe-4825-a040-f15ab354a366)

**Thanks again for your consideration, and for all the work you put into Angular!**

",['area: docs'],open,2025-05-27T08:59:49Z,,bug,['area: docs'],True,,
angular/angular,61692,"Caching issue, when dynamically loading locales","### Which @angular/* package(s) are the source of the bug?

common

### Is this a regression?

No

### Description

When loading locales dynamically and not using `registerLocaleData` which happens, if you load locales as script form a asset folder for example, there is an issue with locales that are cached in the `locale_data_api`. Those are not updated:

https://github.com/angular/angular/blob/c11527fc68965fee9799cc4d1f6f0ea33fce98ce/packages/core/src/i18n/locale_data_api.ts#L103-L112

when `getLocaleData` is called with a locale that isn't loaded yet, it will set the cached `LOCALE_DATA` for the specific locale, but this won't be updated the next time `getLocaleData` is called, if the locale is loaded by that time. so this will always mismatch and throw an error. `registerLocaleData` on the other hand overwrites the Local in `LOCALE_DATA` whenever called.

I think the correct behavior would be to check not only if `normalizedLocale` is `in LOCALE_DATA` but if it holds valid locale data and if not, try to reload the locale from `global`.

### Please provide a link to a minimal reproduction of the bug

_No response_

### Please provide the exception or error you saw

```true
NG0701
```

### Please provide the environment you discovered this bug in (run `ng version`)

```true
Angular CLI: 19.2.11
Node: 20.18.0
Package Manager: npm 10.8.2
OS: win32 x64

Angular: 19.2.10
... animations, common, compiler, compiler-cli, core, forms
... language-service, localize, platform-browser
... platform-browser-dynamic, router

Package                         Version
---------------------------------------------------------
@angular-devkit/architect       0.1902.11
@angular-devkit/build-angular   19.2.11
@angular-devkit/core            19.2.11
@angular-devkit/schematics      19.2.11
@angular/cdk                    19.2.15
@angular/cli                    19.2.11
@schematics/angular             19.2.11
rxjs                            7.8.2
typescript                      5.8.3
zone.js                         0.15.0
```

### Anything else?

I can provide a PR if needed","['area: i18n', 'needs: clarification']",open,2025-05-26T16:02:43Z,,bug,"['area: i18n', 'needs: clarification']",True,,
angular/angular,61684,"TS-994005: Angular compiler option ""extendedDiagnostics.checks"" has an unknown check: ""missingStructuralDirective""","### Which @angular/* package(s) are the source of the bug?

compiler-cli

### Is this a regression?

No

### Description

Extended diagnostics for missingStructuralDirective (19.2+) not available at build time.
It works for vscode ts service though.

### Please provide a link to a minimal reproduction of the bug

https://stackblitz.com/edit/stackblitz-starters-qywmvntd?file=tsconfig.json

### Please provide the exception or error you saw

```true
✘ [ERROR] TS-994005: Angular compiler option ""extendedDiagnostics.checks"" has an unknown check: ""missingStructuralDirective"".

Allowed check names are:
controlFlowPreventingContentProjection
unusedStandaloneImports
invalidBananaInBox
nullishCoalescingNotNullable
optionalChainNotNullable
missingControlFlowDirective
textAttributeNotBinding
missingNgForOfLet
suffixNotSupported
interpolatedSignalNotInvoked
uninvokedFunctionInEventBinding
unusedLetDeclaration
skipHydrationNotStatic [plugin angular-compiler]
```

### Please provide the environment you discovered this bug in (run `ng version`)

```true
Angular CLI: 19.2.13
```

### Anything else?

_No response_",['area: compiler'],closed,2025-05-26T12:02:17Z,2025-05-26T12:49:22Z,bug,['area: compiler'],True,0.0,
angular/angular,61715,"bug(form-field): Uncaught exception when used inside custom element ""TypeError: fn is not a function"" [ver >= 20.0.0-rc.1]","### Is this a regression?

- [x] Yes, this behavior used to work in the previous version

### The previous version in which this bug was not present was

@angular/material 20.0.0-rc.0

### Description

When form-field is used inside a custom element and afterRenderEffect is triggered (_syncOutlineLabelOffset() in https://github.com/angular/components/blob/main/src/material/form-field/form-field.ts), the below unhandled exception is thrown.

```
TypeError: fn is not a function
    at AfterRenderEffectSequence.destroy (core.mjs:4238:17)
    at debug_node-Nc-zr65s.mjs:16753:69
    at processCleanups (debug_node-Nc-zr65s.mjs:8113:13)
    at cleanUpView (debug_node-Nc-zr65s.mjs:8048:9)
    at destroyViewTree (debug_node-Nc-zr65s.mjs:7984:21)
    at destroyLView (debug_node-Nc-zr65s.mjs:8021:5)
```

The passing of signels from one phase to the next fails when running inside a custom element. This is a more generic problem than this bug report, but the only place this functionality is used in angular (core and material) as far as I could search on github is here.

It was introduced in this commit: https://github.com/angular/components/pull/31086: **perf(material/form-field): split DOM accesses into read and write**

### Reproduction

StackBlitz link: 
Steps to reproduce:
1. 
2.


### Expected Behavior

It works as in 20.0.0-rc.0

### Actual Behavior

An exception is thrown:

```
TypeError: fn is not a function
    at AfterRenderEffectSequence.destroy (core.mjs:4238:17)
    at debug_node-Nc-zr65s.mjs:16753:69
    at processCleanups (debug_node-Nc-zr65s.mjs:8113:13)
    at cleanUpView (debug_node-Nc-zr65s.mjs:8048:9)
    at destroyViewTree (debug_node-Nc-zr65s.mjs:7984:21)
    at destroyLView (debug_node-Nc-zr65s.mjs:8021:5)
```

![Image](https://github.com/user-attachments/assets/966b0768-6bd1-466c-83dc-d21cdc4846c3)

### Environment

- Angular: v20 rc-2
- Angular CLI: v20 rc-3
- CDK/Material: v20 rc-2
- Browser(s): All
- Operating System (e.g. Windows, macOS, Ubuntu): Windows
","['needs reproduction', 'area: core', 'needs triage']",open,2025-05-25T23:06:09Z,,bug,"['needs reproduction', 'area: core', 'needs triage']",True,,
akveo/ngx-admin,5589,Side Menu Items with expanded set to true - Not working properly if Side menu is collapsed ***Reproducible on NGX-Admin-Demo***,"**I'm submitting a ...

* [x] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
I have a Side menu item with children that has expanded set to be true. If I hit the breakpoint to make the Side menu icons only the sub-menus collapse(this is expected). However, if I click a menu item, the side drawer comes out, and expanded becomes false and I can see the submenu close as though I clicked it to close.

**Expected behavior:**
If I expand the side menu from the Icon only breakpoint the submenus should stay open as they are not able to be seen while the side drawer is closed.

**Steps to reproduce:**

- Add a side menu item with children
- Set the parent with property expanded to true
- Make window side small enough so that side menu only shows icons
- Click the parent Menu Items icon

This is also reproducible on the ngx-admin-demo page.

- Collapse the menu
- Click the Layout Icon
- The drawer expands and closes the layout submenu

Here is the menu item with children
```
{
    title: 'Members',
    icon: 'people-outline',
    expanded: true,
    children: [
      {
        title: 'Managers',
        link: 'managers',
      },
      {
        title: 'Employees',
        link: 'employees',
      },
    ],
  },
```

### Other information:

**npm, node, OS, Browser**

Node: 12.12.1
npm: 6.12.1
MacOS: Catalina 10.15.2
Browser: Chrome

**Angular, Nebular**

Angular: 8.2.14
Nebular: 4.6.0
",['needs triage'],open,2020-01-17T17:17:34Z,,bug,['needs triage'],True,,
akveo/ngx-admin,5588,"""export 'NbAutocompleteModule' was not found in '@nebular/theme'","I am trying to add auto-complete feature in my application.
in module.ts i am importing:- 
```
import {
   NbUserModule,NbTabsetModule, NbAutocompleteModule,
} from '@nebular/theme';

imports: [
NbUserModule,
NbTabsetModule,
NbAutocompleteModule
]
But when i am trying to compile it is throwing error:-
    ERROR in src/app/pages/vehicles/vehicles.module.ts(10,48): error TS2305: Module '""../../../../node_modules/@nebular/theme""' has no exported member 'NbAutocompleteModule'.

```



<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [ ] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
<!-- Describe how the bug manifests. -->

**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->

**Related code:**
<!-- 
If you are able to illustrate the bug or feature request with an example, please provide a sample application via one of the following means:

A sample application via GitHub

StackBlitz (https://stackblitz.com)

Plunker (http://plnkr.co/edit/cpeRJs?p=preview)

-->

```
insert short code snippets here
```

### Other information:

**npm, node, OS, Browser**
```
<!--
Node, npm: `node --version` and `npm --version`
OS: Windows (7/8/10). Linux (incl. distribution). macOS (El Capitan? Sierra?)
Browser: Chrome/Safari/Firefox/etc?
-->
```

**Angular, Nebular**
```
<!--
Check your `package-lock.json` or locate a `package.json` in the `node_modules` folder.
-->
```
",['question'],open,2020-01-16T01:14:27Z,,bug,['question'],True,,
akveo/ngx-admin,5587,token.getAccessTokenPayload is not a function,"After login, using the asp.net core 3.0 application.   Not sure how to fix this.
` getRole(): Observable<string | string[]> {
    return this.authService.onTokenChange()
      .pipe(
        map((token: any) => {
          const payload = token.getAccessTokenPayload();
          return !!(token.isValid() && payload && payload['role']) ? this.getLowerCaseRoles(payload['role']) : 'user';
        }),
      );
  }``
`core.js:6014 ERROR TypeError: token.getAccessTokenPayload is not a function`
using JWT tokens

**Current behavior:**
<!-- Describe how the bug manifests. -->
core.js:6014 ERROR TypeError: token.getAccessTokenPayload is not a function
**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->",['question'],open,2020-01-13T23:27:10Z,,bug,['question'],True,,
akveo/ngx-admin,5585,Tooltips are cut off in DEMO,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

I'm submitting a 

* [x ] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
<!-- Describe how the bug manifests. -->
I can see tooltips are cut off when nbTooltipPlacement is set to 'left' or 'right' in the live demo.
**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->
""Th"" in ""This is a tooltip"" should be visible with the pointed arrow.
**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->
can be seen in the live demo, link is below.
https://www.akveo.com/ngx-admin/pages/modal-overlays/tooltip
**Related code:**
<!-- 
If you are able to illustrate the bug or feature request with an example, please provide a sample application via one of the following means:

A sample application via GitHub

StackBlitz (https://stackblitz.com)

Plunker (http://plnkr.co/edit/cpeRJs?p=preview)

-->

```
        <nb-actions size=""medium"">
          <nb-action icon=""save-outline"" status=""primary"" 
          [class.btn-pulse]=""submitted"" nbTooltip=""Click to create a new 'Company Type'."" nbTooltipPlacement=""right""></nb-action>
      </nb-actions>
```

### Other information:

**npm, node, OS, Browser**
```
<!--
Node, npm: `node --12.13.1` and `npm --6.12.1`
OS: Windows10
Browser: Chrome/Firefox
-->
```

**Angular, Nebular**
```
<!--
4.4.0
-->
```
![Untitled](https://user-images.githubusercontent.com/23407362/72219574-835f7500-356d-11ea-99fe-f5ec9f803f00.png)
",['bug'],open,2020-01-12T13:29:49Z,,bug,['bug'],False,,
akveo/ngx-admin,5582,NullInjectorError: No provider for NbMenuService in Angular Universal SSR configuration,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [x] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
Ngx admin throws a No provider error while trying to do Server side rendering of a page using Angular Universal. 
```
Error: StaticInjectorError(AppServerModule)[NbMenuItemComponent -> NbMenuService]: 
  StaticInjectorError(Platform: core)[NbMenuItemComponent -> NbMenuService]: 
    NullInjectorError: No provider for NbMenuService!
at NullInjector.get (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3288:23)
    at resolveToken (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3533:28)
    at tryResolveToken (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3477:20)
    at StaticInjector.get (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3374:24)
    at resolveToken (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3533:28)
    at tryResolveToken (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3477:20)
    at StaticInjector.get (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:3374:24)
    at resolveNgModuleDep (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:19805:33)
    at NgModuleRef_.get (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20494:20)
    at resolveNgModuleDep (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:19805:33)
    at NgModuleRef_.get (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20494:20)
    at resolveDep (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20865:49)
    at createClass (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20737:33)
    at createDirectiveInstance (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20616:24)
    at createViewNodes (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:21842:40)
    at Object.createEmbeddedView (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:21750:9)
    at TemplateRef_.createEmbeddedView (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20331:42)
    at ViewContainerRef_.createEmbeddedView (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20197:39)
    at NgIf._updateView (/Users/iRana/bane/node_modules/@angular/common/bundles/common.umd.js:3405:49)
    at NgIf.set [as ngIf] (/Users/iRana/bane/node_modules/@angular/common/bundles/common.umd.js:3373:22)
    at updateProp (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20892:41)
    at checkAndUpdateDirectiveInline (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:20643:23)
    at checkAndUpdateNodeInline (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:21950:24)
    at checkAndUpdateNode (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:21912:20)
    at prodCheckAndUpdateNode (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:22453:9)
    at Object.updateDirectives (/Users/iRana/bane/app_server/main.js:12457:770)
    at Object.updateDirectives (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:22241:76)
    at checkAndUpdateView (/Users/iRana/bane/node_modules/@angular/core/bundles/core.umd.js:21894:18)
```

The `app.module` file already imports ThemeModule which in turn imports NbMenuModule and the NbMenuService providers.


**Expected behavior:**
Server should render the page based on Angular Universal configuration.

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->

**Related code:**
app.module.ts

```
@NgModule({
  declarations: [AppComponent],
  imports: [
    BrowserModule,
    BrowserAnimationsModule,
    HttpClientModule,
    AppRoutingModule,
    NgbModule.forRoot(),
    ThemeModule.forRoot(),
    CoreModule.forRoot(),
    BaneAuthModule,
    SharedModule,
    ShareButtonsModule.forRoot(),
  ],
  bootstrap: [AppComponent],
  providers: [
    CookieService,
    AuthGuardService,
    { provide: APP_BASE_HREF, useValue: '/' },
  ],
  entryComponents: [
  ],
})
export class AppModule {
}
```
Corresponding theme.module.ts
```
import { ModuleWithProviders, NgModule } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule, ReactiveFormsModule } from '@angular/forms';
import { NgbModule } from '@ng-bootstrap/ng-bootstrap';

import {
  NbActionsModule,
  NbCardModule,
  NbLayoutModule,
  NbMenuModule,
  NbRouteTabsetModule,
  NbSearchModule,
  NbSidebarModule,
  NbTabsetModule,
  NbThemeModule,
  NbUserModule,
  NbCheckboxModule,
  NbPopoverModule,
  NbContextMenuModule,
  NbProgressBarModule,
  // NbCalendarModule,
  // NbCalendarRangeModule,
  NbStepperModule,
  NbButtonModule,
  NbInputModule,
  // NbAccordionModule,
  NbDatepickerModule,
  NbDialogModule,
  // NbWindowModule,
  // NbListModule,
  NbToastrModule,
  NbAlertModule,
  NbSpinnerModule,
  NbRadioModule,
  NbSelectModule,
  // NbChatModule,
  NbTooltipModule,
  // NbCalendarKitModule,
} from '@nebular/theme';

import { NbSecurityModule } from '@nebular/security';

import {
  FooterComponent,
  HeaderComponent,
  SearchInputComponent,
  ThemeSettingsComponent,
  ThemeSwitcherComponent,
  // TinyMCEComponent,
} from './components';
import { CapitalizePipe, PluralPipe, RoundPipe, TimingPipe } from './pipes';
import {
  OneColumnLayoutComponent,
  SampleLayoutComponent,
  ThreeColumnsLayoutComponent,
  TwoColumnsLayoutComponent,
} from './layouts';
import { DEFAULT_THEME } from './styles/theme.default';
import { COSMIC_THEME } from './styles/theme.cosmic';
import { DeltaComponent } from './components/delta/delta.component';
import { RouterModule } from '@angular/router';
import { SharePopComponent } from '../shared/share-pop/share-pop.component';
import { ShareButtonsModule } from '@ngx-share/buttons';
import { DecimalRegionPipe } from './pipes/decimal-region.pipe';

const BASE_MODULES = [CommonModule, FormsModule, ReactiveFormsModule];

const NB_MODULES = [
  NbCardModule,
  NbLayoutModule,
  NbTabsetModule,
  NbRouteTabsetModule,
  NbMenuModule,
  NbUserModule,
  NbActionsModule,
  NbSearchModule,
  NbSidebarModule,
  NbCheckboxModule,
  NbPopoverModule,
  NbContextMenuModule,
  NgbModule,
  NbSecurityModule, // *nbIsGranted directive,
  NbProgressBarModule,
  // NbCalendarModule,
  // NbCalendarRangeModule,
  NbStepperModule,
  NbButtonModule,
  // NbListModule,
  NbToastrModule,
  NbInputModule,
  // NbAccordionModule,
  NbDatepickerModule,
  // NbMomentDateModule,
  NbDialogModule,
  // NbWindowModule,
  NbAlertModule,
  NbSpinnerModule,
  NbRadioModule,
  NbSelectModule,
  // NbChatModule,
  NbTooltipModule,
  // NbCalendarKitModule,
  RouterModule,
  ShareButtonsModule,
];

const COMPONENTS = [
  ThemeSwitcherComponent,
  HeaderComponent,
  FooterComponent,
  SearchInputComponent,
  ThemeSettingsComponent,
  // TinyMCEComponent,
  OneColumnLayoutComponent,
  SampleLayoutComponent,
  ThreeColumnsLayoutComponent,
  TwoColumnsLayoutComponent,
  DeltaComponent,
];

const PIPES = [
  CapitalizePipe,
  PluralPipe,
  RoundPipe,
  TimingPipe,
  DecimalRegionPipe,
];

const NB_THEME_PROVIDERS = [
  ...NbThemeModule.forRoot(
    {
      name: 'cosmic',
    },
    [ COSMIC_THEME, DEFAULT_THEME ],
  ).providers,
  ...NbSidebarModule.forRoot().providers,
  ...NbMenuModule.forRoot().providers,
  ...NbDatepickerModule.forRoot().providers,
];

@NgModule({
  imports: [...BASE_MODULES, ...NB_MODULES],
  exports: [...BASE_MODULES, ...NB_MODULES, ...COMPONENTS, ...PIPES],
  declarations: [...COMPONENTS, ...PIPES, SharePopComponent, DecimalRegionPipe],
  entryComponents: [
    SharePopComponent,
  ],
})
export class ThemeModule {
  static forRoot(): ModuleWithProviders {
    return <ModuleWithProviders>{
      ngModule: ThemeModule,
      providers: [...NB_THEME_PROVIDERS],
    };
  }
}
```

### Other information:

**npm, node, OS, Browser**
```
npm - 5.5.1
node - 9.2.0
OS - macOS Sierra
```
**Angular, Nebular**
Here is dependencies section of the package.json file - 
```
""dependencies"": {
    ""@agm/core"": ""1.0.0-beta.5"",
    ""@angular/animations"": ""7.1.2"",
    ""@angular/cdk"": ""^7.0.3"",
    ""@angular/common"": ""7.1.2"",
    ""@angular/compiler"": ""7.1.2"",
    ""@angular/core"": ""7.1.2"",
    ""@angular/forms"": ""7.1.2"",
    ""@angular/http"": ""7.1.2"",
    ""@angular/platform-browser"": ""7.1.2"",
    ""@angular/platform-browser-dynamic"": ""7.1.2"",
    ""@angular/router"": ""7.1.2"",
    ""@asymmetrik/ngx-leaflet"": ""3.0.1"",
    ""@fortawesome/angular-fontawesome"": ""0.1.0-10"",
    ""@fortawesome/fontawesome-free"": ""^5.2.0"",
    ""@fortawesome/fontawesome-svg-core"": ""^1.2.9"",
    ""@fortawesome/free-brands-svg-icons"": ""^5.6.0"",
    ""@fortawesome/free-solid-svg-icons"": ""^5.6.0"",
    ""@nebular/auth"": ""2.0.0-rc.6"",
    ""@nebular/bootstrap"": ""3.1.0"",
    ""@nebular/moment"": ""^3.2.1"",
    ""@nebular/security"": ""3.0.0"",
    ""@nebular/theme"": ""3.0.0"",
    ""@ng-bootstrap/ng-bootstrap"": ""^4.0.0"",
    ""@ngx-share/button"": ""^5.3.1"",
    ""@ngx-share/buttons"": ""^5.3.1"",
    ""@ngx-share/core"": ""^5.3.1"",
    ""@nomadreservations/ngx-stripe"": ""^1.1.0"",
    ""@swimlane/ngx-charts"": ""^10.0.0"",
    ""angular-particle"": ""^1.0.4"",
    ""angular-tree-component"": ""7.2.0"",
    ""angular2-chartjs"": ""0.4.1"",
    ""angular2-toaster"": ""^6.0.1"",
    ""angularx-social-login"": ""github:captainjackrana/angularx-social-login"",
    ""bootstrap"": ""4.0.0"",
    ""chart.js"": ""2.7.1"",
    ""chartjs-plugin-annotation"": ""^0.5.7"",
    ""ckeditor"": ""4.7.3"",
    ""classlist.js"": ""1.1.20150312"",
    ""core-js"": ""2.5.1"",
    ""echarts"": ""^4.1.0"",
    ""eva-icons"": ""^1.1.0"",
    ""font-awesome"": ""4.7.0"",
    ""gsap"": ""^1.20.6"",
    ""intl"": ""1.2.5"",
    ""ionicons"": ""^2.0.1"",
    ""leaflet"": ""1.2.0"",
    ""nebular-icons"": ""1.0.6"",
    ""ng-animate"": ""^0.3.4"",
    ""ng-lazyload-image"": ""^6.1.0"",
    ""ng-recaptcha"": ""^4.2.1"",
    ""ng2-ckeditor"": ""1.1.13"",
    ""ng2-completer"": ""^1.6.3"",
    ""ng2-nouislider"": ""^1.7.13"",
    ""ng2-slider-component"": ""^1.0.9"",
    ""ng2-smart-table"": ""1.2.2"",
    ""ng2-tree"": ""2.0.0-rc.4"",
    ""ngx-bootstrap"": ""^2.0.5"",
    ""ngx-chips"": ""^1.9.8"",
    ""ngx-cookie-service"": ""^1.0.10"",
    ""ngx-echarts"": ""^4.0.1"",
    ""ngx-swiper-wrapper"": ""^6.4.1"",
    ""node-sass"": ""^4.8.1"",
    ""normalize.css"": ""6.0.0"",
    ""nouislider"": ""^11.1.0"",
    ""pace-js"": ""1.0.2"",
    ""roboto-fontface"": ""0.8.0"",
    ""rxjs"": ""^6.3.3"",
    ""rxjs-compat"": ""^6.3.3"",
    ""sha.js"": ""^2.4.11"",
    ""socicon"": ""3.0.5"",
    ""tinymce"": ""4.5.7"",
    ""typeface-exo"": ""0.0.22"",
    ""web-animations-js"": ""2.2.5"",
    ""zone.js"": ""^0.8.26""
  },

```
",['needs triage'],open,2020-01-04T15:32:43Z,,performance,['needs triage'],True,,
akveo/ngx-admin,5579,Production build produces warning ,"**I'm submitting a ...**  (check one with ""x"")

* [x] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

Because I cant use your template in a production build 

### Issue description

**Current behavior:**
<!-- Describe how the bug manifests. -->
Run a production build: ng build --prod --aot 
Produces a warning
**WARNING in Invalid background value at 37366:14. Ignoring.**
I have a work around without going through all the css to find why it wasnt combined properly.  
ng build --prod --aot --extract-css=false

**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->
Run the production build without adding --extract-css flag

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->
1.  Clone repo
2.  Install packages : npm install
3.  Run the build: ng build --prod --aot

### Other information:

**npm, node, OS, Browser**
```
node --version -> v12.10.0

ng --version

     _                      _                 ____ _     ___
    / \   _ __   __ _ _   _| | __ _ _ __     / ___| |   |_ _|
   / △ \ | '_ \ / _` | | | | |/ _` | '__|   | |   | |    | |
  / ___ \| | | | (_| | |_| | | (_| | |      | |___| |___ | |
 /_/   \_\_| |_|\__, |\__,_|_|\__,_|_|       \____|_____|___|
                |___/
    

Angular CLI: 8.3.3
Node: 12.10.0
OS: win32 x64
Angular:
...

Package                      Version
------------------------------------------------------
@angular-devkit/architect    0.803.3
@angular-devkit/core         8.3.3
@angular-devkit/schematics   8.3.3
@schematics/angular          8.3.3
@schematics/update           0.803.3
rxjs                         6.4.0
",['needs triage'],open,2019-12-19T21:16:18Z,,bug,['needs triage'],True,,
akveo/ngx-admin,5577,Routing to authenticate error,"Please, I am using ngx-admin (angular version), I am trying to navigate outside the app because I am sung identity server 4, but it doesn't work, something prevents the request.and the is always a warning in console (TypeError: Cannot read property 'https://localhost:44372/' of undefined) ",['question'],open,2019-12-15T07:49:59Z,,bug,['question'],True,,
akveo/ngx-admin,5576,Register without updating token,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [ ] bug report
* [ ] feature request
* [x] question about the decisions made in the repository

### Issue description

Only admins can create users in my app. But when using auth register, it removes my current token. Is there a way to disable this token removal ?",['question'],open,2019-12-13T10:45:28Z,,bug,['question'],True,,
akveo/ngx-admin,5573,Header component nb-user doesn't update user name,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [X] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
<!-- Describe how the bug manifests. -->
I have a service that allows a user to login and logout and I'm updating the [name] input on the nb-user component in the header (header.component.ts). I logout and log back in as another user and update the user information in the header when this happens.

The change is not detected and i'm not sure how to do this correctly or if this is a defect.

**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->
I would update the value that is bound to the nb-user component name attribute and the component would update accordingly.

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->
Bind a value to the name attribute and change it later.

**Related code:**

// header.component.ts snippet
// inserted into ngOnInit
    this.authService.getUser().subscribe(user => {
        this.userName = user.attributes.name;
        console.log(`User logged in: ${this.userName}`);
      });

// header.component.html snippet
    <nb-action class=""user-action"" *nbIsGranted=""['view', 'user']"" >
      <nb-user [nbContextMenu]=""userMenu""
                nbContextMenuTag=""user-menu""
               [onlyPicture]=""userPictureOnly""
               [name]=""userName"">
      </nb-user>
    </nb-action>

### Other information:

**npm, node, OS, Browser**
```
<!--
Node, npm: node v10.15.0, npm 6.13.1
OS: windows 10
Browser: Chrome 78.0.3904.108
-->
```

**Angular, Nebular**
```
<!--
Angular 8.0.2
Nebular 4.4.0
-->
```
",['needs triage'],open,2019-12-02T13:33:28Z,,bug,['needs triage'],True,,
akveo/ngx-admin,5572,Only index.html in dist folder?,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [ ] bug report
* [ ] feature request
* [x] question ~about the decisions made in the repository~

### Issue description

**Current behavior:**
<!-- Describe how the bug manifests. -->
When I run ``npm run build:prod`` there's only index.html in the ""dist"" folder.
When I start a webserver via xampp, then it only shows the spinner like when you load the live-demo.

**Expected behavior:**
<!-- Describe what the behavior would be without the bug. -->
I expected that all html files (dashboard, forms, etc) are in the dist folder.

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->
git clone <this repo>
cd ngx-admin
npm i
npm run build:prod

### Other information:

**npm, node, OS, Browser**
```
$ node --version
v12.13.1

$ npm --version
6.12.1
```

**Angular, Nebular**
```
    ""@angular/animations"": ""^8.0.0"",
    ""@angular/cdk"": ""^8.0.0"",
    ""@angular/common"": ""^8.0.0"",
    ""@angular/compiler"": ""^8.0.0"",
    ""@angular/core"": ""^8.0.0"",
    ""@angular/forms"": ""^8.0.0"",
    ""@angular/platform-browser"": ""^8.0.0"",
    ""@angular/platform-browser-dynamic"": ""^8.0.0"",
    ""@angular/router"": ""^8.0.0"",
    ""@nebular/auth"": ""4.4.0"",
    ""@nebular/eva-icons"": ""4.4.0"",
    ""@nebular/security"": ""4.4.0"",
    ""@nebular/theme"": ""4.4.0"",
```

",['question'],open,2019-11-28T16:17:16Z,,bug,['question'],True,,
akveo/ngx-admin,5567,Update 3.4.2 -> 3.6.2,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [ x] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

I tried to update nebular from 3.4.2 to 3.6.2 and no matter I am doing I always end up with

`ERROR in node_modules/@nebular/theme/schematics/util/ast.d.ts(2,34): error TS2307: Cannot find module '@angular-devkit/core/src/experimental/workspace'.
node_modules/@nebular/theme/schematics/util/project.d.ts(2,34): error TS2307: Cannot find module '@angular-devkit/core/src/experimental/workspace'.`
",['needs info'],open,2019-11-18T02:23:54Z,,bug,['needs info'],True,,
akveo/ngx-admin,5564,About nbdatepicker languange,"I meet a problem about datepicke. The component's languange is English,and I want to turn language into Chinese now.How can I do this?",['question'],open,2019-11-15T13:00:10Z,,bug,['question'],True,,
akveo/ngx-admin,5562,Enabling Custom Theme,"**I'm submitting a ...**  (check one with ""x"")

 *[x] bug report
* [ ] feature request

I'll Try to Enabling Custom Theme by the following this guide https://akveo.github.io/nebular/docs/design-system/create-custom-theme, but when I check on console there is some error on it :

core.js:7187 ERROR Error: NbThemeConfig: no theme 'aquamarine' found registered.
    at NbJSThemesRegistry.get (index.js:259)
    at MapSubscriber.project (index.js:475)
    at MapSubscriber._next (map.js:29)
    at MapSubscriber.next (Subscriber.js:49)
    at RefCountSubscriber._next (Subscriber.js:72)
    at RefCountSubscriber.next (Subscriber.js:49)
    at Subject.next (Subject.js:39)
    at ConnectableSubscriber._next (Subscriber.js:72)
    at ConnectableSubscriber.next (Subscriber.js:49)
    at ReplaySubject._subscribe (ReplaySubject.js:57)

I Use Windows10 and the Angular Version Following on https://github.com/akveo/ngx-admin.git",['needs info'],closed,2019-11-15T03:39:26Z,2020-03-09T04:26:18Z,bug,['needs info'],True,115.0,
akveo/ngx-admin,5559,Error in ng build --prod | Property is {} so missing.,"
### Issue in production build

- Error statement
1. **Property `'color'` does not exist on type `'{}'`.**
2. **Property `'d'` does not exist on type `'{}'`.**

* [x] bug report

### Issue description
- Angular `ng` not able to build with `prod` argument.

**Related code:**

In `temperature-dragger.component.ts` file 
```typescript
styles = {
    viewBox: '0 0 300 300',
    arcTranslateStr: 'translate(0, 0)',
    clipPathStr: '',
    gradArcs: [],
    nonSelectedArc: {},
    thumbPosition: { x: 0, y: 0 },
    blurRadius: 15,
  };
```
It needs to be 
```typescript
  angle = this.bottomAngleRad / 2 + (1 - this.getValuePercentage()) * (2 * Math.PI - this.bottomAngleRad);
  styles = {
    viewBox: '0 0 300 300',
    arcTranslateStr: 'translate(0, 0)',
    clipPathStr: '',
    gradArcs: [],
    nonSelectedArc:{
      color: this.disableArcColor,
      d: `M ${this.radius},${this.radius}
       L ${this.radius},${3 * this.radius}
       A ${2 * this.radius},${2 * this.radius}
       1 ${this.angle > Math.PI ? '1' : '0'} 0
       ${this.radius + this.radius * 2 * Math.sin(this.angle)},${this.radius + this.radius * 2 * Math.cos(this.angle)}
       Z`,
    },
    thumbPosition: { x: 0, y: 0 },
    blurRadius: 15,
  };
```


### Other information:

Node, npm: `v12.13.0.` and `6.12.0`
OS: Windows (10)

**Angular, Nebular**
",['needs triage'],open,2019-11-13T05:48:02Z,,bug,['needs triage'],True,,
akveo/ngx-admin,5557,Error in ng build --prod Property 'expanded' is private and only accessible within class 'RoomsComponent',"
### Issue in production build

- Error statement
**Property `'expanded'` is private and only accessible within class `'RoomsComponent'`**

* [x] bug report

### Issue description
- Angular `ng` not able to build with `prod` argument.

**Related code:**

In `rooms.component.ts` file the variable is 
```typescript
private expanded:boolean;
```
It needs to be 
```typescript
public expanded:boolean;
```


### Other information:

Node, npm: `v12.13.0.` and `6.12.0`
OS: Windows (10)

**Angular, Nebular**
",['needs info'],closed,2019-11-13T05:21:19Z,2023-07-26T07:02:36Z,bug,['needs info'],True,1351.0,
akveo/ngx-admin,5554,Pull-down-to-refresh not working in Mobile Chrome (Android),"When I want to refresh page (by pull-down-to-refresh -> scroll with finger) in mobile's chrome (android), nothing will happen. How can I enable it? Thanks

* [ ] bug report
* [ x ] feature request
* [ ] question about the decisions made in the repository
",['needs investigation'],open,2019-11-08T11:59:53Z,,bug,['needs investigation'],True,,
akveo/ngx-admin,5550,Search Button from header changes its background color on ngx-admin demo,"<!--
ATTENTION! WE WILL HAVE TO CLOSE THIS ISSUE if you don't provide the needed information.
Please read https://github.com/akveo/ngx-admin/blob/master/CONTRIBUTING.md before opening an issue.
-->

### Issue type

**I'm submitting a ...**  (check one with ""x"")

* [x] bug report
* [ ] feature request
* [ ] question about the decisions made in the repository

### Issue description

**Current behavior:**
The search button (on the header) of ngx-admin changes its background color when you change pages. You can see this bug on the ngx-admin demo too.

**Steps to reproduce:**
Navigate trough sidebar menu and watch the search button from <nb-layout-header> change its background color. It is like a hover effect

Here is a link with the search button bug:
[Image to bug](https://imgur.com/a/sZAP8Un)",['needs triage'],open,2019-10-23T10:59:00Z,,bug,['needs triage'],True,,
ng-bootstrap/ng-bootstrap,4797,clicking on AM/PM when no values are input into Timepicker and meridian is true sets the hours to 12,"A Timepicker with meridian set to true that is backed by a model with the time picker value set to null/undefined will set the hour to 12 when clicking the meridian button.
Something like this with the backing form control set to NULL or undefined

`
          <ngb-timepicker [meridian]=""true"" formControlName=""foo"" />
`

You can see this in the examples page: https://ng-bootstrap.github.io/#/components/timepicker/examples
In the meridian option, clear out the HH and MM so that the placeholder text is visible.  Then click the meridian button (AM) and it'll set the hour to 12 but leave the minute empty.

My expectation is clicking the meridian button wouldn't do anything to the time value.","['type: bug', 'component: timepicker', 'type: demo']",closed,2025-01-23T22:32:53Z,2025-03-06T22:29:50Z,performance,"['type: bug', 'component: timepicker', 'type: demo']",True,41.0,
ng-bootstrap/ng-bootstrap,4771,Accordion collapse/expand not working when SSR is enabled,"### Bug description:
When creating an Angular 18 project with SSR enables the accordion collapse and expand does not work.
When the page loads the following Javascript error is thrown in the console:

_ERROR Error: Expecting instance of DOM Element
    at assertDomElement (chunk-POGNINR2.js?v=047c9d3c:9917:11)
    at getComponent$1 (chunk-POGNINR2.js?v=047c9d3c:9755:16)
    at markRNodeAsHavingHydrationMismatch (chunk-POGNINR2.js?v=047c9d3c:10207:19)
    at validateSiblingNodeExists (chunk-POGNINR2.js?v=047c9d3c:13408:5)
    at siblingAfter (chunk-POGNINR2.js?v=047c9d3c:13865:18)
    at locateDehydratedViewsInContainer (chunk-POGNINR2.js?v=047c9d3c:14388:24)
    at populateDehydratedViewsInLContainerImpl (chunk-POGNINR2.js?v=047c9d3c:15282:42)
    at locateOrCreateAnchorNode (chunk-POGNINR2.js?v=047c9d3c:15292:8)
    at createContainerRef (chunk-POGNINR2.js?v=047c9d3c:15242:3)
    at injectViewContainerRef (chunk-POGNINR2.js?v=047c9d3c:15064:10)_

### Link to minimally-working StackBlitz that reproduces the issue:
https://stackblitz.com/~/github.com/WayneKruger/ng-boorstrap-ssr

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 18.2.8 (but same happens in any v18)

ng-bootstrap: 17.0.1

Bootstrap: 5.3.3 (Same happens in 5.3.2)

I did not test any other major versions.
","['type: bug', 'component: accordion', 'type: ssr']",closed,2024-10-15T16:40:34Z,2024-12-11T10:38:35Z,bug,"['type: bug', 'component: accordion', 'type: ssr']",True,56.0,
ng-bootstrap/ng-bootstrap,4758,Accordion: destroyOnHide is not respected and component content is present in the DOM with OnPush strategy,"### Bug description:
When `destroyOnHide` is set to `true` or not (which according documentation is `true` by default), after collapsing accordion, the body (NgbAccordionBody) still contains its content a.k.a none of the elements are removed from the DOM. I've experience this issue with `OnPush` change detection strategy. I decide to fork and clone the repo, then work it out and found that regardless of which change detection strategy I have choose, DEMO components still present their content of the body, when accordion is collapsed. I have experience this problem with v.16 then decide to clone and test the latest 17, issue is still present.

### Link to minimally-working StackBlitz that reproduces the issue:
Fork/clone the project -> go to : `demo/src/app/components/accordion/demos/basic/accordion-basic.ts` and change the strategy to `OnPush` -> yarn demo -> navigate to : components/accordion/examples -> inspect first basic example and its DOM content while expand/collapse the accordion.
Expecting result: DOM elements/content from body (NgbAccordionBody) to be remove from the DOM, once its collapsed.
Actual result: DOM elements/content of the body are present in the DOM, when accordion is collapsed.

I woud like to provide fix for this issue.

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17, 18

ng-bootstrap: 16,17

Bootstrap:5.3.*
","['type: bug', 'component: accordion']",closed,2024-09-23T07:36:50Z,2024-12-11T10:38:34Z,bug,"['type: bug', 'component: accordion']",True,79.0,
ng-bootstrap/ng-bootstrap,4719,Demo page of ngbModal: wrong title and stackblitz links,"### Bug description:

The issues on [https://ng-bootstrap.github.io/#/components/modal/examples](https://ng-bootstrap.github.io/#/components/modal/examples) :
- title of the page is ""Dropdown"" instead of ""Modal""
- all the links for stackblitz examples are pointing to Dropdown examples not Modal

### Link to minimally-working StackBlitz that reproduces the issue:

N/A


### Versions of Angular, ng-bootstrap and Bootstrap:

N/A

Angular:

N/A

ng-bootstrap:

N/A

Bootstrap:

N/A","['type: bug', 'type: demo site']",closed,2024-06-07T09:20:23Z,2024-06-13T14:15:24Z,bug,"['type: bug', 'type: demo site']",True,6.0,
ng-bootstrap/ng-bootstrap,4709,Zoneless change detection support,"This is an aggregate issue to track zoneless support with `provideExperimentalZonelessChangeDetection()` in apps using ng-bootstrap.

Please open separate issues for specific use cases, we'll reference them here.
And keep in mind this is still considered ""experimental"".",['type: feature'],open,2024-05-31T08:17:25Z,,bug,['type: feature'],True,,
ng-bootstrap/ng-bootstrap,4705,NgbHighlight cause NG0955 warning,"### Bug description:

The NgbHighlight directive, used in the typeahead component, causes the following warning to be logged (when using Angular 18):

> 'NG0955: The provided track expression resulted in duplicated keys for a given collection. Adjust the tracking expression such that it uniquely identifies all the items in the collection.

This is because it splits the text of a typeahead result in parts and iterates through the parts using a `@for (part of parts; track part)`. So if we search with `'n'` in a result such as `'no name'`, then two parts will be identical.

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 18.0.0

ng-bootstrap: 16.0.0

Bootstrap: 5.3.3
","['type: bug', 'component: typeahead']",closed,2024-05-27T09:38:35Z,2024-05-30T11:04:19Z,bug,"['type: bug', 'component: typeahead']",True,3.0,
ng-bootstrap/ng-bootstrap,4667,ngbAccordionCollapse does not collapse when ngbAccordionItem is disabled,"### Bug description:

When an `ngbAccordionItem` is disabled, the `ngbAccordionCollapse` is not collapsed (and the content is not disabled). **This is a breaking change from the component-based accordion.**

Compare the ""Custom header"" demo in the current version with the old release (<https://ng-bootstrap.github.io/releases/13.x/#/components/accordion/examples>).

### Link to minimally-working StackBlitz that reproduces the issue:

Based on the default ""Custom header"" demo: <https://stackblitz.com/edit/angular-oz5acv?file=src%2Fapp%2Faccordion-header.html,src%2Fapp%2Faccordion-header.ts>:

* Open the third panel
* The button can be clicked
* Click on the ""Disable third"" button on the second panel
* The third panel's header is disabled, but the panel remains open, and the button can be clicked!

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.9

ng-bootstrap: 16.0.0

Bootstrap: 5.3.2
","['component: accordion', 'needs: design', 'type: regression']",open,2024-01-26T14:58:16Z,,bug,"['component: accordion', 'needs: design', 'type: regression']",True,,
ng-bootstrap/ng-bootstrap,4664,Feature request: expose componentRef in NgbModalRef,"### Bug description:

When using `NgbModal`, we can access the `componentInstance` from the `NgbModalRef` instance.

Since the introduction of the new `setInput` method in Angular, I think it could be interesting to expose the `componentRef` as well.

For example, in the `NgbModal` documentation, we can see [this example](https://ng-bootstrap.github.io/#/components/modal/examples#component):

```ts
import { Component, inject, Input } from '@angular/core';
import { NgbActiveModal, NgbModal } from '@ng-bootstrap/ng-bootstrap';

@Component({
	selector: 'ngbd-modal-content',
	standalone: true,
	template: `
		<div class=""modal-header"">
			<h4 class=""modal-title"">Hi there!</h4>
			<button type=""button"" class=""btn-close"" aria-label=""Close"" (click)=""activeModal.dismiss('Cross click')""></button>
		</div>
		<div class=""modal-body"">
			<p>Hello, {{ name }}!</p>
		</div>
		<div class=""modal-footer"">
			<button type=""button"" class=""btn btn-outline-dark"" (click)=""activeModal.close('Close click')"">Close</button>
		</div>
	`,
})
export class NgbdModalContent {
	activeModal = inject(NgbActiveModal);

	@Input() name: string;
}

@Component({
	selector: 'ngbd-modal-component',
	standalone: true,
	templateUrl: './modal-component.html',
})
export class NgbdModalComponent {
	private modalService = inject(NgbModal);

	open() {
		const modalRef = this.modalService.open(NgbdModalContent);
		modalRef.componentInstance.name = 'World';
	}
}
```

The problem with this example is that when we set the `name` input on the component instance, it does not trigger any change detection.

It's not a big issue with this trivial example, as the change detection will be triggered anyway, but it also means setting the `name` input like this cannot use the `@Input` transform function and it would had to be done manually.

What I'm suggesting is using the `setInput` method by exposing the `componentRef`.

Here is what it could look like:

```diff
import { Component, inject, Input } from '@angular/core';
import { NgbActiveModal, NgbModal } from '@ng-bootstrap/ng-bootstrap';

@Component({
	selector: 'ngbd-modal-content',
	standalone: true,
	template: `
		<div class=""modal-header"">
			<h4 class=""modal-title"">Hi there!</h4>
			<button type=""button"" class=""btn-close"" aria-label=""Close"" (click)=""activeModal.dismiss('Cross click')""></button>
		</div>
		<div class=""modal-body"">
			<p>Hello, {{ name }}!</p>
		</div>
		<div class=""modal-footer"">
			<button type=""button"" class=""btn btn-outline-dark"" (click)=""activeModal.close('Close click')"">Close</button>
		</div>
	`,
})
export class NgbdModalContent {
	activeModal = inject(NgbActiveModal);

	@Input() name: string;
}

@Component({
	selector: 'ngbd-modal-component',
	standalone: true,
	templateUrl: './modal-component.html',
})
export class NgbdModalComponent {
	private modalService = inject(NgbModal);

	open() {
		const modalRef = this.modalService.open(NgbdModalContent);
-		modalRef.componentInstance.name = 'World';
+		modalRef.componentRef.setInput('name', 'World');
	}
}
```

Let me know what you think: the change seems small, I can work on a PR if it has some interests.

### Link to minimally-working StackBlitz that reproduces the issue:

Not an issue per se, more a feature request :)

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: N/A

ng-bootstrap: ^16.0.0

Bootstrap: N/A
","['component: modal', 'type: feature', 'component: offcanvas', 'type: signals']",open,2024-01-25T12:49:21Z,,bug,"['component: modal', 'type: feature', 'component: offcanvas', 'type: signals']",True,,
ng-bootstrap/ng-bootstrap,4662,ngbAccordionToggle is not disabled when ngbAccordionItem is disabled,"### Bug description:

When an `ngbAccordionItem` is disabled, the button should also be disabled. However, this is done inconsistently.

* If the button is a `ngbAccordionButton`, it is disabled.
* If the button is a `ngbAccordionToggle`, it is *not* disabled. Instead, this must be done explicitly. **This is a breaking change from the component-based accordion.**

In the example, you can see that `<button ngbAccordionToggle [disabled]=""second.disabled"">` is needed to set the button into its disabled state, which is not needed for the `<button ngbAccordionButton>`.

If you compare it to ""Custom Header"" in the old release (<https://ng-bootstrap.github.io/releases/13.x/#/components/accordion/examples>), no explicit code is needed (`<button ngbPanelToggle>`)

### Link to minimally-working StackBlitz that reproduces the issue:

<https://stackblitz.com/edit/angular-sda4bv?file=src%2Fapp%2Faccordion-basic.html>

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.9

ng-bootstrap: 16.0.0

Bootstrap: 5.3.2
","['needs: investigation', 'type: bug', 'type: accessibility', 'component: accordion']",open,2024-01-22T11:52:50Z,,bug,"['needs: investigation', 'type: bug', 'type: accessibility', 'component: accordion']",True,,
ng-bootstrap/ng-bootstrap,4658,Accordion - unable to cancel an event,"### Bug description:

Hi! I have upgraded from v13 to v16. I've noticed a big breaking change in Accordion's behaviour. 
I've had a few panels where there were forms. I was checking if the form is dirty before a panel was collapsed. I was able to do it with `panelChange` event and `preventDefault` function in it's payload.
Now I can only subscribe to `hide` event which gives me only id of panel being collapsed. I have no option to cancel the event.


### Link to minimally-working StackBlitz that reproduces the issue:

https://stackblitz.com/edit/angular-nfcfc3?file=src%2Fapp%2Faccordion-basic.ts

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17
ng-bootstrap: 16","['type: bug', 'component: accordion', 'needs: design', 'type: regression']",open,2024-01-12T13:03:04Z,,bug,"['type: bug', 'component: accordion', 'needs: design', 'type: regression']",True,,
ng-bootstrap/ng-bootstrap,4657,Popover is displayed after source element is destroyed,"### Bug description:
I have an element that shows popover on hover with delay. If element is destroyed before tooltip is displayed popover shows at top-left page corner. Expected behavior - don't show popover if element has been destroyed
```
<button *ngIf=""!hidden""
  ngbPopover=""test action""
  container=""body""
  triggers=""mouseenter:mouseleave""
  [openDelay]=""1000""
  (click)=""hidden = true"">
  test action
</button>
```
Click on button before tooltip is displayed.

### Link to minimally-working StackBlitz that reproduces the issue:
https://stackblitz.com/edit/angular-cdwked

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.8

ng-bootstrap: 16.0.0

Bootstrap: 5.3.2
","['component: popover', 'component: tooltip', 'type: bug']",closed,2024-01-09T17:10:48Z,2025-06-15T19:36:16Z,bug,"['component: popover', 'component: tooltip', 'type: bug']",True,523.0,
ng-bootstrap/ng-bootstrap,4656,Many People need ng-bootstrap version 5.x.x and 7.x.x documentations.,"I talked with many people. They need help finding old version documentation. Can I find the old version of the documentation
Is there any specific reason for removing the old version documentation from sites? 
If old version do not support that's fine. But we need to know which fields are used in the old versions.","['resolution: support', 'resolution: wontfix', 'type: doc']",closed,2024-01-08T08:27:02Z,2024-05-31T08:51:09Z,bug,"['resolution: support', 'resolution: wontfix', 'type: doc']",True,144.0,
ng-bootstrap/ng-bootstrap,4652,Button groups and split buttons example lacks border-radius on right due to incorrect markup order,"
### Bug description:

The [example](https://ng-bootstrap.github.io/#/components/dropdown/examples#split) for split buttons has sharp right corners on the ""Split Me"" button. Moving some tags around fixes this.

<img width=""320"" alt=""image"" src=""https://github.com/ng-bootstrap/ng-bootstrap/assets/85100/525f0656-88a3-4984-99ff-8845ca53cb05"">


### Link to minimally-working StackBlitz that reproduces the issue:

https://angular-f1ubcd.stackblitz.io

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.8

ng-bootstrap: 16.0.0

Bootstrap: Not sure?
","['component: dropdown', 'type: demo']",closed,2023-12-27T17:45:12Z,2024-05-31T08:59:23Z,bug,"['component: dropdown', 'type: demo']",True,155.0,
ng-bootstrap/ng-bootstrap,4640,ng-bootstrap Scrollspy : Show only one image (active) at a time,"https://stackoverflow.com/questions/77589372/ng-bootstrap-scrollspy-show-only-one-image-active-at-a-time

My Output:
![image](https://github.com/ng-bootstrap/ng-bootstrap/assets/32062337/495a29c0-56fb-4d22-8ad0-525dcbb420ab)

Expected Output:
![image](https://github.com/ng-bootstrap/ng-bootstrap/assets/32062337/73fc2bf1-6dab-42af-8c84-8452d031fbf1)
",['needs: stackblitz'],open,2023-12-02T06:35:59Z,,performance,['needs: stackblitz'],True,,
ng-bootstrap/ng-bootstrap,4637,Accessibility [NgbPagination] ARIA attribute,"## Accessibility issue at NgbPagination:

### Bug description:

Affected component is **ngb-pagination**, when I use [ellipses]=""true"" and [maxSize]=""3"" the element created 
to display the three dots.

![image](https://github.com/ng-bootstrap/ng-bootstrap/assets/105566648/58a0f348-cac2-4433-b2b3-060063e0bd65)

I'm using the extension 'siteimprove accesibility checker'.

They report this to me:
`WAI-ARIA authoring practices`
`An ARIA attribute has been specified that is either not supported or is prohibited, on this type of element.`

```html
<li class=""page-item disabled"">
     <a tabindex=""-1"" aria-disabled=""true"" class=""page-link"">
        ...
     </a>
</li>
```

### Resolve with adding 'aria-pressed=false' and 'role=button':
```html
<li class=""page-item disabled"">
     <a tabindex=""-1"" role=""button"" aria-pressed=""false"" class=""page-link"">
        ...
     </a>
</li>
``` 

### Link to minimally-working StackBlitz that reproduces the issue:

[Stackblitz](https://stackblitz.com/edit/angular-zxcejp?file=src%2Fapp%2Ftable-pagination.html) 

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: ""17.0.3""

ng-bootstrap: ""16.0.0""

Bootstrap: ""5.3.2""
","['needs: investigation', 'type: accessibility', 'component: pagination']",open,2023-11-24T12:01:37Z,,bug,"['needs: investigation', 'type: accessibility', 'component: pagination']",True,,
ng-bootstrap/ng-bootstrap,4633,Accessing modal body markup,"Hi. Is there a less hacky way to access modal body markup (Angular 15, if it matters) than:

```
    const mapLayerModalRef = this.modalService.open(this.mapLayerContent, { centered: true, size: 'xl' });
    mapLayerModalRef.dismissed.subscribe(() => {
      const dialogRef = (mapLayerModalRef as any)._windowCmptRef.instance._dialogEl as ElementRef;
      this.mapLayerContentBodyMarkup = (mapLayerContentBody as HTMLElement).innerHTML; //accessing modal body markup in a very hacky way
    });
```

?

Markup:

```
<ng-template #mapLayerContent let-modal let-c=""close"" let-d=""dismiss"">
  ...
  <div class=""modal-body""><!-- Need to access this markup --></div>
</ng-template>
```

I've tried different approaches (e.g. using this.mapLayerContent `TemplateRef`), but in vain.","['component: modal', 'resolution: support']",open,2023-11-21T02:38:29Z,,bug,"['component: modal', 'resolution: support']",True,,
ng-bootstrap/ng-bootstrap,4632,Allow setting for minutes to hour roll over feature.,"### Feature Request:
Provide a method to turn off incrementing/decrementing the hours field when the minutes field wraps around. For example, if the user enters 9 in the hours field and then click on the down spinner for the minutes field (so it goes to 45 for example), do not decrement the hours field to 8.
The most common use case for us is that the user works from left to right, so the user enters the hour and then the minutes, and is not expecting the minutes field to change the hours field.
Therefore we would very much like to have the option of turning this behavior off.","['type: feature', 'component: timepicker']",open,2023-11-17T19:47:58Z,,performance,"['type: feature', 'component: timepicker']",True,,
ng-bootstrap/ng-bootstrap,4630,"Focus is going out of the modal, if it is having hidden button as the last interactive element.","**Bug description:**
While traversing through the elements, focus is going out of the modal if last interactive button is hidden on modal.

**Versions of Angular, ng-bootstrap and Bootstrap:**

Angular: 15.2

ng-bootstrap: 14

Bootstrap: 6
","['component: modal', 'type: bug']",open,2023-11-17T09:58:48Z,,bug,"['component: modal', 'type: bug']",True,,
ng-bootstrap/ng-bootstrap,4623,[16.0.0-rc.1] [ngbAccordionBody]: Cannot get a TemplateRef from a template variable inside ngbAccordionBody,"### Bug description:

I use [NgBoostrap accordion](https://ng-bootstrap.github.io/#/components/accordion/overview).

And I'm trying to retrieve a TemplateRef that is in an ng-template with @ViewChild . The ng-template is an embedded view created by the ngbAccordionBody directive.

See NgBootstrap GitHub for embedded view creation: [ngbAccordionBody](https://github.com/ng-bootstrap/ng-bootstrap/blob/master/src/accordion/accordion.directive.ts#L73)

I created a [StackBlitz](https://stackblitz.com/edit/angular-ngbdaccordionbasic-viewchild?file=src%2Fapp%2Faccordion-basic.html) to present my problem.

You'll see that I've found a workaround to my problem.

But I'd like to know if using @ViewChild is possible in this situation. If not, I'd like to know why not.

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.2

ng-bootstrap: 16.0.0-rc.1

Bootstrap: 5.3.2
","['type: bug', 'component: accordion']",closed,2023-11-15T13:48:05Z,2023-11-16T08:19:45Z,bug,"['type: bug', 'component: accordion']",True,0.0,
ng-bootstrap/ng-bootstrap,4617,[ngbTypeahead] selectOnExact results length condition,"Hello,
I recently faced an issue using this useful attribute ""selectOnExact"": the problem is that even if one of the result is exaclty the value typed from the user and there are some others which in my case have just a suffix, the first and exact match is not taken because this condition regarding the number of results is not match.

Here's the code line in typeahead.ts : 
https://github.com/ng-bootstrap/ng-bootstrap/blob/2fcf9e94c738664c885cf292b0753fde666f1f82/src/typeahead/typeahead.ts#L417

Thanks in advance for any discussion and/or further implementation regarding the topic :)
Cheers

_Originally posted by @billyLumberjack in https://github.com/ng-bootstrap/ng-bootstrap/discussions/4610_","['type: feature', 'component: typeahead']",open,2023-11-13T10:10:08Z,,bug,"['type: feature', 'component: typeahead']",True,,
ng-bootstrap/ng-bootstrap,4616,16.0.0-rc.0: datepicker `startDate` type breaking change,"### Bug description:

The following commit https://github.com/ng-bootstrap/ng-bootstrap/commit/30dc67c40b819652890262346eef4ffb04c2cc0f#diff-46903bc1acb49e5dd30ed8bf9f24552a5abcb647a97043a2bea97cde5cbe1cfbL399-R406 changed the type of `startDate` from `{ year: number; month: number: day?: number }` to the inferred type `{ year: number; month: number }` from the config.

When updating to rc.0, we are seeing compilation errors when trying to pass an object with a day property to `startDate`.

I suppose that the type should still have an optional `day` as it is used by the `navigateTo` method.

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: v17.0.2

ng-bootstrap: v16.0.0-rc.0

Bootstrap: v5.3.2
","['type: bug', 'component: datepicker']",closed,2023-11-13T09:19:23Z,2023-11-13T10:35:53Z,bug,"['type: bug', 'component: datepicker']",True,0.0,
ng-bootstrap/ng-bootstrap,4615,Accordion does not support FormArray,"Please remember, the issues forum is __NOT__ for support requests. It is for bugs and feature requests only.
Please read https://github.com/ng-bootstrap/ng-bootstrap/blob/master/CONTRIBUTING.md and search
existing issues (both open and closed) prior to opening any new issue and ensure you follow the instructions therein.

### Bug description:

When binding a FormArray to accordion items, the accordion item will no longer open. No errors are thrown.

I have tried moving the `formGroupName` directive both inside and outside of the `ngbAccordionBody`, but neither location works. If I remove the `formGroupName` and `formControlName` bindings, the accordion will open as expected.

I have also tried downgrading to Angular 16 and ng-bootstrap 15.1.2, but the same problem exists.

### Link to minimally-working StackBlitz that reproduces the issue:

https://stackblitz.com/edit/angular-knog2w?file=src%2Fapp%2Faccordion-basic.html

### Versions of Angular, ng-bootstrap and Bootstrap:

Angular: 17.0.2

ng-bootstrap: 16.0.0-rc.0

Bootstrap: 5.3.2
","['resolution: support', 'resolution: wontfix', 'component: accordion']",closed,2023-11-13T03:01:03Z,2023-11-13T09:55:51Z,bug,"['resolution: support', 'resolution: wontfix', 'component: accordion']",True,0.0,
Swimlane/ngx-charts,2047,Angular 20 support,Please add Angular 20 support ASAP!,['New Feature'],open,2025-06-01T20:31:53Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,2046,Tooltip Broken After upgrading to Angular 20,"**Describe the bug**
The tooltip feature seems broken after upgrading to Angular 20. Mouseover on the chart doesnt display tooltip and throw below error in console:

```
ERROR TypeError: elementInjector.get is not a function
    at DomPortalOutlet.attachComponentPortal (portal.mjs:287:51)
    at DomPortalOutlet.attach (portal.mjs:193:19)
    at _InjectionService.appendComponent (swimlane-ngx-charts.mjs:4192:37)
    at _TooltipService.injectComponent (swimlane-ngx-charts.mjs:4042:34)
    at _TooltipService.createByType (swimlane-ngx-charts.mjs:4014:28)
    at _TooltipService.create (swimlane-ngx-charts.mjs:4010:17)
    at swimlane-ngx-charts.mjs:6637:44
    at timer (zone.js:1809:37)
    at _ZoneDelegate.invokeTask (zone.js:431:33)
    at debug_node-Dn-GvQJo.mjs:16150:55
```


**To Reproduce**
Upgrade any angular app from Angular 19.x to v20 and try any chart option e.g:

```
 <ngx-charts-line-chart [view]=""view()""
                        [scheme]=""colorScheme()""
                        [results]=""data()""
                        [gradient]=""true""
                        [xAxis]=""true""
                        [yAxis]=""true""
                        [legend]=""false""
                        [showXAxisLabel]=""true""
                        [showYAxisLabel]=""false""
                        [autoScale]=""false""
                        [curve]=""lineChartLineInterpolation()""
                        [yAxisTickFormatting]=""axisFormat""
                        [legendPosition]=""legendPosition()"">
```

And then try to hoverover the chart, it should throw the error.



**Expected behavior**
It should work without any issue.

**ngx-charts version**
`""@swimlane/ngx-charts"": ""22.0.0"",`
",['Bug'],open,2025-05-29T18:51:22Z,,bug,['bug'],False,,
Swimlane/ngx-charts,2045,Chart tooltips do not activate when used in iPads set to Request Desktop Websites,"**Describe the bug**
Tapping on chart elements to activate a tooltip does not work as expected when Safari is set to **Request Desktop Website** in an iPad.

As I found out, it is because the `navigator.userAgent` string that it reports in this mode is not covered by the regex defined in the `tooltip.directive.ts` in order to set the appropriate timeout value.

https://github.com/swimlane/ngx-charts/blob/47a07d1805879f750111f0f32d44c8e8f3a22671/projects/swimlane/ngx-charts/src/lib/common/tooltip/tooltip.directive.ts#L118

Instead, its `navigator.userAgent` string reports as: 

```
Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/17.1 Safari/605.1.15
```

**To Reproduce**
Steps to reproduce the behavior:
1. Using the browser Safari on an iPad, navigate to https://swimlane.github.io/ngx-charts/#/ngx-charts/tooltip-templates.
2. Click on any of the vertical bars shown in the page. 
3. No tooltip is shown.

**Expected behavior**
Regardless if Desktop or Mobile browsing mode is set iPad Safari, the tooltip should activate and show the relevant info. 

**Screenshots**
With Safari set to ""Request Desktop Website"", the tooltip does not activate after tapping on the United Kingdom bar.
![Image](https://github.com/user-attachments/assets/1c7ebaa7-2ab1-4fcc-a545-63cb8856b0a1)

**Demo**
N/A

**ngx-charts version**
v21.1.0 in the link provided above, but the same bug occurs with v22.0.0, used in our app.

**Additional context**
Angular Version: v19.2.13

Test device settings
```
iPad Pro 11
OS: iOS, v17.5
Browser: Safari
```",['Bug'],open,2025-05-29T08:41:36Z,,bug,['bug'],False,,
Swimlane/ngx-charts,2044,"Line Chart, Expecting background color for each grid line","**Is your feature request related to a problem? Please describe.**
I am using line-chart, for each Y axis grid lines, expecting a background color so that I can show some thresold.

**Describe the solution you'd like**
In each line element, I am increasing the strokeWidth and changing the color of line element. Making an illusion that, its looking as a background color.

**Describe alternatives you've considered**
But whatever the Hack, which I did is not giving proper solution.
What I did is getting the line element, and made changes accordingly. Here, increased the width of that chart, and changed the color as well. But, some unwanted spaces in between we can see. Could not able to remove it.

**Additional context**
![Image](https://github.com/user-attachments/assets/0141ea30-6a03-4754-8bc5-e40b84ada2c0)
",['New Feature'],closed,2025-05-08T13:43:50Z,2025-05-14T04:39:12Z,bug,['new feature'],True,5.0,
Swimlane/ngx-charts,2042,Data Label adds 0 at the start and ending,"In **Stacked Horizontal Bar Chart**, 0 is added in both prefix and suffix of the dataLabel.

**To Reproduce**
Steps to reproduce the behavior:
1.  I am using _showDataLabel_ as true. 
2. Here my chart result is **string** format as shown in the below image. Its causing issue while showing DataLabel.

**Expected behavior**
But the same string value is working for the **Grouped vertical bar**.
![Image](https://github.com/user-attachments/assets/2704262d-433b-4b9d-ae93-22d4dc0ff408)


**Screenshots**
Here **Stacked Horizontal Bar Chart** not working.
![Image](https://github.com/user-attachments/assets/f4dddc25-307a-418c-8749-c30367e9808c)


**Demo**
 Bug in Stacked Horizontal Bar Chart, here is a [demo ](https://stackblitz.com/edit/swimlane-stacked-horizontal-bar-chart-aspzrjik?file=app%2Fapp.component.html).

**ngx-charts version**
   @swimlane/ngx-charts - ^20.5.0

",['Bug'],open,2025-04-23T12:17:54Z,,bug,['bug'],False,,
Swimlane/ngx-charts,2041,Grouped Bar chart >> Custom colors for bar >> even after grouping it,"Hello Guys, My query is >>>

- Consider I have class grouped of two, that is **BOYS**  and **GIRLS**.
- I have 3 classes, but for GIRLS group, I need to show different bar colors [_red, blue, green_] accordingly.
- Please look at the below image. I want to show different colors for **GIRLS** group.

![Image](https://github.com/user-attachments/assets/e7072a1e-0597-4ac7-ba85-19c897228afe)

please refer this link for my query. 
[https://stackblitz.com/edit/swimlane-grouped-vertical-bar-chart?embed=1&file=app/app.component.ts](url)
",['New Feature'],open,2025-04-11T07:30:48Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,2039,Memory leak when animations are enabled,"**Describe the bug**
When animations are enabled on some chart types, detached elements are retained in memory indefinitely as the chart data is updated, leading to a small but consistent memory leak. I have confirmed this is an issue for the pie chart, vertical bar chart and tree map but have not verified that it is an issue for all chart types. This memory leak will eventually lead to the browser tab running out of memory and crashing if the page is not refreshed.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to the ngx-charts demo page - https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-vertical
2. Select any of the Vertical Bar Chart, Pie chart or Tree map chart types, ensure that the Real-time and Animations checkboxes are checked.
3. Open the browser dev tools and select the Memory tab
4. Wait a minute then take a heap snapshot
5. Change the filter at the top of the snapshot summary from ""All Objects"" to ""Objects retained by detached DOM nodes""
6. In the list of objects you will see dozens of Detached SVG type DOM elements (ex. SVGGElement, SVGPathElement, etc).
7. Wait a minute and take another heap snapshot. You will see the number of detached elements has increased compared to the first snapshot.
8. Refresh the page, and this time uncheck animations before checking realtime. When taking heap snapshots over time you will no longer see the number of detached elements increasing over time.

**Expected behavior**
Animations not to cause a memory leak.

**Screenshots**

![Image](https://github.com/user-attachments/assets/6074040e-5ac1-4f84-826a-1b962f07dcb9)

![Image](https://github.com/user-attachments/assets/f87dc52e-0fa4-4f57-8a02-e91724f2b3be)

![Image](https://github.com/user-attachments/assets/0bee0522-5fc6-4d86-98cd-d37abf096649)

![Image](https://github.com/user-attachments/assets/a7998482-62af-4a60-8aab-c65986042cae)


**Demo**
This can be reproduced using the ngx-charts demo page - https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-vertical

**ngx-charts version**
21.1.3

**Additional context**
N/A
",['Bug'],open,2025-04-08T17:49:13Z,,bug,['bug'],False,,
Swimlane/ngx-charts,2036,"Feat| When the theme is changed to light , the left sidebar still stays in the dark theme","When we change the theme the complete framework should be in light theme only . It is not looking good when only the left sidebar of the screen remains in the dark theme. I want to fix that.

![Image](https://github.com/user-attachments/assets/3fddb8fd-ad66-4a9a-8554-90f404da9f13)",['New Feature'],open,2025-03-24T15:51:28Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,2034,tornado chart ngx charts angular,"
** Is it possible to make tornado chart using ngx chart? as example below **

https://smartorg.com/wp-content/uploads/2021/01/Tornado-1024x685-1.png",['New Feature'],open,2025-03-12T11:44:53Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,2033,Security Policy violation SECURITY.md,"_This issue was automatically created by [Allstar](https://github.com/ossf/allstar/)._

**Security Policy Violation**
Security policy not enabled.
A SECURITY.md file can give users information about what constitutes a vulnerability and how to report one securely so that information about a bug is not publicly visible. Examples of secure reporting methods include using an issue tracker with private issue support, or encrypted email with a published key.

To fix this, add a SECURITY.md file that explains how to handle vulnerabilities found in your repository. Go to https://github.com/swimlane/ngx-charts/security/policy to enable.

For more information, see https://docs.github.com/en/code-security/getting-started/adding-a-security-policy-to-your-repository.

---

<!-- Edit section #updates --><!-- Current result text hash: 652713d930a91ecff2c25828a2d2484398968f9fe98523a423a8e942ff08de42 --><!-- Edit section #updates -->
This issue will auto resolve when the policy is in compliance.

Issue created by Allstar. See https://github.com/ossf/allstar/ for more information. For questions specific to the repository, please contact the owner or maintainer.",['allstar'],closed,2025-02-04T22:56:57Z,2025-02-19T12:25:08Z,security,['allstar'],True,14.0,
Swimlane/ngx-charts,2032,Security Policy violation Outside Collaborators,"_This issue was automatically created by [Allstar](https://github.com/ossf/allstar/)._

**Security Policy Violation**
Found 1 outside collaborators with admin access.
This policy requires users with this access to be members of the organisation. That way you can easily audit who has access to your repo, and if an account is compromised it can quickly be denied access to organization resources. To fix this you should either remove the user from repository-based access, or add them to the organization. 

* Remove the user from the repository-based access. From the main page of the repository, go to Settings -> Manage Access. 
(For more information, see https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-user-account/managing-access-to-your-personal-repositories/removing-a-collaborator-from-a-personal-repository)

OR

* Invite the user to join your organisation. Click your profile photo and choose “Your Organization” → choose the org name → “People” → “Invite Member.” (For more information, see https://docs.github.com/en/organizations/managing-membership-in-your-organization/inviting-users-to-join-your-organization)

If you don't see the Settings tab you probably don't have administrative access. Reach out to the administrators of the organisation to fix this issue.

OR

* Exempt the user by adding an exemption to your organization-level Outside Collaborators configuration file.


---

<!-- Edit section #updates --><!-- Current result text hash: 8b7fd3f0992b4def7198ab60acd1e14e241201f28bad8db7bd0706f262c16cc6 --><!-- Edit section #updates -->
This issue will auto resolve when the policy is in compliance.

Issue created by Allstar. See https://github.com/ossf/allstar/ for more information. For questions specific to the repository, please contact the owner or maintainer.",['allstar'],closed,2025-02-04T22:56:53Z,2025-02-19T12:25:07Z,security,['allstar'],True,14.0,
Swimlane/ngx-charts,1989,Sankey Loop Backs,"I was hoping a loopback feature could be added to the current Sankey chart:
https://www.sankey-diagrams.com/loopbacks-in-sankey-diagrams/

It would allow re-recruitment into parts of sequences optionally via nodes:
https://www.sankey-diagrams.com/sankeys-with-circular-links/
",['New Feature'],open,2025-01-21T02:16:10Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1985,Legend Displays Empty Labels When Adding Empty Bars to Adjust Bar Width in ngx-charts-bar-vertical,"**Bug Description**  
I need to reduce the width of individual bars in a single bar chart using `ngx-charts-bar-vertical`. Since there is no direct property to adjust bar width, I added empty bars to the dataset as a workaround (https://github.com/swimlane/ngx-charts/issues/692#issuecomment-394662309). However, this causes an issue with the legend, as it displays colors for all bars, including the empty ones, along with empty labels.

**Steps to Reproduce the Issue**  
1. Use the `ngx-charts-bar-vertical` component.  
2. Add empty bars to the dataset to reduce the width of the existing bars. For example:  
   ```typescript
   if (data.chart_data?.length < 10) {
       const empty = '  ';
       for (let i = 0; i < 10 - data.chart_data.length; i++) {
           this.data.push({
               name: empty.repeat(i + 1),
               value: 0
           });
       }
   }
   ```
3. Save the changes and observe the issue with the legend.

**Expected Behavior** 
Provide a property or configuration to exclude empty-value legends, ensuring the chart looks clean and the legend only reflects meaningful data.


**Screenshots**  
<img width=""642"" alt=""image"" src=""https://github.com/user-attachments/assets/45125a0a-5061-4efe-a022-868108ec6dab"" />

**ngx-charts Version**  
`@swimlane/ngx-charts: ^20.4.1`
",['Bug'],open,2025-01-06T10:03:37Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1975,Pie Chart disappears when the value of one slice is massively larger than the others,"**Describe the bug**
When a pie chart has a couple of slices and the value of one slice is orders of magnitudes larger than the other slice to the point that there would be no room to draw the smallest slice (ex. 5 million times larger), the larger slice disappears.

**To Reproduce**
This can be reproduced in the demo project from this repository.
1. edit src/app/data.ts and change the single const to:
```ts
export const single: SingleSeries = [
  {
    name: 'Germany',
    value: 18,
    extra: {
      code: 'de'
    }
  },
  {
    name: 'United States',
    value: 83333334,
    extra: {
      code: 'us'
    }
  }
];
```
2. Run `npm start`, launch a browser to http://localhost:4200/ and switch to the pie chart demo.
3. See below gif for behavior

**Expected behavior**
The pie chart slice remains visible

**Screenshots**
![pie-chart-bug](https://github.com/user-attachments/assets/3958a00c-eb34-427a-8f13-5be4880c4a3d)

**ngx-charts version**
Specify the version of ngx-charts where this bug is present

**Additional context**
Add any other context about the problem here.
",['Bug'],open,2024-10-23T18:14:31Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1974,Gauge chart doesn't show the value arc,"**Describe the bug**
Gauge chart doesn't show the value arc in an Angular application, although it shows the correct value label. I have uninstalled other npm packages that I thought might have influenced it, but the issue persists. Upon inspecting the CSS, the value arc div is not there, unlike in the stackblitz demo:

Official Stackblitz demo:
![expected](https://github.com/user-attachments/assets/21a9e3f2-d1c3-4395-9cc8-532aaf8982ab)
![expected_chart](https://github.com/user-attachments/assets/9ddecd3b-2186-4c77-b4fa-d82d8f65f67e)


My CSS:
![actual](https://github.com/user-attachments/assets/dff440cc-2d36-4912-bafb-05bcddc91226)
![actual_chart](https://github.com/user-attachments/assets/00989078-414b-40ef-93ea-d67f5abc3d88)


**To Reproduce**
Steps to reproduce the behavior:
- using ""@coreui/angular"": ""^5.2.2"" and ""@swimlane/ngx-charts"": ""^20.5.0""

**Expected behavior**
My chart's value arc should be visible and coloured in the colour I selected (#5AA454)

**Demo**
Couldn't create a stackblitz because of some dependency errors. Might try again if really needed.

**ngx-charts version**
20.5.0 = latest

**Additional context**
I also have a problem related to the line chart data points line and tooltip not showing, but I'm not sure if those two are related.
",['Bug'],open,2024-10-22T15:48:53Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1973,Tree Map Label Visibility Issues,"**Describe the bug**
When the chart width is reduced, the labels on the Tree Map may not display correctly.

**To Reproduce**
1. Open the demo link and navigate to app.component.ts.
2. Decrease the chart width (e.g., view: any[] = [300, 400];).
3. Observe that the label text is missing.

**Expected behavior**
Labels should display in a vertical direction if the width is less.

**Screenshots**
![image](https://github.com/user-attachments/assets/adaf088c-4cb8-4ae0-ab64-2c3f025918bd)

**Demo**
[stackblitz demo](https://stackblitz.com/edit/swimlane-tree-map-chart-uxrzzc?file=app%2Fapp.component.ts)

**ngx-charts version**
  ""@swimlane/ngx-charts"": ""^10.1.0"",

**Additional context**
Labels should display in a vertical direction if the width is less.",['Bug'],open,2024-10-17T09:19:04Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1971,Infinite Loop on my console,"****### Hello guys,
I actually have an issue with the XAxisTickComponent.
I have an infinite loop on my console i dont understand while, even when i remove my XAxisTickComponent function, i dont understand why....

That is the error who is looping : 
----------------------------------
ERROR TypeError: Cannot read properties of undefined (reading 'constructor')
    at XAxisTicksComponent.tickFormat (swimlane-ngx-charts.mjs:5329:15)
    at XAxisTicksComponent__svg_g_2_Template (swimlane-ngx-charts.mjs:221:34)
    at executeTemplate (core.mjs:11268:9)
    at refreshView (core.mjs:12791:13)
    at detectChangesInView$1 (core.mjs:13015:9)
    at detectChangesInViewIfAttached (core.mjs:12978:5)
    at detectChangesInEmbeddedViews (core.mjs:12935:13)
    at refreshView (core.mjs:12815:9)
    at detectChangesInView$1 (core.mjs:13015:9)
    at detectChangesInViewIfAttached (core.mjs:12978:5)
----------------------------------

And this is my xAxisTickFormating function : 


`  xAxisTickFormatting = (val: any): string => {
    if (val === null || val === undefined) {
      return ''; // Ou une autre valeur par défaut comme 'N/A'
    }

    const formatDate = (date: Date): string => {
      if (isNaN(date.getTime())) {
        return 'Date invalide';
      }
      return date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit', year: 'numeric' });
    };

    if (val instanceof Date) {
      return formatDate(val);
    }

    if (typeof val === 'number') {
      return formatDate(new Date(val));
    }

    if (typeof val === 'string') {
      const date = new Date(val);
      if (!isNaN(date.getTime())) {
        return formatDate(date);
      }
      // Si la chaîne n'est pas une date valide, on la retourne telle quelle
      return val;
    }

    // Pour les objets et autres types
    try {
      return String(val);
    } catch (error) {
      console.error('Erreur lors de la conversion en chaîne :', error);
      return 'Erreur de format';
    }
  }`",['Bug'],open,2024-09-25T16:08:16Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1969,Feature Request: Screen Reader Support for Bar Chart Elements,"**Is your feature request related to a problem? Please describe.**

I'm always frustrated when using screen readers to navigate through bar charts because they do not provide clear context that these elements are part of a bar chart. This makes it difficult for users relying on screen readers to understand the data visualization and its purpose.

**Describe the solution you'd like**
I would like the screen reader to mention that the elements are part of a bar chart when navigating through the chart elements. For example, when a screen reader focuses on a bar in the chart, it should announce something like ""Bar chart element: [bar label], value: [bar value]"". This will provide a clearer context and improve the accessibility of data visualizations.

**Additional context**

_Here is an example of the current behavior:_

- Screen reader focuses on a bar and reads ""50"" without mentioning it is part of a bar chart.

_Proposed behavior:_

- Screen reader focuses on a bar and reads ""Bar chart element: Sales for January, value: 50.""

This feature will significantly enhance the accessibility of bar charts for users who rely on screen readers.
",['New Feature'],open,2024-07-23T13:01:00Z,,performance,['new feature'],True,,
Swimlane/ngx-charts,1968,Angular 15-16 LineChartModule bungle size,"I added the LineChartModule module to the Standalone component and the bundle size went through the roof.

It is noteworthy that on a pure Angular 17 project the bundle size increases by only 100kb

lib version 20.5.0

![image](https://github.com/user-attachments/assets/a3aed402-37aa-45ac-91bc-be161fea42fc)
",['Bug'],open,2024-07-19T14:19:18Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1966,Compatibility with Angular 17 / 18 ,"This package is not compatible with latest versions of Angular.

Are you planning to update it ?

Thank you
",['New Feature'],open,2024-07-03T07:48:15Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1965,Width of bars on grouped vertical bar chart depends on height,"The width of the bars on the 'grouped vertical bar chart' change with the height of the chart. I would expect that the width of the bars should only depend on the width of the chart and the number of bars.

**To Reproduce**
Open the example here: https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-vertical-2d
Change height from the default of 300, to 150, 120, 100, etc. and observe that the width of the bars is significantly reduced.

**Expected behavior**
I expect that the width of the bars does not change when only the height of the chart is changed

**Screenshots**
300 high:
![image](https://github.com/swimlane/ngx-charts/assets/54662165/431adc2f-fe5e-4585-869c-3bca2ce4eaf8)

120 high:
![image](https://github.com/swimlane/ngx-charts/assets/54662165/b24fe8c2-2f5f-48d7-8b20-31c2c63133b1)
",['Bug'],open,2024-06-24T07:00:29Z,,performance,['bug'],True,,
Swimlane/ngx-charts,1963,GeoJSON based Map support,"**Is your feature request related to a problem? Please describe.**
I want to be able to provide data rendering maps using custom geojson, and remove leaflet maps in favor of pure d3.js rendering

**Describe the solution you'd like**
Enter geojson to provide an SVG-drawn map

**Describe alternatives you've considered**
The user uses d3.js manually

**Additional context**
reference:
- https://echarts.apache.org/examples/zh/editor.html?c=map-usa
- https://geojson.cn/
- https://observablehq.com/@d3/zoom-to-bounding-box?intent=fork
- https://observablehq.com/@d3/choropleth/2?intent=fork
- https://geojson.org/
- https://en.wikipedia.org/wiki/GeoJSON#TopoJSON
- https://github.com/apache/echarts/blob/master/test/geo-map.html",['New Feature'],open,2024-05-31T03:43:41Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1961,Legend Customization,"**Is your feature request related to a problem? Please describe.**
Currently there's no choice for us to customize Legend. This feature is to add an entry point to customize legend size and style. 

**Describe the solution you'd like**


**Describe alternatives you've considered**


**Additional context**

",['New Feature'],open,2024-05-30T06:34:32Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1960,Unable to hide y-axis ticks without extra space,"**Describe the bug**
I am trying to hide only yAxis ticks , not y-Axis label in an area chart using ""ngx-charts-area-chart"".

I couldnt find any input to explicitly hide y-axis ticks only. So, I tried passing empty string to ""yAxisTickFormatting"" function. It works but still shows a lot of extra space as shown below.

Is there a better way to hide y-axis ticks? If not , how can i reduce the extra space using above solution.

![image](https://github.com/swimlane/ngx-charts/assets/67142751/aedadeb9-4a5c-4486-b989-f09b28b6ab37)

",['Bug'],open,2024-05-16T08:38:18Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1959,Stacked Bar with hours for Taxis - scheduling timeline,"I am unable to create a proper graph, this is kind of what my goal is

![Screenshot 2024-05-14 at 10 22 10 AM](https://github.com/swimlane/ngx-charts/assets/371344/8fdf5028-5b3d-46c4-8bcc-1f448f123bbf)

This is what I have so far

![Screenshot 2024-05-14 at 10 24 00 AM](https://github.com/swimlane/ngx-charts/assets/371344/dc76b2d9-c94f-4f99-be45-e5fd0cfe2b5b)

The problem here is that if a value swing the midnight I need to reset the xaxis numbers. So instead of 25 it should be 01 as 01AM next day.

Is there a way to do it ?

I tried series with new Date() but that does not work at all.

",['New Feature'],open,2024-05-14T15:26:40Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1956,Chart transparency and layer switch,"**Is your feature request related to a problem? Please describe.**
Currently there's no choice for us to customize line transparency or chart transparency. This feature is to add an entry point to customize chart style. And you can change the layer sequence in combo chart.

**Describe the solution you'd like**

**Describe alternatives you've considered**

**Additional context**
You can find these functions in following pics:
![image](https://github.com/swimlane/ngx-charts/assets/58924696/da7240b9-fe7d-4b91-87db-e137bfe9fbe7)
![image](https://github.com/swimlane/ngx-charts/assets/58924696/87a69e91-cf8f-4fd7-8c25-f83085092ef8)
![image](https://github.com/swimlane/ngx-charts/assets/58924696/a0ba94ea-4957-4dd8-846f-2aad6257d93e)
",['New Feature'],open,2024-04-24T06:57:21Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1955,`LegendPosition` enum break template type checks,"**Describe the bug**
Angular's `fullTemplateTypeCheck` wants the passed type of `LegendPosition` to be a value from the enum.  Passing in the string that represents that value causes the compiler to reject the string.  You have the

**To Reproduce**
Manually set the `LegendPosition` to a string, such as `right` or `below` and compile with `fullTemplateTypeCheck`.  You'll get an error like
```
Building Angular Package

------------------------------------------------------------------------------
Building entry point 'livelab'
------------------------------------------------------------------------------
✖ Compiling with Angular sources in Ivy partial compilation mode.
projects/livelab/src/lib/student-details/livelab-student-details.component.html:127:49 - error TS2322: Type '""below""' is not assignable to type 'LegendPosition'.

127             [legend]=""true"" [legendTitle]=""''"" [legendPosition]=""'below'"" [yScaleMax]=""yScaleMax"" [yScaleMin]=""0""
                                                    ~~~~~~~~~~~~~~

  projects/livelab/src/lib/student-details/livelab-student-details.component.ts:33:16
    33   templateUrl: ""./livelab-student-details.component.html"",
                      ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Error occurs in the template of component LivelabStudentDetailsComponent.
```

**Expected behavior**
Unfortunately, this is the expected behavior because enums are bad.  You want, per your documentation, that value to be a string, but it's not.  The source code should be:
```typescript
export type LegendPosition = 'right' | 'below';
```

**ngx-charts version**
Present on any version that uses `LegendPosition` enum.  Experienced on 20.5.0.

**Additional context**
You _can_ work around this issue using Angular's `$any()`, but then why enable strict type checking?

Ideally, you'd similarly convert any other enums to a union of string literals, which is almost always better anyway.  I, however, only attempted to use this enum.",['Bug'],open,2024-04-22T21:16:14Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1953,Chart switching animation,"**Describe the solution you'd like**
There should be a transition animation between charts, including an entry animation and an exit animation.

For example, for a bar chart, there should be a rise and fall of the bar, accompanied by changes in transparency.

**Describe alternatives you've considered**
No alternative has been found.

As a user, you cannot operate inside ngx-charts.
",['New Feature'],open,2024-04-10T06:27:28Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1951,Chart overlay customization & style,"**Is your feature request related to a problem? Please describe.**
Add different line style into combo chart and line chart:
![image](https://github.com/swimlane/ngx-charts/assets/58924696/bcc0f9c7-fb1b-4a5e-86ea-ec2b76283dd5)
<img width=""1915"" alt=""image"" src=""https://github.com/swimlane/ngx-charts/assets/58924696/241b92fb-4a2f-4f67-b662-18bdc534a6d1"">


**Describe the solution you'd like**
Choose line type and the line will change.
You can choose customization line to define the line style.
",['New Feature'],open,2024-03-25T06:33:32Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1950,In Area Line Chart Need Descending Date Time Format like Year 2024 to 2022 instead of Year 2022 to 2024,"I am using area chart in that if we pass data name in Date type then timeline feature has been activated. Its great feature but missing date sorting like ascending or descending wise. Currently its default sorting into ascending order. We need option to sort data into descending order to display dates like e.g. from year 2024 to year 2022.

Below is the sample image which showing graph data into ascending order
![image](https://github.com/swimlane/ngx-charts/assets/140685226/a4e21c39-1e11-4ba4-8077-2a94b0cc087d)
",['New Feature'],open,2024-03-21T12:32:18Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1948,Bar chart appears to render animation misaligned,"**Describe the bug**
Bar chart appears to render animation misaligned

**To Reproduce**
1. Toggle chart type
2. Find misalignment

**Expected behavior**
Start animation at axis base

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/49338067/e206fccf-0093-40b7-b6fb-de1973d657ea)


**Demo**
NGX-CHARTS online demo

**ngx-charts version**
20.4.1

",['Bug'],open,2024-03-18T02:07:30Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1947,JEST transformIgnorePatterns not working,"```
    ""@swimlane/ngx-charts"": ""^20.5.0"",

    ""@types/jest"": ""^29.5.12"",
    ""@types/node"": ""^18.18.0"",
    ""@typescript-eslint/eslint-plugin"": ""^6.19.0"",
    ""@typescript-eslint/parser"": ""^6.19.0"",
    ""jest"": ""^29.7.0"",
    ""jest-canvas-mock"": ""^2.5.2"",
    ""jest-environment-jsdom"": ""^29.7.0"",
    ""jest-preset-angular"": ""^14.0.3"",

```

already tried:

jest.config.js
```
const esModules = ['@swimlane', '@swimlane*', 'd3', 'd3-array', 'd3-selection', 'd3-*'].join('|');

transformIgnorePatterns: [
    `<rootDir>/node_modules/(?!${esModules})`,
  ],

```

but still

```
d3-selection\src\index.js:1
    ({""Object.<anonymous>"":function(module,exports,require,__dirname,__filename,jest){export {default as create} from ""./create.js"";
                                                                                      ^^^^^^

    SyntaxError: Unexpected token 'export' 
```",['Bug'],open,2024-03-08T13:05:31Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1946,"Change geolocation from browser to Mumbai, numerical values are displayed in local language.","**Describe the bug**
When you see the charts in browser and change your geo location to Mumbai the numerical values are switching to local language (Marathi).

**To Reproduce**
Steps to reproduce the behavior:
1. Go to (https://swimlane.github.io/ngx-charts/#/ngx-charts/advanced-pie-chart)
2. Right click on screen, go to inspect.
3. Click three dots, more tools, sensors, change the location to Mumbai and refresh the link.
4. See error

**Expected behavior**
The numerical values should not change to local language it should be displayed in English only.

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/57233541/3e6bbc1d-ec98-419f-acf4-54c57671ebd5)

",['Bug'],open,2024-02-26T11:45:28Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1944,Is this project still maintained?,"Genuine question.

158 pull requests outstanding, little input from developers on the issues raised.

I really like the project but hesitant to commit to it if it's just going to die on the vine within the coming months.
",['Bug'],open,2024-02-24T18:32:14Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1941,Add valueFormatting parameter for Line Area charts,"**Is your feature request related to a problem? Please describe.**
It's not possible to format values as currencies using these types of charts.

**Describe the solution you'd like**
Add valueFormatting parameter for Line Area charts, where it would be possible to include a currency format to values.
",['New Feature'],closed,2024-02-09T16:59:37Z,2024-02-27T15:41:49Z,bug,['new feature'],True,17.0,
Swimlane/ngx-charts,1940,Infinite loading when refreshing the page for multi ngx-charts-bar-horizontal,"**Describe the bug**
There is an issue happening when you have a multiple Horizontal bar charts displaying in one page. It seems to be causing a sort of a memory leak. It happens exactly when you have [yAxis] and [xAxis] set to ""true"".

**To Reproduce**
Steps to reproduce the behavior:
1.  Render multiple ngx-charts-bar-horizontal toghether with different data inside one single page
2. refresh the page (preferabilly multiple times, each time will be slower)

**Expected behavior**
Multiple charts can be shown in the same page with different data, while also showing xAxis and yAxis. When refreshing page, it should also show properly

**Screenshots**
If applicable, add screenshots to help explain your problem.

**ngx-charts version**
""@swimlane/ngx-charts"": ""^20.5.0"",
",['Bug'],open,2024-02-08T15:41:40Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1937,NGX-Charts does not seem to support Content-Security-Policies with nonces properly,"I recently upgraded our web projects to use strict Content Security Policies. This includes the use of nonces both for scripts and stylesheets. Unfortunately, this breaks the ngx-charts module. Instead of nice line graphs, it just renders a black block and throws a CSP error:

![image](https://github.com/swimlane/ngx-charts/assets/39433533/3eb39eb0-dc06-4e65-961b-bf1d78348fb7)

## How to replicate

This issue can be replicated by:

1. Configure the web server to return a Content-Security-Policy header like this: ""default-src 'self'; frame-ancestors 'self'; form-action 'self'; script-src 'self' 'nonce-[nonce]'; style-src 'self' 'nonce-[nonce]'""
2. Configure the Angular project to use nonces. Add ""ngcspnonce=[nonce]"" to <approot></approot>
3. Generate a random nonce on the server and inject it both in the header and in the index.html. I use NGINX to set the header and replace a dynamic nonce tag in the index.html (sub_filter NGINX-CSP-NONCE $request_id).

## Why is this a problem?

The issue here is the inline styling of ngx-charts elements. Inline styling is a [security risk](https://content-security-policy.com/examples/allow-inline-style/), and should ideally be blocked by CSPs. Unfortunately, it is not possible to use the hash approach (""sha256-[somehash]"") as nonces can't be used in conjunction with hashes. The hash also always seems to be different for the styling generated by ngx-charts. Moreover, nonces are probably the safest approach to restrict what styles can be applied.

## Potential resolution

Angular supports CSP nonces from version 16 and onward. So I suspect that upgrading Angular to 16 would work. Alternatively, a user should be able to pass the dynamic nonce to the ngx-charts image, where it is used to decorate styles and scripts with it to allow them to run.
",['Bug'],open,2024-01-23T18:59:51Z,,security,['bug'],True,,
Swimlane/ngx-charts,1934,Timeline chart type,"**Is your feature request related to a problem? Please describe.**
Currently there's no chart that can display date data well. A new timeline chart can be useful for visually representing the chronological sequence of events or milestones. 

**Describe the solution you'd like**
A new chart type that can display date data, eg: https://apexcharts.com/javascript-chart-demos/timeline-charts/

**Describe alternatives you've considered**
n/a

**Additional context**
n/a",['New Feature'],open,2024-01-17T01:24:44Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1932,Euro symbol is displayed when animations is turned off on advanced pie chart,"**Describe the bug**
A euro symbol (€) is displayed after the numbers on the advanced pie chart when animations is turned off, but isn't there when animations is turned on. 

**To Reproduce**
Steps to reproduce the behavior:
1. Go to advanced pie chart
2. Turn off animations, euro symbol (€) will show up after the numbers on the chart

**Expected behavior**
Turning animations on/off shouldn't affect whether the euro symbol (€) is displayed. 

**Screenshots**
Animations off:
![Screenshot 2024-01-09 at 6 00 31 PM](https://github.com/swimlane/ngx-charts/assets/47932418/2860cfb2-fe6f-4221-aafe-174c03673cc2)
Animations on:
![Screenshot 2024-01-09 at 6 00 43 PM](https://github.com/swimlane/ngx-charts/assets/47932418/0d10501c-213b-453c-9683-92663511abe9)

**ngx-charts version**
20.5.0",['Bug'],open,2024-01-10T00:04:28Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1930,Maximum Callstack exceeeded on Pie Chart V: 20.5.0,"**Describe the bug**
Pie chart is unable to render with simple data set. Issues occurs in d3.js with latest version of ngx-charts

**To Reproduce**


```html
 <ngx-charts-pie-chart [scheme]=""'vivid'"" [legend]=""false"" [labels]=""true"" [doughnut]=""false"" [results]=""graphData"">
      </ngx-charts-pie-chart>
```

```json
[{""name"":""AwaitingLoadReport"",""value"":3},{""name"":""Initialized"",""value"":9},{""name"":""AwaitingClientApproval"",""value"":1},{""name"":""PCCReceived"",""value"":1},{""name"":""AwaitingSignedDocs"",""value"":1},{""name"":""AwaitingFinalITN"",""value"":1},{""name"":""AwaitingVesselData"",""value"":1}]
```

```text
core.mjs:10592 ERROR RangeError: Maximum call stack size exceeded
    at Module.default (parse.js:18:1)
    at __WEBPACK_DEFAULT_EXPORT__ (object.js:13:14)
    at __WEBPACK_DEFAULT_EXPORT__ (value.js:21:15)
    at __WEBPACK_DEFAULT_EXPORT__ (object.js:13:19)
    at __WEBPACK_DEFAULT_EXPORT__ (value.js:21:15)
    at __WEBPACK_DEFAULT_EXPORT__ (object.js:13:19)
    at __WEBPACK_DEFAULT_EXPORT__ (value.js:21:15)
    at __WEBPACK_DEFAULT_EXPORT__ (object.js:13:19)
    at __WEBPACK_DEFAULT_EXPORT__ (value.js:21:15)
    at __WEBPACK_DEFAULT_EXPORT__ (object.js:13:19)
```

```js
//parse.js
export function parseSvg(value) {
  if (value == null) return identity;
  if (!svgNode) svgNode = document.createElementNS(""http://www.w3.org/2000/svg"", ""g"");
  svgNode.setAttribute(""transform"", value);
  if (!(value = svgNode.transform.baseVal.consolidate())) return identity;
  value = value.matrix;
  return decompose(value.a, value.b, value.c, value.d, value.e, value.f);
}

//object.js
   if (k in a) {
      i[k] = value(a[k], b[k]); //error
    } else {
      c[k] = b[k];
    }
  **}**
```

**Expected behavior**
The center of the chart renders

**Screenshots**
![20 125 209 179 2024-01-02 08-33-18](https://github.com/swimlane/ngx-charts/assets/147526328/d0302813-9ffa-4500-b384-f25e2a2e7622)


**ngx-charts version**
""@swimlane/ngx-charts"": ""^20.5.0""


",['Bug'],open,2024-01-02T15:35:17Z,,performance,['bug'],True,,
Swimlane/ngx-charts,1929,Timeline mini chart of line chart not clipped correctly when min / max value of x / y is set,"**Describe the bug**
When minimum x / maximum x / minimum y / maximum y value is set to a number within the range of x / y values, the mini chart for timeline selection is not clipped correctly. 

**To Reproduce**
1. Enable timeline on line chart
2. Set minimum x / maximum x / minimum y / maximum y value to a number within the range of x / y values 

**Expected behavior** 
The mini chart for timeline should be clipped so that only the parts of the chart that is shown in the original chart is shown. 

**Screenshots**
<img width=""853"" alt=""Screenshot 2023-12-24 at 1 18 57 PM"" src=""https://github.com/swimlane/ngx-charts/assets/47932418/b7e24b28-8f50-4f38-9657-a486e7ae26c2"">
<img width=""403"" alt=""Screenshot 2023-12-24 at 1 19 15 PM"" src=""https://github.com/swimlane/ngx-charts/assets/47932418/1875c814-084a-4c27-9dcc-97900db12e1f"">

**ngx-charts version**
20.5.0",['Bug'],open,2023-12-24T18:30:15Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1928,"Please, migrate (or provide as an alternative) standalone APIs for both components and providers.","**Is your feature request related to a problem? Please describe.**
Angular now supports standalone components (and APIs, eg `provideX()`) since version 14.

Now with the Angular 17 out, we could easily lazy load (often heavy) chart components but this is not currently possible because the `NgxChartsModule` registers many providers (some of them private) and importing this module in one of the components in consumer application which are marked as `standalone: true` will NOT add these providers to the injector)

A quick enabling workaroudn would be to export ALL providers so that consumers can register them in standalone way by themselves, but eventually it would be best if the library provided something like `provideNgxCharts()` which would register all the providers (1/22 of what the `NgxChartsModule` does.

I have written [an article](https://angularexperts.io/blog/angular-core-module-standalone-migration) about this topic and the approaches and concerns are applicable for this case.

",['New Feature'],open,2023-12-21T15:44:44Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1926,Mouse misalign with vertical line and tooltip in chart-line while zooming in or out,"**Describe the bug**
When zooming in and out such as placing a graph inside ngx-graph, applying zoom, and then hovering over the line graph 
the vertical line and the tooltip are misaligned with the mouse's actual location.

**To Reproduce**
Steps to reproduce the behavior:
1. Embed the graph inside a zoomable object such as ngx-graph
2. Zoom in or out 
3. hover over the graph and try to catch points in the graph with the mouse
4. The hover line and tooltip will lag to the right or left depending on the zoom-in or out

**Expected behavior**
The vertical line and tooltip should always be aligned with the mouse

**Screenshots**
![20231207_143159](https://github.com/swimlane/ngx-charts/assets/99589152/187d1460-4173-4866-b1f3-de6733f8f4a8)



**ngx-charts version**
20.1.0


",['Bug'],open,2023-12-07T12:34:58Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1925,"Heat map If max and min parameters are not passed, the colors of legend and heat grid will be inconsistent.","**Describe the bug**
Heat map If max and min parameters are not passed, the colors of legend and heat grid will be inconsistent.

**To Reproduce**
```angular
      <ngx-charts-heat-map
        *ngIf=""chartType === 'heat-map'""
        class=""chart-container""
        [legend]=""true""
        [view]=""view""
        [results]=""multi""
      >
```

**Expected behavior**
The legend color is consistent with the heat grid color.

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/49338067/b7a7a773-0d9d-4bc8-b995-3eb5340146f4)


**Demo**
https://stackblitz.com/~/github.com/james-curtis/ngx-charts-bug-heat-map-legend-color

**ngx-charts version**
[20.5.0](https://github.com/swimlane/ngx-charts/releases/tag/20.5.0)
",['Bug'],open,2023-12-06T07:02:44Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1924,X Axis Orientation,"**Is your feature request related to a problem? Please describe.**
Currently only the y-axis have the option to change the orientation to left / right. X-axis cannot be changed to top of chart.

**Describe the solution you'd like**
Allow x-axis to be changed to top of chart. 
",['New Feature'],open,2023-12-06T01:50:56Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1921,Chart rendering will shake when SSR is enabled,"**Describe the bug**
Chart rendering will shake when SSR is enabled

**Expected behavior**
The generated charts are not misaligned with ssr enabled and browser js disabled. And the chart will not be jittery with browser js enabled.

**Screenshots**
![20231129185805_rec_](https://github.com/swimlane/ngx-charts/assets/49338067/74508fb3-4a58-487b-82a1-b8b7e8876928)


**Demo**
https://github.com/james-curtis/ngx-charts-bug-ssr-dislocation-16

https://stackblitz.com/~/github.com/james-curtis/ngx-charts-bug-ssr-dislocation-16

**ngx-charts version**
[20.5.0](https://github.com/swimlane/ngx-charts/releases/tag/20.5.0)

",['Bug'],open,2023-11-29T10:58:33Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1920,Custom pie chart label,"**Describe the solution you'd like**
Add feature: text labels on pie chart graphs that can be used to illustrate some data information about the graph, such as values, names, etc.

**Describe alternatives you've considered**
No alternative has been found, if the user needs to force a label to be displayed inside the pie chart sector, the internal lifecycle of the ngx component needs to be interfered with, which is troublesome.

**Additional context**

example: https://echarts.apache.org/zh/option.html#series-pie.label
",['New Feature'],open,2023-11-29T08:38:08Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1918,Calendar Pie Chart,"**Is your feature request related to a problem? Please describe.**
Currently there's no chart that shows pie charts in calendar mode, similar to [this echarts](https://echarts.apache.org/examples/en/editor.html?c=calendar-pie). It is useful for visually representing the distribution of activities over time. They offer a clear way to identify patterns, make comparisons, and track progress over time. 

**Describe the solution you'd like**
A chart similar to [this](https://echarts.apache.org/examples/en/editor.html?c=calendar-pie).

**Describe alternatives you've considered**
n/a

**Additional context**
n/a",['New Feature'],open,2023-11-26T23:27:11Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1916,Request of new Line-Pie Combo Chart type,"**Is your feature request related to a problem? Please describe.**
Currently, ngx-charts doesn't support line-pie combo chart that allows shared data between line and pie chart.

**Describe the solution you'd like**
I would like a chart similar to [this.](https://echarts.apache.org/examples/en/editor.html?c=dataset-link)",['New Feature'],open,2023-11-26T21:32:36Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1914,Creating a component directly using ViewContainerRef.createComponent or using a component directly in a template without any parameters will result in the error,"**Describe the bug**
Creating a component directly using ViewContainerRef.createComponent or using a component directly in a template without any parameters will result in the error

**To Reproduce**
```angular
// ...
ngAfterViewInit(): void {
    setTimeout(() => {
      const ref = this.container.createComponent(BarVerticalComponent);
      ref.instance.view = [700, 300];
      ref.instance.results = this.data;
    });
  }
// ...
```

or

```html
<!-- But if you add any of the input attributes, you won't have a problem -->
<ngx-charts-bar-vertical></ngx-charts-bar-vertical>
```

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/49338067/f9160eaa-d165-41f6-a946-bc06076bf57d)


**Demo**
https://stackblitz.com/edit/vertical-bar-chart-i1i4qy?file=app%2Fapp.component.html

https://vertical-bar-chart-i1i4qy.stackblitz.io/

**ngx-charts version**
20.5.0

",['Bug'],open,2023-11-19T10:01:56Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1913,The legend text is incorrectly located in ssr mode,"**Describe the bug**
The legend text is incorrectly located in ssr mode

**Screenshots**
ssr mode:
![image](https://github.com/swimlane/ngx-charts/assets/49338067/6e8c8932-4084-4959-9b64-19d8e501f5b0)

csr mode:
![image](https://github.com/swimlane/ngx-charts/assets/49338067/a3415c2d-245a-4a88-abf6-9fa447baf72f)


**Demo**
https://github.com/james-curtis/ngx-render/tree/e2045f24aed8d74436b4199592b32225d927d945

**ngx-charts version**
v 20.5.0

**Additional context**
bug css
![image](https://github.com/swimlane/ngx-charts/assets/49338067/1f2f7d32-c328-46ba-9dea-d9275192f0de)

",['Bug'],open,2023-11-13T03:04:18Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1910,Linear-scaled charts maximum gradient color stop is incorrect and does not match legend,"**Describe the bug**
For linear-scaled charts, the maximum gradient color stop is not in the color scheme. It does not match the legend's maximum gradient color stop. 

**To Reproduce**
Steps to reproduce the behavior:
1. Go to any linear-scaled charts, eg linear-scaled vertical bar charts
2. The bug occurs for all color schemes, but is most obvious in the forest color scheme

**Expected behavior**
For linear-scaled charts, the maximum gradient color stop should be in the color scheme and should match the maximum gradient color stop on the legend. 

**Screenshots**
For example, for the forest color scheme, the second bar's top is yellow but yellow is not in the forest color scheme. From the legend we can see that the maximum gradient color stop is supposed to be orange not yellow. 
<img width=""738"" alt=""Screenshot 2023-10-29 at 8 24 06 PM"" src=""https://github.com/swimlane/ngx-charts/assets/47932418/5937e34e-df54-4750-9768-4ee733c5d5c6"">

**Demo**
n/a

**ngx-charts version**
20.4.1

**Additional context**
n/a",['Bug'],open,2023-10-30T01:36:18Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1909,Add custom colors to linear scale type charts,"**Is your feature request related to a problem? Please describe.**
Currently, custom color is only available to ordinal-scaled type charts. It is not available for heat map, linear-scaled bar charts, vertical charts, etc. 

**Describe the solution you'd like**
Add custom colors for linear scale type charts in the form of gradient color stops. 

**Describe alternatives you've considered**
n/a

**Additional context**
n/a",['New Feature'],open,2023-10-30T01:23:21Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1908,Gauge Chart leads to console errors with invalid transform of scale,"**Describe the bug**
After change events of input values the component fires a lot of console errors because of an invalid transformation

**To Reproduce**
Steps to reproduce the behavior:
1. Add a gauge chart with some values including a unit
2. Change the value frequently

**Expected behavior**
No console errors and always a valid transformation of the scaling

**Screenshots**
If applicable, add screenshots to help explain your problem.

**ngx-charts version**
20.1.0

",['Bug'],open,2023-10-26T08:55:49Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1906,Chart export feature,"**Is your feature request related to a problem? Please describe.**

I need to export these diagrams in my project for user use, but ngx doesn't seem to have such a feature, causing me to develop such a feature using other third libraries

**Describe the solution you'd like**

I wish ngx had a way to export charts

**Describe alternatives you've considered**

I have used third-party libraries to implement the chart export function, but it will lead to more boilerplate code

**Additional context**

It would be nice to have an export method like echarts.

reference: https://echarts.apache.org/en/api.html#echartsInstance.getDataURL",['New Feature'],open,2023-10-19T02:33:57Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1904,Trim and Wrap axis label,"**Is your feature request related to a problem? Please describe.**
I want to enable trim and wrap feature for extended axis label  to enhance their aesthetic appeal.

**Describe the solution you'd like**
Buttons for wrap and trim according to user defined max label length. Auto-wrap according to word and graph axis length if max label length is not specified.
",['New Feature'],open,2023-10-18T20:34:46Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1901,Drop dependency on rdfc? CommonJS dependency causes optimisation bailouts.,"**Describe the bug**
Warning:  @swimlane\ngx-charts\fesm2020\swimlane-ngx-charts.mjs depends on 'rfdc'. CommonJS or AMD dependencies can cause optimization bailouts.

**To Reproduce**
Steps to reproduce the behavior:

run the app that uses 'swimlane-ngx-charts', gets above warning at compile time.

**Expected behavior**
should compile without warning, potential missing optimisation.

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/2097150/870d7885-329b-4a20-a758-dbb4eb89c57f)


**ngx-charts version**
20.4.1


",['Bug'],open,2023-09-29T07:30:24Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1899,Web error on ngx-charts-bar-horizontal-2d chart with wrapTicks and maxYAxisTickLength,"**Describe the bug**
Web freezes when setting ngx-charts-bar-horizontal-2d chart with ""wrapTicks"" and ""maxYAxisTickLength"" properties together.

**To Reproduce**
Steps to reproduce the behavior:

1. Go to 'https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-horizontal'
2. Click on 'Wrap Ticks' checkbox
3. Click on ""Trim Y Axis Ticks"" checkbox
4. Web freezes immediately, error appears between 2 to 5 seconds later.

**Expected behavior**
maxYAxisTickLength sets the maximum length per line or the total y-axis width.

**Screenshots**
![image](https://github.com/swimlane/ngx-charts/assets/37313502/3665555d-523c-4976-8ba6-308a12f9b599)

**ngx-charts version**
^20.4.1

**Additional context**
I encountered this error while testing the library locally and confirmed it on the official GitHub page. If any additional information is required, I am able to provide it.",['Bug'],open,2023-09-04T20:58:47Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1897,Add roundEdges input on Stacked Vertical Bar Chart,"**Is your feature request related to a problem? Please describe.**
It's not possible to round edges using Stacked Vertical Bar Chart.

**Describe the solution you'd like**
roundEdges input for Stacked Vertical Bar Chart.

**Describe alternatives you've considered**
N/A

**Additional context**
N/A
",['New Feature'],open,2023-08-28T12:26:40Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1896,"How to handle Ticks (word-wrap, multiline etc)","**Describe the bug**
Is there any way to allow ticks to wrap or drop down to another line neatly underneath ?
I cant seem to find any default way to do this without using renderer2 and a pile of hacks which is not ideal especially when the data and labels are dynamic ",['Bug'],open,2023-08-17T15:45:48Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1894,New Map Chart Type,"**Is your feature request related to a problem? Please describe.**
Currently, users cannot use ngx-charts to display geographic data. 

**Describe the solution you'd like**
A new chart type, map chart, to visualize geographic data. It should retain the common features across ngx-charts such as color theme but also have new features such as the ability to set markers. 

**Describe alternatives you've considered**
n/a

**Additional context**
n/a",['New Feature'],open,2023-08-16T04:31:31Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1570,Pie chart is not aligning at the center of the container with bootstrap,"**Describe the bug**
The chart seems to not be center aligned at its container, but rather, it looks a bit tilted to the right.

**To Reproduce**
Steps to reproduce the behavior:
1. Create components for the charts themselves.
2. Place a div with ""row my-5"" class
3. Then, place a div with ""col-md-auto px-0"" class
4. Finally, place the chart component inside said div
5. The charts look a bit tilted to the left

**Expected behavior**
The translate method is actually missing 50px from the expected target and due to that, the chart is not aligning at the center of its container, but, it seems like it's aligning to its left.

**Screenshots**
If applicable, add screenshots to help explain your problem.
![image](https://user-images.githubusercontent.com/50752448/105972181-1f212d80-606a-11eb-89ee-27e3edec69ff.png)
![image](https://user-images.githubusercontent.com/50752448/105972259-3102d080-606a-11eb-8dad-f4c7f645c83d.png)

**Demo**
https://stackblitz.com/github/mrdedede/ngx-charts-bug

**ngx-charts version**
17.0.0",['Bug'],open,2021-01-27T09:45:11Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1568,Support  counter and custom label at the center of the pie chart (similar to pipe grid),"**Is your feature request related to a problem? Please describe.**
We need to display Total/Percentage value and a custom label at the center of the pie chart (as shown in the screenshot)
<img width=""418"" alt=""Screen Shot 2021-01-12 at 5 26 45 PM"" src=""https://user-images.githubusercontent.com/1259031/104386795-75835d80-54fb-11eb-85bd-5a6bc6cfaf12.png"">

Looks like we have something similar in
<img width=""1253"" alt=""Screen Shot 2021-01-12 at 5 24 47 PM"" src=""https://user-images.githubusercontent.com/1259031/104386907-a5326580-54fb-11eb-8b14-d37f71dc71e5.png"">
 pie grid


**Describe the solution you'd like**
Can we add custom label template/counter template, formatter for pie chart?
",['New Feature'],open,2021-01-12T23:29:15Z,,bug,['new feature'],True,,
Swimlane/ngx-charts,1564,core.js:5967 ERROR TypeError: Cannot read property 'domain' of undefined,"**Describe the bug**
property Scheme is not defined but its used in line-chart.component.ts as shown below. And so in color.helper.ts, its throwing error when domain property is being read from Scheme. 
 
**Screenshots**
![image](https://user-images.githubusercontent.com/16747586/103631973-91a35f80-4f3b-11eb-9174-c39e72aef0ac.png)

line-chart.component.ts
![image](https://user-images.githubusercontent.com/16747586/103633014-09be5500-4f3d-11eb-8476-cd2e1a2ce768.png)

Color.helper.ts
![image](https://user-images.githubusercontent.com/16747586/103632674-961c4800-4f3c-11eb-9e4c-66812f44c687.png)

**ngx-charts version**
16.0.0

",['Bug'],open,2021-01-05T09:58:55Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1563,"Angular build failing: ""export 'ɵb' (imported as 'i14') was not found in '@swimlane/ngx-charts'","**Describe the bug**
Im getting this error while building for production in angular 8
`""export 'ɵb' (imported as 'i14') was not found in '@swimlane/ngx-charts'`

In package.json
""@swimlane/ngx-charts"": ""^12.1.0"",
 ""@swimlane/ngx-graph"": ""^7.2.0"",

Angular & Node version:
Angular CLI: 8.3.29
Node: 10.16.0

**To Reproduce**
Steps to reproduce the behavior:
1. Go to '...'
2. Click on '....'
3. Scroll down to '....'
4. See error

**Expected behavior**
A clear and concise description of what you expected to happen.

**Screenshots**
If applicable, add screenshots to help explain your problem.

**Demo**
Provide an online demo (stackblitz, codesandbox, or similar) where the issue can be reproduced 

**ngx-charts version**
""@swimlane/ngx-charts"": ""^12.1.0"",
""@swimlane/ngx-graph"": ""^7.2.0"",

**Additional context**
Add any other context about the problem here.
",['Bug'],open,2021-01-05T08:41:12Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1562,Area Chart color turns black when Gradient is On and X & Y axis are off,"**Describe the bug**
I wanted an area chart with nothing except the graph. So that means, no labels, no axis, no titles, no legend, etc. 

But when I turn off both axis, the gradient turns the graph black.

If you resize anything it gets painted again (except the timeline if you have it activated)

**Expected behavior**
Just maintain the gradient no matter what.

**Demo**
Provide an online demo (stackblitz, codesandbox, or similar) where the issue can be reproduced 
https://stackblitz.com/edit/swimlane-area-chart-mehq3x?embed=1&file=app/app.component.ts

**ngx-charts version**
16.0.0

",['Bug'],closed,2021-01-04T17:27:50Z,2021-06-10T16:28:00Z,bug,['bug'],False,156.0,
Swimlane/ngx-charts,1559,Pie-chart label overlapping issues,"**Describe the bug**
A clear and concise description of what the bug is.

**ngx-charts version**
""@swimlane/ngx-charts"": ""^16.0.0"",

**To behavior**

1. Go to 'https://drive.google.com/file/d/1zPDGI38dOZPl92O3h95ScDF-qw_7VMt2/view'
2. See error

**Expected behavior**
Pie-chart overlapping label names please check below screenshot 

**Screenshots**
![Screenshot 2020-12-28 180846](https://user-images.githubusercontent.com/6239828/103259225-7033f800-49be-11eb-9eab-fcf8df4394c9.png)

**ngx-charts version**
""@swimlane/ngx-charts"": ""^16.0.0"",
",['Bug'],open,2020-12-29T04:45:30Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1558,Not clear to see which bar is active.,"**Describe the bug**
When hovering over a bar or more importantly when hovering over an entry in the legend, it's hard to tell which bar is active.

**To Reproduce**
Steps to reproduce the behavior:
1. Go to https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-vertical
2. Hover over an entry in the legend.
3. See that it's hard to tell which bar is active.

**Expected behavior**
The expected behavior should be that all the bars besides the active one should become less opaque. This will make the active bar stand out.

**Screenshots**
![image](https://user-images.githubusercontent.com/4143306/103238059-677bed00-48fe-11eb-8b80-2d711c26216e.png)


**Demo**
https://swimlane.github.io/ngx-charts/#/ngx-charts/bar-vertical

**ngx-charts version**
Latest

**Additional context**
Add any other context about the problem here.
",['Bug'],open,2020-12-28T19:19:06Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1554,x-axis.component hardcoded orientation to 'bottom',"**Describe the bug**

in the x-axis.component.ts file the orientation of labels is hardcoded to bottom
it is possible to use the xAxisOffset prop to translate it to top, but it will cause the axis svg to go beyond the svg chart container



**Expected behavior**

i expect to be able to declare a proper x axis located on top of a vertical bar chart (or any chart)



**ngx-charts version**
16


",['Bug'],open,2020-12-20T22:53:39Z,,bug,['bug'],False,,
Swimlane/ngx-charts,1553,Width not adjusted to 100% when using flexbox,I am sorry - I just saw that this is the wrong repository :-),['Bug'],closed,2020-12-20T22:39:19Z,2020-12-20T22:46:09Z,bug,['bug'],False,0.0,
Swimlane/ngx-charts,1551,Removing DOM Sanitisation Bypass?,"**Is your feature request related to a problem? Please describe.**

The [scale legend component](https://github.com/swimlane/ngx-charts/blob/0ccf026beadb2a5bf9750e1359a884245ae3ce45/projects/swimlane/ngx-charts/src/lib/common/legend/scale-legend.component.ts#L40) calls `bypassSecurityTrustStyle()`. As far as I could see, the `$gradientValues` is potentially unsafe because it is read from the `@Input() colors` of the component, which might make it possible to inject malicious code... or at least make automatic security scanning tools think that's possible.

**Describe the solution you'd like**

Is there an alternative to make sure this can never be used for attacks, e.g. by adding additional manual sanitisation?",['New Feature'],closed,2020-12-15T16:50:15Z,2021-01-04T22:13:40Z,security,['new feature'],True,20.0,
angular-ui/ui-router,3836,child states of lazy loaded future states get stuck in stateQueue,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: 1.0.29



# Bug Report

#### Current Behavior:

- Define a main application state
- Define a future state to lazy load a module using the glob double wildcard
```
export const clientAdminLandingFutureState: Ng1StateDeclaration = {
    name: 'clientAdmin.**',
    parent: 'app',
    url: '/admin',
        lazyLoad: function(transition: Transition) {
        const $ocLazyLoad: ILazyLoad = transition.injector().get('$ocLazyLoad');
        const $log: ILogService = transition.injector().get('$log');

        return import(
            /* webpackChunkName: ""clientAdminLanding"" */ './client-admin-landing.module'
        )
            .then(({ ClientAdminLandingModule }) =>
                $ocLazyLoad.load(<any>ClientAdminLandingModule)
            )
            .catch((err) => $log.error(err));
    }
};
```
- Define another future state to lazy load a module that is a child of the first state
```
export const proxyFutureState: Ng1StateDeclaration = {
    name: 'proxy.**',
    parent: 'clientAdmin',
    url: '/proxy',
    lazyLoad: (transition: Transition) => {
        const $ocLazyLoad: ILazyLoad = transition.injector().get('$ocLazyLoad');
        const $log: ILogService = transition.injector().get('$log');

        return import(/* webpackChunkName: ""proxy"" */ './proxy.module')
            .then(({ ProxyModule }) => $ocLazyLoad.load(<any>ProxyModule))
            .catch((err) => $log.error(err));
    }
};
```
- Register each future state with the $stateRegistry
```
import { module } from ""angular"";

import { clientAdminLandingFutureState } from ""./src/client-admin-landing/client-admin-landing.future-state"";
import { proxyFutureState } from ""./src/proxy/proxy-future-state"";

const AppModule = module(""appModule"", []).config(
  /* @ngInject */($stateRegistry, $stateProvider) => {
        $stateProvider.state('app', {
            abstract: true,
            views: {
                master: {
                    templateUrl: '/templates/core/master-layout.html',
                    controller: 'coreController'
                },
            }
        });
        
        $stateRegistry.register(clientAdminLandingFutureState);
        $stateRegistry.register(proxyFutureState);
  }
);
```
- When logging $stateRegistry.stateQueue.queue through the onStatesChanged listener or through an $onInit the child future state is still queued:
`[self: {name: ""proxy.**"", parent: ""clientAdmin"", url: ""/proxy"", lazyLoad: ƒ, $$state: ƒ}]`

#### Expected Behavior:

If the parent state is already defined, the child state should be registered and not queued. If the child state is put into the queue, it should be registered after the parent state is registered. 

My thinking is that the double wildcard is preventing the child and parent names from matching

#### Link to Plunker or stackblitz that reproduces the issue:

See code sample above


",['stale'],open,2021-08-26T16:05:06Z,,bug,['stale'],True,,
angular-ui/ui-router,3835,Optional params included on all similar routes,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [X] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: 1.0.29



# Bug Report

#### Current Behavior:

I have multiple links to the same route, but with different params. The optional params, when present in the URL are appended to all `srefs` for that route

#### Expected Behavior:

Only the params defined on the `sref` is included",['stale'],closed,2021-08-26T11:42:58Z,2022-05-12T10:41:25Z,bug,['stale'],True,258.0,
angular-ui/ui-router,3833,Resolve triggering twice ,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: (type version) - 0.3.2



# Bug Report

#### Current Behavior:

New URL entered into the browser for the first time triggers resolve twice 

#### Expected Behavior:

To only trigger once

#### Link to Plunker or stackblitz that reproduces the issue:

Its a massive application without the ability to isolate and make a Plunker out of it
( if you want a response to your issue, provide a way to reproduce it )
( http://bit.ly/UIR-Plunk1 )
( https://stackblitz.com/edit/ui-router-angularjs )




# Feature Request

(type feature request here)




# General Query

Please direct general implementation questions to StackOverflow: 
http://stackoverflow.com/questions/ask?tags=angularjs,angular-ui-router

Please review the Sample Application which highlights common approaches:
https://github.com/ui-router/sample-app-angularjs

- [x] I have already asked my question on StackOverflow and nobody could answer the question

- [x] I have already reviewed the sample application for examples of common approaches

- [ ] I believe my question can only be answered by the UI-Router maintainers


(type general query here)
",['stale'],open,2021-08-15T06:41:27Z,,bug,['stale'],True,,
angular-ui/ui-router,3832,ui-router core v6.0.7 does not work with IE version 21H1,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: 1.0.29



# Bug Report

#### Current Behavior:

Javascript crashes, testing via try-catch and window alert indicated problem with line 1209 in getSafeConsole. It is trying to check if console.table exists, but throwing an error because console does not exist with the dev tools closed.

#### Expected Behavior:

No errors occur

#### Link to Plunker or stackblitz that reproduces the issue:

I'm not sure how to show error without using a modified core.js, as the error only occurs in IE version 21H1 with the dev console closed. I fixed it locally by modifying the line in question to read:

`else if (console && (!console.table || !console.error)) {`

I do not know if that's the best solution.",['stale'],open,2021-08-11T21:17:05Z,,bug,['stale'],True,,
angular-ui/ui-router,3831,Thank You (That's All),"This is a (check one box):

- [ ] Bug Report
- [ ] Feature Request
- [x] General Query 

My version of UI-Router is: 0.3.2 (!!!)

# General Query

- [x] I have already asked my question on StackOverflow and nobody could answer the question

- [x] I have already reviewed the sample application for examples of common approaches

- [x] I believe my question can only be answered by the UI-Router maintainers


@christopherthielen (and others) I just wanted to take a second to thank you for the hard work on this project. I've been using this, ""ui-router-extras"", etc for a _long_ time -- starting in the v0.2.x range IIRC -- and have gotten **great** use out of it in the AngularJS world over the years. Currently I'm migrating an AJS application to React and have, for various reasons, been reviewing the v0.3.2 documentation and code base -- and it _still_ impresses the hell out of me. Especially the code comments... Just goes to show how important clean, well-documented code is and how it's still useful years down the road.

Keep up the good work!",['stale'],open,2021-07-20T00:08:00Z,,bug,['stale'],True,,
angular-ui/ui-router,3830,$urlRouterProvider.when is ignoring { priority: -1 },"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: `1.0.29`

# Bug Report

#### Current Behavior:

When configuring a route such as the following:

```javascript
$urlRouterProvider.when('/{path:.+}', '/404?path', { priority: -1 })
```
If after the application is loaded I check `$urlRouter.rules()`, the rule that's associated with this `when` call has a `{ priority: 0 }` rather than the `{ priority: -1 }` that we specified.

However, if we do this in a `.run` it works:

```javascript
$urlRouter.when('/{path:.+}', '/404?path', { priority: -1 })
```
And the `{ priority: -1 }` is correctly configured in the `$urlRouter.rules()` for this rule.

#### Expected Behavior:

That `$urlRouterProvider.when` has the same interface as `$urlRouter.when` in that it honors the `options` passed as the 3rd argument.",['stale'],open,2021-05-18T20:04:36Z,,bug,['stale'],True,,
angular-ui/ui-router,3829,Returning a promise on a $transaction changes URL in browser but not on returning false. URL should not change until promise is rejected or resolved. ,"This is a (check one box):

- [X ] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: v1.0.26

# Bug Report

#### Current Behavior:

Currently when pressing the navigation buttons on the browser, after setting a $transition.onStart to intercept, if you return a promise the URL in the browser will change before a resolve or reject is called on the promise but if you simply return false it does not change the URL. 

#### Expected Behavior:

Expected behaviour would be no change to the URL until promise comes back with reject or resolve. As when rejecting I do not wish the URL to change. 

#### Link to Plunker or stackblitz that reproduces the issue:

https://embed.plnkr.co/plunk/bCTfAXLTQwsk3NkP

If you open plunker in separate window to look at URL changes. You can see when you go to foo2 and click the back button in the browser no URL changes but if you go from home to foo and click the back button on the browser the URL changes but the promise in 2 seconds is rejected. 

",['stale'],open,2021-04-27T12:36:11Z,,bug,['stale'],True,,
angular-ui/ui-router,3827,"When resolving an onBefore promise, the previous state is removed while async resolves are still pending.","This is a (check one box):

- [X] Bug Report

My version of UI-Router is: 1.0.28

# Bug Report

#### Current Behavior:

We can return a promise to `transitions.onBefore()`, if the promises resolves, I observe that the router starts the exit/retain/enter flow, and in turn removes the original state from the DOM. 

The new state is only added after all async resolves are completed. In the mean time this leaves an empty dom or 'flickering' page. 

#### Expected Behavior:

I expect the behavior to be the same to when I am not using an async onBefore, which is: Don't exit the original state until all async resolves are completed.

When returning a promise `transitions.onEnter()` the behavior is as expected. I can work with that.

If you think I am on to something here I am happy to provide a repro – otherwise feel free to ignore. Thanks for maintaining this useful project!
",['stale'],open,2021-03-24T21:05:24Z,,bug,['stale'],True,,
angular-ui/ui-router,3823,Broken link for 0.x documentation in README ,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: (type version)

0.2.18

# Bug Report

#### Current Behavior:

Looking at the current README, you'll see this:

    Note: this is the Angular 1.x source for UI-Router version 1.x. If you are looking for the source for UI-Router version 0.x, it can be found here

The here link points to [https://github.com/angular-ui/ui-router/tree/legacy](https://github.com/angular-ui/ui-router/tree/legacy) which 404s.


",['stale'],open,2020-10-20T13:26:41Z,,bug,['stale'],True,,
angular-ui/ui-router,3822,callback url with HTTP Post not working using ui.router,"Hi Team,

Need help on how to handle the scenario mentioned with all details at https://stackoverflow.com/questions/64050474/callback-url-with-http-post-not-working-using-ui-router

Any help on this is much appreciated.

Thanks,
Santosh",['stale'],closed,2020-10-05T13:45:06Z,2021-06-26T03:20:02Z,bug,['stale'],True,263.0,
angular-ui/ui-router,3806,"When using $state.href inside a resolve, it returns null at first","This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: 
```
    ""@uirouter/angularjs"": ""1.0.3"",
    ""@uirouter/core"": ""5.0.3"",
    ""@uirouter/dsr"": ""1.0.3"",
    ""@uirouter/sticky-states"": ""1.5.0"",
    ""@uirouter/visualizer"": ""6.0.0"",
```

# Bug Report

#### Current Behavior:
When doing this in a resolve: (I added logs to find out what is going on)
```
        resolve: {
          /**
           * @function
           * @param {StateService} $state
           * @returns {string}
           */
          presentationUrl($state) {
            'ngInject';

            console.log('###', $state.href('presentation-state')); // null
            setTimeout(() => {
              console.log('###', $state.href('presentation-state')); // null
            });
            setTimeout(() => {
              console.log('###', $state.href('presentation-state')); // '/app/presentation'
            }, 1000);

            return $state.href('presentation-state'); // null
          },
        },
```
Note that this happens on a page reload, so my guess is that something is not yet fully hooked up?

#### Expected Behavior:

I expect that in a resolve, we can already use the `href` function. If this is not the case, then having it return a promise will be more logical.

#### Link to Plunker or stackblitz that reproduces the issue:

( if you want a response to your issue, provide a way to reproduce it )
( http://bit.ly/UIR-Plunk1 )
( https://stackblitz.com/edit/ui-router-angularjs )

This can't be reproduced in a plunker, because the reloading of a page can't be replicated in it, and as said above, it is then that the error happens.
",['stale'],closed,2020-05-28T09:52:25Z,2021-06-11T01:51:46Z,bug,['stale'],True,378.0,
angular-ui/ui-router,3803,ui-sref does not work until your refresh the page.,"This issue tracker is for Bug Reports and Feature Requests only.

Please direct requests for help to StackOverflow.
See http://bit.ly/UIR-SOF for details.

This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [x] General Query 

My version of UI-Router is: (type version)
angular version 1.7.9
angular-router 0.4.2

# Bug Report

#### Current Behavior:

(type current behavior here)

#### Expected Behavior:

(type expected behavior here)

#### Link to Plunker or stackblitz that reproduces the issue:

( if you want a response to your issue, provide a way to reproduce it )
( http://bit.ly/UIR-Plunk1 )
( https://stackblitz.com/edit/ui-router-angularjs )




# Feature Request

(type feature request here)




# General Query

Please direct general implementation questions to StackOverflow: 
http://stackoverflow.com/questions/ask?tags=angularjs,angular-ui-router

Please review the Sample Application which highlights common approaches:
https://github.com/ui-router/sample-app-angularjs

- [ ] I have already asked my question on StackOverflow and nobody could answer the question

- [x] I have already reviewed the sample application for examples of common approaches

- [x] I believe my question can only be answered by the UI-Router maintainers


(type general query here)

In the template

```html
<a ui-sref=""some-route""> My route</a>
```
route config
state('some-route' , {
url:'/route',
cache:false
view: {
'details': ""template.html""
}

That is the basic setup. What happens is , i'm trying to authenticate a user and if the user provides an invalid credentials i basically stay on the same page with a notification message from the back end. But when that happens and the page doesn't refresh i can't click on the <a> tag with the ui-sref directive. Its this a known issue. Because it seems i'm wasting my time. The code was inherited 
})",['stale'],closed,2020-05-08T20:42:24Z,2020-12-12T21:06:46Z,bug,['stale'],True,218.0,
angular-ui/ui-router,3799,transition.abort() transition rejection does not invoke onError hook,"This is a (check one box):

- [x] Bug Report
- [ ] Feature Request
- [ ] General Query 

My version of UI-Router is: 1.0.25



# Bug Report

#### Current Behavior:

Forcing a transition to fail via transition.abort() does not invoke onError.

The following transition:
```
$stateProvider.state({ 
  name: 'home.foo', 
  url: '/foo', 
  component: 'foo',
  resolve: { 
    fooData: function($transition$) { 
      //'foo data';    
      console.log('ABORTING TRANSITION!');    
      $transition$.abort(); 
      }
  },
});
```
With the following onError hook:
```
$transitions.onError({}, function () {
  console.log('onError CALLED!')
});
```
Appears in the console as follows:
```
ABORTING TRANSITION!
Transition #1-0: <- Rejected ""Transition#1( 'home'{} -> 'home.foo'{} )"", reason: Transition Rejection($id: 0 type: 3, message: The transition has been aborted, detail: undefined)
```

#### Expected Behavior:

If a Transition fails, its promise is rejected and the onError hooks are invoked.
https://ui-router.github.io/ng2/docs/5.0.0/classes/transition.transition-1.html#onerror

#### Link to Plunker or stackblitz that reproduces the issue:

http://plnkr.co/edit/S4lac3e0I3PvKzzx
",['stale'],closed,2020-04-07T01:54:09Z,2020-10-18T05:37:12Z,bug,['stale'],True,194.0,
angular/material,12157,MatDatePicker implementation issue: Cannot read properties of undefined (reading 'subscribe') for MatDatepickerInputBase,"Hello, I'm trying to implement a basic DatePicker.
I have already tried several alternatives from the documentation, but I always receive this error.
Any idea why it is ocurrying and how to solve it?


core.js:6498 ERROR Error: Uncaught (in promise): TypeError: Cannot read properties of undefined (reading 'subscribe')
TypeError: Cannot read properties of undefined (reading 'subscribe')
    at new MatDatepickerInputBase (datepicker.js:3041:1)
    at new MatDatepickerInput (datepicker.js:3286:1)
    at NodeInjectorFactory.MatDatepickerInput_Factory [as factory]
  ...
    

Thank you,
    
Carlota","['type: bug', 'resolution: invalid']",closed,2022-04-06T10:49:47Z,2022-04-11T22:00:09Z,bug,"['type: bug', 'resolution: invalid']",True,5.0,
angular/material,12151,$mdDialog throws TypeError: o.cleanupElement is not a function,"Angular js : v1.6.8
Angular material: v1.1.4
jquery: 3.6.0

issue : confirm dialog with ok or cancel throws  TypeError: o.cleanupElement is not a function

![image](https://user-images.githubusercontent.com/39047853/154837895-059f8af6-ef4d-4d23-82d8-2cf269ac50c2.png)

","['needs: demo', 'needs: more info']",open,2022-02-20T10:13:39Z,,bug,"['needs: demo', 'needs: more info']",True,,
angular/material,12149,"datepicker: works incorrectly when ng-model-options=""{timezone: 'UTC'}"" is set","Date Picker incorrectly works when  ng-model-options=""{timezone: 'UTC'}"" is set.

Issues:

1. When initial date loaded local date is displayed in calendar and input shows correctly UTC date.
**How to reproduce:**  Goto ""Demo 1"" and you will see the issue. ( my time zone is +02:00). So I set initial date to be Today and setting UTC time to 23 hours. So first time when date picker is loaded input box will show local time (incorrectly) and date picker will show date in UTC (correctly). images in the Stack Overflow link. Main point to repeat this bug to set time in UTC smalled than timezone offset difference. I.E. I set 23h in UTC, so as my timezone is +2h, then in local time would be next day 01:00h. And input box will show local time.

2. When selecting same date few times - input box and calendar date is out of sync (in calendar local date is displayed - should be UTC)
**How to reproduce:** Go to demo page. Then select date i.e. 2020-02-18th in date picker, then again open date picker and select same (""2020-02-18th"") date after selection open again date picker and you will see that in date picker ""2020-02-17th"" day is selected.  This also can be reproduced on official page sample ""[Ng Model Options Timezone](https://material.angularjs.org/latest/demo/datepicker#ng-model-options-timezone)"" when few times selecting same date in date picker (demo: https://codepen.io/laurencijus/pen/mdqXRMe).

** Demo 1**: https://codepen.io/Drasius/pen/dyZdvoM  (can reproduce booth issues)
**Demo 2**: https://jsfiddle.net/Drasius/z51vgqr6/27/
- My time zone: UTC/GMT +2 hours (Lithuania, Vilnius)
- AngularJS: 1.8.2
- AngularJS Material: 1.2.4
- OS:  Windows
- Browsers: Chrome 

 **Question in StackOverflow:**
https://stackoverflow.com/questions/71123743/angularjs-material-md-datepicker-when-using-ng-model-options-timezone-utc","['type: bug', 'needs: investigation']",open,2022-02-15T15:32:25Z,,bug,"['type: bug', 'needs: investigation']",True,,
angular/material,12148,Radio button (mat-radio) Click effect not disappear until focus lost,"Is there any way of changing the css of the various states of the mat-radio-button?
I cannot find info anywhere.

Similar issue with no explanation: 14290#",['resolution: invalid'],closed,2022-02-15T12:07:08Z,2022-02-15T19:32:20Z,bug,['resolution: invalid'],True,0.0,
angular/material,12144,@angular/material installation fails with unexpected error: unable to get local issuer certificate,"
**error An unexpected error occurred: ""https://registry.npmjs.org/@angular%2fanimations: unable to get local issuer certificate** on install `npm @angular/material`

![image](https://user-images.githubusercontent.com/22417175/149817171-58c05f60-63e6-4377-afaa-b1cb3119bf1f.png)

## Bug Report

![image](https://user-images.githubusercontent.com/22417175/149817106-678ace8b-2dbb-4563-9c3f-480e5e0554ad.png)

![image](https://user-images.githubusercontent.com/22417175/149817317-bc1ed7ef-3662-43ef-9ecf-98c6954f0b09.png)

![image](https://user-images.githubusercontent.com/22417175/149817362-6db25233-ea74-4723-aef9-df7efbb4cb8f.png)

",['resolution: invalid'],closed,2022-01-17T17:48:58Z,2022-01-19T08:13:53Z,bug,['resolution: invalid'],True,1.0,
angular/material,12140,Problem using Content-Security-Policy with Print Syle,"I set the Content-Security-Policy in Webserver
Then I got the folling error in Browser:

_Refused to execute inline event handler because it violates the following Content Security Policy directive: ""script-src 'self'"". Either the 'unsafe-inline' keyword, a hash ('sha256-...'), or a nonce ('nonce-...') is required to enable inline execution. Note that hashes do not apply to event handlers, style attributes and javascript: navigations unless the 'unsafe-hashes' keyword is present._

The Problem is the following Line in the index-html
```html
<link rel=""stylesheet"" href=""styles.d65f2e5b705f26f2.css"" media=""print"" onload=""this.media='all'"">
```

Angular generate this Line automatically.

How can I fix this problem. I don't want use unsafe-inline or so

Thanks for help

",['resolution: invalid'],closed,2021-12-25T15:23:46Z,2022-01-19T08:21:08Z,security,['resolution: invalid'],True,24.0,
angular/material,12136,How to access ng-content in material dialog,"`<my-modal #myModal>
                <div content>
                    <my-directive #myDirective id=""myDirective"" [pageContent]=""pageContent""></my-directive>
                </div>
            </my-modal> `

I need to access a directive inside the modal but getting option to pass data (string, object) only instead of passing a directive via ng-content. In Angular Material dialog, we need to pass data to dialog service first and then to Dialog component. So in that case, ng-content didn't work. So is there any work around or am i missing something? Please let me know. Thanks.","['needs: demo', 'resolution: invalid']",closed,2021-11-29T03:14:47Z,2021-12-15T06:08:35Z,bug,"['needs: demo', 'resolution: invalid']",True,16.0,
angular/material,12135,docs: Travis CI removal broke ability to update documentation site on commit,"## Bug Report

<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

## Demo and steps to reproduce the issue

**Demo URL (required)***:  https://github.com/angular/code.material.angularjs.org/commits/master

### Explain the expected behavior

- When a new commit is pushed to https://github.com/angular/code.material.angularjs.org/ it should deploy the docs site to either `HEAD` or a specific version

### Explain the current behavior

- Commits haven't been updating the docs site sine 9/1/2021 when the Travis CI integration was disabled.

### Discuss the use-case or motivation for changing the existing behavior

Recent commits like https://github.com/angular/material/commit/441a9127676ba4a28aa0c5bc18a70c09815c7221, fixed the rendering of some of the API docs, but those can't be seen since they weren't deployed to the docs site.

Also we need to be able to verify that commits like https://github.com/angular/material/commit/5e2d21350cd0278f210c1e2bb951786c4047bbb6 don't break things on the docs site.
 
### Add anything else we should know

https://github.com/angular/code.material.angularjs.org/ needs to be converted to CircleCI.","['type: docs', 'P1: urgent']",closed,2021-11-23T19:54:11Z,2021-11-29T18:52:41Z,bug,"['type: docs', 'p1: urgent']",True,5.0,
angular/material,12133,Md-Dialog Box is not draggable and Movable so there should be option for  drag and drop. If there is already supported please give me coed,"# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.

## Documentation Feedback

<!-- 
Provide a brief summary of what you would like to see changed in our 
documentation at material.angular.io.

Feel free to provide any suggestions of content or examples you’d like us to include.
-->

**Affected documentation page URL:** 
<!-- 
Provide a link to the affected page on material.angularjs.org
-->
","['type: docs', 'resolution: invalid', 'needs triage']",closed,2021-11-19T12:03:11Z,2021-11-19T15:04:56Z,bug,"['type: docs', 'resolution: invalid', 'needs triage']",True,0.0,
angular/material,12127,card actions- add center alignment in card.d.ts,"please allow for center keyword in alignment for card actions

export declare class MatCardActions {
    /** Position of the actions inside the card. */
    align: 'start' | 'end' | 'center';
}

it works fine when added",['resolution: invalid'],closed,2021-10-19T00:15:54Z,2021-10-19T00:50:12Z,performance,['resolution: invalid'],True,0.0,
angular/material,12126,select: fails to close popover on option click,"<!-- 
Filling out this template is required! Do not delete it when submitting your issue!
Without this information, your issue may be auto-closed. 

Please submit AngularJS Material questions to the
[AngularJS Material Forum](https://groups.google.com/forum/#!forum/ngmaterial)
instead of submitting an issue.

---------------------------------------------------------------------
This repo is for AngularJS Material, not Angular Material or the CDK.
---------------------------------------------------------------------

Please submit Angular Material and CDK questions
[here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.


## Bug Report

<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

If the first option in a `<md-select>` is disabled, clicking any non-disabled option will successfully select the option but fail to close the options popover.

## Demo and steps to reproduce the issue

**Demo URL (required)***:  https://codepen.io/mockenoff/pen/BaZXVjj

#### Detailed Reproduction Steps

1. Click open the select.
2. Click any option besides the disabled one.

### Explain the expected behavior

The option clicked should be selected and the options popover should close.

### Explain the current behavior

The option clicked does become selected but the options popover remains open.

### Discuss the use-case or motivation for changing the existing behavior

In any other instance, the options popover closes after clicking an option. It should be expected that it would do the same in this case, too.

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->

- AngularJS: 1.8.2
- AngularJS Material: 1.2.3
- OS: macOS
- Browsers: Chrome, Firefox
- Screen Readers: 
 
### Add anything else we should know

It seems to have to do with [line 1911 in `select.js`](https://github.com/angular/material/blob/v1.2.3/src/components/select/select.js#L1911).

`opts.focusedNode` is set to the first option if the component is instantiated with nothing selected, which naturally fails the `if` since the first option is disabled and thus never makes it to the `$mdSelect.hide()` call, even though a non-disabled option is being clicked.

Previously, I'd been using `v1.1.4`, which instead used [`$mdUtil.getClosest()`](https://github.com/angular/material/blob/v1.1.4/src/components/select/select.js#L1444) to find the focused option. This change appears to have come along in the [`v1.1.22-rc.0`](https://github.com/angular/material/commit/928c71d6ee87bc03ce383bfa555f67e1d373fe13#diff-dd40654ae27bd1b89a5bdc05faccb3b764ce5b2a051885c6e6456fbdcc0822a1) release.

#### Stack Trace
```

```

#### Screenshots


<!-- Please double check that you have provided the required reproduction steps
     and a Demo via StackBlitz, CodePen, Plunker, or GitHub repo.
-->
","['type: bug', 'severity: regression', 'P3: important']",open,2021-10-06T22:32:02Z,,bug,"['type: bug', 'severity: regression', 'p3: important']",True,,
angular/material,12125,"""Platform"" module fails to detect Edge browser","Tested on Material V12.2.7, the Platform module fails to detect Edge browser.
Running Windows 10 64 bit, and Edge V94.0.992.38.
You can see the problem in this [StackBlitz](https://stackblitz.com/edit/angular-ivy-afzrrv): open the link from an Edge browser and see it fails to detect it.","['type: bug', 'resolution: invalid']",closed,2021-10-06T10:11:04Z,2021-10-06T14:46:54Z,bug,"['type: bug', 'resolution: invalid']",True,0.0,
angular/material,12120,"#698 If is opened a second dialog, the first one closes automatically. ","
Hi , is worth mention on bug #698 to work fine and dont close the first dialog on opening the second ,the first dialog must not contains a form with (ngsubmit)=""submitMethod()"" or have a save button with type=""submit"" , instead must have a save button with  type=""button"" and  a (click) event that save the form data.","[""resolution: can't reproduce""]",closed,2021-09-03T10:53:02Z,2021-11-18T21:59:29Z,bug,"[""resolution: can't reproduce""]",True,76.0,
angular/material,12119,https://ng-matero.github.io/extensions/,"hi ... are these components supported/endorsed by angular material team ?
https://ng-matero.github.io/extensions/

thanks",['type: docs'],closed,2021-08-20T18:36:36Z,2021-08-20T19:53:49Z,bug,['type: docs'],True,0.0,
angular/material,12118,datepicker: invalid value on first load from moment,"## Bug Report

**Demo URL (required)***:  https://datepicker-invalid-value-on-first-load-from-string-12075-pskwl4.stackblitz.io

#### Detailed Reproduction Steps
1. Start date as moment object


### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.8.2
- AngularJS Material: 1.2.3
- OS: All
- Browsers: All
- Screen Readers: 
 
### Add anything else we should know
This was just fixed for string being the default last version.
I added the below to that ticket, but I added it too late. I should have just opened a new ticket. Sorry about that.

When `DatePickerCtrl.prototype.updateErrorState` is called with a moment date
`if (this.dateUtil.isValidDate(date)) {` is false
So `this.ngModelCtrl.$setValidity('valid', date == null);` runs and the ngModel ctrl valid key is set to false.
","['type: bug', 'P2: required']",open,2021-08-08T08:29:50Z,,bug,"['type: bug', 'p2: required']",True,,
angular/material,12116,There is a problem with the example,https://material.angular.io/components/table/examples#table-generated-columns,['resolution: invalid'],closed,2021-07-13T18:05:01Z,2021-07-13T18:42:17Z,bug,['resolution: invalid'],True,0.0,
angular/material,12114,Update project to gulp-sass@5,"### Discuss the use-case or motivation for changing the existing behavior

This is blocked by https://github.com/angular/material/issues/12113 as [gulp-sass@5](https://github.com/dlmanning/gulp-sass/releases/tag/v5.0.0) requires `gulp@4`.

One of the reasons we need to support the new `sass` package is mentioned in PR https://github.com/angular/material/pull/12112:

```bash
DEPRECATION WARNING: Using / for division is deprecated and will be removed in Dart Sass 2.0.0.

Recommendation: math.div($button-fab-height - $button-fab-padding, 2)

More info and automated migrator: https://sass-lang.com/d/slash-div

    ╷
345 │   @include fab-position(bottom-right, auto, ($button-fab-width - $button-fab-padding)/2, ($button-fab-height - $button-fab-padding)/2, auto);
    │                                                                                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ╵
    node_modules\angular-material\angular-material.scss 345:90  fab-all-positions()
    node_modules\angular-material\angular-material.scss 2000:5  @import
```

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.8.2
- AngularJS Material: 1.2.3
- OS: all
- Browsers: all
- Screen Readers: all
 
### Add anything else we should know

Here's the migration guide: https://github.com/dlmanning/gulp-sass#migrating-to-version-5","['type: build', 'P2: required']",closed,2021-07-05T15:54:08Z,2021-11-23T19:41:48Z,performance,"['type: build', 'p2: required']",True,141.0,
angular/material,12113,Update project to gulp@4,"### Discuss the use-case or motivation for changing the existing behavior

We need to [support using the non-deprecated `sass` package](https://github.com/angular/material/issues/12114) instead of only the deprecated `node-sass` package. But to do this, we need to update to [gulp-sass@5](https://github.com/dlmanning/gulp-sass/releases/tag/v5.0.0) which requires `gulp@4`.

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.2.2
- AngularJS Material: 1.8.2
- OS: macOS
- Browsers: Chrome
- Screen Readers: VoiceOver
 
### Add anything else we should know

- In https://github.com/gulpjs/gulp/issues/861, there is some discussion of a migration guide, but there does not actually seem to be a comprehensive guide, just some mentions of things scattered throughout the docs like
  - [series()](https://github.com/gulpjs/gulp/blob/f91c388beb265e5008202f11100309549162247a/docs/api/series.md)
  - [parallel()](https://github.com/gulpjs/gulp/blob/f91c388beb265e5008202f11100309549162247a/docs/api/parallel.md)
- I also mentioned in https://github.com/gulpjs/gulp/issues/861#issuecomment-874220815 that Releases page for the `v4.0.0-alpha.x` releases has links to the commits, but the commits don't have comments or migration instructions
- The [gulp@4.0.0 CHANGELOG.md](https://github.com/gulpjs/gulp/blob/master/CHANGELOG.md#400) has a list of breaking changes","['type: build', 'P4: minor']",open,2021-07-05T15:51:38Z,,bug,"['type: build', 'p4: minor']",True,,
angular/material,12110,Why does this exist,![image](https://user-images.githubusercontent.com/50955085/121755203-95d43a00-cae4-11eb-9783-216171831329.png),['resolution: invalid'],closed,2021-06-11T22:41:11Z,2021-06-12T06:27:05Z,bug,['resolution: invalid'],True,0.0,
angular/material,12100,select: dropdown box is cut off and locate out of the screen in RTL view on mobile/iPad,"<!-- 
Filling out this template is required! Do not delete it when submitting your issue!
Without this information, your issue may be auto-closed. 

Please submit AngularJS Material questions to the
[AngularJS Material Forum](https://groups.google.com/forum/#!forum/ngmaterial)
instead of submitting an issue.

---------------------------------------------------------------------
This repo is for AngularJS Material, not Angular Material or the CDK.
---------------------------------------------------------------------

Please submit Angular Material and CDK questions
[here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.


## Bug Report
md-select dropdown box is cut off and locate out of the screen in RTL view on mobile/iPad.
In the previous versions, this bug hasn't appeared.

<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

## Demo and steps to reproduce the issue
Open md-select drop down on LTR and then change the view to RTL, the list box appears at the edge of the page and cut off.
Also when the text is a little bit long from the example on the Angular JS material documentation, the text also cuts off.

[This blank StackBlitz demo](https://stackblitz.com/edit/angularjs-material-blank?file=app%2Fapp.template.html) can be used to create a reproduction that demonstrates your issue.

**Demo URL (required)***:  

#### Detailed Reproduction Steps
1. 
1. 

### Explain the expected behavior
The expected behavior should be the same as LTR view.


### Explain the current behavior
The current behavior isn't like LTR view and the list box is cut off (also the text inside each md-option)

### Discuss the use-case or motivation for changing the existing behavior
It is important to fix this problem as it is a regression to something that has worked well in the past and there are quite a few customers with RTL languages who need this solution.

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.6.10
- AngularJS Material: 1.1.26
- OS: Windows
- Browsers: Chrome, FF, Edge, Safari
- Screen Readers: NVDA, JAWS
 
### Add anything else we should know


#### Stack Trace
```

```

#### Screenshots
On LTR view:
![123](https://user-images.githubusercontent.com/13016663/119308389-a7f55200-bc75-11eb-9b10-73f705c06ecc.jpg)

On RTL view:
![1234](https://user-images.githubusercontent.com/13016663/119308447-bba0b880-bc75-11eb-892f-d4d339d7f367.jpg)

<!-- Please double check that you have provided the required reproduction steps
     and a Demo via StackBlitz, CodePen, Plunker, or GitHub repo.
-->
","['type: bug', 'i18n: bi-directional', 'needs: demo']",open,2021-05-24T07:08:02Z,,bug,"['type: bug', 'i18n: bi-directional', 'needs: demo']",True,,
angular/material,12098,util: getParentWithPointerEvents > hasComputedStyle causes forced reflow,"<!-- 
Filling out this template is required! Do not delete it when submitting your issue!
Without this information, your issue may be auto-closed. 

Please submit AngularJS Material questions to the
[AngularJS Material Forum](https://groups.google.com/forum/#!forum/ngmaterial)
instead of submitting an issue.

---------------------------------------------------------------------
This repo is for AngularJS Material, not Angular Material or the CDK.
---------------------------------------------------------------------

Please submit Angular Material and CDK questions
[here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.


## Bug Report

<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

### Explain the expected behavior
Angular material forces browser to recalculate style whenever new element is added in the dom, it should read first then write.

### Explain the current behavior
Angular Material is calling function getParentWithPointerEvents > hasComputedStyle from $mdUtil which is forcing browser to recalculate style, due to which i am facing a performance lag in the system. 


### Discuss the use-case or motivation for changing the existing behavior
The read operation i.e. recalculate style must be done before altering DOM.

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.5.8
- AngularJS Material: 1.1.1
- OS: Any
- Browsers: Chromium 90.0.4430.72.
 
#### Screenshots
![angular-material](https://user-images.githubusercontent.com/20557236/118501736-ac39e080-b746-11eb-89ac-82db192f7baa.png)
![angular-material-js](https://user-images.githubusercontent.com/20557236/118501966-de4b4280-b746-11eb-89ab-b4402fba9c6f.png)


<!-- Please double check that you have provided the required reproduction steps
     and a Demo via StackBlitz, CodePen, Plunker, or GitHub repo.
-->
","['type: bug', 'type: performance', 'P3: important']",open,2021-05-17T14:06:12Z,,bug,"['type: bug', 'type: performance', 'p3: important']",True,,
angular/material,12096,NullInjectorError MatDialogConfig,"NullInjectorError: R3InjectorError(AppModule)[MatDialogConfig -> MatDialogConfig -> MatDialogConfig]: 
  NullInjectorError: No provider for MatDialogConfig!","['type: bug', 'resolution: invalid', 'needs triage']",closed,2021-05-11T13:16:57Z,2021-05-11T20:54:12Z,bug,"['type: bug', 'resolution: invalid', 'needs triage']",True,0.0,
angular/material,12095,Blank dropdown in version choices,"<!-- 
Filling out this template is required! Do not delete it when submitting your issue!
Without this information, your issue may be auto-closed. 

Please submit AngularJS Material questions to the
[AngularJS Material Forum](https://groups.google.com/forum/#!forum/ngmaterial)
instead of submitting an issue.

---------------------------------------------------------------------
This repo is for AngularJS Material, not Angular Material or the CDK.
---------------------------------------------------------------------

Please submit Angular Material and CDK questions
[here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.


## Bug Report

<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

## Demo and steps to reproduce the issue
[This blank StackBlitz demo](https://stackblitz.com/edit/angularjs-material-blank?file=app%2Fapp.template.html) can be used to create a reproduction that demonstrates your issue.

**Demo URL (required)***:  
https://material.angular.io/

#### Detailed Reproduction Steps
1. Click on the version
### Explain the expected behavior
1. Version dropdown list show up


### Explain the current behavior
Blank version dropdown.

### Discuss the use-case or motivation for changing the existing behavior


### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.
- AngularJS Material: 1.
- OS: 
- Browsers: 
- Screen Readers: 
 
### Add anything else we should know


#### Stack Trace
```

```

#### Screenshots


<!-- Please double check that you have provided the required reproduction steps
     and a Demo via StackBlitz, CodePen, Plunker, or GitHub repo.
-->
","['type: bug', 'needs triage']",closed,2021-05-10T20:16:02Z,2021-05-10T20:18:30Z,bug,"['type: bug', 'needs triage']",True,0.0,
angular/material,12091,select: label not visible when using md-selected-text,"<!-- 
Filling out this template is required! Do not delete it when submitting your issue!
Without this information, your issue may be auto-closed. 

Please submit AngularJS Material questions to the
[AngularJS Material Forum](https://groups.google.com/forum/#!forum/ngmaterial)
instead of submitting an issue.

---------------------------------------------------------------------
This repo is for AngularJS Material, not Angular Material or the CDK.
---------------------------------------------------------------------

Please submit Angular Material and CDK questions
[here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
# AngularJS Material is in LTS mode

We are no longer accepting changes that are not critical bug fixes into this project.
See [Long Term Support](https://material.angularjs.org/latest/#long-term-support) for more detail.


## Bug Report
If you use md-selected-text on an md-select with a label, the label will not appear until a value has been selected.
<!-- Please note that we are not accepting major feature requests, i.e. requests for new components, at this time. -->

## Demo and steps to reproduce the issue
[This blank StackBlitz demo](https://stackblitz.com/edit/angularjs-material-blank?file=app%2Fapp.template.html) can be used to create a reproduction that demonstrates your issue.

**https://codepen.io/ewahner/pen/MWJPXJJ**  

#### Detailed Reproduction Steps
1.  Use md-selected-text on an md-select
2.  Use a label inside a md-input-container

### Explain the expected behavior
The label should appear as a placeholder.

### Explain the current behavior
The label is not visible until a value has been selected.

### Discuss the use-case or motivation for changing the existing behavior
Feels broken

### List the affected versions of AngularJS, Material, OS, and browsers
<!-- Please note that only issues related to AngularJS 1.x and AngularJS Material 1.x should be submitted here.
Please submit Angular Material and CDK questions [here](https://groups.google.com/forum/#!forum/angular-material2)
and issues [here](https://github.com/angular/components/issues).
-->
- AngularJS: 1.8.2
- AngularJS Material: 1.2.2
- OS: 
- Browsers: 
- Screen Readers: 
 
### Add anything else we should know


#### Stack Trace
```

```

#### Screenshots


<!-- Please double check that you have provided the required reproduction steps
     and a Demo via StackBlitz, CodePen, Plunker, or GitHub repo.
-->
","['needs: investigation', 'needs triage']",open,2021-04-20T19:03:08Z,,bug,"['needs: investigation', 'needs triage']",True,,
angular/material,12090,Need utility css classes included in angular material,"We need css utility classes included in angular material themes. 
It will help us in custimizations like tailwind.css or w3.css ",['needs: feedback'],closed,2021-04-13T15:02:26Z,2021-06-03T21:27:10Z,bug,['needs: feedback'],True,51.0,
ngx-translate/core,1536,Next release,"Hello, i would like to know when the next release is planned ? 
Because i'm currently facing an issue with setDefaultLang and the modifications in this commit (https://github.com/ngx-translate/core/commit/610e4f146d748af78cefc523ff323b49688bff68) seems to be what i need to fix my issue. (setDefaultLang returning an observable instead of void)

(FI: My issue is that the default language is not set because the ""pending"" observable is not resolved when i call translateService.instant)",['Type: question/support'],open,2025-03-20T13:49:26Z,,bug,['type: question/support'],True,,
ngx-translate/core,1516,Feature Request: Add an Optional Parameter to Disable Functionality in directive,"I'm requesting introducing an optional parameter in the ngx-translate directive (e.g., translate) to allow developers to disable translation functionality directly in the HTML template. This can be particularly useful for dynamic scenarios where translation is conditionally required for certain elements.


### Use Case
- Conditional Translation: Developers can disable translations for specific HTML elements based on runtime conditions or user preferences.
- Dynamic Behavior: Applications that adapt to varying user settings or configurations can benefit from toggling translation functionality at the template level.
- Specific Component Use Case: I have a component where, in some cases, I need it to display translated content, while in other cases, I want it to remain untranslated. Having a built-in directive parameter would simplify this dynamic behavior without requiring workarounds like duplicating code.


### Example Usage :


![ngx-translate request](https://github.com/user-attachments/assets/a701f1e7-3344-40ae-9a1e-570fbaead24a)


### Benefits

- Provides greater flexibility and control over translation behavior in templates.
- Reduces the need for workarounds or custom directive implementations to disable ngx-translate.
- Enhances developer experience by integrating the functionality directly into the existing directive.


### Notes
The disableTranslation parameter should default to false to maintain backward compatibility.",['Type: feature request'],closed,2025-01-14T14:43:41Z,2025-03-20T10:32:55Z,bug,['type: feature request'],True,64.0,
ngx-translate/core,1490,Performance optimization: Introduce pure translatePipe,"## Current behavior
<!-- Describe how the issue manifests. -->

The ngx-translate package currently provides an impure Angular pipe for translations. This results in thousands of function calls, especially on pages with numerous pipe calls for translations/internationalization. This behavior can lead to performance issues, particularly on complex or data-heavy pages.

## Expected behavior
<!-- Describe what the desired behavior would be. -->

The package should provide a pure version of the translation pipe. This would significantly reduce the number of function calls and improve performance, especially on pages with many translated elements.

## What is the motivation / use case for changing the behavior?
<!-- Describe the motivation or the concrete use case. -->

The primary motivation is to improve performance in Angular applications using ngx-translate, especially those with a large number of translated elements. By reducing the number of function calls, we can potentially see significant performance improvements, particularly on complex or data-heavy pages.

## How do you think that we should implement this?
<!-- If you can, describe how you would implement this feature. -->

1. Implement a new pure pipe alongside the existing impure pipe.
2. The pure pipe would function similarly to the current pipe but would not automatically trigger on every change detection cycle.
3. Leave it to the user to manage change detection for translations, for example by reloading the whole page when the language changes or manually triggering change detection when needed.
4. Provide clear documentation on how to use the pure pipe effectively, including best practices for managing translations and change detection.

This approach would provide a performance-optimized option for users who are willing to manage change detection themselves, while still keeping the current functionality available for those who prefer it.",['Status: help wanted'],open,2024-09-13T08:20:00Z,,performance,['status: help wanted'],True,,
ngx-translate/core,1456,Translation keys are ignored when dot format and nested format are mixed,"## Current behavior

If the dot format and the nested format are mixed, a translation key in dot format is ignored if there is a nested block with a prefix of the translation key.

In this example
```
{
    ""i18n.fruits.apple"": ""Apfel"",
    ""i18n.fruits.lemon"": ""Zitrone"",
    ""i18n.fruits.lime"": ""Limette"",
    ""i18n.fruits.yellowWatermelon"": ""Gelbe Wassermelone"",
    ""i18n.fruits.pomegranate"": ""Granatapfel"",
    ""i18n.fruits.orange"": ""Orange"",
    ""i18n.fruits.strawberry"": ""Erdbeere"",
    ""i18n.fruits"": {
        ""cherry"": ""Kirsche""
    }
}
```
the nested block 
```
""i18n.fruits"": {
    ""cherry"": ""Kirsche""
}
```
swallows all `""i18n.fruits""` translations. Only the key `""i18n.fruits.cherry""` is translated.


## Expected behavior

If the dot format and the nested format are combined, the translation keys should be merged.

## How do you think that we should fix this?

In the `getValue` method of the `TranslateDefaultParser` the target variable is set to the nested object whose key is a prefix of the translation key. Thus the keys of the previous target (initially the complete json file) are ignored. One option here would be to merge the matching keys of the previous target.

```
target = {
  ...target[key],
  ...Object.fromEntries(
    Object.entries(target)
      .filter(([k]) => k.startsWith(key + '.'))
      .map(([k, v]) => [k.slice(key.length + 1), v])
  )
};
```

Here is a suggestion for the complete adapted `getValue` method (v15.0.0):
```
getValue(target: any, key: string): any {
  let keys = typeof key === 'string' ? key.split('.') : [key];
  key = '';
  do {
    key += keys.shift();
    if (isDefined(target) && isDefined(target[key]) && (typeof target[key] === 'object' || !keys.length)) {
      target = {
        ...target[key],
        ...Object.fromEntries(
          Object.entries(target)
            .filter(([k]) => k.startsWith(key + '.'))
            .map(([k, v]) => [k.slice(key.length + 1), v])
        )
      };
      key = '';
    } else if (!keys.length) {
      target = undefined;
    } else {
      key += '.';
    }
  } while (keys.length);

  return target;
}
```

",['Status: need to check'],closed,2023-11-20T15:50:16Z,2025-06-02T15:40:21Z,performance,['status: need to check'],True,559.0,
ngx-translate/core,1303,fr.json 404 NOT FOUND,"Hello there !

Never seen this kind of problem anywhere, so new post !
I tried to use ngx-translate in order to... translate my Angular website, but it just can't reach my fr.json.
My fr.json is at : LYA/app-web/src/i18n/fr.json
The website points at : http://localhost:4200/undefined/assets/i18n/frjson
Currently, the only thing I can modify in my function HttpLoaderFactory is the part after that ""undefined"", which is clearly the problem.

Thx in advance for your answers.",['Status: need more info'],closed,2021-04-23T07:53:27Z,2025-05-26T15:47:11Z,bug,['status: need more info'],True,1494.0,
ngx-translate/core,1254,setTranslate does not work,"Hi,

I use `setTranslation` to add another translation, but the translate pipe does not resolve the entry.

At my program start I execute the following statement:
```
translate.setTranslation(lang, {HELLO: ""foo""}, true);
```

And in my template I resolve the translation:

```
{{ 'HELLO' | translate }}
```

I can confirm that all other translations which got added by `.json` files through the normal startup and loading routines of `ngx-translate` work fine, but only my manual translation (in this case HELLO) fails. Does anyone know what I am doing wrong?

Thanks a lot!",['Status: need more info'],closed,2020-10-05T14:12:25Z,2025-06-02T09:25:05Z,bug,['status: need more info'],True,1700.0,
ngx-translate/core,1184,Translations do not show in widgets packaged with ng-packagr,"## Current behavior
In the repository https://github.com/marcobuschini/parking-widget (angular9 branch) I have a simple test widget (packaged with ng-packagr) that should translate strings via ngx-translate. When I change the language (both in tests and in real usage) translation files for the package are correctly loaded from the remote end, but no translation is actually shown: the text stays in the original language.

## Expected behavior
Strings should be translated.

## How do you think that we should fix this?
I do not know if this is a bug in my code or in yours. I don't know how to further investigate the issue.

## Minimal reproduction of the problem with instructions
The repository that contains the failing package is https://github.com/marcobuschini/parking-widget (angular9 branch) while the project I use to test it is at https://github.com/marcobuschini/interview-november-2019

## Environment

<pre><code>
ngx-translate version: 11.0.1
Angular version: 9.0.0

Browser:
- [ ] Chrome (desktop) version 79.0.3945.130

For Tooling issues:
- Node version: 12.13.0
- Platform: Linux

Others:
</code></pre>
",['Status: need more info'],closed,2020-03-08T12:44:39Z,2025-05-26T15:48:27Z,bug,['status: need more info'],True,1905.0,
ngx-translate/core,1172,Translations not working past the login page,"Hey

I have a custom translation loader that fetches our object from an API:

```
export class TranslationService implements TranslateLoader {
  constructor(private http: HttpClient) {}

  getTranslation(lang: string): any {
    return this.http.get(Environment.API_ENDPOINT + 'api/AngularTranslations/' + lang, {
      headers: {
        'Content-Type': 'application/json'
      }
    }) as Observable<any>;
  }
}
```

In our app.modules.ts:
```

    TranslateModule.forRoot({
      loader: {
        provide: TranslateLoader,
        useClass: TranslationService
      }
    }),
```

When I fetch the translations in app.components.ts I get the correct object back:

```
    const lang = navigator.language;
    translate.getTranslation(lang).subscribe((result) => {
      console.log('Translation Result');
      console.log(result);
     /**
    loadingText: {loadingTabs: ""Loading Tabs ...""}
    loginScreen:
        cancel: ""Cancel""
        forgotPassword: ""Forgot Password?""
        password: ""Password""
        resetPassword: ""Reset Password""  
        username: ""Username""
     **/

    }, (error: any) => {
      console.log(error);
    });
```

When my site loads the login page translates fine, but once I login to the system nothing else will translate, even though all my translations have loaded.   If I logout the login page will no longer translate and it will show the keys instead of the correct strings.

Do I have to do something after I get the translations?

Thanks",['Status: need more info'],closed,2020-02-13T17:15:46Z,2025-05-26T15:50:13Z,bug,['status: need more info'],True,1928.0,
ngx-translate/core,1130,Translation not working on iOS 13,"## Current behavior
All the labels are not translated (i see the relative key). The same app works if installed/downloaded from Apps Store on iOS 12.

## Expected behavior
All the labels should be translated.

## Environment

<pre><code>
ngx-translate version: 8.x.x
Angular version: 5.2.11
<!-- Check whether this is still an issue in the most recent Angular version -->

OS:
- [x] iOS 13 (device)

For Tooling issues:
- Node version: 10.16
- Platform: Ionic 3/Angular 5 on Mac

</code></pre>
",['Status: need more info'],closed,2019-10-02T09:00:39Z,2025-05-26T15:45:27Z,bug,['status: need more info'],True,2063.0,
tensorflow/tensorflow,95762,Aborted (core dumped) in `tf.distribute.Server`,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf2.19

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

GTX 4090 24G

### Current behavior?

 `tf.distribute.Server` crashes when inter_op_parallelism_threads is set to -1 in `tf.compat.v1.ConfigProto`

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

server = tf.distribute.Server(
    tf.train.ClusterSpec({""worker"": [""localhost:5000""]}).as_dict(),
    job_name='worker',
    task_index=0,
    protocol='grpc',
    config=tf.compat.v1.ConfigProto(inter_op_parallelism_threads=-1)
)
```

### Relevant log output

```shell
2025-06-22 22:48:20.724080: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-06-22 22:48:20.742238: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750603700.760855 2732395 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750603700.766280 2732395 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1750603700.781352 2732395 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603700.781378 2732395 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603700.781381 2732395 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603700.781383 2732395 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-06-22 22:48:20.785849: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
I0000 00:00:1750603702.852113 2732395 gpu_device.cc:2019] Created device /job:worker/replica:0/task:0/device:GPU:0 with 22290 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:1f:00.0, compute capability: 8.9
I0000 00:00:1750603702.855815 2732395 gpu_device.cc:2019] Created device /job:worker/replica:0/task:0/device:GPU:1 with 22290 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:d4:00.0, compute capability: 8.9
2025-06-22 22:48:22.857257: F external/local_xla/xla/tsl/platform/threadpool.cc:126] Check failed: num_threads >= 1 (1 vs. -1)
Aborted (core dumped)
```",['type:bug'],open,2025-06-22T14:51:58Z,,performance,['type:bug'],True,,
tensorflow/tensorflow,95761,Aborted (core dumped) in `tf.raw_ops.QuantizedMaxPool`\`tf.raw_ops.QuantizedAvgPool`,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf2.19

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

GTX 4090 24G

### Current behavior?

`tf.raw_ops.QuantizedAvgPool` and `tf.raw_ops.QuantizedMaxPool` crash when the strides parameter is set to certain specific shapes

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

# crash
tf.raw_ops.QuantizedAvgPool(input=tf.constant(1, dtype=tf.qint8), min_input=0.0, max_input=1.0, ksize=[1], strides=[1], padding='VALID')

# crash
# tf.raw_ops.QuantizedMaxPool(input=tf.ones([5,4,3,2], dtype=tf.qint8), min_input=0.0, max_input=1.0, ksize=[1,1,1,1], strides=[1], padding='VALID')
```

### Relevant log output

```shell
2025-06-22 22:42:45.633584: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-06-22 22:42:45.650723: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750603365.670271 2731361 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750603365.675798 2731361 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1750603365.690433 2731361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603365.690457 2731361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603365.690460 2731361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603365.690466 2731361 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-06-22 22:42:45.694953: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
I0000 00:00:1750603368.916820 2731361 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22290 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:1f:00.0, compute capability: 8.9
I0000 00:00:1750603368.917485 2731361 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22290 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:d4:00.0, compute capability: 8.9
2025-06-22 22:42:49.880540: F tensorflow/core/common_runtime/mkl_layout_pass.cc:3727] Non-OK-status: ret_status
Status: INVALID_ARGUMENT: Length for attr 'strides' of 1 must be at least minimum 4
        ; NodeDef: {{node QuantizedAvgPool}}; Op<name=_MklQuantizedAvgPool; signature=input:T, min_input:float, max_input:float -> output:T, min_output:float, max_output:float; attr=T:type,allowed=[DT_QINT8, DT_QUINT8, DT_QINT32, DT_QINT16, DT_QUINT16]; attr=ksize:list(int),min=4; attr=strides:list(int),min=4; attr=padding:string,allowed=[""SAME"", ""VALID""]>
Aborted (core dumped)
```",['type:bug'],open,2025-06-22T14:47:39Z,,performance,['type:bug'],True,,
tensorflow/tensorflow,95760,Aborted (core dumped) in `tf.image.non_max_suppression`\`tf.raw_ops.NonMaxSuppressionV2`\`tf.raw_ops.NonMaxSuppressionV3`\`tf.raw_ops.NonMaxSuppressionV4`,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

tf2.19

### Custom code

Yes

### OS platform and distribution

Linux Ubuntu 22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

GTX 4090 24G

### Current behavior?

When max_output_size = -1, `tf.image.non_max_suppression`\ `tf.raw_ops.NonMaxSuppressionV2`\ `tf.raw_ops.NonMaxSuppressionV3` \ `tf.raw_ops.NonMaxSuppressionV4` crashes. 

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

boxes= tf.random.uniform([10, 4], maxval=100, dtype=tf.float32)
scores = tf.random.uniform([10], maxval=100, dtype=tf.float32)
max_output_size = -1

# crash
tf.image.non_max_suppression(boxes, scores, max_output_size, iou_threshold=0.5, score_threshold=float('-inf'))

# crash
# tf.raw_ops.NonMaxSuppressionV2(
#     boxes=boxes, scores=scores, max_output_size=max_output_size, iou_threshold=0.5, name=None
# )

# crash
# tf.raw_ops.NonMaxSuppressionV3(
#     boxes=boxes, scores=scores, max_output_size=max_output_size, iou_threshold=0.5, score_threshold=float('-inf'), name=None
# )

# crash
# tf.raw_ops.NonMaxSuppressionV4(boxes=boxes, scores=scores, max_output_size=max_output_size, iou_threshold=0.5, score_threshold=float('-inf'),pad_to_max_output_size=False,name=None)
```

### Relevant log output

```shell
2025-06-22 22:38:58.375799: I tensorflow/core/util/port.cc:153] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2025-06-22 22:38:58.441525: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1750603138.523790 2730428 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1750603138.547987 2730428 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1750603138.626220 2730428 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603138.626380 2730428 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603138.626421 2730428 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1750603138.626461 2730428 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
2025-06-22 22:38:58.648911: I tensorflow/core/platform/cpu_feature_guard.cc:210] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX512F AVX512_VNNI AVX512_BF16 AVX512_FP16 AVX_VNNI AMX_TILE AMX_INT8 AMX_BF16 FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
I0000 00:00:1750603141.358320 2730428 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:0 with 22290 MB memory:  -> device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:1f:00.0, compute capability: 8.9
I0000 00:00:1750603141.358751 2730428 gpu_device.cc:2019] Created device /job:localhost/replica:0/task:0/device:GPU:1 with 22290 MB memory:  -> device: 1, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:d4:00.0, compute capability: 8.9
2025-06-22 22:39:02.556560: F tensorflow/core/framework/tensor_shape.cc:202] Non-OK-status: InitDims(dim_sizes)
Status: INVALID_ARGUMENT: Expected shape dimensions to be non-negative, got -1
Aborted (core dumped)
```",['type:bug'],open,2025-06-22T14:40:43Z,,security,['type:bug'],True,,
tensorflow/tensorflow,95758,/libtensorflow_cc.so.2: undefined symbol: _ZNK10tensorflow8OpKernel11TraceStringB5cxx11ERKNS_15OpKernelContextEb,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf2.12

### Custom code

Yes

### OS platform and distribution

ubuntu20.04

### Mobile device

_No response_

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?


```
(tf212-gpu) hitbuyi@hitbuyi-Dell-G15-5511:/media/hitbuyi/Crucial_X61/labeling/3d_bat/3d-bat$ python -c ""import tensorflow as tf; print(tf.version.GIT_VERSION, tf.version.VERSION)""
Traceback (most recent call last):
  File ""<string>"", line 1, in <module>
  File ""/home/hitbuyi/anaconda3/envs/tf212-gpu/lib/python3.10/site-packages/tensorflow/__init__.py"", line 37, in <module>
    from tensorflow.python.tools import module_util as _module_util
  File ""/home/hitbuyi/anaconda3/envs/tf212-gpu/lib/python3.10/site-packages/tensorflow/python/__init__.py"", line 36, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow
  File ""/home/hitbuyi/anaconda3/envs/tf212-gpu/lib/python3.10/site-packages/tensorflow/python/pywrap_tensorflow.py"", line 26, in <module>
    self_check.preload_check()
  File ""/home/hitbuyi/anaconda3/envs/tf212-gpu/lib/python3.10/site-packages/tensorflow/python/platform/self_check.py"", line 63, in preload_check
    from tensorflow.python.platform import _pywrap_cpu_feature_guard
ImportError: /home/hitbuyi/anaconda3/envs/tf212-gpu/lib/python3.10/site-packages/tensorflow/python/platform/../../libtensorflow_cc.so.2: undefined symbol: _ZNK10tensorflow8OpKernel11TraceStringB5cxx11ERKNS_15OpKernelContextEb
```


### Standalone code to reproduce the issue

```shell
ython -c ""import tensorflow as tf; print(tf.__version__); print(tf.config.list_physical_devices('GPU'))""
```

### Relevant log output

```shell

```",['type:bug'],open,2025-06-22T09:26:11Z,,bug,['type:bug'],True,,
tensorflow/tensorflow,95705,please support rtx50xx...,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

latest

### Custom code

Yes

### OS platform and distribution

ubuntu 22.04

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

please support rtx50xx...

### Standalone code to reproduce the issue

```shell
gpu support
```

### Relevant log output

```shell

```",['type:bug'],open,2025-06-20T23:36:51Z,,bug,['type:bug'],True,,
tensorflow/tensorflow,95663,Runtime error when using empty axes for reduce operator,"**Issue type**
Bug

**Have you reproduced the bug with TensorFlow Nightly?**
Yes

**Source**
Below is the test case:
[Test case link](https://github.com/tensorflow/tensorflow/commit/08ff0933d4fc0a5d85ae2f1a8bb5a7ea1142cba9
)

**OS platform and distribution**
Ubuntu 24.04

**Python version**
3.12.3

**Bazel version**
7.4.1

**GCC/compiler version**
clang 17.0.6

**CUDA/cuDNN version**
No response

**GPU model and memory**
No response

**Current behavior?**
The test case can run and get right results on release tensorflow (2.19.0), but has below runtime error for tf-nightly 2.20.0.dev20250619.

Traceback (most recent call last):
  File ""/home/wei/workspace/wei_tensorflow/tensorflow/lite/examples/python/reduce.py"", line 36, in <module>
    interpreter.allocate_tensors()
  File ""/home/wei/.local/lib/python3.12/site-packages/tensorflow/lite/python/interpreter.py"", line 554, in allocate_tensors
    return self._interpreter.AllocateTensors()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: failed to delegate STABLEHLO_CASE node #0Node number 1 (TfLiteXNNPackDelegate) failed to prepare.

**Additional information**
It is found that following PR is the root causes for the failure of test case:
[Commit 5c6f66a](https://github.com/tensorflow/tensorflow/commit/5c6f66a68ca602c9ff648ec74cf09d0ed4586e39)","['type:bug', 'comp:lite']",open,2025-06-20T06:26:14Z,,bug,"['type:bug', 'comp:lite']",True,,
tensorflow/tensorflow,95644,I'm a spammer,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

eg ft328

### Custom code

Yes

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

my full name mohammed seid ali
l m from ethiopia
phone_+251955134555 any social media contact

### Standalone code to reproduce the issue

```shell
l see every look tanx
```

### Relevant log output

```shell

```",['type:bug'],closed,2025-06-19T20:54:40Z,2025-06-20T04:02:15Z,bug,['type:bug'],True,0.0,
tensorflow/tensorflow,95634,how to use libtensorflowlite_c.so C API and delegate gpu opencl correctly?,"### Issue type

Others

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

latest

### Custom code

No

### OS platform and distribution

_No response_

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

how to use libtensorflowlite_c.so C API and delegate gpu opencl correctly?

### Standalone code to reproduce the issue

```shell
how to use libtensorflowlite_c.so C API and delegate gpu opencl correctly?
```

### Relevant log output

```shell

```","['comp:lite', 'type:others']",open,2025-06-19T06:10:50Z,,bug,"['comp:lite', 'type:others']",True,,
tensorflow/tensorflow,95578,Using Tensorflow Variables as arguments in nested tf.function methods,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

2.17.0

### Custom code

Yes

### OS platform and distribution

Linux Unbuntu 24.04 LTS

### Mobile device

_No response_

### Python version

3.12.2

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

I use in my project multiple methods decorated by `tf.function(reduce_retracing=True)`, and taking as arguments tensors or variables, with possible assignments on latter variables.

However i encounter an `AssertionError` when building graphs with such nested methods. The following code is a simplified and minimal code for the issue i am facing.

Has anyone encountered such an issue, and is there a solution? Thanks in advance for any answer.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf

@tf.function(reduce_retracing=True)
@tf.function(reduce_retracing=True)
def f(variables):
    """"""
    simple function incrementing input variables, nested twice
    """"""
    for v in variables:
        v.assign(v.value() + 1.)

@tf.function(reduce_retracing=True)
def g(variables):
    """"""
    calling f inside a method
    """"""
    f(variables)

@tf.function(reduce_retracing=True)
def g2(variables):
    """"""
    calling f inside another method
    """"""
    f(variables)

variables = [tf.Variable(float(_)) for _ in range(5)]
g(variables) # g runs without any issue, as well as consequent calls even with different variables, which is the expected behavior

variables = [tf.Variable(float(_)) for _ in range(5)]
g2(variables) # AssertionError
```

### Relevant log output

```shell
AssertionError: Called a function referencing variables which have been deleted. This likely means that function-local variables were created and not referenced elsewhere in the program. This is generally a mistake; consider storing variables in an object attribute on first call.
```","['type:bug', '2.17']",closed,2025-06-18T10:34:56Z,2025-06-19T11:56:36Z,bug,"['type:bug', '2.17']",True,1.0,
tensorflow/tensorflow,95489,YoloX different Model Output for Python and Android,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

binary

### TensorFlow version

tf=2.18

### Custom code

Yes

### OS platform and distribution

Linux Mint 22

### Mobile device

Samsung Galaxy A51

### Python version

3.11.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Hello,

I am currently trying to get YoloX working for object detection in a mobile app, while the model inference in Python produces the desired and expected output, Android on the other hand produces nonsense for the same model and test image. I asked for help on [Stackoverflow ](https://stackoverflow.com/questions/79650499/model-ouput-of-androidkotlin-tflite-model-not-matching-python-output-for-same) to no avail, and came to the conclusion that this discrepancy might be caused by a bug.  The input float array representation on Android is the same as the raveled Numpy array input of the Python version, while the outputs produced are different in every way. I have excluded the usual endianness problems, due to TensorImage being used which handles this automatically.  Also similar code does work for both RT-detr and Yolov11/v8, which indicates there might be something in the model behaving wrong for Android specifically.

Thanks in Advance


The entire code for both Android and Python can be found in this [repository](https://github.com/RNoahG/YoloXPythonAndroid).
For Android the relevant code is in the MainActivity.kt and YoloDetector.kt, there is some test code commented out.

### Standalone code to reproduce the issue

```shell

Here is an abridged version of the Android input pipeline:


val imgStream = assets.open(""TestImages/$imagePath"")
val decode = BitmapFactory.decodeStream(imgStream)
val imgmat = Mat()
Utils.bitmapToMat(decode,imgmat)
val imgmat3 = Mat()
Imgproc.cvtColor(imgmat,imgmat3,Imgproc.COLOR_RGBA2BGR)
val resizedmat =  Mat()
val paddedmat = Mat()

val size = Size((1920F*ratio).toDouble(),(1080F*ratio).toDouble())
val scalar = Scalar(114.0,114.0,114.0)
Imgproc.resize(imgmat3,resizedmat,size, 0.0, 0.0,INTER_LINEAR)
Core.copyMakeBorder(resizedmat,paddedmat,0,(imsize- (1080*ratio)).toInt(),0,0,Core.BORDER_CONSTANT,scalar)                           
val bitmap = createBitmap(paddedmat.cols(),paddedmat.width(),Bitmap.Config.ARGB_8888)
Imgproc.cvtColor(paddedmat,argbmat,Imgproc.COLOR_RGB2RGBA)
Utils.matToBitmap(argbmat,bitmap)

val image = TensorImage(DataType.UINT8)
image.load(bitmap)
val tensorproc = ImageProcessor.Builder().add(CastOp(INPUT_IMAGE_TYPE)).build()
val proctensor = tensorproc.process(image)
val imageBuffer = proctensor.buffer
val output = TensorBuffer.createFixedSize(intArrayOf(numChannel, numElements), OUTPUT_IMAGE_TYPE)
interpreter.run(imageBuffer, output.buffer)
 

Abriged Version of Python code:


if len(img.shape) == 3:
        padded_img = np.ones((input_size[0], input_size[1], 3), dtype=np.uint8) * 114
    else:
        padded_img = np.ones(input_size, dtype=np.uint8) * 114

r = min(input_size[0] / img.shape[0], input_size[1] / img.shape[1])
resized_img = cv2.resize(img,(int(img.shape[1] * r), int(img.shape[0] * r)),
                              interpolation=cv2.INTER_LINEAR,).astype(np.uint8)

padded_img[: int(img.shape[0] * r), : int(img.shape[1] * r)] = resized_img
padded_img = np.ascontiguousarray(padded_img, dtype=np.float32)

interpreter = tf.lite.Interpreter(model_path=MODEL_PATH)
interpreter.allocate_tensors()
input_details = interpreter.get_input_details()
output_details = interpreter.get_output_details()
interpreter.set_tensor(input_details[0]['index'], img[None, :, :, :])
interpreter.invoke()
output = interpreter.get_tensor(output_details[0]['index'])
output = np.squeeze(output)
```

### Relevant log output

```shell

```","['type:bug', 'comp:lite', 'TF 2.18']",open,2025-06-17T00:16:42Z,,bug,"['type:bug', 'comp:lite', 'tf 2.18']",True,,
tensorflow/tensorflow,95468,PERPRES,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

3.10

### Custom code

Yes

### OS platform and distribution

microsoft

### Mobile device

microsoft

### Python version

3.10

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

Traceback (most recent call last):
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""D:\PERPRES\train_model.py"", line 2, in <module>
    import tensorflow as tf
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\__init__.py"", line 40, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow  # pylint: disable=unused-import 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 88, in <module>    
    raise ImportError(
    ...<6 lines>...
        f'and include the entire stack trace above this error message.')
ImportError: Traceback (most recent call last):
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>    
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.


### Standalone code to reproduce the issue

```shell
Traceback (most recent call last):
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""D:\PERPRES\train_model.py"", line 2, in <module>
    import tensorflow as tf
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\__init__.py"", line 40, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow  # pylint: disable=unused-import 
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 88, in <module>    
    raise ImportError(
    ...<6 lines>...
        f'and include the entire stack trace above this error message.')
ImportError: Traceback (most recent call last):
  File ""D:\PERPRES\venv\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>    
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: The specified module could not be found.


Failed to load the native TensorFlow runtime.
See https://www.tensorflow.org/install/errors for some common causes and solutions.
If you need help, create an issue at https://github.com/tensorflow/tensorflow/issues and include the entire stack trace above this error message.
```

### Relevant log output

```shell

```",['type:bug'],closed,2025-06-16T16:29:44Z,2025-06-16T16:30:02Z,bug,['type:bug'],True,0.0,
tensorflow/tensorflow,95417,building //tensorflow/lite/ios:TensorFlowLiteC_xcframework results in broken header files,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

hash 84dd28bbc29d75e6a6d917eb2998e4e8ea90ec56

### Custom code

No

### OS platform and distribution

macos 15.5

### Mobile device

iOS 18

### Python version

3.13.2

### Bazel version

7.4.1

### GCC/compiler version

?

### CUDA/cuDNN version

n/a

### GPU model and memory

Apple M2 Pro

### Current behavior?

I build TensorFlowLiteC for iOS:

`% bazel build -c opt --config=ios //tensorflow/lite/ios:TensorFlowLiteC_xcframework --define tflite_with_xnnpack=true --define tflite_with_xnnpack_qs8=true --define tflite_with_xnnpack_qu8=true`

It builds fine.

I unzip the build artifact:

```
% cd bazel-bin/tensorflow/lite/ios
% unzip TensorFlowLiteC_xcframework.zip
```

I navigate to the headers:

```
% cd TensorFlowLiteC.xcframework/ios-arm64_x86_64-simulator/TensorFlowLiteC.framework/Headers
```

I inspect the `c_api.h` header:

```
% cat -n c_api.h 
...
    28  #include ""builtin_ops.h""
    29  #include ""types.h""
    30  #include ""c_api_types.h""  // IWYU pragma: export
    31  #include ""operator.h""  // IWYU pragma: export
...
```

See line 29. There is no `types.h` header:

```
% pwd
<snip>/tensorflow/bazel-bin/tensorflow/lite/ios/TensorFlowLiteC.xcframework/ios-arm64_x86_64-simulator/TensorFlowLiteC.framework/Headers
% ls *h
builtin_ops.h*        c_api_experimental.h* c_api_types.h*        c_api.h*              common.h*             profiler.h*           telemetry_setting.h*  TensorFlowLiteC.h*    xnnpack_delegate.h*
```



### Standalone code to reproduce the issue

```shell
This is easy to reproduce:
1. Build the framework as described above.
2. Using XCode, create a Swift iOS app project.
3. Add `TensorFlowLiteC.framework` as a dependency to your main target.
4. Add a `foo.cpp` file your target to create a create a mixed Swift/C++ target. When XCode prompts you to add a bridging header, do so.
5. In `foo.cpp`, add an `#include <TensorFlowLiteC/c_api.h>`.
6. Build.
7. You will see the error `/Users/<snip>/Library/Developer/Xcode/DerivedData/test-erdzaqurjgfrrbarneayzpeywmra/Build/Products/Debug-iphonesimulator/TensorFlowLiteC.framework/Headers/c_api.h:29:10: error: 'types.h' file not found`
```

### Relevant log output

```shell
<module-includes>:1:9: note: in file included from <module-includes>:1:
#import ""Headers/TensorFlowLiteC.h""
        ^
/Users/<snip>/Library/Developer/Xcode/DerivedData/test-erdzaqurjgfrrbarneayzpeywmra/Build/Products/Debug-iphonesimulator/TensorFlowLiteC.framework/Headers/TensorFlowLiteC.h:2:9: note: in file included from /Users/<snip>/Library/Developer/Xcode/DerivedData/test-erdzaqurjgfrrbarneayzpeywmra/Build/Products/Debug-iphonesimulator/TensorFlowLiteC.framework/Headers/TensorFlowLiteC.h:2:
#import <TensorFlowLiteC/c_api.h>
        ^
/Users/<snip>/Library/Developer/Xcode/DerivedData/test-erdzaqurjgfrrbarneayzpeywmra/Build/Products/Debug-iphonesimulator/TensorFlowLiteC.framework/Headers/c_api.h:29:10: error: 'types.h' file not found
#include ""types.h""
         ^
/Users/<snip>/Library/Developer/Xcode/DerivedData/test-erdzaqurjgfrrbarneayzpeywmra/Build/Products/Debug-iphonesimulator/TensorFlowLite.framework/Modules/TensorFlowLite.swiftmodule/arm64.swiftinterface:8:8: error: could not build Objective-C module 'TensorFlowLiteC'
import TensorFlowLiteC
       ^
/Users/<snip>/Desktop/Development/testTarget/test/DependencyInjection.swift:10:8: error: failed to build module 'TensorFlowLite' for importation due to the errors above; the textual interface may be broken by project issues or a compiler bug
import TensorFlowLite
```","['stat:awaiting tensorflower', 'type:build/install', 'comp:lite', 'subtype:macOS']",open,2025-06-15T20:09:23Z,,performance,"['stat:awaiting tensorflower', 'type:build/install', 'comp:lite', 'subtype:macos']",True,,
tensorflow/tensorflow,95415,tf.nn.conv2d with invalid input dims crashes in TF ≤2.19 — now raises InvalidArgumentError in nightly,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

Yes

### Source

source

### TensorFlow version

tf 2.19

### Custom code

Yes

### OS platform and distribution

linux ubuntu 22.04

### Mobile device

_No response_

### Python version

3.9

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

On Ubuntu 22.04 with TensorFlow 2.19 (stable branch), running the following code:

```python
import tensorflow as tf
x = tf.random.normal([4, 10], mean=1.75, stddev=0.5)
initializer = tf.initializers.truncated_normal(mean=0.0, stddev=0.05)
w = tf.Variable(initializer([10, 5]), dtype=tf.float32)
b = tf.Variable(tf.zeros([5]), dtype=tf.float32)
y = tf.nn.softmax(tf.matmul(x, w) + b)
y_conv = tf.nn.conv2d(x, w, strides=[1, 1, 1, 1], padding='VALID')

results in a crash with abort/core dumped, showing:
Check failed: index >= 0 && index < num_total_dims Invalid index from the dimension: 3，0，C
Aborted (core dumped)

However, in TensorFlow 2.20.0-dev20250604 (nightly), the same code raises a catchable InvalidArgumentError:
convolution input must be 4-dimensional: [4,10] [Op:Conv2D] name: 


### Standalone code to reproduce the issue

```shell
import tensorflow as tf
x = tf.random.normal([4, 10], mean=1.75, stddev=0.5)
initializer = tf.initializers.truncated_normal(mean=0.0, stddev=0.05)
w = tf.Variable(initializer([10, 5]), dtype=tf.float32)
b = tf.Variable(tf.zeros([5]), dtype=tf.float32)
y = tf.nn.softmax((tf.matmul(x, w) + b))
y_conv = tf.nn.conv2d(x, w, strides=[1, 1, 1, 1], padding='VALID')
```

### Relevant log output

```shell
Check failed: index >= 0 && index < num_total_dims Invalid index from the dimension: 3，0，C
Aborted (core dumped)
```","['stat:awaiting response', 'type:bug', 'comp:ops', 'TF 2.19']",open,2025-06-15T14:16:38Z,,bug,"['stat:awaiting response', 'type:bug', 'comp:ops', 'tf 2.19']",True,,
tensorflow/tensorflow,95413,i am storing jupyter notebook in e disk but have tensorflow in other disks,"### Issue type

Bug

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.19

### Custom code

Yes

### OS platform and distribution

Microsoft

### Mobile device

_No response_

### Python version

3.12

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

_No response_

### GPU model and memory

_No response_

### Current behavior?

ImportError                               Traceback (most recent call last)
File ~\AppData\Roaming\Python\Python312\site-packages\tensorflow\python\pywrap_tensorflow.py:73
     72 try:
---> 73   from tensorflow.python._pywrap_tensorflow_internal import *
     74 # This try catch logic is because there is no bazel equivalent for py_extension.
     75 # Externally in opensource we must enable exceptions to load the shared object
     76 # by exposing the PyInit symbols with pybind. This error will only be
     77 # caught internally or if someone changes the name of the target _pywrap_tensorflow_internal.
     78 
     79 # This logic is used in other internal projects using py_extension.

ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.

During handling of the above exception, another exception occurred:

ImportError                               Traceback (most recent call last)
Cell In[2], line 1
----> 1 import tensorflow as tf
      2 print(tf.__version__)
      3 print(""Num GPUs Available:"", len(tf.config.list_physical_devices('GPU')))

File ~\AppData\Roaming\Python\Python312\site-packages\tensorflow\__init__.py:40
     37 _os.environ.setdefault(""ENABLE_RUNTIME_UPTIME_TELEMETRY"", ""1"")
     39 # Do not remove this line; See https://github.com/tensorflow/tensorflow/issues/42596
---> 40 from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow  # pylint: disable=unused-import
     41 from tensorflow.python.tools import module_util as _module_util
     42 from tensorflow.python.util.lazy_loader import KerasLazyLoader as _KerasLazyLoader

File ~\AppData\Roaming\Python\Python312\site-packages\tensorflow\python\pywrap_tensorflow.py:88
     86     sys.setdlopenflags(_default_dlopen_flags)
     87 except ImportError:
---> 88   raise ImportError(
     89       f'{traceback.format_exc()}'
     90       f'\n\nFailed to load the native TensorFlow runtime.\n'
     91       f'See https://www.tensorflow.org/install/errors '
     92       f'for some common causes and solutions.\n'
     93       f'If you need help, create an issue '
     94       f'at https://github.com/tensorflow/tensorflow/issues '
     95       f'and include the entire stack trace above this error message.')

ImportError: Traceback (most recent call last):
  File ""C:\Users\LENOVO\AppData\Roaming\Python\Python312\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.


Failed to load the native TensorFlow runtime.

### Standalone code to reproduce the issue

```shell
import tensorflow as tf
```

### Relevant log output

```shell

```","['stat:awaiting response', 'type:bug', 'subtype:windows', 'TF 2.19']",closed,2025-06-15T08:21:07Z,2025-06-17T14:06:13Z,bug,"['stat:awaiting response', 'type:bug', 'subtype:windows', 'tf 2.19']",True,2.0,
tensorflow/tensorflow,95274,Deeplabcut issue,"### Issue type

Build/Install

### Have you reproduced the bug with TensorFlow Nightly?

No

### Source

source

### TensorFlow version

2.19

### Custom code

Yes

### OS platform and distribution

Windows 11

### Mobile device

_No response_

### Python version

_No response_

### Bazel version

_No response_

### GCC/compiler version

_No response_

### CUDA/cuDNN version

12.9

### GPU model and memory

_No response_

### Current behavior?

Expected Deeplabcut to load the Tensorflow-based project and use pytorch in version 3.0





Traceback (most recent call last):
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\window.py"", line 531, in _open_project
    self._update_project_state(
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\window.py"", line 502, in _update_project_state
    self.add_tabs()
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\window.py"", line 589, in add_tabs
    self.train_network = TrainNetwork(
                         ^^^^^^^^^^^^^
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\tabs\train_network.py"", line 53, in __init__
    self._shuffle_display = SelectedShuffleDisplay(self.root)
                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\displays\selected_shuffle_display.py"", line 45, in __init__
    self._update_display(self.root.shuffle_value)
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\displays\selected_shuffle_display.py"", line 67, in _update_display
    pose_cfg_path = Path(self.root.pose_cfg_path)
                         ^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\gui\window.py"", line 235, in pose_cfg_path
    compat.return_train_network_path(
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\compat.py"", line 300, in return_train_network_path
    from deeplabcut.pose_estimation_tensorflow import return_train_network_path
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\deeplabcut\pose_estimation_tensorflow\__init__.py"", line 16, in <module>
    import tensorflow as tf
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\tensorflow\__init__.py"", line 40, in <module>
    from tensorflow.python import pywrap_tensorflow as _pywrap_tensorflow  # pylint: disable=unused-import
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 88, in <module>
    raise ImportError(
ImportError: Traceback (most recent call last):
  File ""C:\Users\pmarm\anaconda3\envs\deeplabcut3\Lib\site-packages\tensorflow\python\pywrap_tensorflow.py"", line 73, in <module>
    from tensorflow.python._pywrap_tensorflow_internal import *
ImportError: DLL load failed while importing _pywrap_tensorflow_internal: A dynamic link library (DLL) initialization routine failed.


Failed to load the native TensorFlow runtime.
See https://www.tensorflow.org/install/errors for some common causes and solutions.
If you need help, create an issue at https://github.com/tensorflow/tensorflow/issues and include the entire stack trace above this error message.




![Image](https://github.com/user-attachments/assets/98b34400-419b-4b4b-b253-7f931047bc41)

### Standalone code to reproduce the issue

```shell
.
```

### Relevant log output

```shell

```","['stat:awaiting response', 'type:build/install', 'subtype:windows', 'TF 2.19']",closed,2025-06-12T15:24:26Z,2025-06-17T14:06:35Z,security,"['stat:awaiting response', 'type:build/install', 'subtype:windows', 'tf 2.19']",True,4.0,
pallets/flask,5718,"Recommend Warning and Safer Defaults for url_for(..., _external=True)","Hi Flask team,

We recently analyzed several Flask-based applications and noticed a recurring security concern related to url_for(..., _external=True) when used in untrusted request contexts. Specifically, since it uses request.host by default to construct the external URL, applications that do not explicitly configure SERVER_NAME or sanitize headers can be vulnerable to host header injection.

To improve developer awareness and reduce misuse, we suggest: Add a warning to the url_for documentation about the risk of relying on request.host, and recommend the use of SERVER_NAME or trusted_hosts when generating external URLs.

We’d be happy to help draft the relevant documentation or contribute a pull request if this direction aligns with the maintainers' goals.

Best regards,
Rui Yang and Zhengyu Liu
Johns Hopkins University
",['docs'],open,2025-04-14T03:53:08Z,,security,['docs'],True,,
pallets/flask,5688,Error using sample code in favicon documentation,"The code sample gives the assert `view_func is not None, ""expected view func if endpoint is not provided.""`.

Documentation in question: https://flask.palletsprojects.com/en/stable/patterns/favicon/

Sample code in question:
```
app.add_url_rule('/favicon.ico',
                 redirect_to=url_for('static', filename='favicon.ico'))
```",['docs'],closed,2025-03-02T06:04:51Z,2025-03-29T22:32:36Z,bug,['docs'],True,27.0,
pallets/flask,5673,Custom commands not listed,"When I run the `flask` command by itself I get help output with all of my custom commands listed. But when I run `flask --help` I get the help output with only the built-in flask commands (`routes`, `run`, `shell`). I am using the `FLASK_APP` environment variable to load the app.

I would think I should get the same help output (showing my custom commands) whether or not I add the `--help` parameter?

Environment:

- Python 3.12.2
- Flask 3.1.0",['cli'],closed,2025-01-28T06:57:24Z,2025-03-29T22:15:26Z,bug,['cli'],True,60.0,
pallets/flask,5645,Type hint for FlaskCliRunner.invoke is not specific,"The type hint of the return type of `FlaskCliRunner.invoke` ist `typing.Any` but should use `click.testing.Result`. This leads to missing auto completions in the IDE as well as errors from the type checker if not additional type narrowing is done.

The Problem is here: https://github.com/pallets/flask/blob/main/src/flask/testing.py#L276

To fix this `Result` must be imported from `click.testing` and used as a return type annotation.

The documentation already specifies `click.testing.Result` as return type.

Environment:

- Python version: 3.12.2
- Flask version: 3.1.0 but is also present in current main branch.
",['typing'],closed,2024-11-19T12:14:20Z,2024-11-24T01:53:05Z,bug,['typing'],True,4.0,
pallets/flask,5628,dotenv file arg should take precedence over default dotenv files,"As pointed out in #5532, `-e file` is loaded after the default `.env` and `.flaskenv` files, which means it won't override env vars that are set by the defaults. It will be a little tricky to track during CLI startup, but I think it should be possible to fix this so that precedence is: `os.environ` > `-e path` > `.env` > `.flaskenv`.",['cli'],closed,2024-11-06T17:34:15Z,2024-11-07T19:56:28Z,bug,['cli'],True,1.0,
pallets/flask,5556,Test failures in tutorial with python3.12,"The tests runned with `pytest` works with python3.11 and not in 3.12:

How to reproduce:
```
git clone git@github.com:pallets/flask.git
cd flask/examples/tutorial
python3.11 -m venv venv3.11
python3.12 -m venv venv3.12
# install dependencies
# setup db
```
In both cases, the webservice runs properly with `./venv3.1x/bin/flask --app flaskr run --debug`.

However, running the tests show different results. In `venv3.11`, the 24 tests are green. In `venv3.12` virtualenv, there is 6 failures (and 18 green). The failures are due to a `DeprecationWarning` which becomes an error:
```
DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes
```

The full output is provided at the end of the bug report.

The `DeprecationWarning` is documented in the [3.12 release](https://docs.python.org/3/whatsnew/3.12.html): '[default adapters and converters](https://docs.python.org/3/library/sqlite3.html#sqlite3-default-converters) are now deprecated. Instead, use the [Adapter and converter recipes](https://docs.python.org/3/library/sqlite3.html#sqlite3-adapter-converter-recipes) and tailor them to your needs.' Copy-pasting blindly the recipes in `tests/conftest.py`, `flaskr/__init__.py` and `flaskr/db.py` does not fix the errors.

The errors can be fixed by adding thoses lines in conftest.py:
```python
def convert_timestamp(val):
    """"""Convert Unix epoch timestamp to datetime.datetime object.""""""
    return datetime.datetime.strptime(val.decode(""utf-8""), ""%Y-%m-%d %H:%M:%S"").replace(tzinfo=datetime.timezone.utc)

sqlite3.register_converter(""timestamp"", convert_timestamp)
```

It's probably not the best fix but it's a start.


Pytest output:

```
(venv3.12) $ ./venv3.12/bin/pytest
========================================= test session starts ==========================================
platform linux -- Python 3.12.4, pytest-8.3.2, pluggy-1.5.0
rootdir: /home/stephane/src/flasktuto/flask/examples/tutorial
configfile: pyproject.toml
testpaths: tests
collected 24 items                                                                                     

tests/test_auth.py ....F...                                                                      [ 33%]
tests/test_blog.py F...F...F.FF                                                                  [ 83%]
tests/test_db.py ..                                                                              [ 91%]
tests/test_factory.py ..                                                                         [100%]

=============================================== FAILURES ===============================================
______________________________________________ test_login ______________________________________________

client = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297abc6900>

    def test_login(client, auth):
        # test that viewing the page renders without template errors
        assert client.get(""/auth/login"").status_code == 200
    
        # test that successful login redirects to the index page
        response = auth.login()
        assert response.headers[""Location""] == ""/""
    
        # login request set the user_id in the session
        # check that the user is loaded from the session
        with client:
>           client.get(""/"")

tests/test_auth.py:50: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/blog.py:24: in index
    ).fetchall()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
______________________________________________ test_index ______________________________________________

client = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ad26390>

    def test_index(client, auth):
>       response = client.get(""/"")

tests/test_blog.py:7: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/blog.py:24: in index
    ).fetchall()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
_________________________________________ test_author_required _________________________________________

app = <Flask 'flaskr'>, client = <FlaskClient <Flask 'flaskr'>>
auth = <conftest.AuthActions object at 0x7f297ad3e210>

    def test_author_required(app, client, auth):
        # change the post author to another user
        with app.app_context():
            db = get_db()
            db.execute(""UPDATE post SET author_id = 2 WHERE id = 1"")
            db.commit()
    
        auth.login()
        # current user can't modify other user's post
>       assert client.post(""/1/update"").status_code == 403

tests/test_blog.py:34: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/auth.py:27: in wrapped_view
    return view(**kwargs)
flaskr/blog.py:90: in update
    post = get_post(id)
flaskr/blog.py:48: in get_post
    .fetchone()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
_____________________________________________ test_update ______________________________________________

client = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297abc7920>
app = <Flask 'flaskr'>

    def test_update(client, auth, app):
        auth.login()
>       assert client.get(""/1/update"").status_code == 200

tests/test_blog.py:59: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1162: in get
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/auth.py:27: in wrapped_view
    return view(**kwargs)
flaskr/blog.py:90: in update
    post = get_post(id)
flaskr/blog.py:48: in get_post
    .fetchone()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
________________________________ test_create_update_validate[/1/update] ________________________________

client = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ace5160>
path = '/1/update'

    @pytest.mark.parametrize(""path"", (""/create"", ""/1/update""))
    def test_create_update_validate(client, auth, path):
        auth.login()
>       response = client.post(path, data={""title"": """", ""body"": """"})

tests/test_blog.py:71: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/auth.py:27: in wrapped_view
    return view(**kwargs)
flaskr/blog.py:90: in update
    post = get_post(id)
flaskr/blog.py:48: in get_post
    .fetchone()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
_____________________________________________ test_delete ______________________________________________

client = <FlaskClient <Flask 'flaskr'>>, auth = <conftest.AuthActions object at 0x7f297ada5610>
app = <Flask 'flaskr'>

    def test_delete(client, auth, app):
        auth.login()
>       response = client.post(""/1/delete"")

tests/test_blog.py:77: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1167: in post
    return self.open(*args, **kw)
venv3.12/lib/python3.12/site-packages/flask/testing.py:235: in open
    response = super().open(
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1116: in open
    response_parts = self.run_wsgi_app(request.environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:988: in run_wsgi_app
    rv = run_wsgi_app(self.application, environ, buffered=buffered)
venv3.12/lib/python3.12/site-packages/werkzeug/test.py:1264: in run_wsgi_app
    app_rv = app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1498: in __call__
    return self.wsgi_app(environ, start_response)
venv3.12/lib/python3.12/site-packages/flask/app.py:1476: in wsgi_app
    response = self.handle_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:1473: in wsgi_app
    response = self.full_dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:882: in full_dispatch_request
    rv = self.handle_user_exception(e)
venv3.12/lib/python3.12/site-packages/flask/app.py:880: in full_dispatch_request
    rv = self.dispatch_request()
venv3.12/lib/python3.12/site-packages/flask/app.py:865: in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
flaskr/auth.py:27: in wrapped_view
    return view(**kwargs)
flaskr/blog.py:121: in delete
    get_post(id)
flaskr/blog.py:48: in get_post
    .fetchone()
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

val = b'2018-01-01 00:00:00'

    def convert_timestamp(val):
>       warn(msg.format(what=""timestamp converter""), DeprecationWarning, stacklevel=2)
E       DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite3 documentation for suggested replacement recipes

/usr/lib/python3.12/sqlite3/dbapi2.py:76: DeprecationWarning
======================================= short test summary info ========================================
FAILED tests/test_auth.py::test_login - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
FAILED tests/test_blog.py::test_index - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
FAILED tests/test_blog.py::test_author_required - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
FAILED tests/test_blog.py::test_update - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
FAILED tests/test_blog.py::test_create_update_validate[/1/update] - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
FAILED tests/test_blog.py::test_delete - DeprecationWarning: The default timestamp converter is deprecated as of Python 3.12; see the sqlite...
===================================== 6 failed, 18 passed in 8.05s =====================================

``

",['docs'],closed,2024-08-21T16:38:58Z,2024-11-02T01:07:02Z,bug,['docs'],True,72.0,
pallets/flask,5422,Flask logging - Other libraries - FileHandler creates duplicate log entries,"**Description**

In my web server, based on Flask 3.0.0, ([raspi-cam-srv](https://github.com/signag/raspi-cam-srv)), I want to log to a log file.   
For implementation, I followed the Flask [Logging](https://flask.palletsprojects.com/en/3.0.x/logging/) documentation.   

For app and my own modules, I have added a FileHandler with

```
    # Configure loggers
    logsPath = os.path.dirname(app.instance_path) + ""/logs""
    os.makedirs(logsPath, exist_ok=True)
    logFile = logsPath + ""/raspiCamSrv.log""
    Path(logFile).touch(exist_ok=True)
    filehandler = logging.FileHandler(logFile)
    filehandler.setFormatter(app.logger.handlers[0].formatter)
    for logger in(
        app.logger,
        logging.getLogger(""werkzeug""),
        logging.getLogger(""raspiCamSrv.camera_pi""),
    ):
        logger.addHandler(filehandler)
        logger.setLevel(logging.ERROR)
```

As a result, I see duplicate entries for each log entry in the log file (see attachments, below).   
The log output on the console has single entries.

**Note**

I did not add the default_handler to the loggers as described in the Flask [Logging](https://flask.palletsprojects.com/en/3.0.x/logging/) documentation.   
When doing this, I get duplicate log entries also from the StreamHandler to the console.

**How to reproduce the bug**

This is the ```__init__.py```:  [__init__.py.txt](https://github.com/pallets/flask/files/14402038/__init__.py.txt)
This is the log file:  [raspiCamSrv.log](https://github.com/pallets/flask/files/14402051/raspiCamSrv.log)
This is the console output; [console.log](https://github.com/pallets/flask/files/14402057/console.log)

**Expected behavior**

Every log entry should occur only once

**Environment:**

- Python version: 3.11.2
- Flask version: 3.0.0
- Wekzeug version: 3.0.1
",['docs'],closed,2024-02-26T09:18:30Z,2024-04-07T19:03:59Z,bug,['docs'],True,41.0,
pallets/flask,5342,The double quote is missing in the string,"https://github.com/pallets/flask/blob/d61198941adcb191ddb591f08d7d912e40bde8bc/src/flask/cli.py#L798

There is no double quote in the first argument of `click.BadParameter` `""--key is not used`.",['docs'],closed,2023-11-24T19:18:05Z,2023-12-13T23:06:57Z,bug,['docs'],True,19.0,
pallets/flask,5337,"Incompatible return value type: got ""werkzeug.wrappers.response.Response"", expected ""flask.wrappers.Response""","Environment:

- Python version: 3.11
- Flask version: 3.0.0
- mypy version: 1.5.1


Hey! I recently started migrating from Flask version 2.3.2 to version 3.0.0, and I've encountered some typing bugs while doing so.

I have a simple part of a code in my project:
```python
def redirect_to_uri(uri: str) -> flask.Response:
    return flask.redirect(uri)
```
But when I migrated to version 3.0.0, mypy started to raise an error during type checking, while everything was okay on version 2.3.2:

```
main/api/helpers.py: note: In function ""redirect_to_uri"":
main/api/helpers.py:74:12: error: Incompatible return value type (got ""werkzeug.wrappers.response.Response"", expected ""flask.wrappers.Response"")  [return-value]
        return flask.redirect(uri)
               ^~~~~~~~~~~~~~~~~~~
Found 1 error in 1 file (checked 29 source files)
```

I've found an old issue that could possibly help solve the described problem https://github.com/pallets/flask/issues/4600

Have a nice day:)",['typing'],closed,2023-11-14T16:20:43Z,2023-12-13T23:47:09Z,bug,['typing'],True,29.0,
pallets/flask,5322,ResponseValue Typing issue,"This is not a runtime bug but a typing issue. In `flask.typing`, `ResponseValue` does not accept `AsyncIterator[str]`.

I am using `quart-trio`, which itself uses `quart`, which uses `flask`.
`quart.templating.stream_template` returns `AsyncIterator[str]`, and when running mypy on my project I get the following error:
```
error: Value of type variable ""T_route"" of function cannot be ""Callable[[], Coroutine[Any, Any, AsyncIterator[str] | Response]]""  [type-var]
```

Example usage:
```python
__title__ = ""Example Server""
__author__ = ""CoolCat467""

from quart.templating import stream_template
from quart_trio import QuartTrio
import trio
from os import path, makedirs
import functools
import logging
from quart import Response
from typing import Final
from logging.handlers import TimedRotatingFileHandler
from collections.abc import AsyncIterator
from hypercorn.config import Config
from hypercorn.trio import serve


DOMAIN: str | None = None#getenv(""DOMAIN"", None)

FORMAT = ""[%(asctime)s] [%(levelname)s] %(message)s""

ROOT_FOLDER = trio.Path(path.dirname(__file__))
CURRENT_LOG = ROOT_FOLDER / ""logs"" / ""current.log""

if not path.exists(path.dirname(CURRENT_LOG)):
    makedirs(path.dirname(CURRENT_LOG))

logging.basicConfig(format=FORMAT, level=logging.DEBUG, force=True)
logging.getLogger().addHandler(
    TimedRotatingFileHandler(
        CURRENT_LOG,
        when=""D"",
        backupCount=60,
        encoding=""utf-8"",
        utc=True,
        delay=True,
    ),
)


app: Final = QuartTrio(
    __name__,
    static_folder=""static"",
    template_folder=""templates"",
)

async def send_error(
    page_title: str,
    error_body: str,
    return_link: str | None = None,
) -> AsyncIterator[str]:
    """"""Stream error page.""""""
    return await stream_template(
        ""error_page.html.jinja"",
        page_title=page_title,
        error_body=error_body,
        return_link=return_link,
    )


async def get_exception_page(code: int, name: str, desc: str) -> Response:
    """"""Return Response for exception.""""""
    resp_body = await send_error(
        page_title=f""{code} {name}"",
        error_body=desc,
    )
    return Response(resp_body, status=code)


@app.get(""/"")
async def root_get() -> Response:
    """"""Main page GET request.""""""
    return await get_exception_page(404, ""Page not found"", ""Requested content does not exist."")


# Stolen from WOOF (Web Offer One File), Copyright (C) 2004-2009 Simon Budig,
# available at http://www.home.unix-ag.org/simon/woof
# with modifications

# Utility function to guess the IP (as a string) where the server can be
# reached from the outside. Quite nasty problem actually.


def find_ip() -> str:
    """"""Guess the IP where the server can be found from the network.""""""
    # we get a UDP-socket for the TEST-networks reserved by IANA.
    # It is highly unlikely, that there is special routing used
    # for these networks, hence the socket later should give us
    # the IP address of the default route.
    # We're doing multiple tests, to guard against the computer being
    # part of a test installation.

    candidates: list[str] = []
    for test_ip in (""192.0.2.0"", ""198.51.100.0"", ""203.0.113.0""):
        sock = socket.socket(socket.AF_INET, socket.SOCK_DGRAM)
        sock.connect((test_ip, 80))
        ip_addr: str = sock.getsockname()[0]
        sock.close()
        if ip_addr in candidates:
            return ip_addr
        candidates.append(ip_addr)

    return candidates[0]


async def run_async(
    root_dir: str,
    port: int,
    *,
    ip_addr: str | None = None,
    localhost: bool = True,
) -> None:
    """"""Asynchronous Entry Point.""""""
    if ip_addr is None:
        ip_addr = ""0.0.0.0""  # noqa: S104  # Binding to all interfaces
        if not localhost:
            ip_addr = find_ip()

    try:
        # Add more information about the address
        location = f""{ip_addr}:{port}""

        config = {
            ""bind"": [location],
            ""worker_class"": ""trio"",
        }
        if DOMAIN:
            config[""certfile""] = f""/etc/letsencrypt/live/{DOMAIN}/fullchain.pem""
            config[""keyfile""] = f""/etc/letsencrypt/live/{DOMAIN}/privkey.pem""
        app.config[""SERVER_NAME""] = location

        app.jinja_options = {
            ""trim_blocks"": True,
            ""lstrip_blocks"": True,
        }

        app.add_url_rule(""/<path:filename>"", ""static"", app.send_static_file)

        config_obj = Config.from_mapping(config)

        proto = ""http"" if not DOMAIN else ""https""
        print(f""Serving on {proto}://{location}\n(CTRL + C to quit)"")

        await serve(app, config_obj)
    except OSError:
        logging.error(f""Cannot bind to IP address '{ip_addr}' port {port}"")
        sys.exit(1)
    except KeyboardInterrupt:
        logging.info(""Shutting down from keyboard interrupt"")


def run() -> None:
    """"""Synchronous Entry Point.""""""
    root_dir = path.dirname(__file__)
    port = 6002

    hostname: Final = ""None""#os.getenv(""HOSTNAME"", ""None"")

    ip_address = None
    if hostname != ""None"":
        ip_address = hostname

    local = True#""--nonlocal"" not in sys.argv[1:]

    trio.run(
        functools.partial(
            run_async,
            root_dir,
            port,
            ip_addr=ip_address,
            localhost=local,
        ),
        restrict_keyboard_interrupt_to_checkpoints=True,
    )


def main() -> None:
    """"""Call run after setup.""""""
    print(f""{__title__}\nProgrammed by {__author__}.\n"")
    try:
        logging.captureWarnings(True)
        run()
    finally:
        logging.shutdown()


if __name__ == ""__main__"":
    main()
```

`templates/error_page.html.jinja`
```
<!DOCTYPE HTML>
<html lang=""en"">
  <head>
    <meta charset=""utf-8"">
    <meta name=""viewport"" content=""width=device-width, initial-scale=1"">
    <title>{{ page_title }}</title>
    <!--<link rel=""stylesheet"" type=""text/css"" href=""/style.css"">-->
  </head>
  <body>
    <div class=""content"">
      <h1>{{ page_title }}</h1>
      <div class=""box"">
        <p>
          {{ error_body }}
        </p>
        <br>
        {% if return_link %}
        <a href=""{{ return_link }}"">Return to previous page</a>
        <br>
        {% endif %}
        <a href=""/"">Return to main page</a>
      </div>
    </div>
    <footer>
      <i>If you're reading this, the web server was installed correctly.™</i>
      <hr>
      <p>Example Web Server v0.0.0 © CoolCat467</p>
    </footer>
  </body>
</html>
```

<!--
Describe the expected behavior that should have happened but didn't.
-->

Environment:

- Python version: 3.12
- Flask version: 3.0.0
",['typing'],closed,2023-11-05T01:08:03Z,2024-10-31T03:54:16Z,performance,['typing'],True,361.0,
pallets/flask,5320,flask.send_file() with Pylance in strict mode shows reportUnknownMemberType,"I was using this method fine, until I switched on 'strict' mode in the Pylance plugin for vscode. This gave me the error at calling the method:

```
Type of ""send_file"" is partially unknown
  Type of ""send_file"" is ""(path_or_file: PathLike[Unknown] | str | BinaryIO, mimetype: str | None = None, as_attachment: bool = False, download_name: str | None = None, conditional: bool = True, etag: bool | str = True, last_modified: datetime | int | float | None = None, max_age: int | ((str | None) -> (int | None)) | None = None) -> Response"" 
```
Code that causes the error:
```
@app.route('/')
def home():
    return flask.send_file('web/index.html')
```
The error sits on: ""flask.send_file""

I've been trying to infer this type and googled around, but can't seem to resolve this issue. having investigated ""PathLike[Unknown]"" for a while now looking into this, I've come to the conclusion that this issue is likely cause by the fact that PathLike requires a generic type to be declared.  If I manually (and temporary) add this generic type in, the error goes away.

In helpers.py (around line 391) I change:
```
def send_file(
    path_or_file: t.Union[os.PathLike, str, t.BinaryIO],
```
into:
```
def send_file(
    path_or_file: t.Union[os.PathLike[str], str, t.BinaryIO],
```
I've added the ""[str]"" generic type to PathLike. Possibly this might need to be ""[AnyStr]"" as that is the type declared in os.

I hope this is an easy fix, and that this isn't a user error that I have mistaken as an issue.

Environment:
Python 3.11.2
Flask 2.2.2
Werkzeug 2.2.2",['typing'],closed,2023-11-03T22:23:00Z,2023-11-15T20:59:36Z,bug,['typing'],True,11.0,
pallets/flask,5263,Bug in Flask docs,"Hi, flask seems very well done.  The docs are well organized, with quick links to other sections.

However there's one bug I have encountered in the docs.  Specifically [this page](https://flask.palletsprojects.com/en/2.3.x/) has the following content:

> Welcome to Flask’s documentation. Get started with [Installation](https://flask.palletsprojects.com/en/2.3.x/installation/) and then get an overview with the [Quickstart](https://flask.palletsprojects.com/en/2.3.x/quickstart/). 

Beautiful, prominent links to install and quick start.

> There is also a more detailed [Tutorial](https://flask.palletsprojects.com/en/2.3.x/tutorial/) that shows how to create a small but complete application with Flask. Common patterns are described in the [Patterns for Flask](https://flask.palletsprojects.com/en/2.3.x/patterns/) section. The rest of the docs describe each component of Flask in detail, with a full reference in the [API](https://flask.palletsprojects.com/en/2.3.x/api/) section.

Tutorial, patterns, reference API.  Fantastic!

> Flask depends on the [Werkzeug](https://werkzeug.palletsprojects.com/) WSGI toolkit, the [Jinja](https://jinja.palletsprojects.com/) template engine, and the [Click](https://click.palletsprojects.com/) CLI toolkit. Be sure to check their documentation as well as Flask’s when looking for information.

A bit off the rails with minutia here, we can recover...

> ## User’s Guide
> Flask provides configuration and conventions, with sensible defaults, to get started. 

Good to know.

> This section of the documentation explains the different parts of the Flask framework and how they can be used, customized, and extended. 

Great!

> Beyond Flask itself, look for community-maintained extensions to add even more functionality.

Ok...
Here's where the bug is.  In all that great intro information, there was not one single sentence telling me what in god's name Flask is.  Is it a cocktail app?  Is it for powder horn management?  Is it a movement tracker for minutemen militia?  Who knows?  You wouldn't have any earthly idea.

Obviously I or anyone can google it.  But we shouldn't have to.  You did such a great job with the rest of the intro.  You already have great explanatory text on the github readme:
> Flask is a lightweight [WSGI](https://wsgi.readthedocs.io/) web application framework. It is designed to make getting started quick and easy, with the ability to scale up to complex applications.

Just put that at the top of the docs landing page and you're golden!",['docs'],closed,2023-09-23T17:38:26Z,2023-10-06T23:37:43Z,bug,['docs'],True,13.0,
pallets/flask,5214,Application Dispatching Docs Reference Removed `werkzeug` Function,"<!--
This issue tracker is a tool to address bugs in Flask itself. Please use
Pallets Discord or Stack Overflow for questions about your own code.

Replace this comment with a clear outline of what the bug is.
-->

The [""Dispatch by Path"" section of app dispatching docs](https://github.com/pallets/flask/blob/main/docs/patterns/appdispatch.rst#dispatch-by-path) reference now-removed functions, `werkzeug.wsgi.peek_path_info` and `werkzeug.wsgi.pop_path_info`.

These functions were [deprecated in Werkzeug 2.2.0](https://github.com/pallets/werkzeug/pull/2461) and [removed in Werkzeug 2.3.0](https://github.com/pallets/werkzeug/pull/2592).

Using the documented example as-is produces `ImportError`s.

Since Flask 2.3 requires Werkzeug 2.3.6 or later, the documentation contain an example that works with Werkzeug's updated API. 

<!--
Describe how to replicate the bug.

Include a minimal reproducible example that demonstrates the bug.
Include the full traceback if there was an exception.
-->

<!--
Describe the expected behavior that should have happened but didn't.
-->

Environment:

- Python version: 3.9
- Flask version: 2.3.2
",['docs'],closed,2023-08-07T13:42:07Z,2023-08-16T21:29:49Z,bug,['docs'],True,9.0,
expressjs/express,6580,express crashing when using node internal http2 module on sending any request from client,"<!-- The process for bug fixing is:

- We will first assess if the behavior is different from what should occur
- Confirm the bug is reproducible
- Discuss how to best fix the bug
- Work towards a fix
-->

## Environment information

**Version**: 5.*
<!-- 
To find the installed version of a package, you can check the `package.json` file in the root directory of your project. The version will be listed under `dependencies` or `devDependencies`, like this:

```json
""dependencies"": {
  ""express"": ""4.18.2""
}
-->

**Platform**:  
`Linux d176f8ed3db8 5.15.146.1-microsoft-standard-WSL2 #1 SMP Thu Jan 11 04:09:03 UTC 2024 x86_64 GNU/Linux` (Docker image from node:23-slim),  
`Microsoft Windows NT 10.0.19045.0 x64`
<!-- 
UNIX: output of uname -a
Windows: output of ""$([Environment]::OSVersion.VersionString) $(('x86', 'x64')[[Environment]::Is64BitOperatingSystem])"" in PowerShell console 
-->

**Node.js version**:
Linux: 23.11, 24.2
Windows: 22.12
<!-- 
Output of node -v.
-->

**Any other relevant information**:
Error code:
```
node:events:502
      throw er; // Unhandled 'error' event
      ^

TypeError: Cannot read properties of undefined (reading 'readable')
    at IncomingMessage._read (node:_http_incoming:211:19)
    at Readable.read (node:internal/streams/readable:739:12)
    at resume_ (node:internal/streams/readable:1257:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
Emitted 'error' event on IncomingMessage instance at:
    at emitErrorNT (node:internal/streams/destroy:170:8)
    at errorOrDestroy (node:internal/streams/destroy:239:7)
    at Readable.read (node:internal/streams/readable:741:7)
    at resume_ (node:internal/streams/readable:1257:12)
    at process.processTicksAndRejections (node:internal/process/task_queues:90:21)
```
Error persists even without using `http2-express-bridge`

## What steps will reproduce the bug?
1. Install `express` and `http2-express-bridge` dependency with `npm`
2. Generate ssl key and cert file with openssl directly or using wsl
3. Write index.mjs like
```
import fs from ""fs"";
import path from ""path"";
import http2 from ""http2"";
import express from ""express"";
import http2Express from ""http2-express-bridge"";

const app = http2Express(express);
const tlsOptions = {
    key: fs.readFileSync(path.join(""certs"", ""ssl.key"")),
    cert: fs.readFileSync(path.join(""certs"", ""ssl.crt"")),
};

app.get(""/"", function(req, res) {
    res.send(""Hello World"");
});

const server = http2.createSecureServer(tlsOptions, app);
server.listen(8080, () => { console.log(""Server listening on port 8080""); });
```
4. Add `index.mjs` as main script in `package.json`
5. Run with `node .`
6. Navigate to `https://localhost:8080` in browser",['bug'],closed,2025-06-18T15:07:55Z,2025-06-21T01:00:42Z,security,['bug'],True,2.0,
expressjs/express,6579,"Combinations of middleware series with ""app.all"" is broken since 4.18.0","<!-- We can't debug your app for you, but you can ask questions and we will try to answer them.

You can also ask a question in the OpenJs Slack community's #express channel:

* Slack invite form: https://slack-invite.openjsf.org/
* #express-js channel: https://openjs-foundation.slack.com/archives/C02QB1731FH

It is super important that you paste in samples of your code (no screenshots of code, [use markdown](https://docs.github.com/en/get-started/writing-on-github/working-with-advanced-formatting/creating-and-highlighting-code-blocks))!
Without seeing what your code looks like, we won't be able to help you very much.
More is better when it comes to sharing code samples if you're having a problem. -->

looks like https://github.com/expressjs/express/issues/4913 is not fixed in 4.18.2
this is part of my code:

```
app.use(middleware.a);

app.get('/*', getter.a);

app.post('/*', poster.a);

app.use(middleware.b);

app.use('/somepath/otherpath',
  middleware.c,
  middleware.d,
  middleware.e);

app.get('/*', getter.b);

app.all(
  '/unicorn',
  poster.b,
  poster.c,
  poster.d
);
```
 POST /unicorn is not hitting app.all() but will work if changed to app.post()

what am I missing?",['question'],open,2025-06-17T13:50:31Z,,bug,['question'],True,,
expressjs/express,6545,No overload matches this call error ts(2769),"This is my indexWithZod.ts file:

``` import express from 'express';
import { z } from 'zod';

export const appWithZod = express();
appWithZod.use(express.json());


const sumInput = z.object({
  a: z.number(),
  b: z.number()
});

appWithZod.post('/sum', (req, res) => {

  const parsedResponse = sumInput.safeParse(req.body);

  if (!parsedResponse.success) {
    return res.status(411).json({
      message: 'Incorrect inputs'
    });
  }
  
  const answer = parsedResponse.data.a + parsedResponse.data.b;

  return res.json({
    answer
  });
});
```

I am getting error at `(req, res) => {` where the exact error message is 

> No overload matches this call.
  The last overload gave the following error.
    Argument of type '(req: Request<{}, any, any, ParsedQs, Record<string, any>>, res: Response<any, Record<string, any>, number>) => Response<any, Record<...>, number>' is not assignable to parameter of type 'Application<Record<string, any>>'.
      Type '(req: Request<{}, any, any, ParsedQs, Record<string, any>>, res: Response<any, Record<string, any>, number>) => Response<any, Record<...>, number>' is missing the following properties from type 'Application<Record<string, any>>': init, defaultConfiguration, engine, set, and 63 more.ts(2769)

Here is the additional bin.ts file for reference:
```
import { appWithZod } from './indexWithZod';

appWithZod.listen(3001, () => {
  console.log('Server (appWithZod) is running on PORT 3001');
});

```
",['question'],open,2025-05-30T13:10:45Z,,bug,['question'],True,,
expressjs/express,6542,wildcard route isn't working,"
## Environment information

**Version**:
```json
""dependencies"": {
  ""express"": ""^5.1.0""
}
```
**Platform**:
- 
Windows: Microsoft Windows NT 10.0.26100.0 x64

**Node.js version**:
v22.15.0

 i am receving this err

```
[nodemon] restarting due to changes...
[nodemon] starting `tsx ./src/index.ts`
C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:153
      throw new TypeError(`Missing parameter name at ${i}: ${DEBUG_URL}`);
            ^


TypeError: Missing parameter name at 11: https://git.new/pathToRegexpError
    at name (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:153:13)
    at lexer (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:171:21)
    at lexer.next (<anonymous>)
    at Iter.peek (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:188:32)
    at Iter.tryConsume (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:195:24)
    at Iter.text (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:213:26)
    at consume (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:285:23)
    at parse (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:320:18)
    at <anonymous> (C:\Users\gjugn\Desktop\trt\node_modules\path-to-regexp\src\index.ts:503:40)
    at Array.map (<anonymous>)

Node.js v22.15.0
[nodemon] app crashed - waiting for file changes before starting...
```
my code:
```import { toNodeHandler } from ""better-auth/node"";
import cors from ""cors"";
import dotenv from ""dotenv"";
import express from ""express"";
import { auth } from ""./lib/auth.js"";

dotenv.config();
const app = express();
app.use(cors({ origin: ""http://localhost:5173"" }));
app.use(express.json());


app.all(""/api/auth/*"", toNodeHandler(auth));

app.listen(2022, () =>
  console.log(""Server is running on http://localhost:2022"")
);
```",['bug'],closed,2025-05-28T15:44:21Z,2025-05-28T15:50:50Z,bug,['bug'],False,0.0,
expressjs/express,6528,Lack of Type Safety When Extending Express API with Custom Response Methods,"Hi Express community,

I'm exploring the feature of extending the Express API, as documented here, to add custom response methods. While this is a powerful feature, I've encountered what appears to be a lack of type safety when implementing these custom methods, particularly when using TypeScript.

For example, I've defined a custom `AuthUser` type:

```ts
type AuthUser = {
  id: number;
  name: string;
};
```

And extended the `express.Response` object with a custom success method:

```ts
// express.d.ts
/* eslint-disable ts/consistent-type-definitions */

import type { Send } from 'express';

declare global {
  export type Success<T = any> = {
    code: number;
    data: T;
    message: string;
  };
  export namespace Express {
    export interface Response<ResBody = any> {
      respond: (body: ResBody) => ReturnType<Send<ResBody>>;
      success: (code: number, message: string, data: ResBody extends Success<infer T> ? T : never) => ReturnType<Send<ResBody>>;
    }
  }
}
```

```ts
// app.ts
import type { Request, Response } from 'express';

import express from 'express';

const app = express();

type AuthedUser = {
  id: number;
  name: string;
};

app.get('/', (_req: Request, res: Response<Success<AuthedUser>>) => {
  console.warn('Hello World!');
  // this should be an error but it's not
  res.success(200, 'success', 1);
  // this is working fine
  res.send({
    code: 200,
    data: 1,
    message: 'success',
  });
});

app.response.respond = function (body: any) {
  return this.send(body);
};

app.response.success = function (code: number, message?: string, data?: any) {
  return this.respond({
    code,
    data,
    message,
  });
};

export default app;
```

Now, this should provide type-safety but lack 2 (see attachment image) generic missing from express types.

so My question is that is it valid and
if yes then can someone guild me to make first OS PR to express's types.
if not then how can i archive this?.

Thanks.

![Image](https://github.com/user-attachments/assets/bdb82779-ae03-4dec-bb4f-1fb08e0db9c6)
https://github.com/DefinitelyTyped/DefinitelyTyped/discussions/72855",['question'],closed,2025-05-23T18:09:58Z,2025-05-24T01:41:22Z,bug,['question'],True,0.0,
expressjs/express,6521,"app.get(""*"")    not working since version 5","im updating all my packages. now express is crashing for 

express code

```

	app.use(""/"", express.static(""www""));

	app.get(""*"", function(req, res){
		res.sendFile(path.join(__dirname, ""./www/index.html""));
	});
```

with 


error
```
  throw new TypeError(`Missing parameter name at ${i}: ${DEBUG_URL}`);
            ^

TypeError: Missing parameter name at 1: https://git.new/pathToRegexpError
```


could find out why. was working fine in v4. didnt found anything in https://expressjs.com/en/guide/migrating-5.html

for that.

how can i make that work again?



### Environment information

```
{
  ""dependencies"": {
    ""body-parser"": ""^2.2.0"",
    ""busboy"": ""^1.6.0"",
    ""canvas"": ""^3.1.0"",
    ""cluster"": ""^0.7.7"",
    ""compression"": ""^1.8.0"",
    ""connect-busboy"": ""^1.0.0"",
    ""connect-mongodb-session"": ""^5.0.0"",
    ""cors"": ""^2.8.5"",
    ""csvtojson"": ""^2.0.10"",
    ""express"": ""^5.1.0"",
    ""express-session"": ""^1.18.1"",
    ""fast-xml-parser"": ""^5.2.3"",
    ""google-polyline"": ""^1.0.3"",
    ""haversine-distance"": ""^1.2.3"",
    ""json-2-csv"": ""^5.5.9"",
    ""metar-taf-parser"": ""^9.1.2"",
    ""moment"": ""^2.30.1"",
    ""moment-timezone"": ""^0.5.48"",
    ""mongoose"": ""^8.15.0"",
    ""nodemailer"": ""^7.0.3"",
    ""qrcode"": ""^1.5.4"",
    ""request-promise"": ""^4.2.6"",
    ""speakeasy"": ""^2.0.0"",
    ""uuid"": ""^11.1.0"",
    ""xmlbuilder"": ""^15.1.1""
  }
}

```
",['question'],closed,2025-05-19T10:07:06Z,2025-05-19T10:08:20Z,bug,['question'],True,0.0,
expressjs/express,6507,POST handler executed instead of GET handler,"I have sent the full code below. To reproduce the strange behavior:
Run both the server and the client, send a request throw the form , check that you are sending a GET request using developer tools then, on the server check that the app.post handler is being executed. Note that there ia a problem in the form, it is not executing the js script because of a missing property in the button (type=""button""), so the type of the button is by default ""submit"" and the request that is being sent is a GET request sending the data on the URL query part. But why is the server executing the app.post handler?

## Environment information

**Version**:

  ""dependencies"": {
    ""cors"": ""^2.8.5"",
    ""dotenv"": ""^16.5.0"",
    ""express"": ""^5.1.0"",
    ""mysql2"": ""^3.14.0"",
    ""sequelize"": ""^6.37.7""
  }

**Platform**:
Microsoft Windows NT 10.0.26100.0
x64

**Node.js version**:
v22.14.0

**Any other relevant information**:
Full code is here:
Description: a server app and a client app, just add a MySQL server connection details or simply remove connection to DB as it is not relevant here:
https://drive.google.com/file/d/1P-50C95h5RAMYarO-scfUHaLLPq1mmZF/view?usp=sharing",['bug'],closed,2025-05-09T05:17:25Z,2025-05-11T05:49:58Z,bug,['bug'],False,2.0,
expressjs/express,6501,array-flatten,"Hi,

I deployed my next.js webapp in azure web app and I have an issue in the log when I open the url:

> Cannot find module 'array-flatten'Require stack:- C:\home\site\wwwroot\node_modules\express\lib\router\route.js- C:\home\site\wwwroot\node_modules\express\lib\router\index.js- C:\home\site\wwwroot\node_modules\express\lib\application.js- C:\home\site\wwwroot\node_modules\express\lib\express.js- C:\home\site\wwwroot\node_modules\express\index.js- C:\home\site\wwwroot\server.js- C:\Program Files (x86)\iisnode\interceptor.jsat Module._resolveFilename (node:internal/modules/cjs/loader:1225:15)at Module._load (node:internal/modules/cjs/loader:1051:27)at Module.require (node:internal/modules/cjs/loader:1311:19)at Module.patchedRequire (C:\PROGRA~2\SITEEX~1\NODEAP~1\211~1.4\nodejs\node_modules\diagnostic-channel\dist\src\patchRequire.js:16:46)at Hook._require.Module.require (C:\PROGRA~2\SITEEX~1\NODEAP~1\211~1.4\nodejs\node_modules\require-in-the-middle\index.js:167:34)at require (node:internal/modules/helpers:179:18)at Object.<anonymous> (C:\home\site\wwwroot\node_modules\express\lib\router\route.js:17:15)at Module._compile (node:internal/modules/cjs/loader:1469:14)at Module._extensions..js (node:internal/modules/cjs/loader:1548:10)at Module.load (node:internal/modules/cjs/loader:1288:32)Application has thrown an uncaught exception and is terminated:Error: Cannot find module 'array-flatten'Require stack:- C:\home\site\wwwroot\node_modules\express\lib\router\route.js- C:\home\site\wwwroot\node_modules\express\lib\router\index.js- C:\home\site\wwwroot\node_modules\express\lib\application.js- C:\home\site\wwwroot\node_modules\express\lib\express.js- C:\home\site\wwwroot\node_modules\express\index.js- C:\home\site\wwwroot\server.js- C:\Program Files (x86)\iisnode\interceptor.jsat Module._resolveFilename (node:internal/modules/cjs/loader:1225:15)at Module._load (node:internal/modules/cjs/loader:1051:27)at Module.require (node:internal/modules/cjs/loader:1311:19)at Module.patchedRequire (C:\PROGRA~2\SITEEX~1\NODEAP~1\211~1.4\nodejs\node_modules\diagnostic-channel\dist\src\patchRequire.js:16:46)at Hook._require.Module.require (C:\PROGRA~2\SITEEX~1\NODEAP~1\211~1.4\nodejs\node_modules\require-in-the-middle\index.js:167:34)at require (node:internal/modules/helpers:179:18)at Object.<anonymous> (C:\home\site\wwwroot\node_modules\express\lib\router\route.js:17:15)at Module._compile (node:internal/modules/cjs/loader:1469:14)at Module._extensions..js (node:internal/modules/cjs/loader:1548:10)at Module.load (node:internal/modules/cjs/loader:1288:32)


When I look in package.json, I added the package array-flatten just in case, but still continue to get the issue:
```
""dependencies"": {
    ""@emotion/react"": ""11.14.0"",
    ""@emotion/styled"": ""11.14.0"",
    ""@mui/x-data-grid"": ""8.2.0"",
    ""@next/eslint-plugin-next"": ""14.0.4"",
    ""array-flatten"": ""^3.0.0"",
    ""bcrypt"": ""5.1.1"",
    ""bootstrap"": ""5.3.5"",
    ""express"": ""5.1.0"",
    ""firebase"": ""11.6.1"",
    ""leaflet"": ""1.9.4"",
    ""leaflet-defaulticon-compatibility"": ""0.1.2"",
    ""mongoose"": ""8.14.1"",
    ""next"": ""15.3.1"",
    ""next-auth"": ""4.24.11"",
    ""react"": ""18.3.1"",
    ""react-autosuggest"": ""10.1.0"",
    ""react-bootstrap"": ""2.10.9"",
    ""react-dom"": ""18.3.1"",
    ""react-firebase-hooks"": ""5.1.1"",
    ""react-icons"": ""4.12.0"",
    ""react-leaflet"": ""4.2.1"",
    ""react-toastify"": ""10.0.4"",
    ""react-tooltip"": ""4.5.1"",
    ""recharts"": ""2.15.3"",
    ""webpack"": ""5.99.7"",
    ""webpack-cli"": ""6.0.1""
  },
  ""devDependencies"": {
    ""@types/node"": ""22.15.3"",
    ""eslint"": ""9.25.1"",
    ""eslint-config-next"": ""15.3.1""
  }
```


Any idea how to fix it?",['awaiting more info'],closed,2025-05-02T20:21:50Z,2025-05-15T19:42:19Z,performance,['awaiting more info'],True,12.0,
expressjs/express,6499,Performance degradation in node v22,"Hello everyone, 

I have a question regarding express v4/5 performance inconsistency running on node v18 vs node v22

Images below are from a bare minimum express setup code attached below just `nvm use` in each then `npm run start` these are samples but I run these tests over 10 times with different time frames etc and v22 is consistently showing this behavior

<img width=""786"" alt=""Image"" src=""https://github.com/user-attachments/assets/c3a646d5-392d-4504-89a5-e65e77857bd4"" />

node v22 ( 15.3k req/s )

<img width=""850"" alt=""Image"" src=""https://github.com/user-attachments/assets/e0896d9d-7dfe-4870-9cdd-300bc7145b9d"" />

node v18 ( 17.3k req/s )


so the overall performance is not degraded by that much but the per request latency had a major impact, slowest in v18 is 0.07s which slowest request in v22 is 3s u can also see that that difference in the latency histogram, we have also noticed that in a recent upgrade in production where health check is failing under high load, while the same build using v18 is surviving the same load

anyone is experiencing the same or have an idea what I'm actually doing wrong ?

Thanks,

Code used for this test ( full code below )

```
// server.js - Node.js 22 Version
import express from 'express';

const app = express();
const port = process.env.PORT || 3000;

app.use(express.json());

app.get('/api/healthz', (req, res) => {
  res.status(200).send('ok');
});

app.use((err, req, res, next) => {
  console.error('Error:', err);
  res.status(500).send('Internal Server Error');
});

const server = app.listen(port, () => {
  console.log(`Node.js 22 server running on port ${port}`);
  console.log(`Node version: ${process.version}`);
});

const shutdown = () => {
  console.log('Shutdown signal received, closing server gracefully');
  server.close(() => {
    console.log('Server closed');
    process.exit(0);
  });
};

process.on('SIGTERM', () => shutdown());
process.on('SIGINT', () => shutdown());
```

[Archive-1.zip](https://github.com/user-attachments/files/20012920/Archive-1.zip)

Note: I also posted on slack here https://openjs-foundation.slack.com/archives/C02QB1731FH/p1746189447244249",['question'],closed,2025-05-02T12:41:41Z,2025-05-02T17:08:08Z,performance,['question'],True,0.0,
expressjs/express,6491,"TypeError: Unexpected ( at 9, expected END: https://git.new/pathToRegexpError","Hey devs I am new to express js and  I don't know some stuff,.

How could i fix this 
app.get(`/newpage(.html)?`, (req, res) => {
  res.sendFile(path.join(__dirname, ""views"", ""newpage.html""));
});

it showing me error 
Nodejs\node_modules\path-to-regexp\dist\index.js:123
        throw new TypeError(`Unexpected ${nextType} at ${index}, expected ${type}: ${DEBUG_URL}`);
        ^

TypeError: Unexpected ( at 9, expected END: https://git.new/pathToRegexpError
    at Iter.consume (E:\Nodejs\node_modules\path-to-regexp\dist\index.js:123:15)
    at consume (E:\Nodejs\node_modules\path-to-regexp\dist\index.js:179:16)
    at parse (E:\Nodejs\node_modules\path-to-regexp\dist\index.js:183:20)
    at E:\Nodejs\node_modules\path-to-regexp\dist\index.js:294:74
    at Array.map (<anonymous>)
    at pathToRegexp (E:\Nodejs\node_modules\path-to-regexp\dist\index.js:294:25)
    at Object.match (E:\Nodejs\node_modules\path-to-regexp\dist\index.js:264:30)
    at matcher (E:\Nodejs\node_modules\router\lib\layer.js:86:23)
    at new Layer (E:\Nodejs\node_modules\router\lib\layer.js:93:62)
    at Function.route (E:\Nodejs\node_modules\router\index.js:428:17)

",['question'],closed,2025-04-30T08:43:17Z,2025-04-30T13:24:20Z,bug,['question'],True,0.0,
expressjs/express,6479,What happened to `express.text()`,"My app was using [`express.text()`](https://expressjs.com/en/4x/api.html#express.text) with Express v4.21,1 to increase the upload limit for `app.post()` and was recently updated to support Express v5.1.0

Now I see that `express.text()` is neither documented in the [5.x API](https://expressjs.com/en/5x/api.html) or mentioned as being removed in the [Moving to Express 5](https://expressjs.com/en/guide/migrating-5.html) guide.

**_Is it still possible to use `express.text()` with Express 5 or is there a different / better approach?_**
It seems that [express/lib/express.js](https://github.com/expressjs/express/blob/f9954dd317a1b534e62a5ae3aa7f52f3582b8881/lib/express.js#L80) still exposes bodyparser.text as express.text.",['question'],closed,2025-04-22T18:57:01Z,2025-04-26T03:32:48Z,bug,['question'],True,3.0,
expressjs/express,6471,app.listen does not throw on port in use - this seems an error and different from previous version ?,"## Environment information

**Version**:
```json
""dependencies"": {
    ""express"": ""^5.0.1"",
}
```

**Platform**:
Microsoft Windows NT 10.0.19045.0
x64

**Node.js version**:
v20.14.0

## What steps will reproduce the bug?
```
import express, { Express, Request, RequestHandler, Response } from 'express';

const port = 3000;

const app = express();

app.listen(port, () => {

    console.log(`listening on port ${port}`);

    try {

        app.listen(port, () => {
            console.log(`how did we get here ???`);
        });

    } catch(e) {
        // should have thrown ? 
        console.error(e);
    }

});
```
",['question'],closed,2025-04-20T08:20:31Z,2025-04-20T22:46:44Z,bug,['question'],True,0.0,
expressjs/express,6468,"Express 5: Route wildcard ""(.*)""  throw new TypeError in path-to-regexp","## Environment information

**Version**:
```
json
""dependencies"": {
  ""express"": ""^5.1.0""
}
```

**Platform**:
Linux vm188 5.15.143-1-pve #1 SMP PVE 5.15.143-1 (2024-02-08T18:12Z) x86_64 GNU/Linux

**Node.js version**:
v23.11.0

**Any other relevant information**:
path-to-regexp (included in Express 5)
Reproducible in minimal test case

## What steps will reproduce the bug?
When using a wildcard route (.*) in Express 5, the server crashes with:

```
const express = require('express');
const app = express();
app.get('(.*)', (req, res) => res.send('Wildcard route'));
app.listen(3000);
```

Console Error is:

```
/srv/nodejs/express5-wildcard-test/node_modules/path-to-regexp/dist/index.js:123
        throw new TypeError(`Unexpected ${nextType} at ${index}, expected ${type}: ${DEBUG_URL}`);
```",['bug'],closed,2025-04-18T17:31:43Z,2025-04-18T19:11:01Z,bug,['bug'],False,0.0,
expressjs/express,6467,Github tag naming,"I noticed that with the release of 5.1.0 the github tag was labeled `v5.1.0` which is different from how version 4 was tagged.  Also there isn't any real consistency in the version labels for version 5.

We have nightly jobs that get the latest version number from npm and then use that to pull this repo so we can test it on our platforms.  It has been recently failing because of the labelling.  I'm fine with updating our code to use the `v` prefix, i just wanted to know if it will be consistent in the future?
","['question', 'tc agenda', 'top priority']",closed,2025-04-18T14:46:44Z,2025-04-20T14:32:31Z,bug,"['question', 'tc agenda', 'top priority']",True,1.0,
nestjs/nest,15115,Case-insensitive query parameters,"### Did you read the migration guide?

- [x] I have read the whole migration guide

### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Potential Commit/PR that introduced the regression

_No response_

### NestJS version

10 -> 11

### Describe the regression

We previously used the solution described in https://github.com/nestjs/nest/issues/10266 to achieve case-insensitive query parameter parsing. After the upgrade to v11 (and the included upgrade to express v5), this solution does no longer work, [as `req.query` is now a getter and no longer writable](https://expressjs.com/en/guide/migrating-5.html#req.query). (Even worse, the error was silently introduced since we didn't overwrite `req.query`, only the query parameters themselves, which is still possible - it simply has no effect, since setting properties on the object returned by the getter obviously has no effect...)

Is there an intended workaround for that or any other alternative solution? A built-in middleware or validator would of course be our preferred solution, maybe the situation has changed since 2022, when the other mentioned issue was opened?

### Minimum reproduction code

_No response_

### Input code

```ts

```


### Expected behavior

Some way of case-insensitive parameters working again

### Other

_No response_","['type: bug :sob:', 'needs triage']",closed,2025-05-12T11:39:19Z,2025-05-13T12:18:02Z,bug,"['type: bug :sob:', 'needs triage']",True,1.0,
nestjs/nest,15060,getHeader disappeared from AbstractHttpAdapter,"### Did you read the migration guide?

- [x] I have read the whole migration guide

### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Potential Commit/PR that introduced the regression

7197cc1

### NestJS version

10.x.x -> 11.x.x

### Describe the regression

According to the provided commit, it seems that getHeader and appendHeader were accidentally removed instead of being made non-optional.

### Minimum reproduction code

_No response_

### Input code

```ts

```


### Expected behavior

TypeScript should not complain about using the `getHeader` method.

```ts
@Injectable()
export class WhateverGuard {
  constructor(
    private readonly httpAdapterHost: HttpAdapterHost,
  ) {}

  canActivate(context: ExecutionContext) {
    // ...

    const ctx = GqlExecutionContext.create(context);
    const version = this.httpAdapterHost.httpAdapter.getHeader(ctx.getContext().req, 'x-app-version');

    // ...
  }
}

```

### Other

_No response_","['type: bug :sob:', 'needs triage']",closed,2025-05-02T23:22:31Z,2025-05-05T06:40:47Z,performance,"['type: bug :sob:', 'needs triage']",True,2.0,
nestjs/nest,15022,Upgrading to nestjs v11 (and fastify v5) does not handle invalid content-type errors from Fastify,"### Did you read the migration guide?

- [x] I have read the whole migration guide

### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Potential Commit/PR that introduced the regression

_No response_

### NestJS version

11.1.0

### Describe the regression

FastifyError with code `FST_ERR_CTP_INVALID_MEDIA_TYPE` is not being rethrown as an nestjs HttpException.

I have an existing guard that validates content-type to always be `application/json` and raise a `UnsupportedMediaTypeException` if not.

But now in nestjs v11, if I make a request with an invalid content-type (say `foo`), my guard doesnt run and instead I see 
```
FastifyError

code ='FST_ERR_CTP_INVALID_MEDIA_TYPE'
level ='\x1b[31merror\x1b[39m'
message ='Unsupported Media Type: foo'
name ='FastifyError'
statusCode =415

```
in my custom ExceptionFilter


### Minimum reproduction code

https://github.com/yawhide/nestjs-issue-15022

### Input code

```ts
@Catch(Error)
export class ErrorExceptionFilter extends BaseExceptionFilter {
  catch(error: Error, host: ArgumentsHost) {
    console.log(error) // error is a FastifyError, not HttpException
  }
}
```


### Expected behavior

My custom ExceptionFilter should see an `HttpException` exception instead of a `FastifyError` when the content-type is invalid.

### Other

_No response_","['type: bug :sob:', 'needs triage']",closed,2025-04-25T19:11:32Z,2025-05-05T10:47:33Z,bug,"['type: bug :sob:', 'needs triage']",True,9.0,
nestjs/nest,15013,potentially Incorrect implementation of `createAsyncOptionsProvider` when `ConfigurableModuleBuilder` built instance accepts a `useExisting` provider in the async options,"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior



in the file `<rootDir>/packages/common/module-utils/configurable-module.builder.ts`, The `private static createAsyncOptionsProvider()...` (line 304) method used in the dynamically generated class has what I believe to be an error in implementation:

The arguments injected into the factory provider is assumed to be of type `ConfigurableModuleOptionsFactory<ModuleOptions, FactoryClassMethodKey>` which is essentially a `Record<`${FactoryClassMethodKey}`, () => ModuleOptions>` (see `packages/common/module-utils/interfaces/configurable-module-async-options.interface.ts:15`). 

If the passed-in Module async options specify an `options.useExisting` provider for the `optionsInjectionToken`, then the wrapper `useFactory` provider returned by the function will attempt to call a `create` method on the resolved existing provider (or whatever `factoryClassMethodKey` is configured to in the builder instance).

I believe this to be unintentional behaviour, as from my understanding, the `useExisting` provider should idiomatically resolve to the actual configuration object instance, not a factory instance that creates it. There is currently no check to determine whether the object provided from `useExisting` fulfills the contract of an options provider factory, this is just assumed by the code.

```typescript
// this is the method currently in the master branch (tag v11.1.0)
// packages/common/module-utils/configurable-module.builder.ts:304-334

      private static createAsyncOptionsProvider(
        options: ConfigurableModuleAsyncOptions<ModuleOptions>,
      ): Provider {
        if (options.useFactory) {
          return {
            provide: self.options.optionsInjectionToken!,
            useFactory: options.useFactory,
            inject: options.inject || [],
          };
        }
        return {
          provide: self.options.optionsInjectionToken!,
          useFactory: async (
            optionsFactory: ConfigurableModuleOptionsFactory<
              ModuleOptions,
              FactoryClassMethodKey
            >,
          ) =>
            await optionsFactory[
              self.factoryClassMethodKey as keyof typeof optionsFactory
            ](),
          inject: [options.useExisting || options.useClass!],
        };
      }
    }
```

### Minimum reproduction code

N/A

### Steps to reproduce

The description should be sufficient to reason with as it is.

### Expected behavior

My recommendation is if the `options.useExisting` value is defined, the `createAsyncOptionsProvider` method should return the `options.useExisting` provider as it is, instead of its current behaviour of calling the create method on the provider.

If it is intentional that the `useExisting` async option _should_ resolve to a factory instance, This does not align with the (current documentation)[https://docs.nestjs.com/fundamentals/custom-providers#alias-providers-useexisting]. I believe this would lead to unnecessary complexity that should be solved using Injected tokens in a `useFactory` provider instead.

### Package

- [ ] I don't know. Or some 3rd-party package
- [x] <code>@nestjs/common</code>
- [ ] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [ ] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

11.1.0

### Packages versions

```json

```


### Node.js version

N/A

### In which operating systems have you tested?

- [ ] macOS
- [x] Windows
- [x] Linux

### Other

_No response_",['needs triage'],closed,2025-04-24T06:06:10Z,2025-04-24T06:30:08Z,bug,['needs triage'],True,0.0,
nestjs/nest,15006,bug: create a new release to address GHSA-mg2h-6x62-wpwc,"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior

Currtent `@nest/fastify-platform` has a vulnerability already addressed in `master` 4 days ago by the bot.

see: ed8df84be35eedf990d4d9804166a5c8a079de18

### Minimum reproduction code

https://stackblitz.com/edit/nestjs-typescript-starter-gqbphx8i?file=package-lock.json

### Steps to reproduce

1. `npm i @nestjs/fastify-platform`

This will install version `11.0.20` with the GHSA-mg2h-6x62-wpwc vulnerability

### Expected behavior

`npm i @nestjs/fastify-platform` should install a new version that includes the fix already addressed by the bot here ed8df84be35eedf990d4d9804166a5c8a079de18

### Package

- [ ] I don't know. Or some 3rd-party package
- [ ] <code>@nestjs/common</code>
- [ ] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [x] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

11.0.20

### Packages versions

```javascript
{
  // ...
  ""dependencies"": {
    ""@df-api/crypto-utils"": ""4.0.0"",
    ""@df-libs/common"": ""^2.3.1"",
    ""@df-libs/dd-connector"": ""^2.3.1"",
    ""@df-libs/exceptions"": ""^2.3.1"",
    ""@df-libs/logger"": ""^2.3.1"",
    ""@df-libs/apigee-invoker"": ""^2.3.1"",
    ""@df-libs/passthrough-invoker"": ""^2.3.1"",
    ""@fastify/helmet"": ""^13.0.1"",
    ""@fastify/static"": ""^8.0.4"",
    ""@nestjs/axios"": ""^4.0.0"",
    ""@nestjs/common"": ""^11.0.20"",
    ""@nestjs/config"": ""^4.0.0"",
    ""@nestjs/core"": ""^11.0.20"",
    ""@nestjs/platform-express"": ""^11.0.20"",
    ""@nestjs/platform-fastify"": ""^11.0.20"",
    ""@nestjs/swagger"": ""^11.1.3"",
    ""class-transformer"": ""^0.5.1"",
    ""class-validator"": ""^0.14.1"",
    ""dayjs"": ""^1.11.13"",
    ""luxon"": ""^3.6.1"",
    ""reflect-metadata"": ""^0.2.2"",
    ""rxjs"": ""^7.8.1""
  },
  ""devDependencies"": {
    ""@commitlint/cli"": ""^19.6.1"",
    ""@commitlint/config-conventional"": ""^19.6.0"",
    ""@eslint/eslintrc"": ""^3.2.0"",
    ""@eslint/js"": ""^9.19.0"",
    ""@nestjs/cli"": ""^11.0.2"",
    ""@nestjs/schematics"": ""^11.0.0"",
    ""@nestjs/testing"": ""^11.0.11"",
    ""@nx/eslint"": ""^20.4.0"",
    ""@nx/jest"": ""^20.4.0"",
    ""@types/crypto-js"": ""^4.2.2"",
    ""@types/jest"": ""^29.5.14"",
    ""@types/node"": ""^22.10.10"",
    ""@types/supertest"": ""^6.0.2"",
    ""@typescript-eslint/eslint-plugin"": ""^8.22.0"",
    ""@typescript-eslint/parser"": ""^8.22.0"",
    ""eslint"": ""^9.19.0"",
    ""eslint-config-prettier"": ""^10.0.1"",
    ""eslint-plugin-prettier"": ""^5.2.3"",
    ""globals"": ""^15.14.0"",
    ""husky"": ""^9.1.7"",
    ""jest"": ""^29.7.0"",
    ""nock"": ""^13.5.6"",
    ""prettier"": ""^3.4.2"",
    ""source-map-support"": ""^0.5.21"",
    ""supertest"": ""^7.0.0"",
    ""ts-jest"": ""^29.2.5"",
    ""ts-loader"": ""^9.5.1"",
    ""ts-node"": ""10.9.2"",
    ""tsconfig-paths"": ""^4.2.0"",
    ""typescript"": ""^5.7.3"",
    ""typescript-eslint"": ""^8.22.0""
  }
}
```

```bash
[System Information]
OS Version     : Linux6.11.0-24-generic
NodeJS Version : v20.19.0
NPM Version    : 10.8.2 

[Nest CLI]
Nest CLI Version : 11.0.6 

[Nest Platform Information
platform-express version : 11.0.20
platform-fastify version : 11.0.20
schematics version       : 11.0.5
swagger version          : 11.1.5
testing version          : 11.0.20
common version           : 11.0.20
config version           : 4.0.2
axios version            : 4.0.0
core version             : 11.0.20
cli version              : 11.0.6
```

### Node.js version

20.19.0

### In which operating systems have you tested?

- [ ] macOS
- [ ] Windows
- [x] Linux

### Other

Thank you",['needs triage'],closed,2025-04-22T15:42:26Z,2025-04-23T06:31:46Z,bug,['needs triage'],True,0.0,
nestjs/nest,14998,enableShutdownHooks leads to trigger twice the SIGTERM to your app on shutdown,"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior

I noticed that when we use `enableShutdownHooks`, if your app is setup with a `process.on('SIGTERM', callbackFunction)`,then on CTRL+C it will call twice the SIGTERM (a first one with `CTRL+C` signal, and then a `process.kill` from the code below) and so it will call twice the callback shutdown function, which is not supposed to happen.

I think this is because of this code:

https://github.com/nestjs/nest/blob/d37973bb6d8271bd5fd69de1b20d37d621a7ec02/packages/core/nest-application-context.ts#L355

```typescript
protected listenToShutdownSignals(signals: string[]) {
    let receivedSignal = false;
    const cleanup = async (signal: string) => {
      try {
        if (receivedSignal) {
          // If we receive another signal while we're waiting
          // for the server to stop, just ignore it.
          return;
        }
        receivedSignal = true;
        await this.initializationPromise;
        await this.callDestroyHook();
        await this.callBeforeShutdownHook(signal);
        await this.dispose();
        await this.callShutdownHook(signal);
        signals.forEach(sig => process.removeListener(sig, cleanup));
        process.kill(process.pid, signal);
      } catch (err) {
        Logger.error(
          MESSAGES.ERROR_DURING_SHUTDOWN,
          (err as Error)?.stack,
          NestApplicationContext.name,
        );
        process.exit(1);
      }
    };
    this.shutdownCleanupRef = cleanup as (...args: unknown[]) => unknown;

    signals.forEach((signal: string) => {
      this.activeShutdownSignals.push(signal);
      process.on(signal as any, cleanup);
    });
  }
```

### Minimum reproduction code

-

### Steps to reproduce

_No response_

### Expected behavior

I think a quick fix would to not call `process.kill(process.pid, signal);` in the above code

### Package

- [ ] I don't know. Or some 3rd-party package
- [ ] <code>@nestjs/common</code>
- [ ] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [ ] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

10.0.0

### Packages versions

```json

```


### Node.js version

20.11.0

### In which operating systems have you tested?

- [x] macOS
- [ ] Windows
- [ ] Linux

### Other

_No response_",['needs triage'],closed,2025-04-21T21:08:05Z,2025-04-22T07:44:21Z,performance,['needs triage'],True,0.0,
nestjs/nest,14993,NestJS + React Support,"### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Is your feature request related to a problem? Please describe it

Not exactly a problem, but I’ve been exploring ways to bring NestJS-style structure (decorators, separation of concerns, SSR) into React apps. While there are approaches out there, I thought it might be helpful to share a lightweight take I’ve been working on: [@damian88/nestjsx](https://www.npmjs.com/package/@damian88/nestjsx).

### Describe the solution you'd like

Hi there! 👋

I hope you're doing well. I wanted to reach out and share a project I’ve been working on — a lightweight utility library inspired by NestJS, designed for JSX-based apps with a focus on SSR and clean architecture.

I’d love to explore the possibility of collaborating or exchanging ideas — I think there’s some exciting overlap we could explore.

🔗 Check it out here: [@damian88/nestjsx on npm](https://www.npmjs.com/package/@damian88/nestjsx)

Let me know what you think!


### Teachability, documentation, adoption, migration strategy

Hi, you can see my documentation on my readme.md in [https://www.npmjs.com/package/@damian88/nestjsx](https://www.npmjs.com/package/@damian88/nestjsx)

### What is the motivation / use case for changing the behavior?

To bring NestJS-style structure to React—using decorators for cleaner SSR, better separation of concerns, and more maintainable full-stack code.","['type: enhancement :wolf:', 'needs triage']",closed,2025-04-19T20:33:06Z,2025-04-22T07:35:09Z,performance,"['type: enhancement :wolf:', 'needs triage']",True,2.0,
nestjs/nest,14986,Add support for Fastify route schema validation via metadata in NestJS,"### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Is your feature request related to a problem? Please describe it

Yes. NestJS currently does not expose a way to use Fastify's native schema validation in a declarative and Nest-like manner. While Fastify supports schema validation at the route level (e.g., body, querystring, params, headers, response), NestJS does not provide an official way to attach these schemas via decorators.

This creates friction for developers who want to benefit from Fastify’s built-in performance and validation capabilities without relying on external class-based validation libraries like class-validator.

It also means we can’t use JSON Schema-based validators (like `zod`, `typebox`, or `ajv`) in a seamless, idiomatic NestJS way.

We are submitting a PR for this feature alongside this issue to demonstrate the proposed implementation and open it up for review and discussion.

### Describe the solution you'd like

I would like to introduce a new decorator, e.g. @Schema(), that allows attaching Fastify-compatible route schemas directly to controller handlers in NestJS.

This decorator would store schema metadata using Reflect.setMetadata(). Then, the custom FastifyAdapter would read this metadata in injectRouteOptions and pass the schema to Fastify’s route configuration.

The solution should:

Be framework-agnostic: not tied to a specific schema generator like zod, typebox, etc.

Support standard Fastify schema properties: body, querystring, params, headers, response.

Work seamlessly alongside other NestJS features like guards, pipes, interceptors, and versioning.

Require no changes to Fastify core — only the NestJS adapter.

Example usage:
```
@Schema({
  body: SomeTypeboxSchema,
  querystring: SomeQuerySchema,
})
@Post()
create(@Body() body: CreateDto) {
  return this.service.create(body);
}
```


### Teachability, documentation, adoption, migration strategy

**Teachability:**

The solution mirrors familiar NestJS patterns such as `@UseGuards()` or `@SetMetadata()`, so it's intuitive for NestJS developers. The `@Schema()` decorator makes route-level validation explicit and easy to read. Developers can pass in any schema object that Fastify accepts, so there's no new DSL or library required.

**Documentation:**

Minimal documentation is needed:

- One section explaining the `@Schema()` decorator and its usage.
- Code examples for schemas using zod, typebox, JSON Schema, etc.
- Notes on how it integrates with the underlying Fastify validation layer.
- Clarify that it’s optional and only affects Fastify-based apps.

**Adoption:**

This feature is opt-in and backward-compatible. It doesn’t affect apps not using @Schema() or using Express. Fastify users can incrementally adopt this feature by adding schema decorators to selected routes.

**Migration strategy:**

No migration is required for existing applications. However, projects that currently configure Fastify schemas imperatively (e.g., using plugins or middleware) can gradually replace those with the @Schema() decorator to keep schema definitions co-located with the controller logic.

### What is the motivation / use case for changing the behavior?

Fastify has a powerful built-in schema validation mechanism, but currently, NestJS does not expose a clean, idiomatic way to define route-level schemas that integrate directly with Fastify's validation system. While NestJS supports `ValidationPipe`, it is powered by class-transformer/class-validator and runs outside Fastify’s lifecycle — which means you don’t get the performance benefits, request rejection at the earliest stage, or schema-based tooling support.

This feature enables developers to:

- Define route-specific Fastify-compatible schemas directly in the controller using a familiar @Schema() decorator.
- Benefit from native Fastify validation and type inference, especially when using `zod`, `@sinclair/typebox`, or JSON Schema.
- Keep validation definitions co-located with controller handlers in a declarative, composable way.
- Leverage Fastify's ecosystem (e.g., OpenAPI generation, schema-based type providers) without giving up NestJS ergonomics.

It aligns with the NestJS philosophy of structured, declarative programming while enabling deeper integration with Fastify's performance-first features.","['type: enhancement :wolf:', 'needs triage']",closed,2025-04-18T18:53:00Z,2025-04-22T07:43:59Z,performance,"['type: enhancement :wolf:', 'needs triage']",True,3.0,
nestjs/nest,14916,Shutdown hooks not working in NestJS when Puppeteer browser is created,"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior

When Puppeteer is used, NestJS does not call any `onModuleDestroy()` methods, although `app.enableShutdownHooks()` has been called.

### Minimum reproduction code

https://github.com/ssljivic/nest-puppeteer-bug

### Steps to reproduce

Install packages:
`npm i`

Start the app without Pupeteer:
`npm run dev`
Stop the app by pressing `Ctrl + C` in the terminal
Observe that ""OnModuleDestroy start"" and ""OnModuleDestroy end"" are printed.

Start the app with Pupeteer:
`WITH_PUPPETEER=true npm run dev`
Stop the app by pressing `Ctrl + C` in the terminal
Observe that ""OnModuleDestroy start"" and ""OnModuleDestroy end"" have not been printed.


### Expected behavior

Whether Puppeteer is used or not, `onModuleDestroy()` methods should be called.

### Package

- [ ] I don't know. Or some 3rd-party package
- [ ] <code>@nestjs/common</code>
- [x] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [ ] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

10.3.8

### Packages versions

```json
{
  ""name"": ""nest-pup"",
  ""version"": ""1.0.0"",
  ""description"": """",
  ""private"": true,
  ""license"": ""UNLICENSED"",
  ""scripts"": {
    ""build"": ""nest build"",
    ""start"": ""nest start"",
    ""dev"": ""nest start --watch"",
    ""start:prod"": ""node dist/main""
  },
  ""dependencies"": {
    ""@nestjs/common"": ""^10.3.8"",
    ""@nestjs/core"": ""^10.3.8"",
    ""@nestjs/platform-express"": ""^10.3.8"",
    ""puppeteer"": ""^24.6.0""
  },
  ""devDependencies"": {
    ""@nestjs/cli"": ""^10.3.2"",
    ""@nestjs/schematics"": ""^10.1.1"",
    ""@swc/cli"": ""^0.3.12"",
    ""@swc/core"": ""^1.4.16"",
    ""@types/express"": ""^4.17.21""
  }
}

```

### Node.js version

v22.12.0

### In which operating systems have you tested?

- [x] macOS
- [ ] Windows
- [ ] Linux

### Other

_No response_",['needs triage'],closed,2025-04-06T19:41:07Z,2025-04-07T09:56:50Z,bug,['needs triage'],True,0.0,
nestjs/nest,14911,`onApplicationBootstrap` not behaving asynchronously as documented,"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior

According to the [documentation](https://docs.nestjs.com/fundamentals/lifecycle-events#asynchronous-initialization), the `onApplicationBootstrap` lifecycle hook should support asynchronous initialization by returning a Promise. However, in practice, this behavior appears to be blocking the entire application startup process.

Even when using `async` and returning a Promise inside `onApplicationBootstrap`, the app's boot sequence is delayed by the duration of the async call. This contradicts the expectation that async logic would run without blocking the rest of the application.

### Minimum reproduction code

(See steps to reproduce)

### Steps to reproduce

## Sample Code

```ts
import { Injectable, Logger, OnApplicationBootstrap } from '@nestjs/common';

@Injectable()
export class LongRunningWorkerService implements OnApplicationBootstrap {
  private readonly logger = new Logger(LongRunningWorkerService.name);

  async onApplicationBootstrap(): Promise<void> {
    this.logger.debug('Long running worker service is starting');

    await this.longRunningTask();

    this.logger.debug('Long running worker service has ended');
  }

  private async longRunningTask(): Promise<void> {
    this.logger.debug('Starting 30 second async delay');

    await new Promise((resolve) => setTimeout(resolve, 30000)); // Wait for 30 seconds

    this.logger.debug('Finished 30 second async delay');
  }
}
```

Output:

```sh
[Nest] 60711  - 04/04/2025, 9:41:27 PM     LOG [NestFactory] Starting Nest application...
[Nest] 60711  - 04/04/2025, 9:41:27 PM   DEBUG [LongRunningWorkerService] Starting 30 second async delay
[Nest] 60711  - 04/04/2025, 9:41:57 PM   DEBUG [LongRunningWorkerService] Finished 30 second async delay
[Nest] 60711  - 04/04/2025, 9:41:57 PM   DEBUG [LongRunningWorkerService] Long running worker service has ended
[Nest] 60711  - 04/04/2025, 9:41:57 PM     LOG [NestApplication] Nest application successfully started +1ms
[Nest] 60711  - 04/04/2025, 9:41:57 PM     LOG [Main] Application started successfully on http://[::1]:3000 in development mode +3ms
```

As seen in the logs, the entire application startup is delayed by ~30 seconds, matching the time spent in the async logic.

### Expected behavior

`onApplicationBootstrap` should run asynchronously and not block the main application startup.

### Package

- [ ] I don't know. Or some 3rd-party package
- [x] <code>@nestjs/common</code>
- [x] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [ ] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

11.0.13

### Packages versions

```json
""dependencies"": {
  ""@nestjs/common"": ""11.0.13"",
  ""@nestjs/core"": ""11.0.13""
}
```


### Node.js version

22.12.0

### In which operating systems have you tested?

- [x] macOS
- [ ] Windows
- [ ] Linux

### Other

## Workaround

Using `setImmediate` allows the logic to run without blocking startup:

```ts
  async onApplicationBootstrap(): Promise<void> {
    this.logger.debug('Long running worker service is starting');

    setImmediate(() => {
      this.longRunningTask().catch((error: unknown) => {
        this.logger.error('Error during long running task:', error);
      });
    });

    this.logger.debug('Long running worker service has ended');
  }
```

Output:

```sh
[Nest] 75741  - 04/04/2025, 9:57:56 PM     LOG [NestFactory] Starting Nest application...
[Nest] 75741  - 04/04/2025, 9:57:56 PM   DEBUG [LongRunningWorkerService] Long running worker service is starting
[Nest] 75741  - 04/04/2025, 9:57:56 PM   DEBUG [LongRunningWorkerService] Long running worker service has ended
[Nest] 75741  - 04/04/2025, 9:57:56 PM     LOG [NestApplication] Nest application successfully started +0ms
[Nest] 75741  - 04/04/2025, 9:57:56 PM     LOG [Main] Application started successfully on http://[::1]:3000 in development mode +1ms
[Nest] 75741  - 04/04/2025, 9:57:56 PM   DEBUG [LongRunningWorkerService] Starting 30 second async delay
[Nest] 75741  - 04/04/2025, 9:58:26 PM   DEBUG [LongRunningWorkerService] Finished 30 second async delay
```

While this workaround prevents blocking, it feels like a hack and contradicts the documented support for async initialization.

## Questions

- Is this the expected behavior?
- Is the documentation inaccurate, or is this a bug in how lifecycle hooks handle async behavior?
- Is there a cleaner solution than using `setImmediate`?",['needs triage'],closed,2025-04-05T04:02:58Z,2025-04-07T07:04:00Z,performance,['needs triage'],True,2.0,
nestjs/nest,14909,Fastify Adapter setGlobalPrefix exclusions no longer support parameters or wildcard Warning,"### Did you read the migration guide?

- [x] I have read the whole migration guide

### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Potential Commit/PR that introduced the regression

_No response_

### NestJS version

10->11.0.2->11.0.3

### Describe the regression

After migrating to nest 11 using fastify setting a global prefix throws a warning

```
[08:50:28.633] WARN: Unsupported route path: ""/api/*"". In previous versions, the symbols ?, *, and + were used to denote optional or repeating path parameters. The latest version of ""path-to-regexp"" now requires the use of named parameters. For example, instead of using a route like /users/* to capture all routes starting with ""/users"", you should use /users/*path. For more details, refer to the migration guide. Attempting to auto-convert...
[08:50:28.633] WARN: Unsupported route path: ""/api/*"". In previous versions, the symbols ?, *, and + were used to denote optional or repeating path parameters. The latest version of ""path-to-regexp"" now requires the use of named parameters. For example, instead of using a route like /users/* to capture all routes starting with ""/users"", you should use /users/*path. For more details, refer to the migration guide. Attempting to auto-convert...
```
[14894](https://github.com/nestjs/nest/issues/14894#issuecomment-2777714114)

I test the latest release 11.0.3 and still the same issue

### Minimum reproduction code

https://github.com/invaderb/nest-11-test

### Input code

```ts
const globalPrefix = '/api';
app.setGlobalPrefix(globalPrefix);
```


### Expected behavior

no warnings to be thrown if setup correctly

### Other

_No response_","['type: bug :sob:', 'needs triage']",closed,2025-04-04T16:25:15Z,2025-04-07T08:07:29Z,bug,"['type: bug :sob:', 'needs triage']",True,2.0,
nestjs/nest,14890,update v10.x of @nestjs/common for remote execution vuln,"### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Is your feature request related to a problem? Please describe it

We're currently on Nest.js 10.x due to a limitation on the version of Node.js we are using (have to use v18 due to AWS limitation on AppRunner)

However, we're currently getting this security vulnerability alert: https://github.com/advisories/GHSA-cj7v-w2c7-cp7c

### Describe the solution you'd like

Even though this is for the last release, could we please backport the security fix to the v10.x version of Nest.js?

### Teachability, documentation, adoption, migration strategy

request to update the github advisory accordingly after a backport of the patch

### What is the motivation / use case for changing the behavior?

enables us to use Nest.js securely even though we are on a slightly older version","['type: enhancement :wolf:', 'needs triage']",closed,2025-04-01T15:24:01Z,2025-04-01T15:33:03Z,security,"['type: enhancement :wolf:', 'needs triage']",True,0.0,
nestjs/nest,14876,FileTypeValidator naive file type checking (@nestjs/common vulnerability),"### Is there an existing issue for this?

- [x] I have searched the existing issues

### Current behavior

Snyk is reporting a vulnerability with @nestjs/common reported at this URL: [Snyk Report](https://security.snyk.io/vuln/SNYK-JS-NESTJSCOMMON-9538801)

According to reports, there is no version that prevents this vulnerability. Is there any way you can help me?

![Image](https://github.com/user-attachments/assets/36ce0c77-b2d3-4ea9-bd46-35133bb8df39)

### Minimum reproduction code

https://codesandbox.io/p/sandbox/github/nestjs/typescript-starter

### Steps to reproduce

1. npm install -g snyk
2. snyk auth
3. snyk test


### Expected behavior

Remove the vulnerability reported by Snyk

### Package

- [ ] I don't know. Or some 3rd-party package
- [x] <code>@nestjs/common</code>
- [ ] <code>@nestjs/core</code>
- [ ] <code>@nestjs/microservices</code>
- [ ] <code>@nestjs/platform-express</code>
- [ ] <code>@nestjs/platform-fastify</code>
- [ ] <code>@nestjs/platform-socket.io</code>
- [ ] <code>@nestjs/platform-ws</code>
- [ ] <code>@nestjs/testing</code>
- [ ] <code>@nestjs/websockets</code>
- [ ] Other (see below)

### Other package

_No response_

### NestJS version

11.0.12

### Packages versions

```json
""dependencies"": {
    ""@nestjs/common"": ""11.0.12"",
    ""@nestjs/config"": ""4.0.2"",
    ""@nestjs/core"": ""11.0.12"",
    ""@nestjs/jwt"": ""11.0.0"",
    ""@nestjs/platform-express"": ""11.0.12"",
    ""@nestjs/swagger"": ""11.1.0"",
  }
```


### Node.js version

22.14.0

### In which operating systems have you tested?

- [ ] macOS
- [ ] Windows
- [ ] Linux

### Other

_No response_",['needs triage'],closed,2025-03-28T14:30:37Z,2025-04-14T08:37:29Z,security,['needs triage'],True,16.0,
nestjs/nest,14874,Issue with cache-manager and keyv,"### Did you read the migration guide?

- [x] I have read the whole migration guide

### Is there an existing issue that is already proposing this?

- [x] I have searched the existing issues

### Potential Commit/PR that introduced the regression

_No response_

### NestJS version

10.4.15

### Describe the regression

When trying to migrate to `@nestjs/cache-manager` in version `3.0.1` and adapting the code following the [documentation](https://docs.nestjs.com/techniques/caching#using-alternative-cache-stores) with `Keyv`

I'm getting the following error:
```
TypeError: Cannot read properties of undefined (reading 'includes')
    at /Users/toto/workspace/repo/node_modules/keyv/dist/index.cjs:456:123
    at Array.some (<anonymous>)
    at Keyv._checkIterableAdapter (/Users/toto/workspace/repo/node_modules/keyv/dist/index.cjs:456:84)
    at new Keyv (/Users/toto/workspace/repo/node_modules/keyv/dist/index.cjs:302:72)
    at cachingFactory (/Users/toto/workspace/repo/node_modules/@nestjs/cache-manager/dist/cache.providers.js:24:24)
    at /Users/toto/workspace/repo/node_modules/@nestjs/cache-manager/dist/cache.providers.js:31:65
    at Array.map (<anonymous>)
    at InstanceWrapper.useFactory [as metatype] (/Users/toto/workspace/repo/node_modules/@nestjs/cache-manager/dist/cache.providers.js:31:52)
    at Injector.instantiateClass (/Users/toto/workspace/repo/node_modules/@nestjs/core/injector/injector.js:376:55)
    at callback (/Users/toto/workspace/repo/node_modules/@nestjs/core/injector/injector.js:65:45)
```

My code simplified looks like this:
```ts
import { Module } from '@nestjs/common';
import { CacheModule } from '@nestjs/cache-manager';
import { NestFactory } from '@nestjs/core';
import { Keyv } from 'keyv';
import QuickLRU from 'quick-lru';

@Module({
  imports: [
    CacheModule.registerAsync({
      useFactory: async () => {
        const lru = new QuickLRU({
          maxSize: 10_000,
        });

        return {
          stores: [
            new Keyv({
              store: lru,
            }) as any,
          ],
        };
      },
    }),
  ],
})
export class CacheLruModule {}

const app = await NestFactory.create(CacheLruModule);
```

The line in `Keyv` is [this one](https://github.com/jaredwray/keyv/blob/main/packages/keyv/src/index.ts#L389-L392)
And before it comes from [this one](https://github.com/jaredwray/keyv/blob/main/packages/keyv/src/index.ts#L253-L255)

I checked and `'iterable' in lru' returns `false`.

I'm using the same versions for the dependencies as `@nestjs/cache-manager`, except I have migrated yet to `nestjs@11`, but I don't think it matters.

```json
""dependencies"": {
    ""@nestjs/cache-manager"": ""^3.0.1"",
    ""@nestjs/common"": ""^10.4.15"",
    ""@nestjs/core"": ""^10.4.15"",
    ""cache-manager"": ""^6.4.1"",
    ""keyv"": ""^5.3.2"",
    ""quick-lru"": ""^7.0.0""
  }
```

### Minimum reproduction code

_No response_

### Input code

```ts

```


### Expected behavior

I don't understand why we are entering the `'iterable' in store` which triggers the check of `store._opts.url.includes(...)`, which fails because `url` is undefined

### Other

_No response_","['type: bug :sob:', 'needs triage']",closed,2025-03-28T10:09:00Z,2025-03-28T10:45:28Z,bug,"['type: bug :sob:', 'needs triage']",True,0.0,
rails/rails,55218,CPK ID is not an usable ID.,"### Steps to reproduce

<!-- (Guidelines for creating a bug report are [available
here](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#creating-a-bug-report)) -->

As per the rails guide.

https://guides.rubyonrails.org/v7.2/active_record_composite_primary_keys.html

7.1 Absorbed the CPK gem...
7.2 Offered much better support. this is still not fully fleshed out.

For example creating an object calling .id on it and then attempting to find the object via AR and this ID 
Raises an exception. 


<!-- Paste your executable test case created from one of the scripts found [here](https://edgeguides.rubyonrails.org/contributing_to_ruby_on_rails.html#create-an-executable-test-case) below: -->
```ruby
create_table :products, primary_key: [:store_id, :sku] do |t|
      t.integer :store_id
      t.string :sku
      t.text :description
    end

test_product = Product.new(1,'test_sku').save!

## In controller.
Product.find(test_product.id)
```

### Expected behavior

The test_product object is found and returned via it's ID!

<!-- Tell us what should happen -->

### Actual behavior

##### ActiveRecord::RecordNotFound in ProductController#update 
Couldn't find Product with '[""store_id"", ""sku""]'=1_test_sku

<!-- Tell us what happens instead -->

### System configuration

**Rails version**: 7.2.2.1

**Ruby version**:  3.3.7
","['activerecord', 'more-information-needed']",open,2025-06-20T18:59:02Z,,bug,"['activerecord', 'more-information-needed']",True,,
rails/rails,55215,`NameError: uninitialized constant ActionController::Base` for `railties/lib/rails/health_controller.rb`,"Looking into [enabling Rails 8 CI for globalid](https://github.com/rails/globalid/pull/197), there is following test failure:

~~~
  4) Error:
RailtieTest#test_config.global_id_can_be_used_to_set_configurations_after_the_railtie_has_been_loaded:
NameError: uninitialized constant ActionController::Base
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/health_controller.rb:35:in '<module:Rails>'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/health_controller.rb:3:in '<top (required)>'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/bundled_gems.rb:82:in 'Kernel.require'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/bundled_gems.rb:82:in 'block (2 levels) in Kernel#replace_require'
    vendor/bundle/ruby/3.4.0/gems/zeitwerk-2.7.3/lib/zeitwerk/core_ext/kernel.rb:34:in 'Kernel#require'
    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'Module#const_get'
    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'block in ActiveSupport::Autoload#eager_load!'
    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'Array#each'
    vendor/bundle/ruby/3.4.0/gems/activesupport-8.0.2/lib/active_support/dependencies/autoload.rb:67:in 'ActiveSupport::Autoload#eager_load!'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/application/finisher.rb:80:in 'block in <module:Finisher>'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:32:in 'BasicObject#instance_exec'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:32:in 'Rails::Initializable::Initializer#run'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:61:in 'block in Rails::Initializable#run_initializers'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:231:in 'block in TSort.tsort_each'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:353:in 'block (2 levels) in TSort.each_strongly_connected_component'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:434:in 'TSort.each_strongly_connected_component_from'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:352:in 'block in TSort.each_strongly_connected_component'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'Rails::Initializable::Collection#each'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'Method#call'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:350:in 'TSort.each_strongly_connected_component'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:229:in 'TSort.tsort_each'
    /opt/hostedtoolcache/Ruby/3.4.4/x64/lib/ruby/3.4.0/tsort.rb:208:in 'TSort#tsort_each'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/initializable.rb:60:in 'Rails::Initializable#run_initializers'
    vendor/bundle/ruby/3.4.0/gems/railties-8.0.2/lib/rails/application.rb:440:in 'Rails::Application#initialize!'
    test/cases/railtie_test.rb:53:in 'block in <class:RailtieTest>'
~~~

I don't know if the test case is setup properly, but it seems that `RUBYOPT=-raction_controller` helps to workaround this issue. This makes me wonder, should there be `require ""action_controller""` included somewhere in `railties/lib/rails/health_controller.rb`?","['railties', 'With reproduction steps', 'good first issue']",open,2025-06-20T12:01:00Z,,security,"['railties', 'with reproduction steps', 'good first issue']",True,,
rails/rails,55190,ActiveRecord::StatementInvalid Exception: PG::InvalidTextRepresentation: ERROR:  invalid input syntax for type integer,"### Steps to reproduce

I get error with the integer column. 

Rails 8.0.2
pg 1.5.9

```
*** ActiveRecord::StatementInvalid Exception: PG::InvalidTextRepresentation: ERROR:  invalid input syntax for type integer: ""-0.010000000000000009""
CONTEXT:  unnamed portal parameter $10 = '...'
```

```
class Model
  scope :free_capacity_nomorethan, ->(max_free_capacity) {
    where(""total_mb > 0"").where(""free_mb <= total_mb * ? "", max_free_capacity)
  }
end

Model.free_capacity_nomorethan(max_free_capacity)
```
Here `max_free_capacity = -010000000000000009`

`free_mb` and `total_mb` is `Integer`


### System configuration

**Rails version**: 8.0.2

**Ruby version**: 3.2.4
",['activerecord'],closed,2025-06-13T13:45:13Z,2025-06-16T15:33:04Z,bug,['activerecord'],True,3.0,
rails/rails,55183,Strict loading error raised incorrectly when checking if HABTM association includes an unpersisted instance,"### Steps to reproduce
```ruby
# frozen_string_literal: true

require ""bundler/inline""

gemfile(true) do
  source ""https://rubygems.org""

  gem ""rails""
  # If you want to test against edge Rails replace the previous line with this:
  # gem ""rails"", github: ""rails/rails"", branch: ""main""

  gem ""sqlite3""
end

require ""active_record/railtie""
require ""minitest/autorun""

# This connection will do for database-independent bug reports.
ENV[""DATABASE_URL""] = ""sqlite3::memory:""

class TestApp < Rails::Application
  config.load_defaults Rails::VERSION::STRING.to_f
  config.eager_load = false
  config.logger = Logger.new($stdout)
  config.secret_key_base = ""secret_key_base""

  config.active_record.encryption.primary_key = ""primary_key""
  config.active_record.encryption.deterministic_key = ""deterministic_key""
  config.active_record.encryption.key_derivation_salt = ""key_derivation_salt""
end
Rails.application.initialize!

ActiveRecord::Schema.define do
  create_table :posts, force: true do |t|
  end

  create_table :tags, force: true do |t|
  end

  create_join_table :posts, :tags, force: true do |t|
  end
end

class Post < ActiveRecord::Base
  has_and_belongs_to_many :tags
end

class Tag < ActiveRecord::Base
  has_and_belongs_to_many :posts
end

class BugTest < ActiveSupport::TestCase
  def test_habtm_strict_loading_include
    post = Post.create!
    tag = Tag.create!
    post.tags << tag

    assert Post.includes(:tags).first.tags.include?(tag)
    assert_not Post.includes(:tags).first.tags.include?(Tag.new)

    assert Post.includes(:tags).strict_loading.first.tags.include?(tag)
    assert_not Post.includes(:tags).strict_loading.first.tags.include?(Tag.new)
  end
end
```

### Expected behavior

Test passes.

### Actual behavior

The first three assertions succeed, but the last one (checking if an unpersisted model instance is a member of a pre-loaded association) raises a StrictLoadingViolationError. Sample output:
```
ActiveRecord::StrictLoadingViolationError: `Post` is marked for strict_loading. The Post::HABTM_Tags association named `:posts_tags` cannot be lazily loaded.
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/core.rb:257:in `strict_loading_violation!'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/association.rb:250:in `find_target'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_association.rb:274:in `load_target'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_proxy.rb:45:in `load_target'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_proxy.rb:1025:in `records'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/relation/delegation.rb:101:in `each'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/relation.rb:394:in `any?'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/relation.rb:394:in `any?'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_association.rb:510:in `include_in_memory?'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_association.rb:263:in `include?'
    /usr/local/rvm/gems/ruby-3.3.6/gems/activerecord-8.0.2/lib/active_record/associations/collection_proxy.rb:928:in `include?'
    habtm_strict_bug.rb:62:in `test_habtm_strict_loading_include'
```

This also occurs if the `has_and_belongs_to_many` is changed to a `has_many :through`. 

It's possible to work around this by adding additional associations to the `includes()` call, but it doesn't seem like that should be necessary.

### System configuration

**Rails version**: 8.0.2 (also occurs on `main` and goes back to 7.2 and before)

**Ruby version**: 3.3 in this case, but I don't think it matters much
","['activerecord', 'attached PR', 'With reproduction steps']",closed,2025-06-11T03:19:10Z,2025-06-16T14:28:18Z,bug,"['activerecord', 'attached pr', 'with reproduction steps']",True,5.0,
rails/rails,55178,The SQLite adapter includes cascaded deletes in row count for delete_all,"### Steps to reproduce

Since https://github.com/rails/rails/pull/55065, the SQLite adapter uses `total_changes` to count the number of rows affected when performing a query. But [total_changes](https://www.sqlite.org/c3ref/total_changes.html) includes ""changes made as part of [foreign key actions](https://www.sqlite.org/foreignkeys.html#fk_actions)"", so if there is a cascading delete the number returned is wrong.

cc @jenshenny, @skipkayhil

```ruby
# frozen_string_literal: true

require ""bundler/inline""

gemfile(true) do
  source ""https://rubygems.org""

  gem ""rails"", github: ""rails/rails"", branch: ""main""

  gem ""sqlite3""
end

require ""active_record/railtie""
require ""minitest/autorun""

# This connection will do for database-independent bug reports.
ENV[""DATABASE_URL""] = ""sqlite3::memory:""

class TestApp < Rails::Application
  config.load_defaults Rails::VERSION::STRING.to_f
  config.eager_load = false
  config.logger = Logger.new($stdout)
  config.secret_key_base = ""secret_key_base""

  config.active_record.encryption.primary_key = ""primary_key""
  config.active_record.encryption.deterministic_key = ""deterministic_key""
  config.active_record.encryption.key_derivation_salt = ""key_derivation_salt""
end
Rails.application.initialize!

ActiveRecord::Schema.define do
  create_table :posts, force: true do |t|
  end

  create_table :comments, force: true do |t|
    t.references :post, null: false, foreign_key: false
  end

  add_foreign_key ""comments"", ""posts"", column: ""post_id"", on_delete: :cascade
end

class Post < ActiveRecord::Base
  has_many :comments
end

class Comment < ActiveRecord::Base
  belongs_to :post
end

class BugTest < ActiveSupport::TestCase
  def test_it
    post = Post.create!
    comment = post.comments.create!

    assert_equal 1, Post.delete_all
  end
end
```

### Expected behavior

`Post.delete_all` should return 1

### Actual behavior

`Post.delete_all` returns 2

### System configuration

**Rails version**: rails edge (4b7fb1d14b954d2348d2065ff955466479509656)

**Ruby version**: ruby 3.3.5 (2024-09-03 revision ef084cc8f4) [x86_64-linux]
","['activerecord', 'attached PR', 'With reproduction steps']",closed,2025-06-10T13:12:40Z,2025-06-12T06:12:44Z,bug,"['activerecord', 'attached pr', 'with reproduction steps']",True,1.0,
rails/rails,55161,"When rendering a partial, any mention of the string ""render"" inside a `cache` block results in the logged error message ""Couldn't find template for digesting: strings/string""","### Steps to reproduce

Create a file `_partial.html.erb` with the following contents alongside the minimal reproduction shown below:

```ruby
<%# _partial.html.erb %>

<% cache ""key"" do %>
  <div class=""render flex"" data-action=""controller#render other-controller#click"">
    Hello, world!
  </div>
<% end %>
```

Minimal reproduction:

```
# frozen_string_literal: true

require ""bundler/inline""

gemfile(true) do
  source ""https://rubygems.org""

  gem ""rails""
end

require ""action_controller/railtie""
require ""action_view/railtie""
require ""minitest/autorun""

puts ""#{Rails::VERSION::STRING.to_f}""

class TestApp < Rails::Application
  config.load_defaults Rails::VERSION::STRING.to_f
  config.eager_load = false
  config.logger = Logger.new($stdout)
  config.secret_key_base = ""secret_key_base""
  config.action_controller.perform_caching = true
  config.action_controller.enable_fragment_cache_logging = true
  config.cache_store = :null_store
  config.paths[""app/views""] << File.expand_path(""."")
end
Rails.application.initialize!

class BugTest < ActionView::TestCase

  # this render works fine
  def test_regular_erb_render
    render inline: <<~ERB
      <% cache ""key"" do %>
        <div class=""render flex"" data-action=""controller#render other-controller#click"">
          Hello, world!
        </div>
      <% end %>
    ERB

    assert true
  end

  # rendering the same code, but as nested inline render works fine
  def test_nested_inline_render
    nested_partial = <<~ERB
      <% cache ""key"" do %>
        <div class=""render flex"" data-action=""controller#render other-controller#click"">
          Hello, world!
        </div>
      <% end %>
    ERB

    render inline: <<~ERB, locals: { nested_partial: nested_partial }
      <%= render inline: nested_partial %>
    ERB

    assert true
  end

  # rendering the same code, but as a partial on the file system fails
  def test_file_partial
    render inline: <<~ERB
      <%= render partial: ""partial"" %>
    ERB

    assert false, ""Check for 'Couldn't find template for digesting: flexes/flex' in log output ↑""
  end
end
```

### Expected behavior

Everything should render fine, cache is written, no error messages output.

### Actual behavior

When running the third test `test_file_partial` the logs will show an error message:

```
Couldn't find template for digesting: flexes/flex
Couldn't find template for digesting: others/other
```

If the string `render` appears anywhere in the partial, anything following will be assumed to be a template name (ie. `flex` in the above example), and Rails will attempt to digest it for the cache key.

It also occurs even if another symbol separates the two, like in the Stimulus action `turbo:before-stream-render@document->leaderboard#render` the error message will read ""Couldn't find template for digesting: documents/document"".  This is how I actually found the bug originally—removing the Stimulus action string in my code made the error go away.

This only occurs inside of a `cache` block, and only if the template that contains it is nested at least one level deep in partial rendering, and that partial is on the file system (as seen above it wasn't an issue when rendering an inline partial).

### System configuration

**Rails version**: 8.0

**Ruby version**: 3.4.2
","['actionview', 'attached PR']",open,2025-06-05T20:17:17Z,,bug,"['actionview', 'attached pr']",True,,
rails/rails,55154,Allow Passing Custom Locals to ActionText Attachment Partials,"## Problem

When rendering ActionText content like `<%= object.content %>`, developers cannot pass additional context or data to the attachment partials. This limits the ability to customize attachment rendering based on the current user, theme, or other application-specific data.

### Steps to reproduce

There is currently no way to pass custom locals to ActionText attachment partials. When rendering rich text content that includes attachments (e.g., embedded files via Trix), any custom partial (e.g. _blob.html.erb) receives only built-in locals (blob, in_gallery) and cannot access additional context like the current user, theme, or feature flags.

There is no possible way to do something like this (propalby we want to have different way to pass locals):
```ruby
<%= message.content.to_s(locals: { user: current_user }) %>
```

And receive those locals in custom attachment partial:
```ruby
<!-- app/views/active_storage/blobs/_blob.html.erb -->
<figure class=""attachment"">
  <% if user.admin? %>
    <span>Not publicly available data or buttons</span>
  <% end %>
</figure>
```

### Expected behavior

Custom locals passed to `ActionText::RichText#to_s(locals: ...)` should be available in the corresponding attachment partials, merged with built-in locals like in_gallery.

This would allow:
- Custom theming of attachments
- Showing current user info
- Conditional display based on permissions, localization, or feature flags


### Actual behavior

Custom locals are ignored. Attachment partials only receive built-in locals: blob, in_gallery.

Right now the best way i find to pass locals to this partials is through `Current` attributes, especially when partial is used in broadcasting. I think you can also use instance variable

### System configuration

**Rails version**: 
8.0.2

**Ruby version**: 
3.4.4
","['attached PR', 'actiontext']",open,2025-06-04T12:16:11Z,,bug,"['attached pr', 'actiontext']",True,,
rails/rails,55146,`QueuingTest#test_should_interrupt_jobs` fails with Sidekiq,"Managed to reproduce CI failure at https://buildkite.com/rails/rails/builds/118891#01972fe1-57c9-4985-890e-278284657699/1446-1457

### Steps to reproduce

```ruby
git clone https://github.com/rails/rails
cd rails/activejob
bundle install
AJ_INTEGRATION_TESTS=1 AJ_ADAPTER=sidekiq bin/test test/integration/queuing_test.rb -n test_should_interrupt_jobs
```

### Expected behavior
It should pass.

### Actual behavior
```ruby
$ bundle install
Bundle complete! 84 Gemfile dependencies, 244 gems now installed.
Use `bundle info [gemname]` to see where a bundled gem is installed.
1 installed gem you directly depend on is looking for funding.
  Run `bundle fund` for details
$ bundle info sidekiq
  * sidekiq (8.0.2)
	Summary: Simple, efficient background processing for Ruby
	Homepage: https://sidekiq.org
	Documentation: https://github.com/sidekiq/sidekiq/wiki
	Source Code: https://github.com/sidekiq/sidekiq
	Changelog: https://github.com/sidekiq/sidekiq/blob/main/Changes.md
	Bug Tracker: https://github.com/sidekiq/sidekiq/issues
	Path: /home/yahonda/.local/share/mise/installs/ruby/3.4.4/lib/ruby/gems/3.4.0/gems/sidekiq-8.0.2
$ AJ_INTEGRATION_TESTS=1 AJ_ADAPTER=sidekiq bin/test test/integration/queuing_test.rb -n test_should_interrupt_jobs
Using sidekiq
... snip warnings ...
INFO  2025-06-03T14:08:53.639Z pid=848503 tid=i9an: Sidekiq 8.0.2 connecting to Redis with options {size: 10, pool_name: ""internal"", url: nil}
Run options: -n test_should_interrupt_jobs --seed 41491

# Running:

F

Failure:
QueuingTest#test_should_interrupt_jobs [test/integration/queuing_test.rb:61]:
Expected false to be truthy.


bin/test test/integration/queuing_test.rb:50



Finished in 13.056401s, 0.0766 runs/s, 0.2298 assertions/s.
1 runs, 3 assertions, 1 failures, 0 errors, 0 skips
$
```

### System configuration

**Rails version**:  main branch including https://github.com/rails/rails/pull/55127

**Ruby version**: ruby 3.4.4 (2025-05-14 revision a38531fd3f) +PRISM [x86_64-linux]
","['activejob', 'ci issues']",open,2025-06-03T14:12:00Z,,performance,"['activejob', 'ci issues']",True,,
rails/rails,55144,Disabling ActiveStorage.touch_attachment_records causes attaching blobs to raise ActiveRecord::ActiveRecordError (Cannot touch on a new record),"After #53623, attaching a blob to a record raises
```ActiveRecord::ActiveRecordError: Cannot touch on a new or destroyed record object. Consider using persisted?, new_record?, or destroyed? before touching.``` if ```ActiveStorage.touch_attachment_records``` is false.

Reverting the commit (removing **autosave: false** from **has_many :attachments**) or setting **ActiveStorage.touch_attachment_records = true** fixes it.

### Steps to reproduce

```ruby
# frozen_string_literal: true

require ""bundler/inline""

gemfile(true) do
    source ""https://rubygems.org""

    gem ""rails"", ""~> 8.0.2""
    # If you want to test against edge Rails replace the previous line with this:
    #gem ""rails"", github: ""rails/rails"", branch: ""main""

    gem ""sqlite3""
end

require ""active_record/railtie""
require ""active_storage/engine""
require ""minitest/autorun""

ENV[""DATABASE_URL""] = ""sqlite3::memory:""

class TestApp < Rails::Application
    config.load_defaults Rails::VERSION::STRING.to_f

    config.root = __dir__
    config.hosts << ""example.org""
    config.eager_load = false
    config.session_store :cookie_store, key: ""cookie_store_key""
    config.secret_key_base = ""secret_key_base""

    config.logger = Logger.new($stdout)
    Rails.logger  = config.logger

    config.active_storage.service = :local
    config.active_storage.service_configurations = {
        local: {
                root: Dir.tmpdir,
                service: ""Disk""
               }
    }

    # setting it to true (the default), fixes it
    config.active_storage.touch_attachment_records = false

    config.active_job.queue_adapter = :inline
end
Rails.application.initialize!

require ActiveStorage::Engine.root.join(""db/migrate/20170806125915_create_active_storage_tables.rb"").to_s

ActiveRecord::Schema.define do
    CreateActiveStorageTables.new.change

    create_table :users, force: true
end

class User < ActiveRecord::Base
    has_one_attached :tmpfile
    has_many_attached :files
end

class BugTest < ActiveSupport::TestCase
    def test_attachment_create_on_has_one
        data = ""Something else entirely!""
        io = StringIO.new(data)
        blob = ActiveStorage::Blob.create_before_direct_upload! filename: ""tmp.txt"", byte_size: data.size, checksum: OpenSSL::Digest::MD5.base64digest(data)
        blob.upload(io)

        user = User.create!(
            tmpfile: blob.signed_id
        )

        assert(user.tmpfile.attached?)
    end

    def test_attachment_create_on_has_one_with_attach
        data = ""Something else entirely!""
        io = StringIO.new(data)
        blob = ActiveStorage::Blob.create_before_direct_upload! filename: ""tmp2.txt"", byte_size: data.size, checksum: OpenSSL::Digest::MD5.base64digest(data)
        blob.upload(io)

        user = User.create!

        assert_nothing_raised {
            user.tmpfile.attach(blob)
        }

        assert(user.tmpfile.attached?)
    end

    def test_attachment_create_on_has_many
        data = ""Something else entirely!""
        io = StringIO.new(data)
        blob = ActiveStorage::Blob.create_before_direct_upload! filename: ""test.txt"", byte_size: data.size, checksum: OpenSSL::Digest::MD5.base64digest(data)
        blob.upload(io)

        user = User.create!(
            files: blob.signed_id
        )

        assert(user.files.attached?)
        assert_equal(1, user.files.count)
    end
end
```

### Expected behavior

Record to be saved and blob to be attached, with corresponding ```Attachment``` being auto created, irrespective of touching the parent record.

### Actual behavior

```ActiveRecord::ActiveRecordError``` is raised. It seems ```Attachment``` for the blob isn't being saved, hence the ```:touch_attachments``` callback tries to touch non-persisted instances.

### System configuration

**Rails version**: 8.0.2 and ```main```

**Ruby version**: 3.3.7

### Notes

I think **ActiveStorage.touch_attachment_records** wasn't supposed to affect this, and only apply to whether touch the record's/parent's model or not? Within the cited PR, responsibilities of the ```Attachment``` creation seems to be changed, but not sure how it applies here.","['attached PR', 'activestorage']",open,2025-06-02T18:08:45Z,,bug,"['attached pr', 'activestorage']",True,,
rails/rails,55133,Models counter cache columns depend on load order,"### The problem

The `belongs_to` association builder has this logic ([here](https://github.com/rails/rails/blob/0ac3fba6ee5f7d1680024a4925eee6069095487b/activerecord/lib/active_record/associations/builder/belongs_to.rb#L40-L42)):

```ruby
klass = reflection.class_name.safe_constantize
klass._counter_cache_columns |= [cache_column] if klass && klass.respond_to?(:_counter_cache_columns)
model.counter_cached_association_names |= [reflection.name]
```

As we can see, there is a `safe_constantize`, therefore, if we do not have autoloading in place, that depends on load order.

This may happen, for example, in scripts using Active Record directly without autoloading.

It also happens in the Active Record test suite itself. I discovered this adding new tests that resulted in `Car` being loaded before `Person`, and that made [this assertion](https://github.com/rails/rails/blob/0ac3fba6ee5f7d1680024a4925eee6069095487b/activerecord/test/cases/counter_cache_test.rb#L451) fail.

### Steps to reproduce

This test is successful, but it does not pass if you reorder the model definitions:

```ruby
require ""bundler/inline""

gemfile(true) do
  source ""https://rubygems.org""

  gem ""activerecord""
  gem ""sqlite3""
end

require ""active_record""

class BugRecord < ActiveRecord::Base # rubocop:disable Rails/ApplicationRecord
  self.abstract_class = true
  establish_connection(adapter: 'sqlite3', database: ':memory:')
end

BugRecord.connection.tap do |conn|
  conn.create_table :posts do |t|
    t.integer :comments_count
  end

  conn.create_table :comments do |t|
    t.integer :post_id
  end
end

class Post < BugRecord
  has_many :comments
end

class Comment < BugRecord
  belongs_to :post, counter_cache: true
end

require ""minitest/autorun""
class BugTest < ActiveSupport::TestCase
  def test_counter_cache_cache_column_p
    assert Post.counter_cache_column?(""comments_count"")
  end
end
```

### System configuration

**Active Record version**: 8.0.2 (reproduced in `main` too).","['activerecord', 'With reproduction steps']",open,2025-05-31T10:42:59Z,,bug,"['activerecord', 'with reproduction steps']",True,,
laravel/framework,56068,model:prune vs models in app directory,"### Laravel Version

12.19.0

### PHP Version

8.4.9

### Database Driver & Version

_No response_

### Description

https://github.com/laravel/framework/commit/1cefdacaa796445de8747dd6800a3206e28a3b82

This refactor makes it impossible to use the command when the models are stored in the App directory, because the classes (not models) won't have an isPrunable method.

### Steps To Reproduce

php artisan model:prune --path=/app",['bug'],closed,2025-06-17T18:01:59Z,2025-06-18T12:55:10Z,bug,['bug'],False,0.0,
laravel/framework,56063,.env.testing Values Ignored During sail test --env=testing Due to Early Preloading of .env into $_SERVER,"### Laravel Version

12.18.0

### PHP Version

8.4

### Database Driver & Version

pgsql,sqlite

### Description

TLDR:

A work around until this can be fixed would be to provide test envs like this when running tests

```
docker compose exec laravel.test bash -c \
  ""APP_ENV=testing DB_CONNECTION=sqlite DB_DATABASE=':memory:' php artisan test -p $*""
```

Why this works:

It injects the test environment variables (APP_ENV, DB_CONNECTION, etc.) directly into the php process at runtime. This avoids conflicts where Laravel’s environment loader (phpdotenv) refuses to override variables already preloaded from .env by Sail.

--------------------------------------

This issue relates to a recently closed issue:

https://github.com/laravel/framework/issues/55532

I was encountering the same problem and wanted to share my findings after digging deeper.

When running Laravel tests via Docker and Sail:

`sail test --env=testing`

Laravel silently falls back to .env values instead of .env.testing. This leads to issues like DB_CONNECTION=pgsql being used in tests, even though .env.testing specifies SQLite.

Laravel’s LoadEnvironmentVariables class correctly resolves the .env.testing file when --env=testing is passed. However, by that point, environment variables from .env have already been loaded and stored in $_SERVER by Sail:

```
# vendor/laravel/sail/bin/sail
if [ -n ""$APP_ENV"" ] && [ -f ./.env.""$APP_ENV"" ]; then
  source ./.env.""$APP_ENV""
elif [ -f ./.env ]; then
  source ./.env
fi
```

This means Laravel’s env loader can't override them, due to phpdotenv’s immutability safeguard:

```
// Dotenv\Repository\Adapter\ImmutableWriter
public function write(string $name, string $value)
{
    if ($this->isExternallyDefined($name)) {
        return false;
    }
}
```

That check considers any value already present in $_SERVER as externally defined, via:

```
// vendor/vlucas/phpdotenv/src/Repository/Adapter/ServerConstAdapter.php
public function read(string $name)
{
    return Option::fromArraysValue($_SERVER, $name)
        ->filter(is_scalar)
        ->map((string) $value => ... );
}
```

Additionally, Pest's test runner reboots the app in child processes without CLI flags like --env=testing, making the issue even more persistent across runs.

here is an example stack trace showing the calls leading to this happening...

```
ServerConstAdapter.php:43, Dotenv\Repository\Adapter\ServerConstAdapter->read()
MultiReader.php:40, Dotenv\Repository\Adapter\MultiReader->read()
ImmutableWriter.php:108, Dotenv\Repository\Adapter\ImmutableWriter->isExternallyDefined()
ImmutableWriter.php:57, Dotenv\Repository\Adapter\ImmutableWriter->write()
AdapterRepository.php:87, Dotenv\Repository\AdapterRepository->set()
Loader.php:36, Dotenv\Loader\Loader::{closure:/var/www/html/vendor/vlucas/phpdotenv/src/Loader/Loader.php:27-46}()
Loader.php:27, array_reduce()
Loader.php:27, Dotenv\Loader\Loader->load()
Dotenv.php:224, Dotenv\Dotenv->load()
Dotenv.php:237, Dotenv\Dotenv->safeLoad()
LoadEnvironmentVariables.php:29, Illuminate\Foundation\Bootstrap\LoadEnvironmentVariables->bootstrap()
Application.php:341, Illuminate\Foundation\Application->bootstrapWith()
Kernel.php:473, Illuminate\Foundation\Console\Kernel->bootstrap()
Kernel.php:195, Illuminate\Foundation\Console\Kernel->handle()
Application.php:1234, Illuminate\Foundation\Application->handleCommand()
artisan:13, {main}()
```

Temporary workaround:

Override the default env loader to use mutable dotenv:

```
// vendor/laravel/framework/src/Illuminate/Foundation/Bootstrap/LoadEnvironmentVariables.php
protected function createDotenv($app)
{
    return Dotenv::createMutable(
        $app->environmentPath(),
        $app->environmentFile()
    );
}
```

This allows .env.testing to override preloaded $_SERVER values, restoring expected behaviour during test execution. While this may not be a final solution (as mutability isn't ideal for production), it shows where the conflict lies.

Hopefully this helps highlight the problem and is useful when creating a fix.


### Steps To Reproduce

Use sail with a laravel 12.18 project, make sure all composer dependencies are using the latest versions and pest tests and have both .env and .env.testing files in the root of the project with variables that should be over ridden by values in .env.testing then run tests on a running application using.

`sail test --env=testing`

a sample test case

```
<?php

it('checks the environment', function () {
    dump([
        'env' => app()->environment(),
        'db' => config('database.connections.pgsql.database'),
        '__env_file' => app()->environmentFile(),
    ]);
});
```

A sample .env file

```
APP_ENV=local
DB_CONNECTION=pgsql
DB_DATABASE=local
```

a sample .env.testing
```
APP_ENV=testing
DB_CONNECTION=sqlite
DB_DATABASE=:memory:
```

Unfortunately I already spent half a day figuring out why it wasn't working on my set up and I don't have any more free time to create a sample project, so I am just sharing everything I created along the way, I hope this will be enough.",['needs more info'],open,2025-06-17T08:00:55Z,,security,['needs more info'],True,,
laravel/framework,56058,Mail Notification fails with: Cannot serialize CurlResponse,"### Laravel Version

12.17.0

### PHP Version

8.3.7

### Database Driver & Version

_No response_

### Description

I discovered this using the Postmark driver, but it looks like it could affect Mailgun and the other API-based drivers as well.  I'm also using the Redis queue driver.

I'm trying to send a Notification via the mail channel to an email address that Postmark considers ""inactive"".  Instead of a proper error response, I get the following exception:
```
[2025-06-16 21:58:21] production.ERROR: Cannot serialize Symfony\Component\HttpClient\Response\CurlResponse {""exception"":""[object] (BadMethodCallException(code: 0): Cannot serialize Symfony\\Component\\HttpClient\\Response\\CurlResponse at /vendor/symfony/http-client/Response/CommonResponseTrait.php:124)
[stacktrace]
#0 [internal function]: Symfony\\Component\\HttpClient\\Response\\CurlResponse->__sleep()
#1 /vendor/laravel/framework/src/Illuminate/Queue/Queue.php(172): serialize()
#2 /vendor/laravel/framework/src/Illuminate/Queue/Queue.php(140): Illuminate\\Queue\\Queue->createObjectPayload()
#3 /vendor/laravel/framework/src/Illuminate/Queue/RedisQueue.php(231): Illuminate\\Queue\\Queue->createPayloadArray()
#4 /vendor/laravel/horizon/src/RedisQueue.php(89): Illuminate\\Queue\\RedisQueue->createPayloadArray()
#5 /vendor/laravel/framework/src/Illuminate/Queue/Queue.php(112): Laravel\\Horizon\\RedisQueue->createPayloadArray()
#6 /vendor/laravel/horizon/src/RedisQueue.php(47): Illuminate\\Queue\\Queue->createPayload()
#7 /vendor/laravel/framework/src/Illuminate/Queue/Queue.php(63): Laravel\\Horizon\\RedisQueue->push()
#8 /vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(636): Illuminate\\Queue\\Queue->pushOn()
#9 /vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(555): Illuminate\\Events\\Dispatcher->queueHandler()
#10 /vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(481): Illuminate\\Events\\Dispatcher->Illuminate\\Events\\{closure}()
#11 /vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(288): Illuminate\\Events\\Dispatcher->Illuminate\\Events\\{closure}()
#12 /vendor/laravel/framework/src/Illuminate/Events/Dispatcher.php(268): Illuminate\\Events\\Dispatcher->invokeListeners()
#13 /vendor/fntneves/laravel-transactional-events/src/Neves/Events/TransactionalDispatcher.php(110): Illuminate\\Events\\Dispatcher->dispatch()
#14 /vendor/laravel/framework/src/Illuminate/Notifications/NotificationSender.php(169): Neves\\Events\\TransactionalDispatcher->dispatch()
```
The actual error message from Postmark was completely missing.  When the Postmark driver doesn't receive a 200 response, it throws a `Symfony\Component\Mailer\Exception\HttpTransportException` that contains the `Symfony\Component\HttpClient\Response\CurlResponse` object.  Laravel then catches this exception in `\Illuminate\Notifications\NotificationSender::sendToNotifiable` and tries to dispatch a `NotificationFailed` event containing the `HttpTransportException`.  When Laravel tries to serialize the event to place on the queue, the above error message is thrown.

Proposal: In `NotificationSender`, if a `HttpTransportException` is caught, don't include it in the `NotificationFailed` event.  Instead, create a generic `Symfony\Component\Mailer\Exception\TransportException` without the response object, but containing the *message* from the `HttpTransportException`.  e.g. `$exception = new TransportException($exception->getMessage(), $exception->getCode())`.  This way the `NotificationFailed` event will dispatch correctly, and the `HttpTransportException` will appear in the logs (if the user doesn't catch it).

I think this could be a breaking change for someone using the `sync` queue driver *and* doing something with the response object in a `NotifictionFailed` handler.

For reference, here's what that error message actually looks like:
```
Symfony\Component\Mailer\Exception\HttpTransportException(code: 0): Unable to send an email: You tried to send to recipient(s) that have been marked as inactive. Found inactive addresses: xxx@yyy.zzz. Inactive recipients are ones that have generated a hard bounce, a spam complaint, or a manual suppression. (code 406). at /vendor/symfony/postmark-mailer/Transport/PostmarkApiTransport.php:91
```

I will submit a PR with this fix, but am interested in any alternate solutions.

### Steps To Reproduce

1. Install and configure Postmark mail driver
2. Try to send a Notification on the mail channel to an ""inactive"" email address
3. ""Cannot serialize CurlResponse"" error thrown",['bug'],closed,2025-06-16T23:45:46Z,2025-06-18T18:54:16Z,bug,['bug'],False,1.0,
laravel/framework,56053,[Breeze/Jetstream] Inertia middleware not added to bootstrap/app.php,"### Laravel Version

12.x

### PHP Version

8.2

### Database Driver & Version

Sqllite / Any

### Description

When installing Laravel Breeze (Vue/Inertia stack) or Jetstream (Inertia stack) into a fresh project created with `composer create-project`, the installation command does not add the required `HandleInertiaRequests` middleware to the `web` group in `bootstrap/app.php`. This prevents Inertia from functioning correctly.

### Steps To Reproduce

1. Create a fresh Laravel project using Composer:
`composer create-project laravel/laravel Your-App-Name`

2. Require either the Breeze or Jetstream package:

> For Breeze:
> `composer require laravel/breeze --dev`
> 
> For Jetstream:
> `composer require laravel/jetstream`

3. Run the corresponding install command for an Inertia stack:

> For Breeze:
> `php artisan breeze:install vue`
> 
> For Jetstream:
> `php artisan jetstream:install inertia`

4. Observe the contents of the bootstrap/app.php file.

### Observed Behavior (The Bug)
After running the installation, the bootstrap/app.php file remains unchanged and is missing the Inertia middleware. The withMiddleware section looks like this:

```
->withMiddleware(function (Middleware $middleware): void {
    //
})
```

### Expected Behavior (The Fix)
The breeze:install or jetstream:install command should automatically modify bootstrap/app.php to append the necessary middleware for Inertia to work. The withMiddleware section should look like this:

```
->withMiddleware(function (Middleware $middleware): void {
    $middleware->web(append: [
        \App\Http\Middleware\HandleInertiaRequests::class,
        \Illuminate\Http\Middleware\AddLinkHeadersForPreloadedAssets::class,
    ]);
})

```",['bug'],closed,2025-06-16T16:01:24Z,2025-06-17T13:07:21Z,bug,['bug'],False,0.0,
laravel/framework,55944,Validator unhandeled MathException,"### Laravel Version

v12.14.1

### PHP Version

8.4

### Database Driver & Version

_No response_

### Description

On specific input $validator->fails() throws exception instead of returning bool

### Steps To Reproduce

Run this code and you will get an exception instead of var_dump output.
Illuminate\Support\Exceptions\MathException - Scientific notation exponent outside of allowed range.
```
$validator = \Validator::make([
        'amount' => '000542e-110880933569',
    ], [
        'amount' => 'numeric|between:0.9,10',
    ]);

    var_dump($validator->fails()); // throws MathException instead of returning boolean
```",['bug'],closed,2025-06-06T09:05:21Z,2025-06-13T02:11:36Z,bug,['bug'],False,6.0,
laravel/framework,55887,Warning from symfony/console when running composer run dev,"### Laravel Version

12.16.0

### PHP Version

8.3.14

### Database Driver & Version

_No response_

### Description

When running `composer run dev`, there is a repeated truncated warning from symfony/console 7.3:

```
[logs] WARNING Since symfony/console 7.3: Method ""Symfony\Component\Console\Command\Comman...
```

Unable to see the full warning. No warning is reported in `storage/logs`.

### Steps To Reproduce

1. Create a Laravel application with the latest version of Laravel Installer (5.15.0).
2. Run `composer run dev`.
3. See warning in console

",['bug'],closed,2025-05-29T21:46:18Z,2025-06-03T13:37:58Z,bug,['bug'],False,4.0,
laravel/framework,55831,"response()->stream() params inconsistent with Symfony, breaks Livewire","### Laravel Version

12.15.0

### PHP Version

8.3

### Database Driver & Version

_No response_

### Description

In v12.15.0 release, Illuminate/Routing/ResponseFactory::stream() (i.e. response()->stream()) [had a change from directly returning a new Symfony StreamedResponse to performing other actions first](https://github.com/laravel/framework/commit/a9bfc0d37d1580bdafe39735b12fa8656fb3f24b) and then instantiating the StreamedResponse. The Symfony StreamedResponse parameters can take a null ""$callable"" value, so passing null in for response()->stream() was possible before v12.15.0 but not after, due to the introduced code.

While the signature of ResponseFactory::stream() does not indicate that null is allowed for the $callable parameter, it worked before v12.15.0 and the Symfony StreamedResponse that it wraps accepts null, so it seems more like an oversight than truly intended requirement to pass the $callable.

I'm reporting this because it breaks streaming in Livewire. Livewire calls response()->stream() explicitly with a null value for $callable (see [Features/SupportStreaming/SupportStreaming line 22](https://github.com/livewire/livewire/blob/796aa7441e0374229e6a1cba800d2abf90761432/src/Features/SupportStreaming/SupportStreaming.php#L22)). Granted, this is a Livewire error for not adhering to the function signature, but it may affect other applications that similarly were passing null to response()->stream() and successfully getting a streamed response.

### Steps To Reproduce

**v12.14.1:**
```bash
$ php artisan tinker
Psy Shell v0.12.8 (PHP 8.3.15 — cli) by Justin Hileman
> response()->stream(null)->getStatusCode()
= 200
```

**v12.15.0:**
```bash
$ php artisan tinker
Psy Shell v0.12.8 (PHP 8.3.15 — cli) by Justin Hileman
> response()->stream(null)->getStatusCode()
ReflectionException  Function () does not exist.
```",['bug'],closed,2025-05-22T18:16:00Z,2025-05-23T14:32:56Z,bug,['bug'],False,0.0,
laravel/framework,55793,"Preloaded JS file triggers warning: ""was preloaded but not used within a few seconds"" in Laravel app using Vite","### Laravel Version

12.15.X

### PHP Version

8.4

### Database Driver & Version

Sqlite

### Description

In my Larave 10.4.1 application using Vite for asset bundling, I'm getting the following browser warning in the console when i use `aggresive` prefetching:

```
The resource https:/<...>/app-l0sNRNKZ.js was preloaded using link preload but not used within a few seconds from the window's load event.
Please make sure it has an appropriate `as` value and it is preloaded intentionally.
This happens even though the app.js file is included with the `@vite('resources/js/app.js')` directive in my Blade layout, and the generated preload link uses `rel=""modulepreload""`.
```

It appears that the asset is preloaded correctly, but the browser considers it unused shortly after load, possibly due to how Vite or Laravel delays its usage via dynamic import or defer.

### Steps To Reproduce

Any laravel project",['help wanted'],open,2025-05-20T16:51:33Z,,performance,['help wanted'],True,,
laravel/framework,55720,Conditions being dropped when updating custom pivot classes,"### Laravel Version

12.12.0

### PHP Version

8.3.6

### Database Driver & Version

_No response_

### Description

After fixing #55026, there's a new issue when updating pivot tables with `sync()`. Conditions set by `wherePivot()` are no longer being applied, which results in more rows being updated than expected.


### Steps To Reproduce


This is how I define my relationship:
```
  public function texts(int $reportId):BelongsToMany{
    return $this->belongsToMany(Text::class,'orders_texts','order_id','text_id')
      ->wherePivot('report_id',$reportId)
      ->using(OrderText::class)
      ->withPivot(
        [
          'report_id',
          'included',
          'content',
          'status',
          'comment'
        ]
      )
      ->withTimestamps();
  }
```

I then run the following code:
```
  $order->texts(123)->sync(
    [
      1=>[
        'included'=>true,
        'content'=>'Test',
        'status'=>null,
        'comment'=>null
      ]
    ]
  );
```

The query actually being run is the following:
```
  update ""orders_texts"" set ""content"" = ?, ""updated_at"" = ? where ""order_id"" = ? and ""text_id"" = ?""
```

This is missing the `report_id` condition which I set with `wherePivot()`, so all the rows in `orders_texts` with `text_id=1` and `order_id=5` (5 is the order ID) are being updated.

The query should include `report_id`, ie:
```
  update ""orders_texts"" set ""content"" = ?, ""updated_at"" = ? where ""report_id"" = ? and ""order_id"" = ? and ""text_id"" = ?""
```
","['bug', 'help wanted']",closed,2025-05-12T16:01:31Z,2025-05-22T01:35:22Z,bug,"['bug', 'help wanted']",False,9.0,
laravel/framework,55713,"Lowercase subfolder names in View/Components generated by ""artisan make:component"" not recognised on Linux","### Laravel Version

12.x

### PHP Version

8.2

### Database Driver & Version

_No response_

### Description

When making a components with the `php artisan make:component` command, if the provided component name contains a lowercase subfolder, for example `php artisan make:component book/Form`, the created subfolder name is not recognised on a production Linux host.

The solution was to change `App/Views/Components/book` to `App/Views/Components/Book`.

Does it make sense to implement this constraint in the `make:component` command, making the View subfolder name `lcfirst` on creation? 

### Steps To Reproduce

Run command:

`php artisan make:component book/Form`

Place `dd();` in the constructor of Form.php.
Deploy to Linux host with apache2. 

The `dd()` is not fired.

Rename  `App/Views/Components/book` to `App/Views/Components/Book` and retry.

The `dd()` is fired.",['help wanted'],closed,2025-05-12T08:21:23Z,2025-06-01T01:45:19Z,bug,['help wanted'],True,19.0,
vuejs/vue,13164,function setCurrentInstance(vm) crashes when vm._scope is undefined,"### Vue version

2.7

### Link to minimal reproduction

http://

### Steps to reproduce

```
var app = new Vue( 
    {
            mixins: [ any_mixin ],
            el: '#app',
            ...
    }
)
    
```

### What is expected?

Vue application will be created

### What is actually happening?

Creation crashes in function setCurrentInstance(vm) since currentInstance._scope is undefined for `callHook$1(vm, 'created');`

### System Info

_No response_

### Any additional comments?

Solution:
```
function setCurrentInstance(vm) {
      if (vm === void 0) { vm = null; }
      if (!vm)
          currentInstance && currentInstance._scope && currentInstance._scope.off();
      currentInstance = vm;
      vm && vm._scope && vm._scope.on();
  }
```",['need repro'],closed,2024-02-01T16:08:56Z,2024-02-02T14:45:49Z,bug,['need repro'],True,0.0,
vuejs/vue,13104,Vue 2.7 strictTemplates error,"https://github.com/xiaoxiangmoe/issue-vue-2.7-on-click-type-error.git

```
pnpm run type-check
```

```
src/App.vue:12:6 - error TS2559: Type '{ onClick: any; }' has no properties in common with type 'Readonly<Partial<{}> & Omit<Readonly<ExtractPropTypes<{ border: { type: PropType<boolean>; }; }>>, never>>'.

12     <HelloWorld @click=""handleClick"" />
        ~~~~~~~~~~


Found 1 error in src/App.vue:12
```


---
HelloWorld.vue
```vue
<script setup lang=""ts"">

interface ButtonProps {
    border?: boolean; 
}

const props = defineProps<ButtonProps>() 
defineEmits<{
    (event: 'click',payload: MouseEvent): void
}>()
</script>
<template>
    <div id=""app"">
        <button @click=""$emit('click', $event)"">Click me</button>
    </div>
</template>
```

This error come since vue-tsc 1.7.12",['bug'],open,2023-10-17T05:42:32Z,,bug,['bug'],False,,
vuejs/vue,13052,compiler-sfc not compatible with prettier v3,"### Version
2.7.14

### Reproduction link
I think it's not necessary as it's obvious in source code



### Steps to reproduce
Install prettier v3  in a project depending on vue/compiler-sfc v2

### What is expected?
No error

### What is actually happening?
Fail in compiling template.

I found compiler-sfc tried to format code with API of prettier but `format` of Prettier becomes async in v3 and it returns a Promise instead of string.

https://github.com/vuejs/vue/blob/49b6bd4264c25ea41408f066a1835f38bf6fe9f1/packages/compiler-sfc/src/compileTemplate.ts#L179

<!-- generated by vue-issues. DO NOT REMOVE -->","['bug', 'improvement', 'has workaround']",closed,2023-07-13T12:46:51Z,2023-12-06T07:49:43Z,bug,"['bug', 'improvement', 'has workaround']",False,145.0,
vuejs/vue,13037,Compiler-sfc generates ES5 code with arrow functions which breaks IE11. ,"### Vue version

2.7

### Link to minimal reproduction

https://github.com/granowski-bamboo/vue27-arrow-fn-ie11-thing/tree/main

### Steps to reproduce

One repository provided is checked out.
Run
`npm install`
`npm run build'

### What is expected?

The dist folder should contain javascript that has been compiled down to ES5. 

### What is actually happening?

The dist folder should contain javascript that has been compiled down to ES5. 
The JavaScript should be as compatible as possible with older browsers. Vue 2.6 still supported IE11 (based on an actual project we're running here at Bamboo Health) and as of Vue 2.7 the arrow functions were added which breaks IE11.

### System Info

```shell
System:
    OS: macOS 13.4
    CPU: (8) x64 Intel(R) Core(TM) i5-1038NG7 CPU @ 2.00GHz
    Memory: 29.20 MB / 16.00 GB
    Shell: 5.9 - /bin/zsh
  Binaries:
    Node: 20.3.0 - ~/.nvm/versions/node/v20.3.0/bin/node
    Yarn: 1.22.19 - ~/.yarn/bin/yarn
    npm: 9.6.7 - ~/.nvm/versions/node/v20.3.0/bin/npm
  Browsers:
    Chrome: 114.0.5735.133
    Edge: 114.0.1823.55
    Safari: 16.5
  npmPackages:
    vue: ^2.7.7 => 2.7.14
```


### Any additional comments?

At Bamboo Health we have some Vue applications, we unfortunately have a lot of Healthcare partners that still use IE11...
Unfortunately some of our partners have deals with companies like Microsoft to get private support for IE11 even after its official death by Microsoft.
Our product group and security group has asked us to ensure our applications meet a high-trust environment. We're trying to upgrade our apps to Vue 2.x latest or Vue 3 as possible and ran into this problem where IE11 breaks with Vue 2.7",['need repro'],closed,2023-06-20T14:27:44Z,2023-12-14T01:26:13Z,security,['need repro'],True,176.0,
vuejs/vue,12939,"setCurrentInstance is not exported, causes instance fixes to be unavailable","### What problem does this feature solve?
The Why:
1. We need to use Composition API in our project as preparation for Vue 3 + Nuxt 3 migration
2. Nuxt Bridge is not stable enough, so we use Nuxt Composition API
3. Internally, Nuxt Composition API uses Vue's native instance realization
4. Nuxt Composition API doesn't have helper functions for context fixing, unlike Nuxt 3/Nuxt Bridge (can't use yet)
5. We lose instance after calling one await without able to restore
6. All Nuxt helpers become unavailable with ""This must be called within a setup function"" error

Example usage:

```typescript
import { defineComponent, onMounted, ref, getCurrentInstance, setCurrentInstance } from 'vue';
//...
        const instance = getCurrentInstance();
        onMounted(async () => {
            await someAsync();
            setCurrentInstance(instance?.proxy); //not exported right now
            store.action(); //Uses Nuxt Helpers, which are unavailable without instance
        });
```
### What does the proposed API look like?
setCurrentInstance is exported just like getCurrentInstance does

<!-- generated by vue-issues. DO NOT REMOVE -->",['need repro'],closed,2023-01-23T11:58:36Z,2023-01-23T13:34:17Z,bug,['need repro'],True,0.0,
vuejs/vue,12901,bind style merge not as expected,"### Version
2.7.14

### Reproduction link
[codesandbox.io](https://codesandbox.io/s/style-merge-9hltuv)







### Steps to reproduce

click mStyle button twice

### What is expected?
show red border-right and blue border-bottom

### What is actually happening?
only show red border-right. is not similar as setAttribute but vue3 is similar like setAttribute

---
is this a bug?

<!-- generated by vue-issues. DO NOT REMOVE -->",['bug'],closed,2022-12-15T04:35:32Z,2023-12-06T15:17:57Z,bug,['bug'],False,356.0,
vuejs/vue,12837,'WeakMap' is undefined in Vue 2.7.11 and above (IE10 and under),"### Version
2.7.11

### Reproduction link
[github.com](https://github.com/gingerbenw/vue2-minimal)

### Steps to reproduce
Open a Vue2 app using internet explorer 10 or below

### What is expected?
App loads and 'Hello Vue!' is displayed

### What is actually happening?
App does not load and 'WeakMap' is undefined is printed to the console

---
WeakMap is not supported in Internet Explorer 10 or less and was introduced to Vue in version [2.7.11](https://github.com/vuejs/vue/blob/main/CHANGELOG.md#2711-2022-10-11)

<!-- generated by vue-issues. DO NOT REMOVE -->","['regression', 'has workaround']",closed,2022-10-18T09:47:01Z,2022-11-09T12:36:51Z,bug,"['regression', 'has workaround']",True,22.0,
vuejs/vue,12822,"Current instance does not have CSS module named ""$style"" ","### Version
2.7.11

### Reproduction link
[codesandbox.io](https://codesandbox.io/s/current-instance-does-not-have-css-module-llfb0u)

### Steps to reproduce
Using CSS modules to define styles in a component.

### What is expected?
It should not throw the error.

Reverting back to `v2.7.10`, it logs the actual CSS module class.

<img width=""319"" alt=""CleanShot 2022-10-12 at 15 02 18@2x"" src=""https://user-images.githubusercontent.com/29014463/195306648-25ece747-2034-459d-96d0-974eb6868111.png"">

### What is actually happening?
It's throwing an error in console.

`Current instance does not have CSS module named ""$style""`

<img width=""512"" alt=""CleanShot 2022-10-12 at 15 01 44@2x"" src=""https://user-images.githubusercontent.com/29014463/195306444-50b19bb6-2796-4c38-bfa2-117a0e5a9dda.png"">

<!-- generated by vue-issues. DO NOT REMOVE -->",['regression'],closed,2022-10-12T09:32:51Z,2022-10-12T13:23:55Z,bug,['regression'],True,0.0,
vuejs/vue,12821,Issue on the props definition after update from 2.7.10 to 2.7.11,"### Version
2.7.11

### Reproduction link
[codesandbox.io](https://codesandbox.io/s/brave-brook-i13qh2?file=/index.html)







### Steps to reproduce
After update the vue version from 2.7.10 to 2.7.11 the below prop declaration do not work anymore:

``` js
props: {
    btnEditName: {
        type: String,
        required: false,
        default () {
            return this.$t('ui.common.edit');
        },
    },
}
```

Here is the error that I get on the browser:


vendor.js?id=1e442c890616af120be86f4594f164b7:2 TypeError: Cannot read properties of undefined (reading '_t')
    at I.t.$t (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:558340)
    at a.default (app.js?id=76bc79b9d368bc3b9486130d861347b7:2:153982)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692078
    at qr (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692088)
    at o (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695159)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695222
    at t._init (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695235)
    at new a (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692574)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:685664
    at init (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:685695)

I rolledback to the version 2.7.10, and all works fine. 

### What is expected?
Declare a prop like 

``` js
props: {
    btnEditName: {
        type: String,
        required: false,
        default () {
            return this.$t('ui.common.edit');
        },
    },
}
```

### What is actually happening?
This error:

vendor.js?id=1e442c890616af120be86f4594f164b7:2 TypeError: Cannot read properties of undefined (reading '_t')
    at I.t.$t (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:558340)
    at a.default (app.js?id=76bc79b9d368bc3b9486130d861347b7:2:153982)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692078
    at qr (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692088)
    at o (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695159)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695222
    at t._init (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:695235)
    at new a (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:692574)
    at vendor.js?id=1e442c890616af120be86f4594f164b7:2489:685664
    at init (vendor.js?id=1e442c890616af120be86f4594f164b7:2489:685695)

<!-- generated by vue-issues. DO NOT REMOVE -->",['regression'],closed,2022-10-11T19:08:15Z,2022-10-12T13:23:54Z,bug,['regression'],True,0.0,
vuejs/vue,12807,css v-bind not working after build (production mode),"### Version
2.7.10

### Reproduction link
[https://github.com/haomo-studio/element-ui-vite-vue2](https://github.com/haomo-studio/element-ui-vite-vue2)







### Steps to reproduce
1. npm run build
2. publish dist/ to nginx
3. browse url: /HmBgCard in development & production mode. They are different!

### What is expected?
v-bind work in production mode

### What is actually happening?
css v-bind not working in production mode, but working in development mode

<!-- generated by vue-issues. DO NOT REMOVE -->",['need repro'],open,2022-09-28T03:08:40Z,,bug,['need repro'],True,,
docker/compose,12956,"[BUG] Not generating a ""cache-to"" field when COMPOSE_BAKE=true from yaml","### Description

With `COMPOSE_BAKE=true` being the new default now, I happened to spot our caches not being pushed anymore using our `cache-to` fields setup in our `compose.yaml` configuration files.

Unsure if there is something we are missing here or something has been misunderstood by me or whether something else needs to be configured on our hosts to enable the behaviour? We were using the `buildkit` builder setup with the `docker-container`  driver.

We have changed the default for now back to `false` but want to understand if this is intended and there is some sort of misuse on our end or a bug? Thank you, appreciate any help here! 👍🏼 

### Steps To Reproduce

1. Create a test `compose.yaml` file with bare minimum configuration to reproduce this issue.

```
services:
  my-app:
    build:
      cache_from:
        - type=registry,ref=my-registry.com/my-app:main
      cache_to:
        - type=registry,ref=my-registry.com/my-app:main
```

2. Run the `docker compose` command with `--verbose` mode to show the `bake` definition output:

```
docker compose --verbose -f compose.yaml build my-app
```

3. Debug output will show what the `bake` definition generated, which is exactly what I'm seeing with no caches being pushed to the registry. This will only show the `cache-from` fields generating:

```json
TRAC[0000] Docker Desktop integration not enabled
DEBU[0000] bake build config:
{
  ""group"": {
    ""default"": {
      ""targets"": [
        ""my-app""
      ]
    }
  },
  ""target"": {
    ""auditmatic"": {
      ""context"": ""/var/lib/home/tmp"",
      ""dockerfile"": ""/var/lib/home/tmp/Dockerfile"",
      ""tags"": [
        ""my-app""
      ],
      ""cache-from"": [
        ""type=registry,ref=my-registry.com/my-app:main""
      ],
      ""output"": [
        ""type=docker,load=true,push=false""
      ]
    }
  }
}
```

4. Use the raw `docker buildx --print` command to see how it generates outside of compose and is correct with the fields presented:

```
{
  ""group"": {
    ""default"": {
      ""targets"": [
        ""my-app""
      ]
    }
  },
  ""target"": {
    ""my-app"": {
      ""context"": ""."",
      ""dockerfile"": ""Dockerfile"",
      ""cache-from"": [
        {
          ""ref"": ""my-registry.com/my-app:main"",
          ""type"": ""registry""
        },
      ],
      ""cache-to"": [
        {
          ""mode"": ""max"",
          ""ref"": ""my-registry.com/my-app:main"",
          ""type"": ""registry""
        }
      ],
    }
  }
}

```

### Compose Version

```Text
v2.37.1
```

### Docker Environment

```Text
Client: Docker Engine - Community
 Version:    28.2.2
 Context:    default
 Debug Mode: false
 Plugins:
  buildx: Docker Buildx (Docker Inc.)
    Version:  v0.23.0
    Path:     /usr/libexec/docker/cli-plugins/docker-buildx
  compose: Docker Compose (Docker Inc.)
    Version:  v2.37.1
    Path:     /usr/libexec/docker/cli-plugins/docker-compose

Server:
 Containers: 5
  Running: 5
  Paused: 0
  Stopped: 0
 Images: 5
 Server Version: 28.2.2
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: systemd
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 CDI spec directories:
  /etc/cdi
  /var/run/cdi
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 05044ec0a9a75232cad458027ca83437aae3f4da
 runc version: v1.2.5-0-g59923ef
 init version: de40ad0
 Security Options:
  apparmor
  seccomp
   Profile: builtin
  userns
  cgroupns
 Kernel Version: 6.11.0-1015-gcp
 Operating System: Ubuntu 24.04.2 LTS
 OSType: linux
 Architecture: x86_64
 CPUs: 8
 Total Memory: 31.34GiB
 Name: ferocia-builder-3004
 ID: 3f43c53f-e2ed-4e3c-b5a2-3924b66da522
 Docker Root Dir: /var/lib/docker/2000.2000
 Debug Mode: false
 Experimental: true
 Insecure Registries:
  ::1/128
  127.0.0.0/8
 Live Restore Enabled: false
 Default Address Pools:
   Base: 172.17.0.0/20, Size: 26
   Base: 172.17.16.0/20, Size: 26
   Base: 172.17.32.0/20, Size: 26
```

### Anything else?

_No response_","['kind/bug', 'status/0-triage']",closed,2025-06-20T00:32:27Z,2025-06-22T05:44:40Z,bug,"['kind/bug', 'status/0-triage']",True,2.0,
docker/compose,12955,[BUG] docker compose build fails with `--host`,"### Description

Have a compose file to build a container. When connecting to a remote host (with `--host`) image is built, however it ends up in the local docker image store, not the remote one. 
This results in the image not being available when creating the container.

```
[+] Running 2/3
 ✔ container                  Built                                                                                                                                                                                                                                                        
 ✘ Container container            Error response from daemon: No such image: container:latest  
```

The container that was built can be found at `docker images` but not in `docker --host <remote> images`


Works as expected on v2.36.2 so it seems v2.37.0 introduced this bug.

### Steps To Reproduce

```yaml
services:
  container:
    build:
      context: path-to-container
    pull_policy: build
```

`docker --host <remote host> compose up`

Container will be built but will not be found on the remote host:

`Error response from daemon: No such image: container:latest`

### Compose Version

```Text
v2.37.0
v2.37.1
```

### Docker Environment

```Text
Client:
 Version:    28.1.1-1
 Context:    default
 Debug Mode: false
 Plugins:
  buildx: Docker Buildx (Docker Inc.)
    Version:  0.25.0-1
    Path:     /usr/libexec/docker/cli-plugins/docker-buildx
  compose: Docker Compose (Docker Inc.)
    Version:  v2.37.0
    Path:     /usr/libexec/docker/cli-plugins/docker-compose

Server:
 Containers: 9
  Running: 3
  Paused: 0
  Stopped: 6
 Images: 25
 Server Version: 27.2.0
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 nvidia runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 8fc6bcff51318944179630522a095cc9dbf9f353
 runc version: v1.1.13-0-g58aa920
 init version: de40ad0
 Security Options:
  seccomp
   Profile: unconfined
  cgroupns
 Kernel Version: 6.6.87.2-microsoft-standard-WSL2
 Operating System: Docker Desktop
 OSType: linux
 Architecture: x86_64
 CPUs: 12
 Total Memory: 31.22GiB
 Name: docker-desktop
 ID: c5df9fc4-1f38-48c7-a228-4e1e8cae6bff
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 HTTP Proxy: http.docker.internal:3128
 HTTPS Proxy: http.docker.internal:3128
 No Proxy: hubproxy.docker.internal
 Labels:
  com.docker.desktop.address=unix:///var/run/docker-cli.sock
 Experimental: false
 Insecure Registries:
  hubproxy.docker.internal:5555
  127.0.0.0/8
 Live Restore Enabled: false

WARNING: daemon is not using the default seccomp profile
```

### Anything else?

_No response_",['kind/bug'],open,2025-06-19T05:33:44Z,,performance,['kind/bug'],True,,
docker/compose,12953,[BUG] docker compose up with --wait and a provider exits as soon as provider is done,"### Description

I would expect all the services to be up and running before exiting.

### Steps To Reproduce

Use the following compose file:
```yaml
services:
  docker-model-runner:
    provider:
      type: model
      options:
        model: ai/smollm2:135M-Q4_K_M

  backend:
    image: nginx
    depends_on:
      - docker-model-runner
```
and then `docker compose up --wait`: the compose command will exit almost immediately, before the actual backend service is up and running. 

### Compose Version

```Text

```

### Docker Environment

```Text

```

### Anything else?

_No response_",['kind/bug'],open,2025-06-18T15:12:45Z,,bug,['kind/bug'],True,,
docker/compose,12940,[BUG] `docker compose images --format json` is missing the` ContainerName` field compared to 2.36.x,"### Description

2.36.x's `docker compose images --format json` contained the `ContainerName` field; since 2.37.1 it does not contain this field anymore, but it does contain `Platform` which wasn't there before.

(I apparently mislooked in https://github.com/docker/compose/issues/12916#issuecomment-2952954425; while #12917 restored the list output, it did not restore the `ContainerName` field.)

The `ContainerName` information has been removed in #12856 (which caused the breaking change for 2.37.0 that got reverted in #12917).

While the field was actively removed in #12856, there has been no announcement in the changelog of this breaking change, so I'm reporting this as a bug. 

### Steps To Reproduce

Run `docker compose images --format json` with 2.36.x and 2.37.1 or `main`.

### Compose Version

```Text
2.37.1 / `main` branch
```

### Docker Environment

```Text

```

### Anything else?

_No response_",['kind/bug'],closed,2025-06-14T13:36:14Z,2025-06-16T07:42:09Z,bug,['kind/bug'],True,1.0,
docker/compose,12938,[BUG] building w/ compose bake always results in `NotFound desc = no such job xxxxxxxxx` errors,"### Description

I don't have a minimal reproduction scenario at this point, but we've tried to switch to compose bake as the build engine for our existing docker compose project for a while and we always get the same type of error coming from a random container.

The errors look as follows:
```
08:43:09  #141 exporting layers 0.4s done
08:43:12  target some-container: failed to receive status: rpc error: code = NotFound desc = no such job xxxxe8yk4gxypivxclixworqh
```

We've tried all docker compose versions since the feature is available (including 2.37.1 from a day ago) and all of them produce the same results.

Any idea what it could be or how we can help diagnose it?

### Steps To Reproduce

1. enable bake as the build engine w/ `COMPOSE_BAKE=true`
2. build a previously working project w/ `docker compose build --with-dependencies <A LIST OF CONTAINERS>`
3. see it error out on an arbitrary container with the following error: `target some-container: failed to receive status: rpc error: code = NotFound desc = no such job xxxxe8yk4gxypivxclixworqh`

### Compose Version

```Text
2.36.1
2.36.2
2.37.0
2.37.1
```

### Docker Environment

```Text
Client: Docker Engine - Community
 Version:    28.2.1
 Context:    default
 Debug Mode: false
 Plugins:
  buildx: Docker Buildx (Docker Inc.)
    Version:  v0.24.0
    Path:     /usr/libexec/docker/cli-plugins/docker-buildx
  compose: Docker Compose (Docker Inc.)
    Version:  v2.37.1
    Path:     /home/xxx/.docker/cli-plugins/docker-compose

Server:
 Containers: 1
  Running: 1
  Paused: 0
  Stopped: 0
 Images: 139
 Server Version: 28.2.1
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: systemd
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 CDI spec directories:
  /etc/cdi
  /var/run/cdi
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 05044ec0a9a75232cad458027ca83437aae3f4da
 runc version: v1.2.5-0-g59923ef
 init version: de40ad0
 Security Options:
  apparmor
  seccomp
   Profile: builtin
  cgroupns
 Kernel Version: 5.10.0-31-cloud-amd64
 Operating System: Debian GNU/Linux 11 (bullseye)
 OSType: linux
 Architecture: x86_64
 CPUs: 4
 Total Memory: 14.27GiB
 Name: xxxx
 ID: 20e43fc1-f756-441c-aa46-ab1a663b48ae
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 Username: sisubot
 Experimental: false
 Insecure Registries:
  ::1/128
  127.0.0.0/8
 Live Restore Enabled: false
```

**Note**: Error also occurred with older 27.x versions.

### Anything else?

_No response_",['kind/bug'],open,2025-06-13T07:00:52Z,,bug,['kind/bug'],True,,
docker/compose,12937,concurrent map write by provider,"### Description

happens when a service depends on 2 or more services with providers
https://github.com/docker/compose/blob/ea48480d809a03e4abe0a81f69be66bf7b85bcd9/pkg/compose/plugins.go#L77

### Steps To Reproduce

_No response_

### Compose Version

```Text

```

### Docker Environment

```Text

```

### Anything else?

_No response_",['kind/bug'],open,2025-06-12T09:20:22Z,,bug,['kind/bug'],True,,
docker/compose,12934,Support for Apple Containers,"### Description

Apple released a tool to run Linux containers, optimized for Apple Silicon: [https://github.com/apple/container](https://github.com/apple/container).

Is there any plan for docker-compose to support this engine ?","['kind/feature', 'status/0-triage']",closed,2025-06-11T14:19:51Z,2025-06-12T05:49:05Z,bug,"['kind/feature', 'status/0-triage']",True,0.0,
docker/compose,12927,The default-created network disappears on Windows after OS restart,"### Description

When using Windows-based containers, sometimes I cannot start my compose project after the OS restart. The following error is displayed:

> time=""2025-05-10T22:11:32+02:00"" level=warning msg=""a network with name local_default exists but was not created by compose.\nSet `external: true` to use an existing network""
network local_default was found but has incorrect label com.docker.compose.network set to """" (expected: ""default"")


### Steps To Reproduce

1. Switch to windows containers.
2. Create a basic compose project without explicitly defined `networks`.
3. Restart Windows machine.
4. Starting containers is not possible because of the error.

### Compose Version

```Text
Docker Compose version v2.36.2-desktop.1
```

### Docker Environment

```Text
Client:
 Version:    28.2.2
 Context:    desktop-windows
 Debug Mode: false
 Plugins:
  ai: Docker AI Agent - Ask Gordon (Docker Inc.)
    Version:  v1.4.0
    Path:     C:\Program Files\Docker\cli-plugins\docker-ai.exe
  buildx: Docker Buildx (Docker Inc.)
    Version:  v0.24.0-desktop.2
    Path:     C:\Program Files\Docker\cli-plugins\docker-buildx.exe
  cloud: Docker Cloud (Docker Inc.)
    Version:  v0.3.9
    Path:     C:\Program Files\Docker\cli-plugins\docker-cloud.exe
  compose: Docker Compose (Docker Inc.)
    Version:  v2.36.2-desktop.1
    Path:     C:\Program Files\Docker\cli-plugins\docker-compose.exe
  debug: Get a shell into any image or container (Docker Inc.)
    Version:  0.0.41
    Path:     C:\Program Files\Docker\cli-plugins\docker-debug.exe
  desktop: Docker Desktop commands (Docker Inc.)
    Version:  v0.1.9
    Path:     C:\Program Files\Docker\cli-plugins\docker-desktop.exe
  extension: Manages Docker extensions (Docker Inc.)
    Version:  v0.2.29
    Path:     C:\Program Files\Docker\cli-plugins\docker-extension.exe
  init: Creates Docker-related starter files for your project (Docker Inc.)
    Version:  v1.4.0
    Path:     C:\Program Files\Docker\cli-plugins\docker-init.exe
  mcp: Docker MCP Plugin (Docker Inc.)
    Version:  dev
    Path:     C:\Program Files\Docker\cli-plugins\docker-mcp.exe
  model: Docker Model Runner (Docker Inc.)
    Version:  v0.1.24
    Path:     C:\Program Files\Docker\cli-plugins\docker-model.exe
  sbom: View the packaged-based Software Bill Of Materials (SBOM) for an image (Anchore Inc.)
    Version:  0.6.0
    Path:     C:\Program Files\Docker\cli-plugins\docker-sbom.exe
  scout: Docker Scout (Docker Inc.)
    Version:  v1.18.1
    Path:     C:\Users\domsew\.docker\cli-plugins\docker-scout.exe
WARNING: Plugin ""C:\\Users\\domsew\\.docker\\cli-plugins\\docker-feedback.exe"" is not valid: failed to fetch metadata: fork/exec C:\Users\domsew\.docker\cli-plugins\docker-feedback.exe: The system cannot find the file specified.

Server:
 Containers: 12
  Running: 0
  Paused: 0
  Stopped: 12
 Images: 533
 Server Version: 28.2.2
 Storage Driver: windowsfilter
  Windows:
 Logging Driver: json-file
 Plugins:
  Volume: local
  Network: ics internal l2bridge l2tunnel nat null overlay private transparent
  Log: awslogs etwlogs fluentd gcplogs gelf json-file local splunk syslog
 CDI spec directories:
  /etc/cdi
  /var/run/cdi
 Swarm: inactive
 Default Isolation: hyperv
 Kernel Version: 10.0 22631 (22621.1.amd64fre.ni_release.220506-1250)
 Operating System: Microsoft Windows Version 23H2 (OS Build 22631.5335)
 OSType: windows
 Architecture: x86_64
 CPUs: 16
 Total Memory: 31.73GiB
 Name: domsew
 ID: ed08e4d5-d204-48c9-8b75-2d3cdf494f6e
 Docker Root Dir: C:\ProgramData\Docker
 Debug Mode: false
 Labels:
  com.docker.desktop.address=npipe://\\.\pipe\docker_cli
 Experimental: false
 Insecure Registries:
  ::1/128
  127.0.0.0/8
 Live Restore Enabled: false
 Product License: Community Engine
```

### Anything else?

The problem does not occur when I use Linux-based containers. I can't figure out when exactly the problem happens. It is probably after a computer restart, but I am not sure if it happens each time.",['kind/bug'],closed,2025-06-10T22:12:50Z,2025-06-12T17:24:12Z,performance,['kind/bug'],True,1.0,
docker/compose,12827,[BUG] Docker Compose Watch does not trigger hot reload in Next.js with Turbopack inside containers,"### Description

### What is the problem?

When using `docker compose watch` with a Next.js 15+ project running `next dev --turbopack`, file changes are synchronized to the container (confirmed), but **Turbopack does not detect them**, so the app does not hot reload automatically.

This issue **only happens inside Docker**. Running `next dev` directly on the host works as expected.

---

### What I expected to happen

Turbopack should detect file changes and reload the application just like it does outside Docker.

---

### What is actually happening

Files are successfully synced into the container (`/app`) when modified, but the Next.js dev server doesn't notice the changes. I have to manually refresh the browser (F5) or restart the server to see the updates.

---

### Steps To Reproduce

1. Create a new Next.js app with `npx create-next-app@latest --turbo`
2. Add the following Dockerfile and docker-compose.yml (see below)
3. Run: `docker compose up --watch`
4. Edit a page file (e.g. `app/page.tsx`)
5. Changes are synced (confirmed), but app does NOT reload

### Dockerfile

```
FROM node:latest

RUN useradd -ms /bin/bash -u 1001 app
USER app

WORKDIR /app

COPY --chown=app:app package*.json ./
RUN npm install

COPY --chown=app:app . .

EXPOSE 3000
```

### docker-compose.yaml

```
services:
  frontend:
    build:
      context: ./gametrackr-frontend
    container_name: gametrackr-frontend
    env_file:
      - ./gametrackr-frontend/.env
    environment:
      - NODE_ENV=development
    develop:
      watch:
        - action: sync
          path: ./gametrackr-frontend
          target: /app
          ignore:
            - node_modules/
        - action: rebuild
          path: ./gametrackr-frontend/package.json
        - action: rebuild
          path: ./gametrackr-frontend/package-lock.json
    networks:
      - internal
    restart: unless-stopped
    command: npm run dev

networks:
  internal:
    driver: bridge
  public:
    driver: bridge
```


### Compose Version

```Text
Docker Desktop 4.41.2
Docker Compose version v2.35.1-desktop.1
```",['kind/question'],closed,2025-05-13T20:50:44Z,2025-05-14T12:54:00Z,bug,['kind/question'],True,0.0,
docker/compose,12816,[BUG] The .env-child file that is included in a child project is always searched in the current folder.,"### Description

The `.env-child` file that is included in a child project is always searched in the current folder.

For example, I have a project in folder `child` with the following structure:
```
.env-child
compose-common.yaml
compose.yaml
```
`.env-child`:
```
IMAGE=BAR
```
`compose.yaml`:
```
include:
  - path: compose-common.yaml
    env_file:
      - .env-child
```

`compose-common.yaml`:
```
services:
  serviceA:
    image: ${IMAGE}-alpine
```

This works well:
```
$ docker compose config
name: child
services:
  serviceA:
    image: BAR-alpine
    networks:
      default: null
networks:
  default:
    name: child_default
```

Now I want to include the project in the `child` folder in my project. `child` is a subfolder in my project (`my-project` folder). To do this, I create in my project folder the `compose.yaml` like this:
```
include:
  - path: child/compose.yaml
```

This is not working with error: `Couldn't find env file: .../my-project/.env-child`


### Steps To Reproduce

1. Create files like described
2. run `docker compose config`

Result:
`Couldn't find env file: .../my-project/.env-child`

Expected result:
```
name: my-project
services:
  serviceA:
    image: BAR-alpine
    networks:
      default: null
networks:
  default:
    name: my-project_default
```

The [documentation](https://docs.docker.com/reference/compose-file/include/#env_file) states that the .env file will be used from the project folder where the compose file is located. That is, the one in which it is included. If I understood correctly.

Using the project folder doesn't help at all.
IMHO it's bug. If a .env file is specified for include, it must be searched relative to the compose file in which it is specified.

### Compose Version

```Text
docker compose version
Docker Compose version v2.23.1
```

### Docker Environment

```Text
$ docker info
Client: Docker Engine - Community
 Version:    28.1.1
 Context:    default
 Debug Mode: false
 Plugins:
  buildx: Docker Buildx (Docker Inc.)
    Version:  v0.23.0
    Path:     /usr/libexec/docker/cli-plugins/docker-buildx
  compose: Docker Compose (Docker Inc.)
    Version:  v2.23.1
    Path:     /home/slava/.docker/cli-plugins/docker-compose

Server:
 Containers: 1
  Running: 1
  Paused: 0
  Stopped: 0
 Images: 16
 Server Version: 28.1.1
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: systemd
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 05044ec0a9a75232cad458027ca83437aae3f4da
 runc version: v1.2.5-0-g59923ef
 init version: de40ad0
 Security Options:
  seccomp
   Profile: builtin
  cgroupns
 Kernel Version: 6.14.5-300.fc42.x86_64
 Operating System: Fedora Linux 42 (KDE Plasma Desktop Edition)
 OSType: linux
 Architecture: x86_64
 CPUs: 8
 Total Memory: 62.63GiB
 Name: dubrwork
 ID: 6e1fd0b7-7d4b-4392-a489-c7f2f12dfd6f
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 Username: dubrsl
 Experimental: false
 Insecure Registries:
  ::1/128
  127.0.0.0/8
 Live Restore Enabled: false
```

### Anything else?

_No response_",['kind/bug'],closed,2025-05-09T12:04:50Z,2025-05-19T15:20:56Z,bug,['kind/bug'],True,10.0,
docker/compose,12815,[BUG] Inconsistent validation of host_ip field between short and long syntax of `services.*.ports` entries.,"### Description

When specifying an invalid IP address in the `host_ip` field of a [`services.*.ports` entry](https://docs.docker.com/reference/compose-file/services/#ports), using the short form syntax causes `docker compose` to output an error, while in the long form syntax the invalid input is accepted.

### Steps To Reproduce

Create file `short.yaml`:

```yaml
name: host_ip_bug
services:
  test:
    image: alpine
    ports:
      - ""notavalidip:1234:1234""
```

Create file `long.yaml`:

```yaml
name: host_ip_bug
services:
  test:
    image: alpine
    ports:
      - host_ip: ""notavalidip""
        target: 1234
        published: ""1234""
```

Test config of short syntax:

```sh
docker compose -f short.yaml config
```

Output:

```text
invalid IP address: notavalidip
```

Test config of long syntax:

```sh
docker compose -f long.yaml config
```

Output:

```yaml
name: host_ip_bug
services:
  test:
    image: alpine
    networks:
      default: null
    ports:
      - mode: ingress
        host_ip: notavalidip
        target: 1234
        published: ""1234""
        protocol: tcp
networks:
  default:
    name: host_ip_bug_default
```

### Compose Version

```Text
Docker Compose version 2.34.0
```

### Docker Environment

```Text
Client: Docker Engine - Community
 Version:    28.0.1
 Context:    colima
 Debug Mode: false
 Plugins:
  buildx: Docker Buildx (Docker Inc.)
    Version:  v0.21.2
    Path:     /opt/homebrew/lib/docker/cli-plugins/docker-buildx
  compose: Docker Compose (Docker Inc.)
    Version:  2.34.0
    Path:     /opt/homebrew/lib/docker/cli-plugins/docker-compose

Server:
 Containers: 2
  Running: 0
  Paused: 0
  Stopped: 2
 Images: 158
 Server Version: 27.4.0
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: cgroupfs
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 88bf19b2105c8b17560993bee28a01ddc2f97182
 runc version: v1.2.2-0-g7cb3632
 init version: de40ad0
 Security Options:
  apparmor
  seccomp
   Profile: builtin
  cgroupns
 Kernel Version: 6.8.0-50-generic
 Operating System: Ubuntu 24.04.1 LTS
 OSType: linux
 Architecture: x86_64
 CPUs: 4
 Total Memory: 3.819GiB
 Name: colima
 ID: 4704f4f2-2d81-4813-9d80-7185e4efd631
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 Experimental: false
 Insecure Registries:
  127.0.0.0/8
 Live Restore Enabled: false
 Default Address Pools:
   Base: 100.64.0.0/16, Size: 24
```

### Anything else?

_No response_",['kind/bug'],closed,2025-05-08T15:44:35Z,2025-05-19T09:37:32Z,performance,['kind/bug'],True,10.0,
docker/compose,12814,[BUG] compose watch stops services using `links` and `depends_on` with `restart: true`,"### Description

Compose watch mode may currently stop services that link other services without ever restarting:

0. The idea is that a service (think a front proxy) links any another service (think a backend).
1. Compose watch mode will correctly identify that the backend service needs to be recreated/restarted (e.g. using `action: rebuild`).
2. It will correctly stop the front service before stopping the backend service.
3. It will correctly restart the backend, but fails to restart the front service afterwards.
4. The application is now in a broken state (""half up""), the backend can no longer be reached without a front proxy.

I've specifically encountered this when using legacy `links` between services, but the same behavior can be reproduced when using `depends_on` with `restart: true`. It's my understanding legacy `links` would basically act like `depends_on` with `restart: true`, despite `restart: false` being the default otherwise.

I think it's debatable if the front proxy service needs to be restarted in this example. In either case, it should either be restarted completely or not restarted at all. I don't think stopping the service without restarting it again would ever be intended behavior.

The problem occurred as part of a bigger application using multiple services, but I've been able to reproduce this in a most basic `compose.yaml` file with no external dependencies except a public image. The resulting file may look a bit contrived, but I hope this should be enough to reproduce this without any specific service configurations.

Possibly related, I've checked `docker compose up -a` reports the affected services as ""exited"". Using `docker compose restart backend` does restart the `backend` and the affected services as expected. However, the running `docker compose up --watch` session will not pick up the affected services again. This appears to work fine if I do not trigger a rebuild first.

I've checked for similar reports and stumbled upon #11695 and #11813, but believe they may point to different, but possibly related, issues.

The recent changes regarding watch mode and watching multiple services as implemented in #12469 and others have been a real game-changer for me personally and a larger number of projects I'm working on, so keep up the great work! 👍

### Steps To Reproduce

Basic reproducer:

```yaml
services:
  nok:
    image: httpd:2.4-alpine
    links:
      - backend
  backend:
    build:
      dockerfile_inline: |
        FROM httpd:2.4-alpine
    develop:
      watch:
        - path: compose.yaml
          action: rebuild
```

Reproducer showing two broken services + 2 working ones as possible workarounds: 

```yaml
services:
  nok:
    image: httpd:2.4-alpine
    links:
      - backend
  same:
    image: httpd:2.4-alpine
    depends_on:
      backend:
        condition: service_started
        restart: true
  ok:
    image: httpd:2.4-alpine
    depends_on:
      - backend
  alright:
    image: httpd:2.4-alpine
    depends_on:
      backend:
        condition: service_started
        restart: false
  backend:
    build:
      dockerfile_inline: |
        FROM httpd:2.4-alpine
    develop:
      watch:
        - path: compose.yaml
          action: rebuild
```

Start watch mode in foreground:

```bash
docker compose up --watch
```

Change `compose.yaml` file to trigger rebuild:

```bash
touch compose.yaml
```

Log output shows backend service is correctly rebuilt, but affected front proxy services stop:

```log
           ⦿ Rebuilding service(s) [""backend""] after changes were detected...
           ⦿ service(s) [""backend""] successfully built
nok-1      | [Thu May 08 13:30:52.184586 2025] [mpm_event:notice] [pid 1:tid 123450472430344] AH00492: caught SIGWINCH, shutting down gracefully
same-1     | [Thu May 08 13:30:52.189356 2025] [mpm_event:notice] [pid 1:tid 130455114877704] AH00492: caught SIGWINCH, shutting down gracefully
nok-1 exited with code 0
same-1 exited with code 0
backend-1  | [Thu May 08 13:30:53.516278 2025] [mpm_event:notice] [pid 1:tid 128908057438984] AH00492: caught SIGWINCH, shutting down gracefully
backend-1 exited with code 0
backend-1 has been recreated
```

You can see both `nok` and `same` are stopped without restarting.

### Compose Version

```Text
Docker Compose version v2.36.0
```

### Docker Environment

```Text
Client:
 Version:    26.1.3
 Context:    default
 Debug Mode: false
 Plugins:
  compose: Docker Compose (Docker Inc.)
    Version:  v2.36.0
    Path:     /usr/local/libexec/docker/cli-plugins/docker-compose

Server:
 Containers: 33
  Running: 11
  Paused: 0
  Stopped: 22
 Images: 1537
 Server Version: 26.1.3
 Storage Driver: overlay2
  Backing Filesystem: extfs
  Supports d_type: true
  Using metacopy: false
  Native Overlay Diff: true
  userxattr: false
 Logging Driver: json-file
 Cgroup Driver: systemd
 Cgroup Version: 2
 Plugins:
  Volume: local
  Network: bridge host ipvlan macvlan null overlay
  Log: awslogs fluentd gcplogs gelf journald json-file local splunk syslog
 Swarm: inactive
 Runtimes: io.containerd.runc.v2 runc
 Default Runtime: runc
 Init Binary: docker-init
 containerd version: 
 runc version: 
 init version: 
 Security Options:
  apparmor
  seccomp
   Profile: builtin
  cgroupns
 Kernel Version: 6.8.0-59-generic
 Operating System: Ubuntu 24.04.2 LTS
 OSType: linux
 Architecture: x86_64
 CPUs: 16
 Total Memory: 30.54GiB
 Name: me
 ID: 519acebf-0404-4fc7-a89d-afcb3bcf9b15
 Docker Root Dir: /var/lib/docker
 Debug Mode: false
 Experimental: false
 Insecure Registries:
  127.0.0.0/8
 Live Restore Enabled: false
```

### Anything else?

_No response_",['kind/bug'],closed,2025-05-08T13:58:16Z,2025-05-27T14:14:38Z,bug,['kind/bug'],True,19.0,
kubernetes/kubernetes,132437,Kubectl returns error when creating CRs if CRD scope has changed,"[###]([url](url)) What happened?

1. I created a namespace-scoped CRD.
2. I created a CR based on this CRD.
3. I deleted the CRD
4. I created an nearly identical CRD differing only in that it was cluster-scoped
5. I tried creating a CR based on the new CRD and got the following error:
```
Error from server (NotFound): error when creating ""cr-clus.yaml"": the server could not find the requested resource (post testdefs.test.test)
```

### What did you expect to happen?

I expected the CR to be created

### How can we reproduce it (as minimally and precisely as possible)?

```console
kubectl create -f crd-ns.yaml
kubectl create -f cr-ns.yaml
kubectl delete crd testdefs.test.test
kubectl create -f crd-clus.yaml
kubectl create -f cr-clus.yaml
```
The last `kubectl` invocation will return 
```
Error from server (NotFound): error when creating ""cr-clus.yaml"": the server could not find the requested resource (post testdefs.test.test)
```

#### Resource Defs
NS-CRD:
```
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: testdefs.test.test
spec:
  group: test.test
  names:
    kind: TestDef
    listKind: TestDefList
    plural: testdefs
    singular: testdef
  scope: Namespaced
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              number:
                type: integer
    served: true
    storage: true
    subresources:
      status: {}
```
NS-CR
```
apiVersion: test.test/v1alpha1
kind: TestDef
metadata:
  name: test-ns
  namespace: crd-test
spec:
  number: 1
```
Culs-CRD
```

apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  name: testdefs.test.test
spec:
  group: test.test
  names:
    kind: TestDef
    listKind: TestDefList
    plural: testdefs
    singular: testdef
  scope: Cluster
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        type: object
        properties:
          spec:
            type: object
            properties:
              number:
                type: integer
    served: true
    storage: true
    subresources:
      status: {}
```
Clus-CR
```
apiVersion: test.test/v1alpha1
kind: TestDef
metadata:
  name: test-clus
spec:
  number: 1
```

### Anything else we need to know?

If you attempt to create a resource in a nonexistent api-group after creating the second CRD e.g.
```
apiVersion: test-bad.test/v1alpha1
kind: TestDef
metadata:
  name: test-clus
spec:
  number: 1
```
 The subsequent creation of the actual CR will succeed.

### Kubernetes version

<details>

```console
$ kubectl version
Client Version: v1.32.3
Kustomize Version: v5.5.0
Server Version: v1.31.5+k3s1
```

</details>


### Cloud provider

Originally identified on AWS EKS but I reproduced it locally on k3d


### OS version

<details>

```console
Darwin J9TVKJTF3H 24.5.0 Darwin Kernel Version 24.5.0: Tue Apr 22 19:54:29 PDT 2025; root:xnu-11417.121.6~2/RELEASE_ARM64_T6030 arm64 arm Darwin
```

</details>


### Install tools

<details>
N/A
</details>


### Container runtime (CRI) and version (if applicable)

<details>
Docker version 28.1.1, build 4eba377
</details>


### Related plugins (CNI, CSI, ...) and versions (if applicable)

<details>
N/A
</details>
","['kind/bug', 'needs-sig', 'needs-triage']",open,2025-06-21T02:20:19Z,,bug,"['kind/bug', 'needs-sig', 'needs-triage']",True,,
kubernetes/kubernetes,132436,Relaxing immutability of Pod Templates resources/limits,"### What would you like to be added?

As In Place Pod Vertical scaling is maturing, there is interest in using this feature for apps or batch workloads.

I can imagine a world where someone wants to change an existing job to lower the cgroups of a workload or scale up. One interest is to rebalance workloads to match their actual utilization. As stated in the in place pod vertical scaling, some apps have high startup resources and then they are able to have their resources scaled down. Most of these workloads do not use pods but higher level objects so it is important to consider how this feature will eventually work with higher level controllers like Jobs, Deployments and StatefulSets. 

Another use case I have heard is the ability to patch/update workloads before they are scheduled. Some use cases I've heard are using an external service to select requests/limits for workloads based on model size or historical data. One implementation idea is to submit a Job in a suspended state and allow the service to patch the Job to reflect the intended state of the resource request and unsuspend with the updated request. This is forbidden today in validation logic so it would be worth considering how to relax this.

For Job, Deployment, and StatefulSet we assume PodTemplates are immutable. In some cases, for Job, we did relax the immutability for scheduling directives but we did not change resource/requests. I was curious how we can start the discussion on how to relax this to further enable In Place Pod Vertical scaling and other use cases where the workloads have not yet been scheduled.

I am opening this up to see how we could tackle this overall.

One possibility is to take this in smaller KEPS:

- [KEP - 1]: Relax immutability of container requests/limits when suspended for Jobs
- [KEP - 2]: In Place Pod Resizing of Job while running.
- [KEP - 3]: In Place Pod Resizing of Deployments
- [KEP - 4]: In Place Pod Resizing of StatefulSets


### Why is this needed?

See above.","['sig/node', 'kind/feature', 'sig/apps', 'needs-triage']",open,2025-06-20T23:55:13Z,,performance,"['sig/node', 'kind/feature', 'sig/apps', 'needs-triage']",True,,
kubernetes/kubernetes,132435,GarbageCollection panics “fatal error: concurrent map writes” under DiskPressure,"### What happened?

Red Hat downstream bug
https://issues.redhat.com/browse/OCPBUGS-57499

When nodes in an OpenShift cluster began reporting DiskPressure, the CRI‑O image garbage‑collector kicked in—but immediately panicked with: `fatal error: concurrent map writes`

### What did you expect to happen?

Under DiskPressure, image GC should synchronously walk its internal image‑cache maps (or hold appropriate locks) and delete unused images down to the low threshold without ever panicking.

### How can we reproduce it (as minimally and precisely as possible)?

It's very hard to reproduce locally.

### Anything else we need to know?

N/A

### Kubernetes version

<details>

```console
$ kubectl version
# paste output here
```

</details>


### Cloud provider

<details>

</details>


### OS version

<details>

```console
# On Linux:
$ cat /etc/os-release
# paste output here
$ uname -a
# paste output here

# On Windows:
C:\> wmic os get Caption, Version, BuildNumber, OSArchitecture
# paste output here
```

</details>


### Install tools

<details>

</details>


### Container runtime (CRI) and version (if applicable)

<details>

</details>


### Related plugins (CNI, CSI, ...) and versions (if applicable)

<details>

</details>
","['kind/bug', 'sig/node', 'needs-triage']",closed,2025-06-20T22:14:02Z,2025-06-20T23:11:26Z,bug,"['kind/bug', 'sig/node', 'needs-triage']",True,0.0,
kubernetes/kubernetes,132434,Feature Name : is it CPUCFSQuotaPeriod? or CustomCPUCFSQuotaPeriod?,"originally added in https://github.com/kubernetes/kubernetes/commit/588d2808b77d11f235b6eba5c21bcaa89a2f7804#diff-71e3b98f9a6bbf5b8421e26a7ba0c079f397cd8d49abacdad943c66a4f44f03dR162-R420

the code constant is `CPUCFSQuotaPeriod` BUT the string is `CustomCPUCFSQuotaPeriod`. 

docs look like refer to it as `CustomCPUCFSQuotaPeriod`:
https://cs.k8s.io/?q=CustomCPUCFSQuotaPeriod&i=nope&literal=nope&files=&excludeFiles=&repos=

it's also stuck in Alpha since v1.12? https://github.com/kubernetes/kubernetes/blob/master/pkg/features/kube_features.go#L1048

Do we get rid of it entirely? 

/sig node

@szuecs ","['sig/node', 'needs-triage']",open,2025-06-20T21:32:05Z,,bug,"['sig/node', 'needs-triage']",True,,
kubernetes/kubernetes,132428,"[Flaking Test][sig-node] node-conformance-crio-cgroup{v1,v2} - spurious segmentation fault causing test failures","### Which jobs are flaking?

The release blocking tests are flaking in crio due to a segmentation fault occurring in random tests.


### Which tests are flaking?

release blocking crio tests

### Since when has it been flaking?

not sure yet

### Testgrid link

_No response_

### Relevant Issues

- https://github.com/kubernetes/kubernetes/issues/132426
- https://github.com/kubernetes/kubernetes/issues/132425
- https://github.com/kubernetes/kubernetes/issues/132207
- https://github.com/kubernetes/kubernetes/issues/132201
- https://github.com/kubernetes/kubernetes/issues/132185

### Reason for failure (if possible)

Test failure seems to occur due a crio segmentation fault:

```
file=""server/container_create.go:606"" id=7d66fffa-275b-440d-8859-ccda2fe8d996 name=/runtime.v1.RuntimeService/CreateContainer
Jun 20 04:35:41 tmp-node-e2e-76cc36f4-fedora-coreos-42-20250526-3-0-gcp-x86-64 crio[2475]: time=""2025-06-20T04:35:41.334782109Z"" level=debug msg=""Response: &CreateContainerResponse{ContainerId:1ab02e6f8558d47d9fc4f186de706f84814ccb8f1fac82d454b32da1d1b2d877,}"" file=""interceptors/interceptors.go:76"" id=7d66fffa-275b-440d-8859-ccda2fe8d996 name=/runtime.v1.RuntimeService/CreateContainer
Jun 20 04:35:46 tmp-node-e2e-76cc36f4-fedora-coreos-42-20250526-3-0-gcp-x86-64 systemd-coredump[5387]: Process 2475 (crio) of user 0 dumped core.
                                                                                                       
                                                                                                       Stack trace of thread 3018:
                                                                                                       #0  0x000000000041ea38 n/a (/var/usrlocal/bin/crio + 0x1ea38)
                                                                                                       #1  0x0000000000480479 n/a (/var/usrlocal/bin/crio + 0x80479)
                                                                                                       #2  0x0000000000485969 n/a (/var/usrlocal/bin/crio + 0x85969)
                                                                                                       #3  0x000000000047ca36 n/a (/var/usrlocal/bin/crio + 0x7ca36)
                                                                                                       #4  0x000000000044fb25 n/a (/var/usrlocal/bin/crio + 0x4fb25)
                                                                                                       #5  0x000000000044f7df n/a (/var/usrlocal/bin/crio + 0x4f7df)
                                                                                                       ELF object binary architecture: AMD x86-64
``

### Anything else we need to know?

_No response_

### Relevant SIG(s)

/sig node","['priority/critical-urgent', 'sig/node', 'kind/flake', 'needs-triage']",open,2025-06-20T13:20:41Z,,performance,"['priority/critical-urgent', 'sig/node', 'kind/flake', 'needs-triage']",True,,
kubernetes/kubernetes,132426,[Flaking Test] [sig-node] Probing container with readiness probe should not be ready before initial delay and never restart [NodeConformance] [Conformance],"### Which jobs are flaking?

master-blocking
- ci-crio-cgroupv1-node-e2e-conformance
- ci-crio-cgroupv2-node-e2e-conformance

### Which tests are flaking?

E2eNode Suite.[It] [sig-node] Probing container with readiness probe should not be ready before initial delay and never restart [NodeConformance] [Conformance]

[Triage](https://storage.googleapis.com/k8s-triage/index.html?job=ci-crio-cgroupv&test=Probing%20container%20with%20readiness%20probe%20should%20not%20be%20ready%20before%20initial%20delay%20and%20never%20restart&xjob=ci-crio-cgroupv1-evented-pleg)
[Prow](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1935461094793416704)

### Since when has it been flaking?

[6/19/2025, 3:44:41 AM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1935461094793416704)
[6/16/2025, 3:21:41 AM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1934368131594063872)
[6/11/2025, 5:58:45 PM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1932776881065562112)
[6/11/2025, 3:07:42 PM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv2-node-e2e-conformance/1932733846827044864)

### Testgrid link

https://testgrid.k8s.io/sig-release-master-blocking#ci-crio-cgroupv1-node-e2e-conformance

### Reason for failure (if possible)

```
{ failed [FAILED] pod should have a restart count of 0 but got 1
Expected
    <int>: 1
to equal
    <int>: 0
In [It] at: k8s.io/kubernetes/test/e2e/common/node/container_probe.go:99 @ 06/18/25 22:24:50.498
}
```

### Anything else we need to know?

NA

### Relevant SIG(s)

/sig node

/cc @kubernetes/release-team-release-signal ","['sig/node', 'kind/flake', 'needs-triage']",open,2025-06-20T11:47:24Z,,bug,"['sig/node', 'kind/flake', 'needs-triage']",True,,
kubernetes/kubernetes,132425,[Flaking Test] [sig-node] Container Runtime blackbox test when starting a container that exits should run with the expected status [NodeConformance] [Conformance],"### Which jobs are flaking?

master-blocking
- ci-crio-cgroupv1-node-e2e-conformance
- ci-crio-cgroupv2-node-e2e-conformance

### Which tests are flaking?

E2eNode Suite.[It] [sig-node] Container Runtime blackbox test when starting a container that exits should run with the expected status [NodeConformance] [Conformance]

[Triage](https://storage.googleapis.com/k8s-triage/index.html?test=Container%20Runtime%20blackbox%20test%20when%20starting%20a%20container%20that%20exits%20should%20run%20with%20the%20expected%20status)
[Prow](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1935597494759067648)

### Since when has it been flaking?

[6/19/2025, 12:46:47 PM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1935597494759067648)
[6/19/2025, 4:33:58 AM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv2-node-e2e-conformance/1935473425841655808)
[6/15/2025, 12:20:47 PM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1934141385615609856)
[6/15/2025, 2:17:50 AM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv1-node-e2e-conformance/1933989634321158144)
[6/10/2025, 3:02:43 PM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-crio-cgroupv2-node-e2e-conformance/1932370197138640896)

### Testgrid link

https://testgrid.k8s.io/sig-release-master-blocking#ci-crio-cgroupv1-node-e2e-conformance

### Reason for failure (if possible)

```
{ failed [FAILED] Expected
    <bool>: false
to equal
    <bool>: true
In [It] at: k8s.io/kubernetes/test/e2e/common/node/runtime.go:121 @ 06/19/25 07:29:11.248
}
```

### Anything else we need to know?

NA

### Relevant SIG(s)

/sig node

cc @kubernetes/release-team-release-signal ","['sig/node', 'kind/flake', 'needs-triage']",open,2025-06-20T11:30:23Z,,performance,"['sig/node', 'kind/flake', 'needs-triage']",True,,
kubernetes/kubernetes,132424,[Flaking Test] UT k8s.io/kubernetes/pkg/kubeapiserver: options,"### Which jobs are flaking?

https://prow.k8s.io/view/gs/kubernetes-ci-logs/pr-logs/pull/132412/pull-kubernetes-unit-windows-master/1936004474929680384



### Which tests are flaking?

pkg/kubeapiserver/options TestToAuthenticationConfig_OIDC/authentication_config_file_not_found

pkg/kubeapiserver/options TestToAuthenticationConfig_OIDC

### Since when has it been flaking?


1935430903828320256 | #132360[WIP] pkg/kubelet: Fix concurrent map write crash during image gc (094ea09) by sohankunkerkar | Jun 19 04:15:52Jun 19 2025, 04:15:52 UTC+0800 | 24m5s | FAILURE
-- | -- | -- | -- | --
1935427168020467712 | #132341Promote KubeletTracing featuregate to GA (98f7c70) by dashpole | Jun 19 04:00:55Jun 19 2025, 04:00:55 UTC+0800 | 28m35s | FAILURE
1935410223762116608 | #132341Promote KubeletTracing featuregate to GA (eb781f6) by dashpole | Jun 19 02:53:32Jun 19 2025, 02:53:32 UTC+0800 | 29m57s | FAILURE
1935396716643618816 | #132341Promote KubeletTracing featuregate to GA (eb781f6) by dashpole | Jun 19 01:59:53Jun 19 2025, 01:59:53 UTC+0800 | 25m58s | FAILURE
1935388362974171136 | #132325WIP: DRA kubelet connection monitoring (6ad724f) by bart0sh | Jun 19 01:26:45Jun 19 2025, 01:26:45 UTC+0800 | 26m55s | FAILURE
1935369797621518336 | #128388Retry starting the Device Manager gRPC service if it fails (a482d2f) by zhifei92 | Jun 19 00:12:56Jun 19 2025, 00:12:56 UTC+0800 | 26m13s | FAILURE
1935357658697568256 | #129719[WIP][FG:InPlacePodVerticalScaling] Fix Static CPU management policy alongside InPlacePodVerticalScaling (ddf152d) by esotsal | Jun 18 23:24:50Jun 18 2025, 23:24:50 UTC+0800 | 28m29s | FAILURE

[1935430903828320256](https://prow.k8s.io/view/gs/kubernetes-ci-logs/pr-logs/pull/132360/pull-kubernetes-unit-windows-master/1935430903828320256)	#132360 ([094ea09](https://github.com/kubernetes/kubernetes/pull/132360/commits/094ea091db8a59f5a40dc29d940c75ea2c58619c)) by [sohankunkerkar](https://github.com/sohankunkerkar)	
Jun 19 04:15:52
24m5s	FAILURE
1935427168020467712	#132341 ([98f7c70](https://github.com/kubernetes/kubernetes/pull/132341/commits/98f7c7024f48c81c3cc92d9d0cc0c2ad22212c17)) by [dashpole](https://github.com/dashpole)	
Jun 19 04:00:55
28m35s	FAILURE
1935410223762116608	#132341 ([eb781f6](https://github.com/kubernetes/kubernetes/pull/132341/commits/eb781f6eff57a45da96d214651b07e1ea4b1fd41)) by [dashpole](https://github.com/dashpole)	
Jun 19 02:53:32
29m57s	FAILURE
1935396716643618816	#132341 ([eb781f6](https://github.com/kubernetes/kubernetes/pull/132341/commits/eb781f6eff57a45da96d214651b07e1ea4b1fd41)) by [dashpole](https://github.com/dashpole)	
Jun 19 01:59:53
25m58s	FAILURE
1935388362974171136	#132325 ([6ad724f](https://github.com/kubernetes/kubernetes/pull/132325/commits/6ad724fce0300782e0afadfb727cba2cb74f8249)) by [bart0sh](https://github.com/bart0sh)	
Jun 19 01:26:45
26m55s	FAILURE
1935369797621518336	#128388 ([a482d2f](https://github.com/kubernetes/kubernetes/pull/128388/commits/a482d2fd265e04216e89c7065fe93f50ae174ce7)) by [zhifei92](https://github.com/zhifei92)	
Jun 19 00:12:56
26m13s	FAILURE
1935357658697568256	#129719 ([ddf152d](https://github.com/kubernetes/kubernetes/pull/129719/commits/ddf152d61a1754a63d1b3e6613e371458f25eda3)) by [esotsal](https://github.com/esotsal)	
Jun 18 23:24:50
28m29s	FAILURE

### Testgrid link

https://prow.k8s.io/job-history/gs/kubernetes-ci-logs/pr-logs/directory/pull-kubernetes-unit-windows-master

### Reason for failure (if possible)

{Failed  === RUN   TestToAuthenticationConfig_OIDC/authentication_config_file_not_found
    authentication_test.go:1082: Got err: failed to load authentication configuration from file ""nonexistent-file"": open nonexistent-file: The system cannot find the file specified.; Want err: failed to load authentication configuration from file ""nonexistent-file"": open nonexistent-file: no such file or directory
--- FAIL: TestToAuthenticationConfig_OIDC/authentication_config_file_not_found (0.01s)

=== RUN   TestToAuthenticationConfig_OIDC
--- FAIL: TestToAuthenticationConfig_OIDC (0.13s)
}

### Anything else we need to know?

when run ""pull-kubernetes-unit-windows-master"", it will fail

### Relevant SIG(s)

/sig testing","['kind/flake', 'sig/auth', 'sig/testing', 'triage/accepted']",open,2025-06-20T11:17:49Z,,security,"['kind/flake', 'sig/auth', 'sig/testing', 'triage/accepted']",True,,
kubernetes/kubernetes,132422,Unexpected Deletion of Environment Variables During kubectl apply,"### What happened?

When applying a YAML file using `kubectl apply`, an environment variable (`MY_ENV_VAR`) was unexpectedly deleted. The YAML contained a fix to rename a duplicate variable, but both the renamed duplicate and the correct variable were removed during the operation.

### What did you expect to happen?

The duplicate variable was renamed, while the correct variable remained intact.

### How can we reproduce it (as minimally and precisely as possible)?

1. Create a deployment YAML file with duplicate environment variables:
```yaml
env:
  - name: MY_ENV_VAR
    value: ""value1""
  - name: MY_ENV_VAR
    value: ""value2""
``` 
2. Update the YAML to rename the duplicate variable and apply it using `kubectl apply -f xxx.yaml`:
```yaml
env:
  - name: MY_NEW_ENV_VAR
    value: ""value1""
  - name: MY_ENV_VAR
    value: ""value2""
``` 
3. Observe that `MY_ENV_VAR` is deleted.

### Anything else we need to know?

The issue seems related to how the diff is calculated between two YAML versions, leading to a delete action. The original logic does not appear to account for cases with duplicate keys, which may have caused the unintended deletion.

### Kubernetes version

<details>

```console
$ kubectl version
Client Version: v1.30.5-dispatcher
Kustomize Version: v5.0-4.0.20230601165947-6c30bf390ce3
Server Version: v1.32.2-gke.1.297002
```

</details>


### Cloud provider

<details>
Google Kubernetes Engine (GKE)
</details>


### OS version

<details>

```console
# On Windows:
C:\> wmic os get Caption, Version, BuildNumber, OSArchitecture
BuildNumber Caption                                            OSArchitecture Version
19045.           Microsoft Windows 10 Enterprise 64-bit                 10.0.19045
```

</details>


### Install tools

<details>

</details>


### Container runtime (CRI) and version (if applicable)

<details>

</details>


### Related plugins (CNI, CSI, ...) and versions (if applicable)

<details>

</details>
","['kind/bug', 'sig/cli', 'needs-triage']",closed,2025-06-20T10:05:33Z,2025-06-20T13:08:11Z,bug,"['kind/bug', 'sig/cli', 'needs-triage']",True,0.0,
kubernetes/kubernetes,132418,[Flaking Test] UT k8s.io/apiextensions-apiserver/pkg: apiserver,"### Which jobs are flaking?

https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-kubernetes-unit/1933607361415483392
https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-kubernetes-unit-1-33/1931163207162925056
https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-kubernetes-unit-ppc64le/1935867526592335872


### Which tests are flaking?

`k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go: TestResourceManagerAddedCRD `
`k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:TestDiscoveryControllerResourceManagerRemovedCRD`

### Since when has it been flaking?

Triage tool shows the earliest failures on [6/13/2025, 7:47:46 AM](https://prow.k8s.io/view/gs/kubernetes-ci-logs/logs/ci-kubernetes-unit/1933347647851073536) as per [Link](https://storage.googleapis.com/k8s-triage/index.html?date=2025-06-20&pr=1&test=k8s.io%2Fapiextensions-apiserver%2Fpkg%2Fapiserver.apiserver&xjob=e2e-kops). 

### Testgrid link

https://testgrid.k8s.io/sig-release-master-blocking#ci-kubernetes-unit

### Reason for failure (if possible)

```
=== RUN   TestResourceManagerAddedCRD
    customresource_discovery_controller_test.go:326: 
        	Error Trace:	/home/prow/go/src/k8s.io/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:326
        	Error:      	Received unexpected error:
        	            	timed out waiting for the condition
        	Test:       	TestResourceManagerAddedCRD
--- FAIL: TestResourceManagerAddedCRD (1.01s)
```

```
=== RUN   TestDiscoveryControllerResourceManagerRemovedCRD
    customresource_discovery_controller_test.go:408: 
        	Error Trace:	/home/prow/go/src/k8s.io/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:408
        	Error:      	Received unexpected error:
        	            	timed out waiting for the condition
        	Test:       	TestDiscoveryControllerResourceManagerRemovedCRD
--- FAIL: TestDiscoveryControllerResourceManagerRemovedCRD (1.00s)
```

### Anything else we need to know?

We were able to reproduce this flake locally using stress tool.
**_Steps to reproduce:_** 
1. Install stress tool (# go install golang.org/x/tools/cmd/stress@latest).
2. Clone the k8s repo (git clone https://github.com/kubernetes/kubernetes.git).
3. cd kubernetes
4.  go test ./staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/ -c race
5.  /root/go/bin/stress ./apiserver.test  -test.run TestResourceManagerAddedCRD

```
[root@raji-x86-workspace1 kubernetes]# uname -a
Linux raji-x86-workspace1.fyre.ibm.com 5.14.0-573.el9.x86_64 #1 SMP PREEMPT_DYNAMIC Tue Mar 18 15:33:59 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux
[root@raji-x86-workspace1 kubernetes]#
```
```
[root@raji-x86-workspace1 kubernetes]# /root/go/bin/stress ./apiserver.test  -test.run TestResourceManagerAddedCRD
5s: 297 runs so far, 0 failures, 16 active
10s: 614 runs so far, 0 failures, 16 active

/tmp/go-stress-20250620T013232-1920411983
I0620 01:32:42.568589  872999 customresource_discovery_controller.go:294] Starting DiscoveryController
--- FAIL: TestResourceManagerAddedCRD (1.00s)
    customresource_discovery_controller_test.go:326:
                Error Trace:    /root/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:326
                Error:          Received unexpected error:
                                timed out waiting for the condition
                Test:           TestResourceManagerAddedCRD
FAIL
I0620 01:32:43.569575  872999 customresource_discovery_controller.go:332] Shutting down DiscoveryController


ERROR: exit status 1

15s: 922 runs so far, 1 failures (0.11%), 16 active

/tmp/go-stress-20250620T013232-2803581754
I0620 01:32:47.777126  877060 customresource_discovery_controller.go:294] Starting DiscoveryController
--- FAIL: TestResourceManagerAddedCRD (1.00s)
    customresource_discovery_controller_test.go:326:
                Error Trace:    /root/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:326
                Error:          Received unexpected error:
                                timed out waiting for the condition
                Test:           TestResourceManagerAddedCRD
FAIL
I0620 01:32:48.779243  877060 customresource_discovery_controller.go:332] Shutting down DiscoveryController


ERROR: exit status 1


/tmp/go-stress-20250620T013232-3917711053
I0620 01:32:50.684182  879309 customresource_discovery_controller.go:294] Starting DiscoveryController
--- FAIL: TestResourceManagerAddedCRD (1.00s)
    customresource_discovery_controller_test.go:326:
                Error Trace:    /root/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:326
                Error:          Received unexpected error:
                                timed out waiting for the condition
                Test:           TestResourceManagerAddedCRD
FAIL


ERROR: exit status 1

20s: 1228 runs so far, 3 failures (0.24%), 16 active
^C
[root@raji-x86-workspace1 kubernetes]#
 ```
```
[root@raji-x86-workspace1 kubernetes]# /root/go/bin/stress ./apiserver.test  -test.run TestDiscoveryControllerResourceManagerRemovedCRD

/tmp/go-stress-20250620T013722-1214723754
I0620 01:37:23.401497  882604 customresource_discovery_controller.go:294] Starting DiscoveryController
--- FAIL: TestDiscoveryControllerResourceManagerRemovedCRD (1.01s)
    customresource_discovery_controller_test.go:408:
                Error Trace:    /root/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:408
                Error:          Received unexpected error:
                                timed out waiting for the condition
                Test:           TestDiscoveryControllerResourceManagerRemovedCRD
FAIL


ERROR: exit status 1

5s: 189 runs so far, 1 failures (0.53%), 16 active

/tmp/go-stress-20250620T013722-3937345706
I0620 01:37:30.666243  886121 customresource_discovery_controller.go:294] Starting DiscoveryController
--- FAIL: TestDiscoveryControllerResourceManagerRemovedCRD (1.00s)
    customresource_discovery_controller_test.go:408:
                Error Trace:    /root/kubernetes/staging/src/k8s.io/apiextensions-apiserver/pkg/apiserver/customresource_discovery_controller_test.go:408
                Error:          Received unexpected error:
                                timed out waiting for the condition
                Test:           TestDiscoveryControllerResourceManagerRemovedCRD
FAIL


ERROR: exit status 1

10s: 398 runs so far, 2 failures (0.50%), 16 active
^C
[root@raji-x86-workspace1 kubernetes]#
```

### Relevant SIG(s)

/sig testing","['kind/flake', 'sig/testing', 'needs-triage']",open,2025-06-20T08:45:05Z,,performance,"['kind/flake', 'sig/testing', 'needs-triage']",True,,
kubernetes/kubernetes,132416,Proposal: Kubelet to add a preset label for Swap enabled nodes,"### What would you like to be added?

Add swap labels to swap-enabled nodes to allow admin to target swap demanding pods selectively for scheduling on specific nodes.

eg:

```
 node.kubernetes.io/swap-behavior: ""LimitedSwap""
```

This follows precedent in kubelet auto-adding hardware/os features as node-label metadata. eg: https://kubernetes.io/docs/reference/node/node-labels/#preset-labels

### Why is this needed?

This is desirable to ensure that only specific swap needing Pods run on swap setup nodes with certain isolation. 

Swap labels doesn't replace but will be additive to other swap scheduling improvements and/or NodeCapabilities in Kubernetes as it also enables efficient filtering and monitoring of swap provisioned nodes.","['sig/node', 'kind/feature', 'needs-triage']",open,2025-06-20T06:15:53Z,,performance,"['sig/node', 'kind/feature', 'needs-triage']",True,,
kubernetes/kubernetes,132415,Proposal: Runtime-Level Overcommit Model for Burstable Workloads Inspired by Financial Systems,"### What would you like to be added?

Feature Request: Observability-Based Runtime Overcommit for Burstable Workloads
Kubernetes currently enforces static ResourceQuota at the namespace level, which becomes counterproductive in clusters where workloads are predominantly burstable (i.e., requests < limits). The quota model effectively flattens all container limits into a hard ceiling, preventing efficient shared resource utilization—even if most workloads are well below their limits.

This rigid enforcement eliminates the benefits of burstable QoS and contradicts the shared-resource philosophy of Kubernetes.

Proposed Solution:
Introduce a runtime-level overcommit model with observability, inspired by financial risk management practices. In banking, individual and corporate customers are assigned credit limits that often exceed the institution’s total liquidity—assuming not all customers will utilize their full limit simultaneously. Real-time monitoring and risk engines ensure the system stays within safe operating bounds.

Kubernetes could adopt a similar model:

Replace (or complement) static quota enforcement with runtime metrics-aware policies.

Allow overcommit beyond namespace quotas as long as the cluster has available headroom.

Introduce observability hooks or admission plugins that warn, throttle, or deny burst if global limits are at risk.

Benefits:
More efficient resource utilization in shared environments.

Preserves burstable QoS semantics.

Closer alignment with real-world elastic demand patterns.

This model could optionally be opt-in via a new feature gate, scheduler policy, or dynamic admission controller.

Happy to collaborate for a draft KEP if there's interest from the community.

### Why is this needed?

For more efficient resource utilization in shared environments within namespase/project/cluster level budgets/quotas.","['kind/feature', 'needs-sig', 'needs-triage']",open,2025-06-20T06:00:01Z,,performance,"['kind/feature', 'needs-sig', 'needs-triage']",True,,
kubernetes/kubernetes,132404,Replacing deprecated package k8s.io/utils/pointer with k8s.io/utils/ptr,"### What would you like to be added?

Based on the Issue #127888 ([Umbrella] Make client-go lighter and easier to consume) I started the replacement of the deprecated package 'k8s.io/utils/pointer' with the package 'k8s.io/utils/ptr'.
I found more than >150 Imports of the deprecated Package through the codebase.

### Why is this needed?

Removing deprecations is always a good idea.","['kind/cleanup', 'kind/feature', 'priority/important-longterm', 'needs-sig', 'area/dependency', 'area/code-organization', 'needs-triage']",closed,2025-06-19T13:02:16Z,2025-06-20T04:49:49Z,bug,"['kind/cleanup', 'kind/feature', 'priority/important-longterm', 'needs-sig', 'area/dependency', 'area/code-organization', 'needs-triage']",True,0.0,
kubernetes/kubernetes,132403,imageMaximumGCAge download /remove loop with CreateContainerConfigError state,"### What happened?

Hi,

After setting `imageMaximumGCAge: ""168h""` in our clusters we noticed high traffic from one development cluster. This is caused by same images being re-downloaded every 5 minutes.

These images are used in pods currently in `CreateContainerConfigError` state. Would be nice not to have those, but developers tend to leave their configs broken for a while from time to time...

### What did you expect to happen?

Apparently images are downloaded even if the there is a config error, so they should not be GCd.

### How can we reproduce it (as minimally and precisely as possible)?

Set low `imageMaximumGCAge` and create pod with config error. Download loop should happen after `imageMaximumGCAge` is hit.

### Anything else we need to know?

Logs showing removal and download of same image:

```
Jun 19 11:44:20 XXX kubelet[811]: I0619 11:44:20.612999     811 image_gc_manager.go:487] ""Removing image to free bytes"" imageID=""sha256:b0e3dXXX"" size=73998917 runtimeHandler=""""
Jun 19 11:44:20 XXX containerd[726]: time=""2025-06-19T11:44:20.613218825Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\""""
Jun 19 11:44:20 XXX containerd[726]: time=""2025-06-19T11:44:20.615450139Z"" level=info msg=""ImageDelete event name:\""sha256:b0e3dXXX\""""
Jun 19 11:44:21 XXX containerd[726]: time=""2025-06-19T11:44:21.213006175Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\"" returns successfully""
Jun 19 11:44:44 XXX containerd[726]: time=""2025-06-19T11:44:44.197490953Z"" level=info msg=""ImageCreate event name:\""sha256:b0e3dXXX\"" labels:{key:\""io.cri-containerd.image\"" value:\""managed\""}""
Jun 19 11:44:44 XXX containerd[726]: time=""2025-06-19T11:44:44.199710890Z"" level=info msg=""Pulled image \""XXX\"" with image id \""sha256:b0e3dXXX\"", repo tag \""docker.io/XXX\"", repo digest \""docker.io/XXX\"", size \""73998917\"" in 5.048435516s""
Jun 19 11:44:44 XXX containerd[726]: time=""2025-06-19T11:44:44.199734786Z"" level=info msg=""PullImage \""XXX\"" returns image reference \""sha256:b0e3dXXX\""""
Jun 19 11:49:21 XXX kubelet[811]: I0619 11:49:21.984228     811 image_gc_manager.go:487] ""Removing image to free bytes"" imageID=""sha256:b0e3dXXX"" size=73998917 runtimeHandler=""""
Jun 19 11:49:21 XXX containerd[726]: time=""2025-06-19T11:49:21.985035449Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\""""
Jun 19 11:49:21 XXX containerd[726]: time=""2025-06-19T11:49:21.987898122Z"" level=info msg=""ImageDelete event name:\""sha256:b0e3dXXX\""""
Jun 19 11:49:22 XXX containerd[726]: time=""2025-06-19T11:49:22.449547321Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\"" returns successfully""
Jun 19 11:49:36 XXX containerd[726]: time=""2025-06-19T11:49:36.757847266Z"" level=info msg=""ImageCreate event name:\""sha256:b0e3dXXX\"" labels:{key:\""io.cri-containerd.image\"" value:\""managed\""}""
Jun 19 11:49:36 XXX containerd[726]: time=""2025-06-19T11:49:36.760564771Z"" level=info msg=""Pulled image \""XXX\"" with image id \""sha256:b0e3dXXX\"", repo tag \""docker.io/XXX\"", repo digest \""docker.io/XXX\"", size \""73998917\"" in 6.181031711s""
Jun 19 11:49:36 XXX containerd[726]: time=""2025-06-19T11:49:36.760586233Z"" level=info msg=""PullImage \""XXX\"" returns image reference \""sha256:b0e3dXXX\""""
Jun 19 11:54:24 XXX kubelet[811]: I0619 11:54:24.435420     811 image_gc_manager.go:487] ""Removing image to free bytes"" imageID=""sha256:b0e3dXXX"" size=73998917 runtimeHandler=""""
Jun 19 11:54:24 XXX containerd[726]: time=""2025-06-19T11:54:24.435614226Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\""""
Jun 19 11:54:24 XXX containerd[726]: time=""2025-06-19T11:54:24.438226633Z"" level=info msg=""ImageDelete event name:\""sha256:b0e3dXXX\""""
Jun 19 11:54:25 XXX containerd[726]: time=""2025-06-19T11:54:25.036297417Z"" level=info msg=""RemoveImage \""sha256:b0e3dXXX\"" returns successfully""
Jun 19 11:54:40 XXX containerd[726]: time=""2025-06-19T11:54:40.904006044Z"" level=info msg=""ImageCreate event name:\""sha256:b0e3dXXX\"" labels:{key:\""io.cri-containerd.image\"" value:\""managed\""}""
Jun 19 11:54:40 XXX containerd[726]: time=""2025-06-19T11:54:40.906558131Z"" level=info msg=""Pulled image \""XXX\"" with image id \""sha256:b0e3dXXX\"", repo tag \""docker.io/XXX\"", repo digest \""docker.io/XXX\"", size \""73998917\"" in 6.243500934s""
Jun 19 11:54:40 XXX containerd[726]: time=""2025-06-19T11:54:40.906584570Z"" level=info msg=""PullImage \""XXX\"" returns image reference \""sha256:b0e3dXXX\""""
```

### Kubernetes version

<details>

```console
$ kubectl version
Client Version: v1.31.9
Kustomize Version: v5.4.2
Server Version: v1.31.8
```

</details>


### Cloud provider

<details>
Self hosted.
</details>


### OS version

<details>

```console
# On Linux:
$ cat /etc/os-release
PRETTY_NAME=""Ubuntu 22.04.5 LTS""
NAME=""Ubuntu""
VERSION_ID=""22.04""
VERSION=""22.04.5 LTS (Jammy Jellyfish)""
VERSION_CODENAME=jammy
ID=ubuntu
ID_LIKE=debian
HOME_URL=""https://www.ubuntu.com/""
SUPPORT_URL=""https://help.ubuntu.com/""
BUG_REPORT_URL=""https://bugs.launchpad.net/ubuntu/""
PRIVACY_POLICY_URL=""https://www.ubuntu.com/legal/terms-and-policies/privacy-policy""
UBUNTU_CODENAME=jammy
$ uname -a
Linux XXX 5.15.0-141-generic #151-Ubuntu SMP Sun May 18 21:35:19 UTC 2025 x86_64 x86_64 x86_64 GNU/Linux

# On Windows:
C:\> wmic os get Caption, Version, BuildNumber, OSArchitecture
# paste output here
```

</details>


### Install tools

<details>
Kubespray v2.27.0
</details>


### Container runtime (CRI) and version (if applicable)

<details>
containerd github.com/containerd/containerd v1.7.26 753481ec61c7c8955a23d6ff7bc8e4daed455734
</details>


### Related plugins (CNI, CSI, ...) and versions (if applicable)

<details>

</details>
","['kind/bug', 'needs-sig', 'needs-triage']",open,2025-06-19T12:09:58Z,,security,"['kind/bug', 'needs-sig', 'needs-triage']",True,,
ansible/ansible,85367,"ERROR! Unexpected Exception, this is probably a bug: '_raw_params' occured","### Summary

Updated to  ansible [core 2.18.6] and still had same problem. 

Various steps in my play books generate the above error. 
The steps causing the problem have worked in the past, so I doubt the problem is in the steps themselves. 
The steps are:

```
  - name: Remove MySQL test database
    mysql_db: name=test state=absent

  - name: Disable binary logging
    asibnle.builtin.lineinfile:
      path: /etc/mysql/mysql.conf.d/mysqld.cnf
      search_string: ""disable_log_bin""
      line: ""disable_log_bin""
```

Disable binary logging failed, while I tried may variations. Then I commented it out, and the PREVIOUS step them failed. I know this makes little sense. 

The software versions in use on the ansible machine are: 
```
ian@ansible:~/ansible$ ansible --version
ansible [core 2.18.6]
  config file = /home/ian/.ansible.cfg
  configured module search path = ['/home/ian/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/ian/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.12.7 (main, Jun 18 2025, 13:16:51) [GCC 14.2.0] (/usr/bin/python3)
  jinja version = 3.1.3
  libyaml = True

ian@ansible:~/ansible$ cat /etc/lsb-release 
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=24.10
DISTRIB_CODENAME=oracular
DISTRIB_DESCRIPTION=""Ubuntu 24.10""
ian@ansible:~/ansible$ python3 --version
Python 3.12.7
ian@ansible:~/ansible$ 

```
The version s of software on the target machine are:

```
ian@bitfolk:~$ python3 --version
Python 3.12.3
ian@bitfolk:~$ cat /etc/lsb-release 
DISTRIB_ID=Ubuntu
DISTRIB_RELEASE=24.04
DISTRIB_CODENAME=noble
DISTRIB_DESCRIPTION=""Ubuntu 24.04.2 LTS""
ian@bitfolk:~$ 
```


### Issue Type

Bug Report

### Component Name

asibnle.builtin.lineinfile

### Ansible Version

```console
ansible [core 2.18.6]
  config file = /home/ian/.ansible.cfg
  configured module search path = ['/home/ian/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3/dist-packages/ansible
  ansible collection location = /home/ian/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.12.7 (main, Jun 18 2025, 13:16:51) [GCC 14.2.0] (/usr/bin/python3)
  jinja version = 3.1.3
  libyaml = True
```

### Configuration

```console
CONFIG_FILE() = /home/ian/.ansible.cfg
DEFAULT_HOST_LIST(/home/ian/.ansible.cfg) = ['/home/ian/ansible/playbooks/config/hosts']
DEFAULT_ROLES_PATH(/home/ian/.ansible.cfg) = ['/home/ian/ansible/playbooks/roles']
DEFAULT_VAULT_PASSWORD_FILE(/home/ian/.ansible.cfg) = /home/ian/.ansible/passwd
INTERPRETER_PYTHON(/home/ian/.ansible.cfg) = auto_silent
```

### OS / Environment

Ubunut 24.04 and 24.10 

### Steps to Reproduce

Created a (long) ansible playbook with the following two steps. 
```
  - name: Remove MySQL test database
    mysql_db: name=test state=absent

  - name: Disable binary logging
    ansible.builtin.lineinfile:
      path: /etc/mysql/mysql.conf.d/mysqld.cnf
      search_string: ""disable_log_bin""
      line: ""disable_log_bin""
```
### Expected Results

I expected the steps to be taken, but they failed with the message in the title. 
See main report for strangeness of results. 


### Actual Results

```console
TASK [installMySQL : Disable binary logging] *********************************************************************************************************************
task path: /home/ian/ansible/playbooks/roles/installMySQL/tasks/main.yml:57
<bitfolk.hcs> ESTABLISH SSH CONNECTION FOR USER: None
<bitfolk.hcs> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' bitfolk.hcs '/bin/sh -c '""'""'echo ~ && sleep 0'""'""''
<bitfolk.hcs> (0, b'/home/ian\n', b'')
<bitfolk.hcs> ESTABLISH SSH CONNECTION FOR USER: None
<bitfolk.hcs> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' bitfolk.hcs '/bin/sh -c '""'""'( umask 77 && mkdir -p ""` echo /home/ian/.ansible/tmp `""&& mkdir ""` echo /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482 `"" && echo ansible-tmp-1750470677.9586055-25522-141622179858482=""` echo /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482 `"" ) && sleep 0'""'""''
<bitfolk.hcs> (0, b'ansible-tmp-1750470677.9586055-25522-141622179858482=/home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482\n', b'')
Using module file /usr/lib/python3/dist-packages/ansible/modules/lineinfile.py
<bitfolk.hcs> PUT /home/ian/.ansible/tmp/ansible-local-249290antwqep/tmpq_1x0gqn TO /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/AnsiballZ_lineinfile.py
<bitfolk.hcs> SSH: EXEC sftp -b - -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' '[bitfolk.hcs]'
<bitfolk.hcs> (0, b'sftp> put /home/ian/.ansible/tmp/ansible-local-249290antwqep/tmpq_1x0gqn /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/AnsiballZ_lineinfile.py\n', b'')
<bitfolk.hcs> ESTABLISH SSH CONNECTION FOR USER: None
<bitfolk.hcs> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' bitfolk.hcs '/bin/sh -c '""'""'chmod u+x /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/ /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/AnsiballZ_lineinfile.py && sleep 0'""'""''
<bitfolk.hcs> (0, b'', b'')
<bitfolk.hcs> ESTABLISH SSH CONNECTION FOR USER: None
<bitfolk.hcs> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' -tt bitfolk.hcs '/bin/sh -c '""'""'sudo -H -S -p ""[sudo via ansible, key=ozlywtdvdarmalmbulniilzgobgdoplr] password:"" -u root /bin/sh -c '""'""'""'""'""'""'""'""'echo BECOME-SUCCESS-ozlywtdvdarmalmbulniilzgobgdoplr ; /usr/bin/python3 /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/AnsiballZ_lineinfile.py'""'""'""'""'""'""'""'""' && sleep 0'""'""''
Escalation succeeded
<bitfolk.hcs> (0, b'\r\n\r\n{""changed"": false, ""msg"": """", ""backup"": """", ""diff"": [{""before"": """", ""after"": """", ""before_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (content)"", ""after_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (content)""}, {""before_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (file attributes)"", ""after_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (file attributes)""}], ""invocation"": {""module_args"": {""path"": ""/etc/mysql/mysql.conf.d/mysqld.cnf"", ""search_string"": ""disable_log_bin"", ""line"": ""disable_log_bin"", ""state"": ""present"", ""backrefs"": false, ""create"": false, ""backup"": false, ""firstmatch"": false, ""unsafe_writes"": false, ""regexp"": null, ""insertafter"": null, ""insertbefore"": null, ""validate"": null, ""mode"": null, ""owner"": null, ""group"": null, ""seuser"": null, ""serole"": null, ""selevel"": null, ""setype"": null, ""attributes"": null}}}\r\n', b'Shared connection to bitfolk.hcs closed.\r\n')
<bitfolk.hcs> ESTABLISH SSH CONNECTION FOR USER: None
<bitfolk.hcs> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o KbdInteractiveAuthentication=no -o PreferredAuthentications=gssapi-with-mic,gssapi-keyex,hostbased,publickey -o PasswordAuthentication=no -o ConnectTimeout=10 -o 'ControlPath=""/home/ian/.ansible/cp/bf80a919c9""' bitfolk.hcs '/bin/sh -c '""'""'rm -f -r /home/ian/.ansible/tmp/ansible-tmp-1750470677.9586055-25522-141622179858482/ > /dev/null 2>&1 && sleep 0'""'""''
<bitfolk.hcs> (0, b'', b'')
ok: [bitfolk.hcs] => {
    ""backup"": """",
    ""changed"": false,
    ""diff"": [
        {
            ""after"": """",
            ""after_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (content)"",
            ""before"": """",
            ""before_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (content)""
        },
        {
            ""after_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (file attributes)"",
            ""before_header"": ""/etc/mysql/mysql.conf.d/mysqld.cnf (file attributes)""
        }
    ],
    ""invocation"": {
        ""module_args"": {
            ""attributes"": null,
            ""backrefs"": false,
            ""backup"": false,
            ""create"": false,
            ""firstmatch"": false,
            ""group"": null,
            ""insertafter"": null,
            ""insertbefore"": null,
            ""line"": ""disable_log_bin"",
            ""mode"": null,
            ""owner"": null,
            ""path"": ""/etc/mysql/mysql.conf.d/mysqld.cnf"",
            ""regexp"": null,
            ""search_string"": ""disable_log_bin"",
            ""selevel"": null,
            ""serole"": null,
            ""setype"": null,
            ""seuser"": null,
            ""state"": ""present"",
            ""unsafe_writes"": false,
            ""validate"": null
        }
    },
    ""msg"": """"
}
ERROR! Unexpected Exception, this is probably a bug: '_raw_params'
the full traceback was:

Traceback (most recent call last):
  File ""/usr/lib/python3/dist-packages/ansible/cli/__init__.py"", line 659, in cli_executor
    exit_code = cli.run()
                ^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/cli/playbook.py"", line 156, in run
    results = pbex.run()
              ^^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/executor/playbook_executor.py"", line 190, in run
    result = self._tqm.run(play=play)
             ^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/executor/task_queue_manager.py"", line 348, in run
    play_return = strategy.run(iterator, play_context)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/plugins/strategy/linear.py"", line 151, in run
    host_tasks = self._get_next_task_lockstep(hosts_left, iterator)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/plugins/strategy/linear.py"", line 71, in _get_next_task_lockstep
    state, task = iterator.get_next_task_for_host(host, peek=True)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File ""/usr/lib/python3/dist-packages/ansible/executor/play_iterator.py"", line 260, in get_next_task_for_host
    display.debug("" ^ task is: %s"" % task)
                  ~~~~~~~~~~~~~~~~~^~~~~~
  File ""/usr/lib/python3/dist-packages/ansible/playbook/task.py"", line 141, in __repr__
    return ""TASK: meta (%s)"" % self.args['_raw_params']
                               ~~~~~~~~~^^^^^^^^^^^^^^^
KeyError: '_raw_params'
ian@ansible:~/ansible$
```

### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['needs_triage', 'bug', 'affects_2.16', 'affects_2.18']",open,2025-06-21T01:53:25Z,,bug,"['needs_triage', 'bug', 'affects_2.16', 'affects_2.18']",False,,
ansible/ansible,85365,Technical information disclosure,"### Summary

<!---
The Ansible community is highly committed to the security of our open source
projects.  Security concerns should be reported directly by email to
security@ansible.com.  For more information on the Ansible community's
practices regarding responsible disclosure, see
https://www.ansible.com/security
-->

The applications Ansible disclose the versions of Ansible AWX (24.6.0), respectively, to unauthenticated users. This practice poses a security risk, as it allows attackers to easily identify the software versions in use and search for associated known vulnerabilities, which they could exploit to compromise the applications.

Information disclosure, also known as information leak, occurs when a website reveals sensitive 
information. Depending on the context, websites can disclose all kinds of information to a potential 
attacker, including:
Data concerning other users, such as usernames or financial information.
Sensitive commercial or professional data.
Technical details about the website and its infrastructure.
The dangers of leaking sensitive user or corporate data are obvious enough, but the disclosure of 
technical information can sometimes be equally severe. While some of this information may be of limited 
use, it can potentially provide a starting point for exposing an additional attack surface, which may 
contain other interesting vulnerabilities.


<!--

PLEASE DO NOT USE A BLANK TEMPLATE IN THE AWX REPO.
This is a legacy template used for internal testing ONLY.

Any issues opened will this template will be automatically closed.

Instead use the bug or feature request.

-->



##### ISSUE TYPE
<!--- Pick one below and delete the rest: -->
Bug, Docs Fix or other nominal change


##### COMPONENT NAME
<!-- Pick the area of AWX for this issue, you can have multiple, delete the rest: -->
 - API


##### SUMMARY
<!-- Briefly describe the problem. -->

##### ENVIRONMENT
* AWX version: 24.6.0
* AWX install method: operator, developer environment
* AWX deployment target: kubernetes
* Operating System: Ubuntu Linux
* Web Browser: any

##### STEPS TO REPRODUCE

<!-- For new features, show how the feature would be used. For bugs, please show
exactly how to reproduce the problem. Ideally, provide all steps and data needed
to recreate the bug from a new awx install. -->

##### EXPECTED RESULTS

<!-- For bug reports, what did you expect to happen when running the steps
above? -->
To enhance the security of the applications, it is crucial to conceal technical information, such as software 
versions, especially from unauthenticated users. Implementing this measure may require modifications 
to the source code sections that expose software version details.

##### ACTUAL RESULTS

<!-- For bug reports, what actually happened? -->
/

### Issue Type

Feature Idea

### Component Name

API

### Additional Information

<img width=""622"" alt=""Image"" src=""https://github.com/user-attachments/assets/28b6265b-0dff-499c-8c2f-2dad995a295e"" />

<!--- Paste example playbooks or commands between quotes below -->
```yaml (paste below)

```


### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['needs_info', 'needs_triage', 'needs_template', 'bug']",open,2025-06-20T13:47:39Z,,security,"['needs_info', 'needs_triage', 'needs_template', 'bug']",True,,
ansible/ansible,85363,ansible-galaxy setup through template,"### Summary

I want to be able to create roles and collections through my own standard based on the official setup generated by the ansible-galaxy command. 

As example: From what I understand from the official documentation is Travis still the default for CI/CD, while there are many other solutions like Gitlab, Github and so on. This means that I have to do two steps for setting up an empty role.

A suggestion to solve this, that it would be great if it is possible to create a role through a template or directory that can be used as a template for creating roles and collections just like the Python tool cookie-cutter.   

### Issue Type

Feature Idea

### Component Name

ansible-galaxy

### Additional Information

<!--- Paste example playbooks or commands between quotes below -->
```yaml (paste below)

```


### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['needs_triage', 'feature']",open,2025-06-20T10:34:30Z,,bug,"['needs_triage', 'feature']",True,,
ansible/ansible,85359,json.decoder.JSONDecodeError when using SSH_ASKPASS support with incorrect password (Python 3.13),"### Ansible Version

```console
ansible [core 2.19.0b6]
  config file = /Users/alex/.ansible.cfg
  configured module search path = ['/Users/alex/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /private/tmp/.venv/lib/python3.13/site-packages/ansible
  ansible collection location = /Users/alex/.ansible/collections:/usr/share/ansible/collections
  executable location = .venv/bin/ansible
  python version = 3.13.0 (main, Oct 16 2024, 08:05:40) [Clang 18.1.8 ] (/private/tmp/.venv/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

In Ansible 12a6 (ansible-core 2.19b6) on Python 3.13, attempting to connect over SSH, with an incorrect SSH password, causes a `JSONDecodeError` in `ansible.cli._ssh_askpass.main()`.

```console
➜  /tmp .venv/bin/ansible-playbook -i 192.168.67.3, -e ansible_ssh_password=wrong ssh_ping.yml -vvvv
ansible-playbook [core 2.19.0b6]
  config file = /Users/alex/.ansible.cfg
  configured module search path = ['/Users/alex/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /private/tmp/.venv/lib/python3.13/site-packages/ansible
  ansible collection location = /Users/alex/.ansible/collections:/usr/share/ansible/collections
  executable location = .venv/bin/ansible-playbook
  python version = 3.13.0 (main, Oct 16 2024, 08:05:40) [Clang 18.1.8 ] (/private/tmp/.venv/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
Using /Users/alex/.ansible.cfg as config file
setting up inventory plugins
Loading collection ansible.builtin from 
Parsed 192.168.67.3, inventory source with host_list plugin
Loading callback plugin default of type stdout, v2.0 from /private/tmp/.venv/lib/python3.13/site-packages/ansible/plugins/callback/default.py
Skipping callback 'default', as we already have a stdout callback.
Skipping callback 'minimal', as we already have a stdout callback.
Skipping callback 'oneline', as we already have a stdout callback.

PLAYBOOK: ssh_ping.yml ***********************************************************************************
Positional arguments: ssh_ping.yml
verbosity: 4
connection: ssh
become_method: sudo
tags: ('all',)
inventory: ('192.168.67.3,',)
extra_vars: ('ansible_ssh_password=wrong',)
forks: 5
1 plays in ssh_ping.yml

PLAY [all] ***********************************************************************************************

TASK [meta] **********************************************************************************************
task path: /private/tmp/ssh_ping.yml:8
<192.168.67.3> sending connection check: [b'ssh', b'-C', b'-o', b'ControlMaster=auto', b'-o', b'ControlPersist=60s', b'-o', b'User=""debian""', b'-o', b'ConnectTimeout=10', b'-o', b'ControlPath=""/Users/alex/.ansible/cp/79d4489580""', b'-O', b'check', b'192.168.67.3']
<192.168.67.3> No connection to reset: Control socket connect(/Users/alex/.ansible/cp/79d4489580): No such file or directory
META: reset connection

TASK [ping] **********************************************************************************************
task path: /private/tmp/ssh_ping.yml:9
<192.168.67.3> ESTABLISH SSH CONNECTION FOR USER: debian
<192.168.67.3> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'User=""debian""' -o ConnectTimeout=10 -o 'ControlPath=""/Users/alex/.ansible/cp/79d4489580""' 192.168.67.3 '/bin/sh -c '""'""'echo ~debian && sleep 0'""'""''
<192.168.67.3> (255, b'', b'Permission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\ndebian@192.168.67.3: Permission denied (publickey,password).\r\n')
<192.168.67.3> ESTABLISH SSH CONNECTION FOR USER: debian
<192.168.67.3> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'User=""debian""' -o ConnectTimeout=10 -o 'ControlPath=""/Users/alex/.ansible/cp/79d4489580""' 192.168.67.3 '/bin/sh -c '""'""'echo ""`pwd`"" && sleep 0'""'""''
<192.168.67.3> (255, b'', b'Permission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\ndebian@192.168.67.3: Permission denied (publickey,password).\r\n')
<192.168.67.3> ESTABLISH SSH CONNECTION FOR USER: debian
<192.168.67.3> SSH: EXEC ssh -C -o ControlMaster=auto -o ControlPersist=60s -o 'User=""debian""' -o ConnectTimeout=10 -o 'ControlPath=""/Users/alex/.ansible/cp/79d4489580""' 192.168.67.3 '/bin/sh -c '""'""'( umask 77 && mkdir -p ""` echo ~/.ansible/tmp `""&& mkdir ""` echo ~/.ansible/tmp/ansible-tmp-1750342255.1596758-29940-177458359385974 `"" && echo ansible-tmp-1750342255.1596758-29940-177458359385974=""` echo ~/.ansible/tmp/ansible-tmp-1750342255.1596758-29940-177458359385974 `"" ) && sleep 0'""'""''
<192.168.67.3> (255, b'', b'Permission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b\'\\x00\'))\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode\n    raise JSONDecodeError(""Expecting value"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\ndebian@192.168.67.3: Permission denied (publickey,password).\r\n')
[ERROR]: Task failed: SSH encountered an unknown error. The output was:
Permission denied, please try again.
Traceback (most recent call last):
  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>
    from ansible.cli.adhoc import main
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>
    _ssh_askpass.main()
    ~~~~~~~~~~~~~~~~~^^
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main
    cfg = json.loads(shm.buf.tobytes().rstrip(b'\x00'))
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
Permission denied, please try again.
Traceback (most recent call last):
  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>
    from ansible.cli.adhoc import main
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>
    _ssh_askpass.main()
    ~~~~~~~~~~~~~~~~~^^
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main
    cfg = json.loads(shm.buf.tobytes().rstrip(b'\x00'))
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
debian@192.168.67.3: Permission denied (publickey,password).
, stderr output: Permission denied, please try again.
Traceback (most recent call last):
  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>
    from ansible.cli.adhoc import main
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>
    _ssh_askpass.main()
    ~~~~~~~~~~~~~~~~~^^
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main
    cfg = json.loads(shm.buf.tobytes().rstrip(b'\x00'))
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
Permission denied, please try again.
Traceback (most recent call last):
  File ""/private/tmp/.venv/bin/ansible"", line 4, in <module>
    from ansible.cli.adhoc import main
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py"", line 21, in <module>
    _ssh_askpass.main()
    ~~~~~~~~~~~~~~~~~^^
  File ""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py"", line 35, in main
    cfg = json.loads(shm.buf.tobytes().rstrip(b'\x00'))
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py"", line 346, in loads
    return _default_decoder.decode(s)
           ~~~~~~~~~~~~~~~~~~~~~~~^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 344, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File ""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py"", line 362, in raw_decode
    raise JSONDecodeError(""Expecting value"", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
debian@192.168.67.3: Permission denied (publickey,password).
Origin: /private/tmp/ssh_ping.yml:9:7

7   tasks:
8     - meta: reset_connection
9     - ping:
        ^ column 7

fatal: [192.168.67.3]: UNREACHABLE! => {
    ""changed"": false,
    ""msg"": ""Task failed: SSH encountered an unknown error. The output was:\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File \""/private/tmp/.venv/bin/ansible\"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py\"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py\"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b'\\x00'))\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py\"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 362, in raw_decode\n    raise JSONDecodeError(\""Expecting value\"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File \""/private/tmp/.venv/bin/ansible\"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py\"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py\"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b'\\x00'))\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py\"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 362, in raw_decode\n    raise JSONDecodeError(\""Expecting value\"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\ndebian@192.168.67.3: Permission denied (publickey,password).\r\n, stderr output: Permission denied, please try again.\r\nTraceback (most recent call last):\n  File \""/private/tmp/.venv/bin/ansible\"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py\"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py\"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b'\\x00'))\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py\"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 362, in raw_decode\n    raise JSONDecodeError(\""Expecting value\"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\nPermission denied, please try again.\r\nTraceback (most recent call last):\n  File \""/private/tmp/.venv/bin/ansible\"", line 4, in <module>\n    from ansible.cli.adhoc import main\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/__init__.py\"", line 21, in <module>\n    _ssh_askpass.main()\n    ~~~~~~~~~~~~~~~~~^^\n  File \""/private/tmp/.venv/lib/python3.13/site-packages/ansible/cli/_ssh_askpass.py\"", line 35, in main\n    cfg = json.loads(shm.buf.tobytes().rstrip(b'\\x00'))\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/__init__.py\"", line 346, in loads\n    return _default_decoder.decode(s)\n           ~~~~~~~~~~~~~~~~~~~~~~~^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 344, in decode\n    obj, end = self.raw_decode(s, idx=_w(s, 0).end())\n               ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^\n  File \""/Users/alex/.local/share/uv/python/cpython-3.13.0-macos-aarch64-none/lib/python3.13/json/decoder.py\"", line 362, in raw_decode\n    raise JSONDecodeError(\""Expecting value\"", s, err.value) from None\njson.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)\ndebian@192.168.67.3: Permission denied (publickey,password)."",
    ""unreachable"": true
}

PLAY RECAP ***********************************************************************************************
192.168.67.3               : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0   
```

If a correct password is used then no error occurs and the conection succeeds

```console
➜  /tmp .venv/bin/ansible-playbook -i 192.168.67.3, -e ansible_ssh_password=debian ssh_ping.yml

PLAY [all] ***********************************************************************************************

TASK [meta] **********************************************************************************************

TASK [ping] **********************************************************************************************
ok: [192.168.67.3]

PLAY RECAP ***********************************************************************************************
192.168.67.3               : ok=1    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

```yaml
# ssh_ping.yml
- hosts: all
  gather_facts: false
  vars:
    ansible_python_interpreter: /usr/bin/python3
    ansible_ssh_user: debian
    ansible_ssh_password: wrong
  tasks:
    - meta: reset_connection
    - ping:
```

Controller is macOS 15.5. `sshpass` 1.10 is present on the controller, and `ssh_connection.password_mechanim` has been left at the default `ssh_askpass`

```console
➜  /tmp uname -a
Darwin kintha 24.5.0 Darwin Kernel Version 24.5.0: Tue Apr 22 19:54:49 PDT 2025; root:xnu-11417.121.6~2/RELEASE_ARM64_T6000 arm64
➜  /tmp ssh -V       
OpenSSH_9.9p2, LibreSSL 3.3.6
➜  /tmp which sshpass
/Users/alex/.nix-profile/bin/sshpass
➜  /tmp sshpass -V       
sshpass 1.10
(C) 2006-2011 Lingnu Open Source Consulting Ltd.
(C) 2015-2016, 2021-2022 Shachar Shemesh
This program is free software, and can be distributed under the terms of the GPL
See the COPYING file for more information.

Using ""assword"" as the default password prompt indicator.
```

Target is Debian 12

```console
➜  /tmp ssh debian@192.168.67.3
debian@192.168.67.3's password: 
Linux debian 6.1.0-37-arm64 #1 SMP Debian 6.1.140-1 (2025-05-22) aarch64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Thu Jun 19 07:14:51 2025 from 192.168.67.1
debian@debian:~$ uname -a
Linux debian 6.1.0-37-arm64 #1 SMP Debian 6.1.140-1 (2025-05-22) aarch64 GNU/Linux
debian@debian:~$ lsb
lsblk        lsb_release  
debian@debian:~$ lsb_release -a
No LSB modules are available.
Distributor ID: Debian
Description:    Debian GNU/Linux 12 (bookworm)
Release:        12
Codename:       bookworm
```

Python 3.12 emits a resource warning, rather than an error.

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['needs_triage', 'bug', 'has_pr', 'affects_2.19', 'pre_release']",open,2025-06-19T14:23:40Z,,performance,"['needs_triage', 'bug', 'has_pr', 'affects_2.19', 'pre_release']",True,,
ansible/ansible,85357,import_playbook does not add playbook dir to collection loader playbook paths,"The existing code to add the playbook path for `import_playbook` does not work and has no tests:

https://github.com/ansible/ansible/blob/fa9f2860967c441e0d5fae6ecd386a502d8488d4/lib/ansible/playbook/playbook_include.py#L94

@ansibot bot_skip
","['bug', 'core-internal']",open,2025-06-18T23:55:47Z,,bug,"['bug', 'core-internal']",False,,
ansible/ansible,85354,User home default access rights differ when full path doesn't exist (Ubuntu 22),"### Summary

On the target host running Ubuntu 22, when I create a user and their home directory, the home directory permissions do not follow the default if the parent directory does not exist:
- The default permissions (when creating a user with `useradd`) are `755` on Ubuntu 20 and `750` on Ubuntu 22.
- The default permissions (when creating a user with `useradd`) are `750` on Ubuntu 22, even if parent folders don't exist.

### Issue Type

Bug Report

### Component Name

user

### Ansible Version

```console
$ ansible --version
ansible [core 2.16.14]
  config file = /home/<user>/.ansible.cfg
  configured module search path = ['/home/<user>/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/lib/python3.12/site-packages/ansible
  ansible collection location = /home/<user>/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/bin/ansible
  python version = 3.12.10 (main, Apr 22 2025, 00:00:00) [GCC 14.2.1 20240912 (Red Hat 14.2.1-3)] (/usr/bin/python3)
  jinja version = 3.1.6
  libyaml = True
```

### Configuration

```console
# if using a version older than ansible-core 2.12 you should omit the '-t all'
$ ansible-config dump --only-changed -t all
Using /home/<user>/.ansible.cfg as config file
CALLBACKS_ENABLED(/home/<user>/.ansible.cfg) = ['profile_roles', 'timer', 'tree']
CONFIG_FILE() = /home/<user>/.ansible.cfg
DEFAULT_HOST_LIST(/home/<user>/.ansible.cfg) = ['/home/<user>/.ansible/inventories/vagrant_ansible_inventory', '/home/<user>/.ansible/inventories/vm_ansible_i>
DEFAULT_VERBOSITY(/home/<user>/.ansible.cfg) = 1
EDITOR(env: EDITOR) = nvim
ENABLE_TASK_DEBUGGER(/home/<user>/.ansible.cfg) = True
INVENTORY_ENABLED(/home/<user>/.ansible.cfg) = ['aws_ec2', 'yaml', 'ini']

CALLBACK:
========

tree:
____
directory(/home/<user>/.ansible.cfg) = /home/<user>/.ansible/tree
```

### OS / Environment

- Source OS: 
  + Fedora 40
  + Ubuntu 24.04
- Target OS:
  + Ubuntu 22

### Steps to Reproduce

```yaml
# Here, the home directory has `755` access rights on Ubuntu 20 and `750` on Ubuntu 22 (correct). `/home` already exists.
- hosts: all
  tasks:
  - name: Add group bar
    group:
      name: bar
    become: true

  - name: Add user bar
    user:
      name: bar
      group: bar
      home: /home/bar
      shell: /bin/bash
    become: true

# Here, the home directory has `755` access rights on Ubuntu 20 and also on Ubuntu 22, instead of `750`. `/home/users` do not already exists.
  - name: Add group foo
    group:
      name: foo
    become: true

  - name: Add user foo
    user:
      name: foo
      group: foo
      home: /home/users/foo
      shell: /bin/bash
    become: true
```

### Expected Results

I expect access rights to respect the default ones, whether parent folders exist or not.


### Actual Results

```console
$ ansible-playbook -l Vagrant test.yml
Using /home/<user>/.ansible.cfg as config file

PLAY [all] ****************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************
mercredi 18 juin 2025  16:05:14 +0200 (0:00:00.007)       0:00:00.007 *********
ok: [vagrant-ubuntu22]
ok: [vagrant-ubuntu20]

TASK [Add group bar] ******************************************************************************************************************************************
mercredi 18 juin 2025  16:05:17 +0200 (0:00:03.478)       0:00:03.486 *********
changed: [vagrant-ubuntu22] => {""changed"": true, ""gid"": 1001, ""name"": ""bar"", ""state"": ""present"", ""system"": false}
changed: [vagrant-ubuntu20] => {""changed"": true, ""gid"": 1001, ""name"": ""bar"", ""state"": ""present"", ""system"": false}

TASK [Add user bar] *******************************************************************************************************************************************
mercredi 18 juin 2025  16:05:20 +0200 (0:00:02.273)       0:00:05.759 *********
changed: [vagrant-ubuntu22] => {""changed"": true, ""comment"": """", ""create_home"": true, ""group"": 1001, ""home"": ""/home/bar"", ""name"": ""bar"", ""shell"": ""/bin/bash"", ""state"": ""present"", ""system"": false, ""uid"": 1001}
changed: [vagrant-ubuntu20] => {""changed"": true, ""comment"": """", ""create_home"": true, ""group"": 1001, ""home"": ""/home/bar"", ""name"": ""bar"", ""shell"": ""/bin/bash"", ""state"": ""present"", ""system"": false, ""uid"": 1001}

TASK [Add group foo] ******************************************************************************************************************************************
mercredi 18 juin 2025  16:05:22 +0200 (0:00:02.254)       0:00:08.013 *********
changed: [vagrant-ubuntu22] => {""changed"": true, ""gid"": 1002, ""name"": ""foo"", ""state"": ""present"", ""system"": false}
changed: [vagrant-ubuntu20] => {""changed"": true, ""gid"": 1002, ""name"": ""foo"", ""state"": ""present"", ""system"": false}

TASK [Add user foo] *******************************************************************************************************************************************
mercredi 18 juin 2025  16:05:24 +0200 (0:00:02.249)       0:00:10.263 *********
changed: [vagrant-ubuntu22] => {""changed"": true, ""comment"": """", ""create_home"": true, ""group"": 1002, ""home"": ""/home/users/foo"", ""name"": ""foo"", ""shell"": ""/bin/bash"", ""state"": ""present"", ""stderr"": ""useradd: warning: the home directory /home/users/foo already exists.\nuseradd: Not copying any file from skel directory into it.\n"", ""stderr_lines"": [""useradd: warning: the home directory /home/users/foo already exists."", ""useradd: Not copying any file from skel directory into it.""], ""system"": false, ""uid"": 1002}
changed: [vagrant-ubuntu20] => {""changed"": true, ""comment"": """", ""create_home"": true, ""group"": 1002, ""home"": ""/home/users/foo"", ""name"": ""foo"", ""shell"": ""/bin/bash"", ""state"": ""present"", ""stderr"": ""useradd: warning: the home directory /home/users/foo already exists.\nuseradd: Not copying any file from skel directory into it.\n"", ""stderr_lines"": [""useradd: warning: the home directory /home/users/foo already exists."", ""useradd: Not copying any file from skel directory into it.""], ""system"": false, ""uid"": 1002}

PLAY RECAP ****************************************************************************************************************************************************
vagrant-ubuntu20           : ok=5    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
vagrant-ubuntu22           : ok=5    changed=4    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
```

### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['module', 'needs_triage', 'bug', 'affects_2.16']",open,2025-06-18T14:17:34Z,,security,"['module', 'needs_triage', 'bug', 'affects_2.16']",True,,
ansible/ansible,85341,HTTPSConnection.__init__() got an unexpected keyword argument 'cert_file' with unarchive,"### Summary

When trying to download a file with https in the unarchive module from a control (python 3.11) on target node (python 3.13), the download fails due to unexpected keyword argument 'cert_file'.

### Issue Type

Bug Report

### Component Name

unarchive

### Ansible Version

```console
ansible==11.6.0
ansible-core==2.18.6
```

### Configuration

```console
CONFIG_FILE() = None
```

### OS / Environment

Debian 12 (Target system Debian 13)

### Steps to Reproduce

Running on Python < 3.13.3 on control to target system >= 3.13
```yaml (paste below)
  ansible.builtin.unarchive:
    src: https://example.com/example.zip
    dest: /usr/local/bin
    remote_src: yes
```


### Expected Results

Use new keyword for newer python versions.

### Actual Results

```console
Failure downloading https://example.com/example.zip, An unknown error occurred: HTTPSConnection.__init__() got an unexpected keyword argument 'cert_file'
```

### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['module', 'bug']",closed,2025-06-16T08:57:01Z,2025-06-16T09:25:09Z,bug,"['module', 'bug']",False,0.0,
ansible/ansible,85340,Only restrict dependency version when real bug is identified,"### Summary

The package restricts the upper-bound versions for dependencies.

https://github.com/ansible/ansible/blob/f6be5ab2241377b93d5fc06c87d6bf86c4225123/pyproject.toml#L2

This causes a build error when packaging for Arch Linux (RISC-V), which has a setuptools 80.9.0. We need to patch it every time we build ansible, which leads to a tough time for downstream distributions.

We recommend not arbitrarily setting an upper-bound; instead, only restrict when a certain bug is identified or reported.

### Issue Type

Feature Idea

### Component Name

distribution

### Additional Information

<!--- Paste example playbooks or commands between quotes below -->
```yaml (paste below)

```
N/A

### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['has_pr', 'feature']",closed,2025-06-16T07:41:27Z,2025-06-16T17:54:11Z,bug,"['has_pr', 'feature']",True,0.0,
ansible/ansible,85339,My SSH keeps getting bricked by Ansible after a playbook fails,"### Summary

After I run a playbook with an error, I can no longer ssh into my server. Sometimes a restart isn't good enough. I have to straight up restore the server from a backup. I don't know what the hell is going on.

After restoring from backup, i also get:

[WARNING]: sftp transfer mechanism failed on [142.93.152.9]. Use ANSIBLE_DEBUG=1 to see detailed information
[WARNING]: scp transfer mechanism failed on [142.93.152.9]. Use ANSIBLE_DEBUG=1 to see detailed information

### Issue Type

Bug Report

### Component Name

pip

### Ansible Version

```console
$ ansible --version
ansible [core 2.18.6]
  config file = None
  configured module search path = ['/home/maste/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /home/maste/.local/lib/python3.12/site-packages/ansible
  ansible collection location = /home/maste/.ansible/collections:/usr/share/ansible/collections
  executable location = /home/maste/.local/bin/ansible
  python version = 3.12.9 (main, Feb  4 2025, 00:00:00) [GCC 11.5.0 20240719 (Red Hat 11.5.0-5)] (/usr/bin/python3.12)
  jinja version = 3.1.6
  libyaml = True
```

### Configuration

```console
# if using a version older than ansible-core 2.12 you should omit the '-t all'
$ ansible-config dump --only-changed -t all
CONFIG_FILE() = None
```

### OS / Environment

AlmaLinux 9

### Steps to Reproduce

<!--- Paste example playbooks or commands between quotes below -->
```yaml (paste below)
- name: Deploy website
  hosts: elijahlopez_ca_1
  tasks:
  - name: Install Caddy
    community.general.copr:
      name: '@caddy/caddy'
      chroot: fedora-rawhide-{{ ansible_facts.architecture }}
      includepkgs:
      - caddy

  - name: Config Caddy
    ansible.builtin.copy:
      src: ../config/Caddyfile
      dest: /etc/caddy/Caddyfile
      mode: '0644'
    notify: Reload Caddy

  - name: Remove podman, buildah
    ansible.builtin.dnf:
      state: absent
      name:
      - podman
      - buildah

  - name: Add Docker CE Repo
    ansible.builtin.command: ""dnf config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo""
    args:
      creates: /etc/yum.repos.d/docker-ce.repo

  - name: Install deps
    ansible.builtin.dnf:
      name:
      - python3-pip
      - docker-ce
      - docker-ce-cli
      - containerd.io
      - git
      state: present

  - name: Enable docker daemon
    ansible.builtin.systemd_service:
      name: docker
      state: started
      enabled: true

  - name: Install docker SDK
    ansible.builtin.pip:
      name:
      - docker
      state: present

  - name: Log into GHCR registry
    community.docker.docker_login:
      registry_url: https://ghcr.io
      username: elibroftw
      password: ""{{ docker_ghcr_pass }}""
      reauthorize: false

- name: Deploy Rybbit
  hosts: elijahlopez_ca_1
  tasks:
    - name: Clone or pull Rybbit repository
      ansible.builtin.git:
        repo: https://github.com/rybbit-io/rybbit.git
        dest: /opt/rybbit
        update: yes
      notify: Deploy Rybbit

    - name: Make setup.sh executable
      ansible.builtin.file:
        path: /opt/rybbit/setup.sh
        state: file
        mode: u+x

    - name: Run Rybbit setup script
      ansible.builtin.command: /opt/rybbit/setup.sh ryb.elijahlopez.ca --no-webserver
      args:
        creates: /opt/rybbit/.setup_done

    - name: Create sentinel file
      ansible.builtin.file:
        path: /opt/rybbit/.setup_done
        state: touch
        mode: '0644'

  handlers:
  - name: Deploy Rybbit
    community.docker.docker_compose_v2:
        project_src: /opt/rybbit
        services:
          - backend
          - client
          - clickhouse
          - postgres
        state: present
        started: true

```


### Expected Results

I should be to run the playbook

### Actual Results

```console
[maste@SURFACE personal-self-hosted]$ ansible-playbook --ask-vault-pass -i inventory.yml playbooks/self_hosting.yml
Vault password: 

PLAY [Deploy website] **************************************************************************************************************************************************************************

TASK [Gathering Facts] *************************************************************************************************************************************************************************
fatal: [elijahlopez_ca_1]: UNREACHABLE! => {""changed"": false, ""msg"": ""Failed to connect to the host via ssh: kex_exchange_identification: read: Connection reset by peer\r\nConnection reset by 142.93.152.9 port 22"", ""unreachable"": true}

PLAY RECAP *************************************************************************************************************************************************************************************
elijahlopez_ca_1           : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0

[maste@SURFACE personal-self-hosted]$ ansible-playbook --ask-vault-pass -i inventory.yml playbooks/self_hosting.yml
Vault password: 

PLAY [Deploy website] **************************************************************************************************************************************************************************

TASK [Gathering Facts] *************************************************************************************************************************************************************************
fatal: [elijahlopez_ca_1]: UNREACHABLE! => {""changed"": false, ""msg"": ""Failed to connect to the host via ssh: ssh: connect to host 142.93.152.9 port 22: Connection refused"", ""unreachable"": true}

PLAY RECAP *************************************************************************************************************************************************************************************
elijahlopez_ca_1           : ok=0    changed=0    unreachable=1    failed=0    skipped=0    rescued=0    ignored=0
```

### Code of Conduct

- [x] I agree to follow the Ansible Code of Conduct","['module', 'bug', 'affects_2.15', 'affects_2.18']",closed,2025-06-15T21:29:20Z,2025-06-16T22:20:25Z,bug,"['module', 'bug', 'affects_2.15', 'affects_2.18']",False,1.0,
ansible/ansible,85337,Core v2.19b / the new error message is too verbose and can be misleading,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

An example of the new error message :

```
[ERROR]: Task failed: Error while evaluating conditional: 'task_service_status_for_rndc' is undefined

Task failed.
Origin: /etc/ansible/roles/dns-bind/tasks/installation.yml:40:3

38
39 # a bug exists on Debian where the owner is not root and can cause access errors
40 - name: Bind DNS | system - adjust rndc key owner
     ^ column 3

<<< caused by >>>

Error while evaluating conditional: 'task_service_status_for_rndc' is undefined
Origin: /etc/ansible/roles/dns-bind/tasks/installation.yml:55:9

53     - { path: """"{{ role_bind_dist.etc_rndc_key }}"""",  owner: """"root"""", group: """"{{ role_bind_dist.group }}"""" }
54   # the configuration is not yet complete on the first installation if the service is not already started
55   when: >
           ^ column 9

failed: [ci-ansible-master] (item={'path': '/etc/bind/rndc.key', 'owner': 'root', 'group': 'bind'}) => {""""ansible_loop_var"""": """"item"""", """"changed"""": false, """"item"""": {""""group"""": """"bind"""", """"owner"""": """"root"""", """"path"""": """"/etc/bind/rndc.key""""}, """"msg"""": """"Task failed: Error while evaluating conditional: 'task_service_status_for_rndc' is undefined""""}
```


The error itself is fully valid, but :
* the new error message is too verbose. 
* the part before `<<cause by>>` is highly misleading by pointing to the task name that could contains the source of the error. While the real source could be elsewhere.  

This example is point-on for this problem, because the error is really elsewhere. 
The `where:` conditional has the error, and is correctly selected.
But the line containing the undefined variable [is on line 56](https://github.com/Daryes/ansible-roles/blob/6123e0605f19ea451fad39659f7d19c869bf3b68/roles/dns-bind/tasks/installation.yml#L56), which is not present in the error message, due to the yaml scalar.

This said, honestly going the way of the java error dump is not the good one.
If you really want to provide the task name (or the task module if there is no name), reduce it to this : 

```
[ERROR]: Task failed: 
Error while evaluating conditional: 'task_service_status_for_rndc' is undefined

Origin: /etc/ansible/roles/dns-bind/tasks/installation.yml:55:9

40 - name: Bind DNS | system - adjust rndc key owner
(...)
53     - { path: """"{{ role_bind_dist.etc_rndc_key }}"""",  owner: """"root"""", group: """"{{ role_bind_dist.group }}"""" }
54   # the configuration is not yet complete on the first installation if the service is not already started
55   when: >
           ^ column 9

failed: [ci-ansible-master] (item={'path': '/etc/bind/rndc.key', 'owner': 'root', 'group': 'bind'}) => {""""ansible_loop_var"""": """"item"""", """"changed"""": false, """"item"""": {""""group"""": """"bind"""", """"owner"""": """"root"""", """"path"""": """"/etc/bind/rndc.key""""}, """"msg"""": """"Task failed: Error while evaluating conditional: 'task_service_status_for_rndc' is undefined""""}
```

Ignore the empty lines and comment for the task name, and also take into account the presence of yaml scalar.
And no need to repeat 4+ times the error, 2 is more than enough (first line, last line in the json block)

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T22:23:38Z,2025-06-14T22:56:30Z,security,"['bug', 'affects_2.19', 'pre_release']",True,0.0,
ansible/ansible,85336,Core v2.19b / Error rendering template: No filter named 'ipaddr' found (or ipv4 or others moved from netcommon),"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)



And the collections : 

$ ansible-galaxy collection list
# /home/ansible/.ansible/collections/ansible_collections
Collection           Version
-------------------- --------
ansible.netcommon    8.0.0
ansible.posix        2.0.0
ansible.utils        6.0.0
ansible.windows      3.1.0
community.crypto     2.26.2
community.general    10.7.0
community.mysql      3.14.0
community.postgresql 4.1.0

# /usr/local/lib/python3.11/dist-packages/ansible/_internal/ansible_collections
Collection           Version
-------------------- --------
ansible._protomatter 2.19.0b5
```

### Summary

Nothing new, this error keep appearing from time to time (ex: #77244, #77221, #77192, ... or [this PR](https://github.com/ansible-collections/ansible.netcommon/pull/359) )
This time is with core 2.19b

When using those filters :
* ipaddr
* ipv4
* ipv6
* and probably all the other which were moved from netcommon

The following error will be raised : 
```
Error rendering template: No filter named 'ipaddr' found.
```
and
```
Error rendering template: No filter named 'ipv4' found.
```

The filters moved from netcommon must now be used with the full designation `ansible.utils.` as a prefix, otherwise the execution will halt on the task / template. 
It is not possible to use the short naming with them.

Can all the moved filters from netcommon be checked and fixed definitely, allowing the short naming ?

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T22:02:44Z,2025-06-14T22:44:11Z,bug,"['bug', 'affects_2.19', 'pre_release']",False,0.0,
ansible/ansible,85335,Core v2.19b / ansible_managed variable is deprecated,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

```
[DEPRECATION WARNING]: The `ansible_managed` variable is deprecated. This feature will be removed from ansible-core version 2.23.
Origin: /etc/ansible/roles/dns-bind/templates/etc/named/named.conf.options.j2
```

It seems there are contradictions, if not disagreements about the state of this variable everywhere with v2.19. 

As explained in [the ansible forum thread](https://forum.ansible.com/t/core-2-19-templating-changes-preview-and-testing/40759/34), even if in a locked mode, this variable must stay.  
Which would be the case, given the information stated by @bcoca in [the ansible forum](https://forum.ansible.com/t/core-2-19-templating-changes-preview-and-testing/40759/37). 

As such, the deprecation notice should be removed
Another problem for now is that there is no information nor statement about this in the 2.19 changes / porting guide ( at least for core v2.19.0b5).


### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T21:52:11Z,2025-06-14T21:58:47Z,bug,"['bug', 'affects_2.19', 'pre_release']",False,0.0,
ansible/ansible,85334,Core v2.19b / jinja2 templating directly in a task causing : Finalization of task args for 'ansible.builtin.set_fact' failed,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary


```
[ERROR]: Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for '_serial_over_hostgroups': access to attribute 'append' of '_AnsibleLazyTemplateList' object is unsafe.

Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed.
Origin: /etc/ansible/roles/_include-serial_over_hostgroups/tasks/main.yml:5:3

3 # using namespace for updating variables in a loop
4 # as such, it is required when updating to use : set x = ns.... = """"new value""""
5 - set_fact:
    ^ column 3

<<< caused by >>>

Error while resolving value for '_serial_over_hostgroups': access to attribute 'append' of '_AnsibleLazyTemplateList' object is unsafe.
Origin: /etc/ansible/roles/_include-serial_over_hostgroups/tasks/main.yml:6:30

4 # as such, it is required when updating to use : set x = ns.... = """"new value""""
5 - set_fact:
6     _serial_over_hostgroups: >-
                               ^ column 30

fatal: [ci-ansible-master]: FAILED! => {""""changed"""": false, """"msg"""": """"Task failed: Finalization of task args for 'ansible.builtin.set_fact' failed: Error while resolving value for '_serial_over_hostgroups': access to attribute 'append' of '_AnsibleLazyTemplateList' object is unsafe.""""}
```

The full code causing this error is available here : https://github.com/Daryes/ansible-roles/blob/master/roles/_include-serial_over_hostgroups/tasks/main.yml  

Afaik, I might be mistaken, but this is the sole existing solution both as a role and a function able to provide a working answer for a native ""serial by group"" in ansible.  
(With the downside of a huge wall of skipped line when initialized)

---

Also, same exact error for this code : https://github.com/Daryes/ansible-roles/blob/6123e0605f19ea451fad39659f7d19c869bf3b68/roles/dns-bind/tasks/main.yml#L6
Principle is the same as the error, the use in a `set_fact` of a jinja templating code to generate a dict.

This one gives the possibility of having a more intuitive inventory.  
The task search for all variables defined in the inventory through `hostvars[]` , with this format : `<group name the host is a member of>_suffix`.  
Allowing in a single call to retrieve all the related inventory definitions, and merge them in a dict.  
Which greatly reduce the burden for roles managing a module centralizing the information of multiples groups or hosts.  
Such as a dns server, or a monitoring server (the main configuration of prometheus server being a good candidate for that).  

This without the need to open the `hash_behaviour` pandora box by altering it to `merge`

Both works perfectly since ansible 2.7 (yeah, even before 2.9) up to 2.16.14 (not tested after), and need to be working in 2.19

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T21:32:47Z,2025-06-14T21:46:10Z,performance,"['bug', 'affects_2.19', 'pre_release']",True,0.0,
ansible/ansible,85333,Core v2.19b / --one-line parameter is deprecated ?,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

```
[DEPRECATION WARNING]: The '--one-line' argument is deprecated. This feature will be removed from ansible-core version 2.23.
[DEPRECATION WARNING]: The oneline callback plugin is deprecated. This feature will be removed from ansible-core version 2.23.
```
What's the rationale for this ? 
I didn't found any information about it, and this plugin is extremely useful with ad-hoc commands for a simpler output when having to verify a specific information for a very long list of servers. 
At the minimum, it makes the output easy to pipe to grep, sed, ...

Is there any replacement ?
If not, the --one-line parameter must stay.




### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T21:06:02Z,2025-06-17T00:50:13Z,bug,"['bug', 'affects_2.19', 'pre_release']",False,2.0,
ansible/ansible,85332,Core v2.19b / include_tasks limit the amount of recursive  calls then start restricting the file search path,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

Hard to find a correct title.

Got this error 
```
""[ERROR]: Could not find or access '/opt/repo/tests/ansible/debian_proc-uninstall.yml' on the Ansible Controller: Unable to retrieve file contents.
Could not find or access '/opt/repo/tests/ansible/debian_proc-uninstall.yml' on the Ansible Controller.
If you are using a module and expect the file to exist on the remote, see the remote_src option: [Errno 2] No such file or directory: '/opt/repo/tests/ansible/debian_proc-uninstall.yml'
""
```
The  '/opt/repo/tests/ansible/` location is from where the playbook was launched, The playbook itself only contains calls to roles.
The error lies in the fact ansible stopped looking into the directory of the current running role, and moved instead onto the playbook location.
This is running correctly on core 2.16 and older.

To reproduce, 
The file is loaded as a relative path [from here](https://github.com/Daryes/ansible-roles/blob/6123e0605f19ea451fad39659f7d19c869bf3b68/roles/_include-pkg_install/tasks/pkg-install/debian.yml#L4)
The whole _include-pkg_install role is loaded with include_role. (For example](https://github.com/Daryes/ansible-roles/blob/6123e0605f19ea451fad39659f7d19c869bf3b68/roles/sys-docker/tasks/main.yml#L50)

Given it was able to work for the first include_tasks, it seems the file search is purged when called from a file loaded ifself by include_tasks.

Said in another manner, in the same role myrole, under tasks, there are main.yml, file1.yml and file2.yml
* include_role: myrole => main.yml => include_tasks: file1.yml => ok
* include_role: myrole => main.yml => include_tasks: file2.yml => ok
* include_role: myrole => main.yml => include_tasks: file1.yml => has itself include_tasks: file2.yml => error on file2.yml not found

It seems similar to #85282


### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'affects_2.19', 'pre_release']",closed,2025-06-14T21:00:35Z,2025-06-17T21:41:06Z,bug,"['bug', 'affects_2.19', 'pre_release']",False,3.0,
ansible/ansible,85331,core v2.19b / regression in callback profile_tasks missing the task recap,"### Ansible Version

```console
For reference, core 2.19b version (Warning, dedicated docker image, no venv)

$ ansible --version
ansible [core 2.19.0b5]
  config file = /etc/ansible/ansible.cfg
  configured module search path = ['/home/ansible/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /usr/local/lib/python3.11/dist-packages/ansible
  ansible collection location = /server/ansible/ansible/collections:/home/ansible/.ansible/collections:/usr/share/ansible/collections
  executable location = /usr/local/bin/ansible
  python version = 3.11.2 (main, Apr 28 2025, 14:11:48) [GCC 12.2.0] (/usr/bin/python3)
  jinja version = 3.1.6
  pyyaml version = 6.0.2 (with libyaml v0.2.5)
```

### Summary

When activating the profile_tasks callback through the environment : `ANSIBLE_CALLBACKS_ENABLED=profile_tasks`
the final recap is missing the tasks recap section

In core v2.16.14 : 
```
""TASK [certificate-push-private : Certificate push private | ansible - register execution status in a fact] ***************************************************************************************************
Tuesday 10 June 2025  22:04:50 +0000 (0:00:01.192)       0:00:26.813 **********
changed: [ci-test-centos-2]
changed: [ci-test-centos-1]
changed: [ci-test-debian-1]

PLAY RECAP ***************************************************************************************************************************************************************************************************
ci-ansible-master          : ok=36   changed=24   unreachable=0    failed=0    skipped=11   rescued=0    ignored=0
ci-test-centos-1           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-centos-2           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-centos-3           : ok=9    changed=3    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-debian-1           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0


TASKS RECAP **************************************************************************************************************************************************************************************************
Tuesday 10 June 2025  22:04:50 +0000 (0:00:00.056)       0:00:26.869 **********
===============================================================================
certificate-generate : Certificate Generate | OpenSSL - Private key local generation ------------------------------------------------------------------------------------------------------------------ 3.93s
certificate-generate_ca : Certificate CA | OpenSSL - Private key generation --------------------------------------------------------------------------------------------------------------------------- 2.67s
certificate-push-trusted : Certificate push trusted | certs - update local ca-certificates ------------------------------------------------------------------------------------------------------------ 2.46s
Gathering Facts --------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 1.86s
certificate-push-trusted : Certificate push trusted | certs - send public certificates from local files ----------------------------------------------------------------------------------------------- 1.53s
certificate-generate_ca_intermediate : Intermediate CA | OpenSSL - Private key generation ------------------------------------------------------------------------------------------------------------- 1.21s
certificate-push-private : Certificate push private | certs - generate combined certs ----------------------------------------------------------------------------------------------------------------- 1.19s
certificate-push-private : Certificate push private | certs - install pem certificates ---------------------------------------------------------------------------------------------------------------- 1.19s
certificate-push-private : Certificate push private | certs - install keyfiles ------------------------------------------------------------------------------------------------------------------------ 1.18s
certificate-generate : Certificate Generate | Send to server ------------------------------------------------------------------------------------------------------------------------------------------ 0.90s
certificate-generate_ca : Certificate CA | OpenSSL - Signed certificate generation -------------------------------------------------------------------------------------------------------------------- 0.69s
certificate-generate_ca : Certificate CA | OpenSSL - CSR generation ----------------------------------------------------------------------------------------------------------------------------------- 0.62s
certificate-generate : Certificate Generate | OpenSSL - Signed certificate local generation ----------------------------------------------------------------------------------------------------------- 0.56s
certificate-push-private : Certificate push private | system - create access group for certificates --------------------------------------------------------------------------------------------------- 0.53s
certificate-generate_ca_intermediate : Intermediate CA | OpenSSL - Signed certificate generation ------------------------------------------------------------------------------------------------------ 0.53s
certificate-generate : Certificate Generate | OpenSSL - CSR local generation -------------------------------------------------------------------------------------------------------------------------- 0.50s
certificate-push-private : Certificate push private | certs - create dedicated cert directories ------------------------------------------------------------------------------------------------------- 0.47s
certificate-push-trusted : Certificate push trusted | ansible - read local public certificates -------------------------------------------------------------------------------------------------------- 0.47s
certificate-push-private : Certificate push private | system - create private directory --------------------------------------------------------------------------------------------------------------- 0.47s
certificate-generate_ca_intermediate : Intermediate CA | OpenSSL - CSR generation --------------------------------------------------------------------------------------------------------------------- 0.46s
""
```

Vs in core 2.19 : 
```
""TASK [certificate-push-private : Certificate push private | ansible - register execution status in a fact] ***************************************************************************************************
Tuesday 10 June 2025  20:55:14 +0000 (0:00:01.237)       0:00:31.024 **********
changed: [ci-test-centos-2]
changed: [ci-test-centos-1]
changed: [ci-test-debian-1]

PLAY RECAP ***************************************************************************************************************************************************************************************************
ci-ansible-master          : ok=36   changed=24   unreachable=0    failed=0    skipped=11   rescued=0    ignored=0
ci-test-centos-1           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-centos-2           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-centos-3           : ok=9    changed=3    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
ci-test-debian-1           : ok=17   changed=10   unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
""
```

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'has_pr', 'affects_2.19', 'pre_release']",closed,2025-06-14T20:47:42Z,2025-06-17T03:03:08Z,security,"['bug', 'has_pr', 'affects_2.19', 'pre_release']",True,2.0,
ansible/ansible,85325,transform_to_native_types leaks keys,"### Ansible Version

```console
2.19.0b6
```

### Summary

We leaned on AnsibleVariableVisitor as the initial impl for `transform_to_native_types`, but it ignores keys, thus leaking `str` subclasses to the finished structure. This hasn't been a problem in most existing use cases, but it absolutely is a problem for `transform_to_native_types`.

### <!-- Bot instructions (ignore this) -->

<!--
### Component Name
bin/ansible
### Issue Type
Bug Report
### Configuration
### OS / Environment
-->
","['bug', 'has_pr', 'pre_release']",open,2025-06-13T20:33:56Z,,bug,"['bug', 'has_pr', 'pre_release']",False,,
hashicorp/terraform,37264,Facing issue in installing providers,"### Terraform Version

```shell
terraform version: 1.8.5
```

### Terraform Configuration Files

provider_config.tf
terraform {
  required_providers {
    aws = {
      source  = ""hashicorp/aws""
      version = ""=5.54.1""
    }
    azurerm = {
      source  = ""hashicorp/azurerm""
      version = ""=3.108.0""
    }
    openstack = {
      source  = ""terraform-provider-openstack/openstack""
      version = ""=1.54.1""
    }
    vsphere = {
      source  = ""vmware/vsphere""
      version = ""2.8.1""
    }
  }
}

provider_aws.tf
# Configure the AWS Provider
provider ""aws"" {
  region = ""us-west-2""
  shared_credentials_files = [""~/.aws/credentials""]
}

provider_azure.tf
provider ""azurerm"" {
  features {
    virtual_machine {
      delete_os_disk_on_deletion = true
    }
  }
  subscription_id   = ""*********""
  client_id         = ""__azure_client_id__""
  client_secret     = ""__azure_client_secret__""
  tenant_id     = ""__azure_tenant_id__""
}


provider_vmware.tf
provider ""vsphere"" {
  version = ""2.8.1""
  vim_keep_alive = 30
  user           = ""__vsphere_user__""
  password       = ""__vsphere_password__""
  vsphere_server = ""********""

  # if you have a self-signed cert
  allow_unverified_ssl = false
  api_timeout          = 10
}

provider ""vsphere"" {
  version = ""2.8.1""
  vim_keep_alive = 30
  user           = ""__vsphere_user_or1__""
  password       = ""__vsphere_password_or1__""
  vsphere_server = ""*********""
  alias          = ""vmware_or1""
  # if you have a self-signed cert
  allow_unverified_ssl = false
  api_timeout          = 10
}


provider_openstack.tf
provider ""openstack"" {
  user_name   = ""__openstack_user__""
  password    = ""__openstack_password__""
  tenant_name = ""Project""
  user_domain_name = ""domain""
  project_domain_name = ""name""
  auth_url    = ""https://**********:5000/v3""
  region      = ""region""
}


### Debug Output

06:40:53 Initializing provider plugins...
06:40:53 - Finding latest version of hashicorp/template...
06:40:58 - Finding hashicorp/azurerm versions matching ""3.108.0""...
06:41:03 - Finding terraform-provider-openstack/openstack versions matching ""1.54.1""...
06:41:04 - Finding vmware/vsphere versions matching ""2.8.1""...
06:41:04 - Finding hashicorp/aws versions matching ""5.54.1""...
06:42:25 - Installing terraform-provider-openstack/openstack v1.54.1...
06:42:41 - Installed terraform-provider-openstack/openstack v1.54.1 (self-signed, key ID 4F80527A391BEFD2)
06:42:47 - Installing vmware/vsphere v2.8.1...
06:42:49 - Installed vmware/vsphere v2.8.1 (signed by a HashiCorp partner, key ID ED13BE650293896B)
06:43:10 
06:43:10 Partner and community providers are signed by their developers.
06:43:10 If you'd like to know more about provider signing, you can read about it here:
06:43:10 https://www.terraform.io/docs/cli/plugins/signing.html
06:43:10 ╷
06:43:10 │ Warning: Version constraints inside provider configuration blocks are deprecated
06:43:10 │ 
06:43:10 │   on provider_vmware.tf line 2, in provider ""vsphere"":
06:43:10 │    2:   version = ""2.8.1""
06:43:10 │ 
06:43:10 │ Terraform 0.13 and earlier allowed provider version constraints inside the
06:43:10 │ provider configuration block, but that is now deprecated and will be
06:43:10 │ removed in a future version of Terraform. To silence this warning, move the
06:43:10 │ provider version constraint into the required_providers block.
06:43:10 │ 
06:43:10 │ (and 3 more similar warnings elsewhere)
06:43:10 ╵
06:43:10 
06:43:10 ╷
06:43:10 │ Error: Failed to install provider
06:43:10 │ 
06:43:10 │ Error while installing hashicorp/template v2.2.0: could not query provider
06:43:10 │ regis**** for regis****.terraform.io/hashicorp/template: failed to retrieve
06:43:10 │ authentication checksums for provider: the request failed after 2 attempts,
06:43:10 │ please **** again later: Get
06:43:10 │ ""https://releases.hashicorp.com/terraform-provider-template/2.2.0/terraform-provider-template_2.2.0_SHA256SUMS"":
06:43:10 │ net/http: request canceled while waiting for connection (Client.Timeout
06:43:10 │ exceeded while awaiting headers)
06:43:10 ╵
06:43:10 
06:43:10 ╷
06:43:10 │ Error: Failed to install provider
06:43:10 │ 
06:43:10 │ Error while installing hashicorp/azurerm v3.108.0: could not query provider
06:43:10 │ regis**** for regis****.terraform.io/hashicorp/azurerm: failed to retrieve
06:43:10 │ authentication checksums for provider: the request failed after 2 attempts,
06:43:10 │ please **** again later: Get
06:43:10 │ ""https://releases.hashicorp.com/terraform-provider-azurerm/3.108.0/terraform-provider-azurerm_3.108.0_SHA256SUMS"":
06:43:10 │ net/http: request canceled while waiting for connection (Client.Timeout
06:43:10 │ exceeded while awaiting headers)
06:43:10 ╵
06:43:10 
06:43:10 ╷
06:43:10 │ Error: Failed to install provider
06:43:10 │ 
06:43:10 │ Error while installing hashicorp/aws v5.54.1: could not query provider
06:43:10 │ regis**** for regis****.terraform.io/hashicorp/aws: the request failed after
06:43:10 │ 2 attempts, please **** again later: Get
06:43:10 │ ""https://regis****.terraform.io/v1/providers/hashicorp/aws/5.54.1/download/linux/amd64"":
06:43:10 │ net/http: request canceled while waiting for connection (Client.Timeout
06:43:10 │ exceeded while awaiting headers)
06:43:10 ╵
06:43:10 
06:43:10 -----------------------------Applying Terraform-------------------------------------
06:43:10 destroy instance value is True
06:43:10 ╷
06:43:10 │ Warning: Version constraints inside provider configuration blocks are deprecated
06:43:10 │ 
06:43:10 │   on provider_vmware.tf line 2, in provider ""vsphere"":
06:43:10 │    2:   version = ""2.8.1""
06:43:10 │ 
06:43:10 │ Terraform 0.13 and earlier allowed provider version constraints inside the
06:43:10 │ provider configuration block, but that is now deprecated and will be
06:43:10 │ removed in a future version of Terraform. To silence this warning, move the
06:43:10 │ provider version constraint into the required_providers block.
06:43:10 │ 
06:43:10 │ (and one more similar warning elsewhere)
06:43:10 ╵
06:43:10 ╷
06:43:10 │ Error: Inconsistent dependency lock file
06:43:10 │ 
06:43:10 │ The following dependency selections recorded in the lock file are
06:43:10 │ inconsistent with the current configuration:
06:43:10 │   - provider regis****.terraform.io/hashicorp/aws: required by this configuration but no version is selected
06:43:10 │   - provider regis****.terraform.io/hashicorp/azurerm: required by this configuration but no version is selected
06:43:10 │   - provider regis****.terraform.io/hashicorp/template: required by this configuration but no version is selected
06:43:10 │   - provider regis****.terraform.io/terraform-provider-openstack/openstack: required by this configuration but no version is selected
06:43:10 │   - provider regis****.terraform.io/vmware/vsphere: required by this configuration but no version is selected
06:43:10 │ 
06:43:10 │ To make the initial dependency selections that will initialize the
06:43:10 │ dependency lock file, run:
06:43:10 │   terraform init
06:43:10 ╵

### Expected Behavior

It was working till 20th June 2025 since many years

### Actual Behavior

Everytime I execute Jenkins job, it fails to install some provider.
But not failing for particular provider

### Steps to Reproduce

terraform init

### Additional Context

_No response_

### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'new']",open,2025-06-22T01:41:36Z,,security,"['bug', 'new']",True,,
hashicorp/terraform,37263,Please provide a `-specific-target` flag for `terraform apply`,"### Terraform Version

```shell
Terraform v1.5.6
on linux_amd64
+ provider registry.terraform.io/hashicorp/aws v5.84.0
+ provider registry.terraform.io/hashicorp/azurerm v4.33.0
+ provider registry.terraform.io/hashicorp/dns v3.4.3
```

### Use Cases

We are frequently running into issues where `terraform apply -target` will attempt apply for the target and a bunch of related/dependent resources -- but we really need to specifically target a single resource.


example issue -- attempting to delete target group fails because it's referenced by an ALB rule...  attempt to target the ALB resource to remove the rule results in the target group being included in the apply..


### terraform apply
```
Terraform will perform the following actions:

  # module.aws_edgelb_usw2.aws_lb_listener_rule.alb_rule[""RULE_REFERENCE""] will be updated in-place 
  ~ resource ""aws_lb_listener_rule"" ""alb_rule"" {
      ...
      ~ action {
            # (2 unchanged attributes hidden)

          ~ forward {
              - target_group {
                  - arn    = ""arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx"" -> null
                  - weight = 0 -> null
                }
            }
        }
    }

  # module.aws_edgelb_usw2.aws_lb_target_group.alb[""TG_NAME""] will be destroyed
  # (because key [""TG_NAME""] is not in for_each map)
  - resource ""aws_lb_target_group"" ""alb"" {
      - arn                                = ""arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx"" -> null
      ...
    }

Plan: 0 to add, 1 to change, 1 to destroy.
...
Do you want to perform these actions?
  Terraform will perform the actions described above.
  Only 'yes' will be accepted to approve.

  Enter a value: yes
...
│ Error: deleting ELBv2 Target Group (arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx): operation error Elastic Load Balancing v2: DeleteTargetGroup, https response error StatusCode: 400, RequestID: afcd1dee-605e-451c-9ce1-46ac4a9affc0, ResourceInUse: Target group 'arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx' is currently in use by a listener or a rule
```

### targeted apply
`terraform apply -target 'module.aws_edgelb_usw2.aws_lb_listener_rule.alb_rule[""RULE_REFERENCE""]'`
```
Terraform will perform the following actions:

  # module.aws_edgelb_usw2.aws_lb_listener_rule.alb_rule[""RULE_REFERENCE""] will be updated in-place 
  ~ resource ""aws_lb_listener_rule"" ""alb_rule"" {
     ....
      ~ action {
          ~ forward {
              - target_group {
                  - arn    = ""arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx"" -> null
                  - weight = 0 -> null
                }
            }
        }
    }

  # module.aws_edgelb_usw2.aws_lb_target_group.alb[""TG_NAME""] will be destroyed
  # (because key [""TG_NAME""] is not in for_each map)
  - resource ""aws_lb_target_group"" ""alb"" {
      - arn                                = ""arn:aws:elasticloadbalancing:us-west-2:ACCOUNT_ID:targetgroup/TG_NAME/xxx"" -> null
```

...sigh.



### Attempted Solutions

- apply <-- doesn't work
- targeted apply <-- doesn't work
- log into the AWS console and manually update the ALB rule, then apply <--- works, but is terrible.

### Proposal

provide a `terraform apply -specific-target xxx`  capability that will result in ONLY the explicitly-targeted resource to be updated..   (maybe `-explicit-target` is a better name?)

### References

_No response_","['enhancement', 'new']",closed,2025-06-20T16:05:50Z,2025-06-20T17:59:22Z,security,"['enhancement', 'new']",True,0.0,
hashicorp/terraform,37262,Validation error on dynamic `name` field despite compliant value,"### Terraform Version

```shell
Terraform v1.4.0  // (or whatever you're using)
required_version = "">= 0.14.10""
```

### Terraform Configuration Files

```terraform
data ""azurerm_service_plan"" ""service_plan"" {
  name = format(local.resource_name_template, ""function-serviceplan"")
  resource_group_name = local.resource_group_name
}
```


### Debug Output

While validating Terraform configuration using terraform validate, I encountered the following error:

```
Error: ""name"" may only contain alphanumeric characters, dashes and underscores up to 60 characters in length
  with data.azurerm_service_plan.service_plan,
  on main.tf line 61, in data ""azurerm_service_plan"" ""service_plan"":
  61:   name = format(local.resource_name_template, ""function-serviceplan"")
```
The variable `local.resource_name_template` is dynamically constructed (in our case it's a valid, static string like `""svcv-pricebook-dev""`) and is well within Azure's naming restrictions (length < 60 characters, valid characters only). However, the validation fails at the static analysis phase despite the eventual value being compliant.

### Expected Behavior

Terraform should not throw a hard validation error for expressions that are dynamically evaluated at apply time. Instead:
- This condition could be downgraded to a warning rather than an error if the value can't be evaluated statically but is expected to be compliant.
- Alternatively, a smarter static analysis could be used to attempt to validate dynamic strings only when they are fully interpolated with known-safe values.

## Suggested Resolution
- If the name value is built using dynamic expressions (like format() or variables), and Terraform can't check it exactly at the time of validation, this should not be treated as an error.
- Instead, show it as a warning to inform the user without stopping the validation process.
- If possible, try to make the validation smarter so it can recognize when dynamic values are still safe and follow the rules.

### Actual Behavior

The terraform validate command fails prematurely with a hard error during the static validation phase, even though:
- The actual value of name is compliant
- terraform apply and pipelines execute the deployment successfully

### Steps to Reproduce

````
locals {
  resource_name_template = ""svcv-pricebook-dev""
}

data ""azurerm_service_plan"" ""service_plan"" {
  name                = format(local.resource_name_template, ""function-serviceplan"") # Still < 60 chars
  resource_group_name = ""my-rg""
}
````
Run:
````
terraform validate
````

### Additional Context

- Our CI/CD pipelines run terraform apply and the name resolves correctly.
- We believe this strict validation behavior results in false negatives and creates confusion during initial development and peer reviews.
- A more lenient validation or warning-level feedback could improve DX (developer experience).

### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'question', 'provider/azurerm', 'new']",closed,2025-06-20T13:58:19Z,2025-06-20T17:11:14Z,bug,"['bug', 'question', 'provider/azurerm', 'new']",False,0.0,
hashicorp/terraform,37261,Terraform Fails SSH Authentication with Amazon Linux 2023 (OpenSSH 8.7+/8.9+) in v0.14.x,"### Terraform Version

```shell
v0.14.7
```

### Terraform Configuration Files

```terraform
...terraform config...
```


### Debug Output

```
resource ""null_resource"" ""print_hostname"" {
  provisioner ""remote-exec"" {
    inline = [
      ""echo 'Hostname is: $(hostname)'""
    ]

    connection {
      type        = ""ssh""
      user        = ""ec2-user""
      private_key = file(""~/.ssh/my)key.pem"")
      host        = ""<IP_ADDRESS>""
      timeout     = ""2m""
    }
  }

  triggers = {
    always_run = timestamp()
  }
}
```


### Expected Behavior

null_resource.print_hostname (remote-exec): Connected!
null_resource.print_hostname (remote-exec): Hostname is: $(hostname)
null_resource.print_hostname: Creation complete after 0s [id=7980356368681144379]

### Actual Behavior

null_resource.print_hostname: Still creating... [2m0s elapsed]
2025/06/20 12:46:43 [WARN] Errors while provisioning null_resource.print_hostname with ""remote-exec"", so aborting


Error: timeout - last error: SSH authentication failed (ec2-user@1<IP_ADDRESS>:22): ssh: handshake failed: ssh: unable to authenticate, attempted methods [none publickey], no supported methods remain


### Steps to Reproduce

Against Amazon linux 2023, run ""terraform apply"" 

### Additional Context

Notes: 
Manual SSH test - working with mentioned location
PEM format - perfect (-----BEGIN RSA PRIVATE KEY-----)
Key permissions - perfect (400)
Terraform version - (v0.14.7)


### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'waiting-response', 'provisioner/remote-exec', 'new']",open,2025-06-20T13:41:23Z,,bug,"['bug', 'waiting-response', 'provisioner/remote-exec', 'new']",False,,
hashicorp/terraform,37259,Support for maximum file enforce limit in policy setting for azurerm_web_application_firewall_policy,"### Terraform Version

```shell
v1.11.3
```

### Terraform Configuration Files

```terraform
...terraform config...
```
resource ""azurerm_web_application_firewall_policy"" ""waf_policy"" {
  name                = var.waf_policy_name
  location            = azurerm_resource_group.rg.location
  resource_group_name = azurerm_resource_group.rg.name

  policy_settings {
    enabled                     = var.policy_settings.enabled
    mode                        = var.policy_settings.mode
    
    # Conditionally set optional attributes
    request_body_check                        = try(var.policy_settings.request_body_check, null)
    request_body_inspect_limit_in_kb          = try(var.policy_settings.request_body_inspect_limit_in_kb, null)
    request_body_enforcement                  = try(var.policy_settings.request_body_enforcement, null)
    file_upload_enforcement                   = try(var.policy_settings.file_upload_enforcement, null)
    file_upload_limit_in_mb                   = try(var.policy_settings.file_upload_limit_in_mb, null)
    max_request_body_size_in_kb               = try(var.policy_settings.max_request_body_size_in_kb, null)
    js_challenge_cookie_expiration_in_minutes = try(var.policy_settings.js_challenge_cookie_expiration_in_minutes, null) 
  }


### Debug Output

[```](
╷
│ Error: Unsupported argument
│ 
│   on .terraform/modules/waf_policy/main.tf line 46, in resource ""azurerm_web_application_firewall_policy"" ""waf_policy"":
│   46:     file_upload_enforcement                   = try(var.policy_settings.file_upload_enforcement, null)
│ 
│ An argument named ""file_upload_enforcement"" is not expected here.
╵
Cleaning up project directory and file based variables
00:01
ERROR: Job failed: command terminated with exit code 1

)
...debug output, or link to a gist...
```


### Expected Behavior

I want to enable or disable Enforce maximum file upload limit in policy setting of WAF in azure

### Actual Behavior

Is there any supported parameter or argument?

### Steps to Reproduce

1. terraform plan
2. terraform apply

### Additional Context

_No response_

### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'question', 'provider/azurerm', 'new']",closed,2025-06-20T09:00:16Z,2025-06-20T17:14:35Z,performance,"['bug', 'question', 'provider/azurerm', 'new']",True,0.0,
hashicorp/terraform,37255,Support for cross-zone replication for azure netapp files,"### Terraform Version

```shell
1.9.6
```

### Use Cases

Replicate volume across zones within the same region

### Attempted Solutions

The existing module only seems to support cross-region replication.

### Proposal

_No response_

### References

_No response_","['enhancement', 'question', 'provider/azurerm', 'new']",closed,2025-06-19T11:03:41Z,2025-06-19T14:48:05Z,performance,"['enhancement', 'question', 'provider/azurerm', 'new']",True,0.0,
hashicorp/terraform,37251,Store errored.tfstate in TF_DATA_DIR rather than working directory,"### Terraform Version

```shell
1.11.3
```

### Use Cases

When using Terraform to apply changes to multiple workspaces in parallel, especially in automation or scripting scenarios, it's important to maintain workspace-specific state isolation. If an apply operation fails (e.g., due to expired credentials or runtime errors), Terraform writes the errored state to the working directory by default, rather than to the directory defined by the TF_DATA_DIR environment variable.

This behavior can lead to conflicts and state loss in parallelized environments where multiple applies are running simultaneously, each expecting to operate in isolated directories. Losing this state complicates recovery and troubleshooting, especially when applying to many workspaces concurrently.

My end goal is to ensure that each failed apply operation writes its errored state to a unique and predictable location that matches the rest of Terraform's directory structure and honors the workspace's TF_DATA_DIR.

### Attempted Solutions

To parallelize Terraform applies across multiple workspaces, I used a custom Bash function that sets a temporary TF_DATA_DIR for each apply:

```sh
TEMP_DIR=$(mktemp -d)
export TF_DATA_DIR=""$TEMP_DIR""

cp $WORKDIR/.terraform/terraform.tfstate $TEMP_DIR/terraform.tfstate
ln -s $WORKDIR/.terraform/modules $TEMP_DIR/modules
ln -s $WORKDIR/.terraform/providers $TEMP_DIR/providers

terraform workspace select ""$WS""
terraform apply -auto-approve ""$PLAN_FILE""
```

This approach ensures that each apply operation has its own isolated working state.

However, when credentials expired mid-apply, Terraform failed to save the state to the backend, and the fallback errored state file was written to the working directory, not the TF_DATA_DIR. Because multiple applies were running in parallel, they all wrote to the same fallback location (e.g., errored.tfstate), overwriting each other. This resulted in all but one errored state being lost, leaving me with no way to recover or inspect the failed workspaces.

I attempted to mitigate this by managing TF state and data directories more carefully, but the fallback behavior is hardcoded and cannot be redirected.

### Proposal

I propose that Terraform should either:

1. Write the fallback errored.tfstate file to the configured TF_DATA_DIR, instead of the working directory; or
2. Provide a configuration option (e.g., a CLI argument or environment variable like TF_ERROR_STATE_PATH) to explicitly control where the fallback errored state is written.

This change would ensure consistency with how Terraform otherwise respects TF_DATA_DIR and allow advanced users to safely manage parallel apply operations without risking state conflicts.

For example:
```sh
export TF_ERROR_STATE_PATH=""$TF_DATA_DIR/errored.tfstate""
```

or automatically write:
```sh
$TF_DATA_DIR/errored.tfstate
```

This is a niche use case, and I understand it may not be a priority. However, for teams using Terraform in parallel workflows, especially with large workspace counts and CI/CD automation, this small change would dramatically improve reliability and reduce recovery pain during partial apply failures.

Thank you for considering this request, and for your excellent work on Terraform!

### References

_No response_","['enhancement', 'new']",open,2025-06-18T11:13:03Z,,performance,"['enhancement', 'new']",True,,
hashicorp/terraform,37250,Increase retry attempts when querying / installing providers,"### Terraform Version

```shell
Applicable to all past versions and latest version
```

### Use Cases

TF CLI should perform additional retry attempts with exponential backoff when transient / temporary error conditions are encountered.  The current 2x attempt approach should be increased (with exponential backoff between subsequent attempts) to between 4 to 6 attempts.  Any reason it doesn't already?

![Image](https://github.com/user-attachments/assets/9a210533-571c-4081-903c-26025b8f9789)

### Attempted Solutions

Follow up rerun of `init` etc shows the transient issue is not encountered.

### Proposal

TF CLI should perform additional retry attempts with exponential backoff when transient / temporary error conditions are encountered.  The current 2x attempt approach should be increased (with exponential backoff between subsequent attempts) to between 4 to 6 attempts.  Any reason it doesn't already?

![Image](https://github.com/user-attachments/assets/9a210533-571c-4081-903c-26025b8f9789)

### References

_No response_","['enhancement', 'new']",open,2025-06-18T07:55:35Z,,performance,"['enhancement', 'new']",True,,
hashicorp/terraform,37249,Cannot install terraform through `yum` and `yum-config-manager`,"### Terraform Version

```shell
(not relevant for this)
```

### Terraform Configuration Files

(not relevant)


### Debug Output

(not relevant here)

### Expected Behavior

yum-config-manager adds the terraform repo to yum and yum intall terraform installs terraform

### Actual Behavior

403 error, terraform is not installed

### Steps to Reproduce

```
sudo yum-config-manager --add-repo https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo
```
output:
```
Loaded plugins: extras_suggestions, langpacks, priorities, update-motd
adding repo from: https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo
grabbing file https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo to /etc/yum.repos.d/hashicorp.repo
Could not fetch/save url https://rpm.releases.hashicorp.com/AmazonLinux/hashicorp.repo to file /etc/yum.repos.d/hashicorp.repo: [Errno 14] HTTPS Error 403 - Forbidden
```

### Additional Context

I'm not sure whether this is a documentation change (if this is working as intended) or if it's a bug in the current distribution channel for terraform through yum.

https://github.com/hashicorp/terraform/blob/f31477f9abde80b84b30bc2c7ec3da63c9e103eb/website/docs/language/stacks/reference/tfstacks-cli.mdx#amazon-linux
and https://developer.hashicorp.com/terraform/tutorials/aws-get-started/install-cli#install-terraform mention steps which are currently returning 403 errors for me on resources like https://rpm.releases.hashicorp.com/RHEL/hashicorp.repo

Incidentally, hitting this from a normal browser succeeds, so I suspect that yum / yum-config-manager adds a user-agent that's currently blocked.

Are the documented steps wrong ?

### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'new']",closed,2025-06-17T21:02:32Z,2025-06-18T23:37:56Z,bug,"['bug', 'new']",False,1.0,
hashicorp/terraform,37247,Weird thing happens if two `aws_s3_bucket_policy` resources with different names refers to the same bucket,"### Terraform Version

```shell
Terraform v1.11.4
on darwin_arm64
```

### Terraform Configuration Files

```terraform
resource ""aws_s3_bucket_policy"" ""logs-elb"" {
  bucket = aws_s3_bucket.logs-s3.bucket

  policy = jsonencode({ **ALLOW** })
}

resource ""aws_s3_bucket_policy"" ""logs-elb-essentials"" {
  bucket = aws_s3_bucket.logs-s3.bucket

  policy = jsonencode({ **DENY** })
```

### Debug Output

N/A

### Expected Behavior

Terraform should not allow to define two resources with different names which refer one actual resource.

### Actual Behavior

Terraform allows to define two resources with different names and different configuration which refers the same actual resource.

Depending on the order which one configuration is processed first the **DENY** or **ALLOW** policy is applied!!

### Steps to Reproduce

1. Create configuration as described
2. terraform plan
3. terraform apply

### Additional Context

_No response_

### References

_No response_

### Generative AI / LLM assisted development?

_No response_","['bug', 'question', 'provider/aws', 'new']",closed,2025-06-17T18:01:31Z,2025-06-17T18:21:21Z,bug,"['bug', 'question', 'provider/aws', 'new']",False,0.0,
hashicorp/terraform,37244,Provider produced inconsistent result after apply,"### Terraform Version

```shell
Terraform v1.12.2
on linux_amd64
+ provider registry.terraform.io/hashicorp/aws v5.100.0
+ provider registry.terraform.io/hashicorp/null v3.2.1
```

### Terraform Configuration Files

main.tf
```
resource ""aws_auditmanager_assessment"" ""sample_assessment"" {
  name = ""${module.naming.resources.prefix.name}-audit-manager""

  assessment_reports_destination {
    destination      = ""s3://${module.s3_bucket.s3_bucket_id}""
    destination_type = ""S3""
  }

  framework_id = ""fbb2b9b2-5a09-46fb-b338-ed2f8a86512d""

  roles {
    role_arn  = aws_iam_role.auditmanager_process_owner.arn
    role_type = ""PROCESS_OWNER""
  }

  scope {
    aws_accounts {
      id = data.aws_caller_identity.current.account_id
    }
    aws_services {
      service_name = ""S3""
    }
  }
}
```

### Debug Output

```
aws_iam_policy.auditmanager_process_owner_policy: Creating...
aws_iam_role.auditmanager_process_owner: Creating...
aws_iam_policy.auditmanager_process_owner_policy: Creation complete after 2s [id=arn:aws:iam::426857564226:policy/AuditManagerProcessOwnerPolicy]
aws_iam_role.auditmanager_process_owner: Creation complete after 3s [id=AuditManagerProcessOwnerRole]
aws_iam_role_policy_attachment.attach_process_owner_policy: Creating...
aws_auditmanager_assessment.sample_assessment: Creating...
aws_iam_role_policy_attachment.attach_process_owner_policy: Creation complete after 1s [id=AuditManagerProcessOwnerRole-20250616162630170200000001]
╷
│ Error: Provider produced inconsistent result after apply
│ 
│ When applying changes to aws_auditmanager_assessment.sample_assessment, provider ""provider[\""registry.terraform.io/hashicorp/aws\""]"" produced an unexpected new value: .scope[0].aws_services: planned set element
│ cty.ObjectVal(map[string]cty.Value{""service_name"":cty.StringVal(""S3"")}) does not correlate with any element in actual.
│ 
│ This is a bug in the provider, which should be reported in the provider's own issue tracker.
```

### Expected Behavior

According to configuration i specify on terraform file, that should have created Audit Manager Assessment. 

### Actual Behavior

It was all going great till terraform plan, but when i do terraform, error shown:
```
 Error: Provider produced inconsistent result after apply

│ When applying changes to aws_auditmanager_assessment.sample_assessment, provider ""provider[\""registry.terraform.io/hashicorp/aws\""]"" produced an unexpected new value: .scope[0].aws_services: planned set element
│ cty.ObjectVal(map[string]cty.Value{""service_name"":cty.StringVal(""S3"")}) does not correlate with any element in actual.
│ 
│ This is a bug in the provider, which should be reported in the provider's own issue tracker.
```

### Steps to Reproduce

1. terraform init
2. terraform validate
3. terraform plan
4. terraform apply

### Additional Context

iam.tf
```
resource ""aws_iam_role"" ""auditmanager_process_owner"" {
  name = ""AuditManagerProcessOwnerRole""

  assume_role_policy = jsonencode({
    Version = ""2012-10-17"",
    Statement = [
      {
        Effect = ""Allow"",
        Principal = {
          Service = ""auditmanager.amazonaws.com""
        },
        Action = ""sts:AssumeRole""
      }
    ]
  })
}

resource ""aws_iam_policy"" ""auditmanager_process_owner_policy"" {
  name = ""AuditManagerProcessOwnerPolicy""

  policy = jsonencode({
    Version = ""2012-10-17"",
    Statement = [
      {
        Sid : ""AllowAuditManagerAccess"",
        Effect = ""Allow"",
        Action = [
          ""auditmanager:GetAssessment"",
          ""auditmanager:ListAssessments"",
          ""auditmanager:GetEvidenceFoldersByAssessment"",
          ""auditmanager:GetEvidence"",
          ""auditmanager:ListControls"",
          ""auditmanager:ListKeywordsForDataSource"",
          ""auditmanager:GetAccountStatus"",
          ""auditmanager:ListNotifications"",
          ""auditmanager:TagResource""
        ],
        Resource = ""*""
      },
      {
        Sid : ""AllowReadAccessToEvidenceSources"",
        Effect : ""Allow"",
        Action : [
          ""cloudtrail:LookupEvents"",
          ""config:GetResourceConfigHistory"",
          ""config:DescribeConfigRules"",
          ""config:GetComplianceDetailsByConfigRule"",
          ""s3:GetObject"",
          ""s3:ListBucket""
        ],
        Resource = ""*""
      },
      {
        Sid : ""AllowWriteReportsToS3"",
        Effect = ""Allow"",
        Action : [
          ""s3:PutObject""
        ],
        Resource = ""arn:aws:s3:::${module.s3_bucket.s3_bucket_id}/*""
      }
    ]
  })
}

resource ""aws_iam_role_policy_attachment"" ""attach_process_owner_policy"" {
  role       = aws_iam_role.auditmanager_process_owner.name
  policy_arn = aws_iam_policy.auditmanager_process_owner_policy.arn
}
```
main.tf
```
resource ""aws_auditmanager_assessment"" ""sample_assessment"" {
  name = ""${module.naming.resources.prefix.name}-audit-manager""

  assessment_reports_destination {
    destination      = ""s3://${module.s3_bucket.s3_bucket_id}""
    destination_type = ""S3""
  }

  framework_id = ""fbb2b9b2-5a09-46fb-b338-ed2f8a86512d""

  roles {
    role_arn  = aws_iam_role.auditmanager_process_owner.arn
    role_type = ""PROCESS_OWNER""
  }

  scope {
    aws_accounts {
      id = data.aws_caller_identity.current.account_id
    }
    aws_services {
      service_name = ""S3""
    }
  }
}
```
versions.tf
```
terraform {
  required_version = ""~> 1.2""

  required_providers {
    aws = {
      source  = ""hashicorp/aws""
      version = "">= 5.0""
    }
    null = {
      source  = ""hashicorp/null""
      version = ""3.2.1""
    }
  }
}
```
providers.tf
```
provider ""aws"" {
  region = var.region
}
```



After initializing this files `terraform init` 
`terraform validate` as well as  `terraform plan` will also works fine 
but it stuck on `terraform apply`
``` Error: Provider produced inconsistent result after apply```


### References

Reference: 
1. https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/auditmanager_assessment
2. https://support.hashicorp.com/hc/en-us/articles/1500006254562-Provider-Produced-Inconsistent-Results

### Generative AI / LLM assisted development?

ChatGPT","['bug', 'question', 'provider/aws', 'new']",closed,2025-06-16T17:04:24Z,2025-06-16T17:10:28Z,bug,"['bug', 'question', 'provider/aws', 'new']",False,0.0,
hashicorp/terraform,37239,How can I declaratively manage security groups and follow best practise?,"### Terraform Version

```shell
1.9.1
```

### Use Cases

* I want to manage security group egress and ingress rules on AWS
* I want to follow best practise by declaring the group with `aws_security_group` and the rules with `aws_vpc_security_group_ingress_rule`
* I don't want users to be able to manually change the rules in the console

However - when I set up a group and rules, I can freely add rules in the console and they are not revoked by Terraform.

### Attempted Solutions

I have tried setting `ingress = []` and `egress = []` on the group, but that revokes all the rules and then flaps back and forth on each run.

### Proposal

Some mechanism to be able to both follow best practise and revoke manually added rules.

### References

_No response_","['enhancement', 'question', 'provider/aws', 'new']",closed,2025-06-16T09:00:34Z,2025-06-16T11:53:19Z,security,"['enhancement', 'question', 'provider/aws', 'new']",True,0.0,
prometheus/prometheus,16255,Prometheus dropping series unexpectedly in remote_write,"### What did you do?

I have configured a Prometheus server (v3.2.1) to remote_write to a Cortex cluster. Several times there were instances where the Prometheus server will get into a bad state where it doesn't sent any samples for some timeseries.

The series is present in Prometheus but is not sent to Cortex. This is evident when I query both of them separately.

#### Prometheus result
Query: `prometheus_http_requests_total{code!=""200""}`
![Image](https://github.com/user-attachments/assets/e06e2d5f-1a1a-4a76-b099-6a7d7d2567fd)

#### Cortex Result
Query: `prometheus_http_requests_total{code!=""200""}`
![Image](https://github.com/user-attachments/assets/5fcaa165-4edf-462d-98d3-ca20c93d61de)


I've narrowed down the issue to the following logs in Prometheus.
```
time=2025-03-21T03:50:39.469Z level=INFO source=queue_manager.go:709 msg=""Dropped sample for series that was not explicitly dropped via relabelling"" component=remote remote_name=5cd4b5 url=<Cortex URL> ref=21931
```

I took a quick look at the code. This seems to be a bug in Prometheus where it cannot find the series ID in the queue_manager.
https://github.com/prometheus/prometheus/blob/3d603d19575ef20ced7e3a2293b7bf10ce359d54/storage/remote/queue_manager.go#L705



I don't know if it's relevant to this issue. I saw Prometheus server getting OOM killed before this happened. But it doesn't always happen after an OOM.

### What did you expect to see?

Prometheus shouldn't unexpectedly drop series.

### What did you see instead? Under which circumstances?

Prometheus should send all the series in remote write.

### System information

Linux 5.10.234-225.895.amzn2.x86_64 x86_64

### Prometheus version

```text
$ prometheus --version
prometheus, version 3.2.1 (branch: HEAD, revision: 804c49d58f3f3784c77c9c8ec17c9062092cae27)
  build user:       root@42fd9529152a
  build date:       20250226-09:19:49
  go version:       go1.23.6
  platform:         linux/amd64
  tags:             netgo,builtinassets,stringlabels
```

### Prometheus configuration file

```yaml
global:
  scrape_interval: 15s
  scrape_timeout: 10s
  scrape_protocols:
  - OpenMetricsText1.0.0
  - OpenMetricsText0.0.1
  - PrometheusText1.0.0
  - PrometheusText0.0.4
  evaluation_interval: 1m
runtime:
  gogc: 50
rule_files:
- /etc/config/recording_rules.yml
- /etc/config/alerting_rules.yml
- /etc/config/rules
- /etc/config/alerts
scrape_configs:
- job_name: prometheus
  honor_timestamps: true
  track_timestamps_staleness: false
  scrape_interval: 15s
  scrape_timeout: 10s
  scrape_protocols:
  - OpenMetricsText1.0.0
  - OpenMetricsText0.0.1
  - PrometheusText1.0.0
  - PrometheusText0.0.4
  metrics_path: /metrics
  scheme: http
  enable_compression: true
  follow_redirects: true
  enable_http2: true
  static_configs:
  - targets:
    - localhost:9090
- job_name: kube-state-metrics
  honor_timestamps: true
  track_timestamps_staleness: false
  scrape_interval: 15s
  scrape_timeout: 10s
  scrape_protocols:
  - OpenMetricsText1.0.0
  - OpenMetricsText0.0.1
  - PrometheusText1.0.0
  - PrometheusText0.0.4
  metrics_path: /metrics
  scheme: http
  enable_compression: true
  follow_redirects: true
  enable_http2: true
  relabel_configs:
  - source_labels: [__meta_kubernetes_service_name]
    separator: ;
    regex: sharded-kube-state-metrics
    replacement: $1
    action: keep
  metric_relabel_configs:
  - source_labels: [__name__]
    separator: ;
    regex: (kube_pod_info)
    replacement: $1
    action: keep
  kubernetes_sd_configs:
  - role: endpoints
    kubeconfig_file: """"
    follow_redirects: true
    enable_http2: true
remote_write:
- url: <cortex>
  remote_timeout: 30s
  write_relabel_configs:
  - source_labels: [__replica__]
    separator: ;
    regex: ^.*(server-.*)$
    target_label: __replica__
    replacement: $1
    action: replace
  protobuf_message: prometheus.WriteRequest
  follow_redirects: true
  enable_http2: false
  queue_config:
    capacity: 10000
    max_shards: 50
    min_shards: 1
    max_samples_per_send: 2000
    batch_send_deadline: 30s
    min_backoff: 30ms
    max_backoff: 5s
  metadata_config:
    send: true
    send_interval: 1m
    max_samples_per_send: 2000
```

### Alertmanager version

```text

```

### Alertmanager configuration file

```yaml
N/A
```

### Logs

```text
""time=2025-03-21T03:00:02.923Z level=INFO source=compact.go:591 msg=""""write block"""" component=tsdb mint=1742515201728 maxt=1742522400000 ulid=01JPVA9DDWJ38KEGYKP3JG711D duration=302.616924ms ooo=false""
""time=2025-03-21T03:00:02.940Z level=INFO source=head.go:1371 msg=""""Head GC completed"""" component=tsdb caller=truncateMemory duration=13.187926ms""
""time=2025-03-21T03:00:02.941Z level=INFO source=checkpoint.go:100 msg=""""Creating checkpoint"""" component=tsdb from_segment=86 to_segment=87 mint=1742522400000""
""time=2025-03-21T03:00:03.363Z level=INFO source=head.go:1333 msg=""""WAL checkpoint complete"""" component=tsdb first=86 last=87 duration=422.589249ms""
""time=2025-03-21T03:43:40.637Z level=WARN source=main.go:282 msg=""""Unknown option for --enable-feature"""" option=expand-external-labels""
""time=2025-03-21T03:43:40.637Z level=INFO source=main.go:228 msg=""""Experimental memory snapshot on shutdown enabled""""""
""time=2025-03-21T03:43:40.637Z level=WARN source=main.go:282 msg=""""Unknown option for --enable-feature"""" option=auto-gomemlimit""
""time=2025-03-21T03:43:40.637Z level=INFO source=main.go:237 msg=""""Experimental per-step statistics reporting""""""
""time=2025-03-21T03:43:40.638Z level=INFO source=main.go:687 msg=""""Starting Prometheus Server"""" mode=server version=""""(version=3.2.1, branch=HEAD, revision=804c49d58f3f3784c77c9c8ec17c9062092cae27)""""""
""time=2025-03-21T03:43:40.638Z level=INFO source=main.go:692 msg=""""operational information"""" build_context=""""(go=go1.23.6, platform=linux/amd64, user=root@42fd9529152a, date=20250226-09:19:49, tags=netgo,builtinassets,stringlabels)"""" host_details=""""(Linux 5.10.234-225.895.amzn2.x86_64 #1 SMP Tue Feb 11 11:40:46 UTC 2025 x86_64 query-correctness-prometheus-server-0 (none))"""" fd_limits=""""(soft=1048576, hard=1048576)"""" vm_limits=""""(soft=unlimited, hard=unlimited)""""""
""time=2025-03-21T03:43:40.639Z level=INFO source=main.go:768 msg=""""Leaving GOMAXPROCS=16: CPU quota undefined"""" component=automaxprocs""
""time=2025-03-21T03:43:40.639Z level=INFO source=query_logger.go:85 msg=""""These queries didn't finish in prometheus' last run:"""" component=activeQueryTracker queries=""""[{\""""query\"""":\""""-bottomk without () (time(), {__name__=\\\""""kube_pod_info\\\"""",created_by_kind=\\\""""DaemonSet\\\"""",pod!=\\\""""ebs-csi-node-z4qcw\\\""""})\"""",\""""timestamp_sec\"""":1742528600},{\""""query\"""":\""""bottomk without () (time(), {__name__=\\\""""kube_pod_info\\\"""",created_by_kind=\\\""""DaemonSet\\\"""",pod!=\\\""""ebs-csi-node-xcrwg\\\""""})\"""",\""""timestamp_sec\"""":1742528599},{\""""query\"""":\""""-bottomk without () (time(), {__name__=\\\""""kube_pod_info\\\"""",created_by_kind=\\\""""DaemonSet\\\"""",pod!=\\\""""ebs-csi-node-8vffd\\\""""})\"""",\""""timestamp_sec\"""":1742528600},{\""""query\"""":\""""-bottomk without () (time(), {__name__=\\\""""kube_pod_info\\\"""",created_by_kind=\\\""""DaemonSet\\\"""",pod!=\\\""""kube-proxy-7gfpl\\\""""})\"""",\""""timestamp_sec\"""":1742528599},{\""""query\"""":\""""bottomk without () (time(), {__name__=\\\""""kube_pod_info\\\"""",created_by_kind=\\\""""DaemonSet\\\"""",pod!=\\\""""ebs-csi-node-x9ddd\\\""""})\"""",\""""timestamp_sec\"""":1742528601}]""""""
""time=2025-03-21T03:43:40.642Z level=INFO source=web.go:654 msg=""""Start listening for connections"""" component=web address=0.0.0.0:9090""
""time=2025-03-21T03:43:40.642Z level=INFO source=main.go:1228 msg=""""Starting TSDB ...""""""
""time=2025-03-21T03:43:40.644Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1741895455092 maxt=1742018400000 ulid=01JPCQC3VEBMM3PT7PBH4ZJZ8A""
""time=2025-03-21T03:43:40.644Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742018401728 maxt=1742212800000 ulid=01JPJGRQDTM97DGGBSS467E46N""
""time=2025-03-21T03:43:40.644Z level=INFO source=tls_config.go:347 msg=""""Listening on"""" component=web address=[::]:9090""
""time=2025-03-21T03:43:40.644Z level=INFO source=tls_config.go:350 msg=""""TLS is disabled."""" component=web http2=false address=[::]:9090""
""time=2025-03-21T03:43:40.646Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742212801728 maxt=1742407200000 ulid=01JPRA59KTYSEEA6AB2N9J5NNS""
""time=2025-03-21T03:43:40.647Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742407201728 maxt=1742472000000 ulid=01JPT7YSYXTQKZ8JDJT8PMB1XV""
""time=2025-03-21T03:43:40.648Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742493601728 maxt=1742500800000 ulid=01JPTNP7NN8BTY5YGJ5Q3B3W88""
""time=2025-03-21T03:43:40.649Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742500801728 maxt=1742508000000 ulid=01JPTWHYY6MTWXJT59AK3HBWA5""
""time=2025-03-21T03:43:40.651Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742472001728 maxt=1742493600000 ulid=01JPTWHZP28JF6DCYYMGPMZNG0""
""time=2025-03-21T03:43:40.652Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742508001728 maxt=1742515200000 ulid=01JPV3DP5YHHWT493PE221SDSW""
""time=2025-03-21T03:43:40.653Z level=INFO source=repair.go:54 msg=""""Found healthy block"""" component=tsdb mint=1742515201728 maxt=1742522400000 ulid=01JPVA9DDWJ38KEGYKP3JG711D""
""time=2025-03-21T03:43:40.653Z level=WARN source=dir_locker.go:76 msg=""""A lockfile from a previous execution already existed. It was replaced"""" component=tsdb file=/data/lock""
""time=2025-03-21T03:43:40.811Z level=INFO source=head.go:628 msg=""""Replaying on-disk memory mappable chunks if any"""" component=tsdb""
""time=2025-03-21T03:43:40.811Z level=INFO source=head.go:637 msg=""""Chunk snapshot is enabled, replaying from the snapshot"""" component=tsdb""
""time=2025-03-21T03:43:40.899Z level=INFO source=head_wal.go:1667 msg=""""chunk snapshot loaded"""" component=tsdb dir=/data/chunk_snapshot.000072.0008978432 num_series=12682 duration=87.85565ms""
""time=2025-03-21T03:43:40.899Z level=INFO source=head.go:667 msg=""""Chunk snapshot loading time"""" component=tsdb duration=88.011992ms""
""time=2025-03-21T03:43:40.918Z level=INFO source=head.go:715 msg=""""On-disk memory mappable chunks replay completed"""" component=tsdb duration=18.89737ms""
""time=2025-03-21T03:43:40.918Z level=INFO source=head.go:723 msg=""""Replaying WAL, this may take a while"""" component=tsdb""
""time=2025-03-21T03:43:41.051Z level=INFO source=head.go:760 msg=""""WAL checkpoint loaded"""" component=tsdb""
""time=2025-03-21T03:43:41.324Z level=INFO source=head.go:795 msg=""""WAL segment loaded"""" component=tsdb segment=88 maxSegment=91""
""time=2025-03-21T03:43:41.842Z level=INFO source=head.go:795 msg=""""WAL segment loaded"""" component=tsdb segment=89 maxSegment=91""
""time=2025-03-21T03:43:42.032Z level=INFO source=head.go:795 msg=""""WAL segment loaded"""" component=tsdb segment=90 maxSegment=91""
""time=2025-03-21T03:43:42.032Z level=INFO source=head.go:795 msg=""""WAL segment loaded"""" component=tsdb segment=91 maxSegment=91""
""time=2025-03-21T03:43:42.032Z level=INFO source=head.go:832 msg=""""WAL replay completed"""" component=tsdb checkpoint_replay_duration=133.504971ms wal_replay_duration=980.865649ms wbl_replay_duration=170ns chunk_snapshot_load_duration=88.011992ms mmap_chunk_replay_duration=18.89737ms total_replay_duration=1.221332779s""
""time=2025-03-21T03:43:42.116Z level=INFO source=main.go:1249 msg=""""filesystem information"""" fs_type=EXT4_SUPER_MAGIC""
""time=2025-03-21T03:43:42.116Z level=INFO source=main.go:1252 msg=""""TSDB started""""""
""time=2025-03-21T03:43:42.116Z level=INFO source=main.go:1437 msg=""""Loading configuration file"""" filename=/etc/config/prometheus.yml""
""time=2025-03-21T03:43:42.149Z level=INFO source=watcher.go:225 msg=""""Starting WAL watcher"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write queue=5cd4b5""
""time=2025-03-21T03:43:42.149Z level=INFO source=metadata_watcher.go:90 msg=""""Starting scraped metadata watcher"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write""
""time=2025-03-21T03:43:42.149Z level=INFO source=watcher.go:277 msg=""""Replaying WAL"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write queue=5cd4b5""
""time=2025-03-21T03:43:42.149Z level=INFO source=kubernetes.go:323 msg=""""Using pod service account via in-cluster config"""" component=""""discovery manager scrape"""" discovery=kubernetes config=kube-state-metrics""
""time=2025-03-21T03:43:42.150Z level=INFO source=main.go:1486 msg=""""Completed loading of configuration file"""" db_storage=883ns remote_storage=32.8121ms web_handler=428ns query_engine=1.233µs scrape=48.458µs scrape_sd=457.845µs notify=1.094µs notify_sd=903ns rules=176.53µs tracing=6.676µs filename=/etc/config/prometheus.yml totalDuration=33.904832ms""
""time=2025-03-21T03:43:42.150Z level=INFO source=main.go:1213 msg=""""Server is ready to receive web requests.""""""
""time=2025-03-21T03:43:42.150Z level=INFO source=manager.go:175 msg=""""Starting rule manager..."""" component=""""rule manager""""""
""time=2025-03-21T03:43:47.770Z level=INFO source=watcher.go:522 msg=""""Done replaying WAL"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write duration=5.621042809s""
""time=2025-03-21T03:50:39.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:51:54.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:53:09.468Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:54:09.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:55:09.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:56:24.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:57:39.468Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T03:58:54.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T04:00:09.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T04:01:24.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""
""time=2025-03-21T04:02:39.469Z level=INFO source=queue_manager.go:709 msg=""""Dropped sample for series that was not explicitly dropped via relabelling"""" component=remote remote_name=5cd4b5 url=https://aps-workspaces.us-east-1.amazonaws.com/workspaces/<WS>/api/v1/remote_write ref=21931""```",['kind/bug'],open,2025-03-21T15:37:35Z,,performance,['kind/bug'],True,,
prometheus/prometheus,16247,Inconsistency in millisecond selectors in query explanations,"### What did you do?

When using the ""Explain"" feature in Prometheus, there's an inconsistency in how millisecond selectors are represented:

- up[1001ms] is explained as up[1s]
- up[1002ms] is explained as up[1s2ms]
- up[1003ms] is explained as up[1s2ms]

![Image](https://github.com/user-attachments/assets/eaa11156-10e8-4d7b-a9ee-9648f01f8250)

### What did you expect to see?

Each millisecond selector should consistently and precisely reflect the original query:

- up[1001ms] => up[1s1ms]
- up[1002ms] => up[1s2ms]
- up[1003ms] => up[1s3ms]

### What did you see instead? Under which circumstances?

https://prometheus.demo.prometheus.io/query?g0.expr=up%5B1003ms%5D&g0.show_tree=1&g0.tab=explain&g0.range_input=1h&g0.res_type=auto&g0.res_density=medium&g0.display_mode=lines&g0.show_exemplars=0

### System information

_No response_

### Prometheus version

```text
prometheus, version 3.2.1 (branch: arythmetics, revision: 63e29dba9a7418d02a4200f60d862e408462380b)
  build user:       reproducible@reproducible
  build date:       19800101-00:00:00
  go version:       go1.24.0
  platform:         linux/amd64
  tags:             netgo,builtinassets,stringlabels
```

### Prometheus configuration file

```yaml

```

### Alertmanager version

```text

```

### Alertmanager configuration file

```yaml

```

### Logs

```text

```","['kind/bug', 'component/ui', 'component/promql']",closed,2025-03-20T09:39:39Z,2025-05-08T10:02:11Z,bug,"['kind/bug', 'component/ui', 'component/promql']",True,49.0,
grafana/grafana,107072,Alerting: Error on alert state history load: ruleUID is required to query annotations,"### What happened?

As soon as I try to access the alert state history page, it stays empty even though alerts were active in the past, and outputs the following error message: 

```
Something went wrong loading the alert state history
ruleUID is required to query annotations
```

Screenshot:
![Image](https://github.com/user-attachments/assets/35466ad0-ecab-4f58-92d3-ec58c3cb0148)

Entering filters does not help and still produces the same error message.

Grafana built-in alert manager is used, no other alert manager is and was ever configured.

### What did you expect to happen?

The alert state history page loads without error and displays past alerts as shown the [documentation](https://grafana.com/docs/grafana/latest/alerting/monitor-status/view-alert-state-history/#view-from-the-history-page).

### Did this work before?

The alert state history has not worked before on this installation, as it was just recently upgraded from a previous version which did not support the feature (11.1, if memory serves) to the most recent OOS version (12.0.2). The corresponding feature flag was enabled after the upgrade, using a Docker environment variable.

### How do we reproduce it?

1. Upgrade to current Docker container image
2. Enable ```alertingCentralAlertHistory``` feature flag, i.e. add ```GF_FEATURE_TOGGLES_ENABLE=alertingCentralAlertHistory``` to the Docker compose file in the environment variable section
3. Navigate to Alerting -> History

Seams to be a problem specific to our installation, as I could not find any other reports of the error message appearing in the alert state history. Further troubleshooting is probably required, any help is appriciated 😃 

### Is the bug inside a dashboard panel?

_No response_

### Environment (with versions)?

Grafana: Grafana OOS v12.0.2 (5bda17e7c1)
OS: Docker image, Docker version: Community 28.1.1, Kernel version: 6.5.13-1-pve (Docker container running inside LXC container running on [Proxmox](https://www.proxmox.com/en/))
Browser: Firefox 139.0.4 (64-Bit); Seams to be Browser independent, same error when using MS Edge

### Grafana platform?

Docker

### Datasource(s)?

_No response_","['type/bug', 'area/alerting', 'automated-triage']",open,2025-06-21T21:57:23Z,,bug,"['type/bug', 'area/alerting', 'automated-triage']",True,,
grafana/grafana,107070,Is it possible to package a default data source and several sample dashboards/tiles?,"<!-- Please only use this template for submitting feature requests -->

**Why is this needed**:

I am a newbie to Prometheus/Grafana observability stack. By default, when Prometheus/Grafana is up and running, you need to config data sources and start adding dashboards. To lower the bar for the newbies, maybe it will be useful to ship with a sample data source and some demo dashboards to give examples for the visualizations. Newbies can start playing immediately instead of trying to find what metrics are available, how to compose the query, etc.

You can also use the demo dashboards to showcase new changes when you release new versions.


**What would you like to be added**:

Package a default data source and several sample dashboards with Grafana. When it is running, users can play with those dashboards immediately.


**Who is this feature for?**

   1. Newbies to Prometheus/Grafana platform to quickly get started.
   2. Existing users to learn about new features and how to use them.
","['type/feature-request', 'area/provisioning', 'area/dashboard/import', 'automated-triage']",open,2025-06-21T17:28:09Z,,bug,"['type/feature-request', 'area/provisioning', 'area/dashboard/import', 'automated-triage']",True,,
grafana/grafana,107069,Resetting the admin password multiple times locks you out of Grafana,"### What happened?

Edit: Okay upon further examination I think it was just some weird UI issues. I was wrong about it evaluating the contents of the file, phew. Sorry! It just changed the password without showing that it changed it. But once I reset the password a second time with `admin reset-admin-password admin`, it becomes impossible to log in with any current or previous password. 


----------


This is going to sound batshit but it is reproducible.

So I am trying to get Grafana to run on a NixOS VM without knowing anything about VMs, Grafana or NixOS. And the NixOS documentation says ""use the file provider"" to avoid putting your admin password in your nix file, but either this ""file provider"" does not work in the nix file, or I am just doing it wrong. Either way, I ended up with my password being the string ""$__file(/var/secrets/grafana-admin)"". I logged in using this string.

I then went to change the password, put the string ""$__file(/var/secrets/grafana-admin)"" into the field for the old password, and the content of the file (which was the password that I wanted) into the fields for the new password. It gave an invalid old password error. But then I put the _contents_ of that file into the old password field, and it gave me the error that my new and old passwords should not be the same. So Grafana must have evaluated the content of the file while trying to set a password, or it could not have known that this string was inside the file.

I set up a fresh VM to reproduce it. This time, it did not set the admin password correctly in the first place (I must have done something different while installing Grafana or NixOS, like I said I am clueless). So before I could log in at all, I did `grafana-cli admin reset-admin-password admin` (it gave me an error that this is deprecated, but it worked).

Then I logged in using the password string ""admin"" and Grafana correctly asked me to change my password. I provided the string ""$__file(/var/secrets/grafana-admin)"" as my desired new password. Then I went to change my password again, and again it did not accept ""$__file(/var/secrets/grafana-admin)"" as my password, but only the content of the file.

After doing this, it seems to be impossible to log in again at all. Even resetting the password with grafana-cli does not result in a state where I can log in with any of the passwords. I have no idea what is going on. Sorry for this insane bug report, I just don't think this is desired behaviour

### What did you expect to happen?

Not that

### Did this work before?

I don't know

### How do we reproduce it?

See above

### Is the bug inside a dashboard panel?

No

### Environment (with versions)?

Grafana: grafana version 11.3.7+security-01
OS: NixOS 24.11.718854.d883b6213afa
Browser: Firefox


### Grafana platform?

None

### Datasource(s)?

_No response_","['type/bug', 'area/security', 'area/admin/user', 'automated-triage']",closed,2025-06-21T16:51:40Z,2025-06-21T18:39:42Z,bug,"['type/bug', 'area/security', 'area/admin/user', 'automated-triage']",True,0.0,
grafana/grafana,107067,[New Data Source]: <name-of-service>,"### Background

AWS sagamaker

### Use case

aws sagemaker for mlops pipelines.

### Contribution

- [x] Are you looking to create the plugin?
- [x] Are you affiliated with the project/product the data source integrates with?
- [x] Does the plugin integrate with a commercial product?","['area/datasource', 'type/new-plugin-request']",open,2025-06-21T11:46:43Z,,bug,"['area/datasource', 'type/new-plugin-request']",True,,
grafana/grafana,107066,Analytics broke,"### What happened?

This is failing in grafana/grafana:12.0.1 and grafana/grafana:12.0.2

[analytics]
check_for_updates = false
reporting_enabled = false
check_for_plugin_updates = false

https://github.com/grafana/grafana/pull/91194

### What did you expect to happen?

not reaching out to grafana.com

### Did this work before?

worked in 11

### How do we reproduce it?

1.add those to the analytics in the config file
2.
3.


### Is the bug inside a dashboard panel?

_No response_

### Environment (with versions)?

Grafana: 12.01
OS: debian
Browser: any


### Grafana platform?

Kubernetes

### Datasource(s)?

_No response_","['type/bug', 'area/backend', 'area/configuration', 'type/regression', 'automated-triage']",open,2025-06-20T22:08:56Z,,bug,"['type/bug', 'area/backend', 'area/configuration', 'type/regression', 'automated-triage']",True,,
elastic/elasticsearch,129817,[CI] MixedClusterEsqlSpecIT test {ip.ToIpInAgg SYNC} failing,"**Build Scans:**
- [elasticsearch-periodic #8893 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/jxyre2jr2k7ly)
- [elasticsearch-periodic #8887 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/zz2dfgpfqvqyy)
- [elasticsearch-periodic #8881 / 8.11.4_bwc](https://gradle-enterprise.elastic.co/s/tmrxwnir4r73q)
- [elasticsearch-periodic #8875 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/tja6z5pse3jby)
- [elasticsearch-periodic #8869 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/cedo443vssnum)
- [elasticsearch-periodic #8863 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/eo2d6ty2pq322)
- [elasticsearch-periodic #8857 / 8.11.4_bwc](https://gradle-enterprise.elastic.co/s/iia5w3jbvonzo)
- [elasticsearch-periodic #8857 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/gwhc7hpo4pu72)
- [elasticsearch-periodic #8851 / 8.12.2_bwc](https://gradle-enterprise.elastic.co/s/zsvoax5zmgsyi)

**Reproduction Line:**
```
./gradlew "":x-pack:plugin:esql:qa:server:mixed-cluster:v8.12.2#javaRestTest"" -Dtests.class=""org.elasticsearch.xpack.esql.qa.mixed.MixedClusterEsqlSpecIT"" -Dtests.method=""test {ip.ToIpInAgg SYNC}"" -Dtests.seed=703C5C97A5661337 -Dtests.bwc=true -Dtests.locale=cgg-Latn-UG -Dtests.timezone=America/Thunder_Bay -Druntime.java=24
```

**Applicable branches:**
8.19

**Reproduces locally?:**
N/A

**Failure History:**
[See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.xpack.esql.qa.mixed.MixedClusterEsqlSpecIT),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(test%20%7Bip.ToIpInAgg%20SYNC%7D),title:'Test',type:optionsListControl)))))

**Failure Message:**
```
org.elasticsearch.client.ResponseException: method [POST], host [http://[::1]:35445], URI [/_query?format=cbor&pretty=true&error_trace=true], status line [HTTP/1.1 400 Bad Request]
¿eerror¿jroot_cause¿dtypeqparsing_exceptionfreasonxCline 1:42: mismatched input '=' expecting {<EOF>, PIPE, COMMA, '.'}kstack_tracey	®org.elasticsearch.xpack.esql.parser.ParsingException: line 1:42: mismatched input '=' expecting {<EOF>, PIPE, COMMA, '.'}
	at org.elasticsearch.xpack.esql.parser.EsqlParser$1.syntaxError(EsqlParser.java:109)
	at org.antlr.v4.runtime.ProxyErrorListener.syntaxError(ProxyErrorListener.java:41)
	at org.antlr.v4.runtime.Parser.notifyErrorListeners(Parser.java:544)
	at org.antlr.v4.runtime.DefaultErrorStrategy.reportInputMismatch(DefaultErrorStrategy.java:327)
	at org.antlr.v4.runtime.DefaultErrorStrategy.reportError(DefaultErrorStrategy.java:139)
	at org.elasticsearch.xpack.esql.parser.EsqlBaseParser.singleStatement(EsqlBaseParser.java:188)
	at org.elasticsearch.xpack.esql.parser.
[truncated]
```

**Issue Reasons:**
- [8.19] 2 consecutive failures in step 8.12.2_bwc
- [8.19] 9 failures in test test {ip.ToIpInAgg SYNC} (4.4% fail rate in 203 executions)
- [8.19] 7 failures in step 8.12.2_bwc (87.5% fail rate in 8 executions)
- [8.19] 2 failures in step 8.11.4_bwc (25.0% fail rate in 8 executions)
- [8.19] 8 failures in pipeline elasticsearch-periodic (100.0% fail rate in 8 executions)

**Note:**
This issue was created using new test triage automation. Please report issues or feedback to es-delivery.","['>test-failure', 'Team:Analytics', ':Analytics/ES|QL', 'needs:risk']",open,2025-06-22T13:35:20Z,,security,"['>test-failure', 'team:analytics', ':analytics/es|ql', 'needs:risk']",True,,
elastic/elasticsearch,129811,ArrayIndexOutOfBoundsException in ValuesBytesRefGroupingAggregatorFunction,"Observed in our Serverless environment.

```
java.lang.ArrayIndexOutOfBoundsException: Index 5 out of bounds for length 5   
 org.elasticsearch.compute.data.Page.getBlock(Page.java:146)
 org.elasticsearch.compute.aggregation.ValuesBytesRefGroupingAggregatorFunction.addIntermediateInput(ValuesBytesRefGroupingAggregatorFunction.java:218)
 org.elasticsearch.compute.aggregation.GroupingAggregator$1.add(GroupingAggregator.java:62)
 org.elasticsearch.compute.operator.HashAggregationOperator$1AddInput.add(HashAggregationOperator.java:175)
 org.elasticsearch.compute.aggregation.GroupingAggregatorFunction$AddInput.add(GroupingAggregatorFunction.java:69)
 org.elasticsearch.compute.aggregation.blockhash.AddPage.emitOrds(AddPage.java:162)
 org.elasticsearch.compute.aggregation.blockhash.AddPage.flushRemaining(AddPage.java:156)
 org.elasticsearch.compute.aggregation.blockhash.PackedValuesBlockHash$AddWork.add(PackedValuesBlockHash.java:145)   org.elasticsearch.compute.aggregation.blockhash.PackedValuesBlockHash.add(PackedValuesBlockHash.java:85)   org.elasticsearch.compute.aggregation.blockhash.PackedValuesBlockHash.add(PackedValuesBlockHash.java:80)
 org.elasticsearch.compute.operator.HashAggregationOperator.addInput(HashAggregationOperator.java:203)
 org.elasticsearch.compute.operator.Driver.runSingleLoopIteration(Driver.java:279)
 org.elasticsearch.compute.operator.Driver.run(Driver.java:185)
 org.elasticsearch.compute.operator.Driver$1.doRun(Driver.java:406)
 org.elasticsearch.server@9.1.0/org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:27)
 org.elasticsearch.compute.operator.DriverScheduler$1.doRun(DriverScheduler.java:57)
 org.elasticsearch.server@9.1.0/org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:27)
 org.elasticsearch.server@9.1.0/org.elasticsearch.common.util.concurrent.TimedRunnable.doRun(TimedRunnable.java:35)
 org.elasticsearch.server@9.1.0/org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:1044)
 org.elasticsearch.server@9.1.0/org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:27)
 java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1095)
 java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:619)
 java.base/java.lang.Thread.run(Thread.java:1447)
```","['>bug', 'Team:Analytics', ':Analytics/ES|QL']",open,2025-06-21T15:08:59Z,,bug,"['>bug', 'team:analytics', ':analytics/es|ql']",True,,
elastic/elasticsearch,129808,[CI] DockerTests test082CannotUseEnvVarsAndFiles failing,"**Build Scans:**
- [elasticsearch-periodic-packaging #8549 / ubuntu-2204_packaging-tests-unix](https://gradle-enterprise.elastic.co/s/36atltbb7ruva)
- [elasticsearch-periodic-packaging #8543 / ubuntu-2204_packaging-tests-unix](https://gradle-enterprise.elastic.co/s/dsmczgxra5ydi)

**Reproduction Line:**
```
null
```

**Applicable branches:**
main

**Reproduces locally?:**
N/A

**Failure History:**
[See dashboard](https://es-delivery-stats.elastic.dev/app/dashboards#/view/dcec9e60-72ac-11ee-8f39-55975ded9e63?_g=(refreshInterval:(pause:!t,value:60000),time:(from:now-7d%2Fd,to:now))&_a=(controlGroupState:(initialChildControlState:('0c0c9cb8-ccd2-45c6-9b13-96bac4abc542':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:task.keyword,order:0,selectedOptions:!(),title:'GradleTask',type:optionsListControl),'4e6ad9d6-6fdc-4fcc-bf1a-aa6ca79e0850':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:className.keyword,order:1,selectedOptions:!(org.elasticsearch.packaging.test.DockerTests),title:'Suite',type:optionsListControl),'144933da-5c1b-4257-a969-7f43455a7901':(dataViewId:fbbdc689-be23-4b3d-8057-aa402e9ed0c5,fieldName:name.keyword,order:2,selectedOptions:!(test082CannotUseEnvVarsAndFiles),title:'Test',type:optionsListControl)))))

**Failure Message:**
```
java.lang.AssertionError: Elasticsearch container did not start successfully.

ps output:
0

Stdout:
Created elasticsearch keystore in /usr/share/elasticsearch/config/elasticsearch.keystore

Stderr:


Thread dump:
2025-06-21 05:11:00
Full thread dump OpenJDK 64-Bit Server VM (24+36-3646 mixed mode, sharing):

Threads class SMR info:
_java_thread_list=0x000076f410000b60, length=12, elements={
0x000076f48002a7d0, 0x000076f48006d3b0, 0x000076f48006e380, 0x000076f48006fb90,
0x000076f480071270, 0x000076f4800728b0, 0x000076f480074470, 0x000076f480075c20,
0x000076f4800818d0, 0x000076f480083f80, 0x000076f4005295b0, 0x000076f410000f20
}

""main"" #3 [315] prio=5 os_prio=0 cpu=20679.22ms elapsed=24.18s tid=0x000076f48002a7d0 nid=315 runnable  [0x000076f484af9000]
   java.lang.Thread.State: RUNNABLE
	at sun.security.provider.DigestBase.engineDigest(java.base@24/DigestBase.java:205)
	at sun.security.provider.DigestBase.engineDigest(java.base@24/DigestBase.java:185)
	at java.security.MessageDigest$De
[truncated]
```

**Issue Reasons:**
- [main] 2 failures in test test082CannotUseEnvVarsAndFiles (0.6% fail rate in 318 executions)
- [main] 2 failures in step ubuntu-2204_packaging-tests-unix (66.7% fail rate in 3 executions)
- [main] 2 failures in pipeline elasticsearch-periodic-packaging (50.0% fail rate in 4 executions)

**Note:**
This issue was created using new test triage automation. Please report issues or feedback to es-delivery.","[':Delivery/Packaging', '>test-failure', 'Team:Delivery', 'needs:risk']",open,2025-06-21T06:46:43Z,,security,"[':delivery/packaging', '>test-failure', 'team:delivery', 'needs:risk']",True,,
elastic/elasticsearch,129778,"ESQL: MATCH, MATCH_PHRASE allowed past LOOKUP JOIN (and fails uncontrolled)","### Description

The following query fails with an assertion, instead of a verification error:
```
FROM sample_data
| LOOKUP JOIN lookup_sample_data_ts_nanos ON client_ip
| WHERE message : ""Disconnected""
```

The verification works for KQL, QSTR, however, the error message should be improved: `[QSTR] function cannot be used after LOOKUP` (there's a splitting of node's name and only picking the first token).

Only tried main, 8.19 is probably affected too.","['>bug', 'Team:Analytics', ':Analytics/ES|QL', 'v9.1.0']",open,2025-06-20T14:19:16Z,,bug,"['>bug', 'team:analytics', ':analytics/es|ql', 'v9.1.0']",True,,
elastic/elasticsearch,129777,[ML] Update calendar events for anomaly detection jobs fails sometimes,"### Elasticsearch Version

8.17

### Installed Plugins

_No response_

### Java Version

_bundled_

### OS Version

Linux

### Problem Description

The customer reported that assigning the DST calendar to a job group that contains 1500 anomaly detection jobs failed to enforce the time shift for about 15% of the jobs.

### Steps to Reproduce

1. Add all jobs to one group
2. Assign the group to a DST calendar
3. Verify if the model was shifted by 3600 seconds when the DST event occurred.


### Logs (if relevant)

_No response_","['>bug', ':ml', 'Team:ML']",open,2025-06-20T14:14:15Z,,bug,"['>bug', ':ml', 'team:ml']",True,,
nodejs/node,58792,rejectUnauthorized for WebSocket,"### What is the problem this feature will solve?

Accessing trusted remotes with expired certificates or where the name mismatches.

### What is the feature you are proposing to solve the problem?

A `rejectUnauthorized` option for the WebSocket constructor.

### What alternatives have you considered?

Using the 'websocket' package, but this depends on node-gyp, making it a less portable solution than native support.",['feature request'],open,2025-06-22T14:07:04Z,,security,['feature request'],True,,
nodejs/node,58784,ERR_USE_AFTER_CLOSE in repl with async eval,"### Version

24.2

### Platform

```text
Darwin oz.local 24.5.0 Darwin Kernel Version 24.5.0: Tue Apr 22 19:54:49 PDT 2025; root:xnu-11417.121.6~2/RELEASE_ARM64_T6000 arm64
```

### Subsystem

repl

### What steps will reproduce the bug?

u.mjs:

```js
import repl from 'node:repl';
const cborRepl = repl.start({
  prompt: 'u> ',
  eval(cmd, _context, _file, cb) {
    console.log('eval', cmd);
    setTimeout(() => {
      cb(new Error('foo'));
    }, 10);
  },
});
```

Then at the command line: `echo bar | node u.mjs`.

### How often does it reproduce? Is there a required condition?

100%

### What is the expected behavior? Why is that the expected behavior?

On node 24.1 and earlier, produces the follow output:

```
u> bar
eval bar

Uncaught Error: foo
u> ⏎
```

With an exit code of 0.

### What do you see instead?

On node 24.2, produces:

```
u> bar
eval bar

Uncaught Error: foo
Uncaught Error [ERR_USE_AFTER_CLOSE]: readline was closed
    at REPLServer.resume (node:internal/readline/interface:583:13)
    at REPLServer.prompt (node:internal/readline/interface:434:27)
    at REPLServer.displayPrompt (node:repl:1217:8)
    at Domain.debugDomainError (node:repl:782:12)
    at Domain.emit (node:events:507:28)
    at Domain.emit (node:domain:489:12)
    at finish (node:repl:961:22) {
  code: 'ERR_USE_AFTER_CLOSE'
}
node:internal/readline/interface:583
      throw new ERR_USE_AFTER_CLOSE('readline');
      ^

Error [ERR_USE_AFTER_CLOSE]: readline was closed
    at REPLServer.resume (node:internal/readline/interface:583:13)
    at REPLServer.prompt (node:internal/readline/interface:434:27)
    at REPLServer.displayPrompt (node:repl:1217:8)
    at Domain.debugDomainError (node:repl:782:12)
    at Domain.emit (node:events:507:28)
    at Domain.emit (node:domain:489:12)
    at Domain._errorHandler (node:domain:279:23)
    at Object.<anonymous> (node:domain:181:29)
    at process._fatalException (node:internal/process/execution:159:29) {
  code: 'ERR_USE_AFTER_CLOSE'
}

Node.js v24.2.0
```

With an exit code of 1.

### Additional information

This was caused by #58283.

In my opinion, either:

a) the close of repl's readline instance due to the end-of-file on stdin should be delayed until any outstanding callbacks from eval have been called.
b) the callback firing after close has been called should not cause an error

There are likely several other ways to fix it.

As a quick hack of a workaround, I can add this code:

```js
const oclose = r.close;
r.close = (...args) => {
  setTimeout(() => oclose.apply(r, args), 15);
};
```

to move the close a little later.  This is NOT RECOMMENDED, and only works in my use case because my eval callback is called pretty quickly and stays in the queue ahead of this setTimeout.",['repl'],open,2025-06-21T22:43:28Z,,performance,['repl'],True,,
nodejs/node,58766,"Nominate @IlyasShabi as a collaborator 
","@IlyasShabi is doing some solid work on Node.js dotenv. I believe they will be a good addition to the Node.js project.

Commits in the [nodejs/node](https://github.com/nodejs/node) repository: https://github.com/nodejs/node/commits?author=IlyasShabi
Pull requests and issues opened in the [nodejs/node](https://github.com/nodejs/node) repository: https://github.com/nodejs/node/issues?q=author:IlyasShabi
Comments on pull requests and issues in the [nodejs/node](https://github.com/nodejs/node) repository: https://github.com/nodejs/node/issues?q=commenter:IlyasShabi
Reviews on pull requests in the [nodejs/node](https://github.com/nodejs/node) repository: https://github.com/nodejs/node/pulls?q=reviewed-by:IlyasShabi
Pull requests and issues opened throughout the Node.js organization: https://github.com/search?q=author:IlyasShabi+org:nodejs
Comments on pull requests and issues throughout the Node.js organization: https://github.com/search?q=commenter:IlyasShabi+org:nodejs

cc @nodejs/collaborators",['meta'],open,2025-06-19T14:06:04Z,,bug,['meta'],True,,
nodejs/node,58759,fs.rmSync('a.思') crash without throw,"### Version

v24.2.0

### Platform

```text
Windows 10
```

### Subsystem

_No response_

### What steps will reproduce the bug?

When `fs.rmSync('a.思')` exists files with extension containing Chinese chars, node 24 will crash without throw. node 23 seems OK.

### How often does it reproduce? Is there a required condition?

Everytime

### What is the expected behavior? Why is that the expected behavior?

Delete the file normally.

### What do you see instead?

Process exited with code 3221226505.

### Additional information

Maybe there's a problem with how v24 parses the extension?
The response of direct crash is similar to #56049.","['fs', 'windows']",open,2025-06-18T23:23:17Z,,bug,"['fs', 'windows']",True,,
nodejs/node,58755,Support relative compile cache,"### What is the problem this feature will solve?

The built-in compile cache is currently always using absolute paths to decide cache miss/hit, so the cache is not portable.

### What is the feature you are proposing to solve the problem?

Support an option for the built-in compile cache to encode the hashes with relative paths and use that to decide cache miss/hit, so that after generating the cache in a specified relative directory, the source directory along with the cache directory can be bundled and moved to elsewhere, and continue to work from a different base directory.


### What alternatives have you considered?

_No response_",['feature request'],open,2025-06-18T14:28:31Z,,performance,['feature request'],True,,
nodejs/node,58747,fs.promises.mkdtemp has internal error under --permissions,"### Version

v24.2.0

### Platform

```text
Darwin The-Box.local 23.6.0 Darwin Kernel Version 23.6.0: Fri Nov 15 15:11:49 PST 2024; root:xnu-10063.141.1.702.7~1/RELEASE_ARM64_T6020 arm64
```

### Subsystem

fs

### What steps will reproduce the bug?

Run `node --permission` (granting no permissions), then

```js
await fs.promises.mkdtemp('asdf')
```


### How often does it reproduce? Is there a required condition?

Always

### What is the expected behavior? Why is that the expected behavior?

This should throw a single `ERR_ACCESS_DENIED` error.

### What do you see instead?

This produces the wrong error:

```
TypeError: Method Promise.prototype.then called on incompatible receiver undefined
    at then (<anonymous>)
    at Object.mkdtemp (node:internal/fs/promises:1178:16)
    at REPL65:1:51
```
and also produces an _uncaught_ error with the right error:
```
Error: Access to this API has been restricted. Use --allow-fs-write to manage permissions.
    at Object.mkdtemp (node:internal/fs/promises:1179:13)
    at REPL65:1:51 {
  code: 'ERR_ACCESS_DENIED',
  permission: 'FileSystemWrite',
  resource: 'asdfXXXXXX'
```

### Additional information

You can also wrap it in a try-catch and observe that there is still an uncaught error, which should never happen:

```
> try { await fs.promises.mkdtemp('asdf') } catch {}
undefined
> Uncaught:
Error: Access to this API has been restricted. Use --allow-fs-write to manage permissions.
    at Object.mkdtemp (node:internal/fs/promises:1179:13)
    at REPL66:1:40 {
  code: 'ERR_ACCESS_DENIED',
  permission: 'FileSystemWrite',
  resource: 'asdfXXXXXX'
```",['permission'],open,2025-06-18T03:52:38Z,,bug,['permission'],True,,
nodejs/node,58744,v8: consider cherry-picking `3d750c2` to v24.x,"13.7.92 contains an explicit resource management fix, v8/v8@3d750c2aa9ef3d44660a977baf4839fc1e9df217.

Currently, the feature is broken entirely if the `[await] using` variable gets bound to a closure, with the disposer never being invoked.

```js
{
  using disposable = {
    [Symbol.dispose]() { console.log('disposed!') },
  };
  // Create an arbitrary closure binding `disposable`
  () => { disposable };
}
```

When running the above example in v24.x, after the closure is created, V8 does not invoke the disposer on exiting the block.

cc: @targos","['v8 engine', 'v24.x']",open,2025-06-17T17:10:31Z,,bug,"['v8 engine', 'v24.x']",True,,
nodejs/node,58742,`fsPromise.writeFile` should catch stream's error and reject the promise.,"### Version

22.16.0

### Platform

```text
All
```

### Subsystem

_No response_

### What steps will reproduce the bug?

Following code fails with an application crash.

```javascript
import fsp from ""node:fs/promises"";
import { createReadStream } from ""node:fs"";

try {
    const s1 = createReadStream(""not-existent"");
    await fsp.writeFile(""new-file.txt"", s1);
} catch (error) {
    console.log(`Sorry file copy failed`);
}
```

Instead it should just say that an error has occurred and reject the promise.

### How often does it reproduce? Is there a required condition?

Everytime

### What is the expected behavior? Why is that the expected behavior?

The application should not crash and an error should be thrown.

### What do you see instead?

Application Crashes.

# Reproduction Repository
[ackava/node-write-file-promise-fail](https://github.com/ackava/node-write-file-promise-fail)

This repo contains docker container source code to reproduce error in container. On windows machine, delay causes app to crash but in container, slight delay of 1 ms causes crash.


### Workaround

So far following code works correctly with slight time differences, and does not crash the app, promise is rejected correctly.
```
        const writable = createWriteStream(outputFilePath);
        return pipeline(inputStream, writable, { end: true });
```","['confirmed-bug', 'fs']",open,2025-06-17T13:28:46Z,,bug,"['confirmed-bug', 'fs']",True,,
nodejs/node,58735,Conflict between `child_process` API guidance and DEP0190,"### Affected URL(s)

https://nodejs.org/docs/latest-v24.x/api/child_process.html#spawning-bat-and-cmd-files-on-windows

### Description of the problem

The suggestions here include using `spawn` with `shell: true`, however doing so is deprecated with [DEP0190](https://nodejs.org/docs/latest-v24.x/api/deprecations.html#dep0190-passing-args-to-nodechild_process-execfilespawn-with-shell-option-true). This conflicting messaging is confusing and makes this difficult-to-use-safely API even more confusing to use for non-experts.

I don't know what the right call is here. My guess is that DEP0190 was created to nudge people away from using `spawn` with `shell: true` by either using it safely or explicitly using the insecure `exec` command. Since the only alternative in the documentation is `exec` I'd suggest removing the suggestion to use `spawn` with `shell: true` entirely.",['doc'],open,2025-06-16T21:08:54Z,,bug,['doc'],True,,
nodejs/node,58730,Enabling Rust support for Temporal,"Hi!


I've been working on [implementing ECMAScript Temporal upstream in V8](https://chromium-review.googlesource.com/q/hashtag:%22temporal%22+(status:open%20OR%20status:merged)). It's being implemented based on the [temporal_rs](https://github.com/boa-dev/temporal) and [icu4x](https://github.com/unicode-org/icu4x) libraries, which are in Rust.

As such, it needs Rust support to work ([initial V8 CL for adding Rust to DEPS](https://chromium-review.googlesource.com/c/v8/v8/+/6254457).

When first working on this feature [V8-in-Node CI](https://ci.chromium.org/ui/p/node-ci/builders/try/node_ci_linux64_rel/b8715942349745390433/overview) was failing due to the lack of these vendored deps. So V8 now has a `v8_enable_temporal_support` that is enabled by default[^1] but disabled in some builds, including the Node build.

Presumably, NodeJS will eventually want to have support for Temporal. It's probably worth figuring out what is needed to get there even though there's still a fair amount of time for us to be ready to ship.

Opening this issue to start the conversation; I'm happy to help out upstream if needed.

A challenge that may crop up is that Node vendors v8 which means that it will have to vendor third_party/rust and the toolchain: currently V8's third_party/rust is the same as that of Chrome, which includes a lot of extra Rust deps that Chrome has (so far this hasn't been a problem). If Node doesn't wish to pull all of that in, it may need to do something build-system wise to download those deps but not check them in to the tree.


 [^1]: Temporal is still disabled at runtime by default (the implementation is not ready); but it still gets built.",['build-agenda'],open,2025-06-16T17:03:42Z,,bug,['build-agenda'],True,,
nodejs/node,58729,Extend --env-file with support for INI sections,"### What is the problem this feature will solve?

In our team, we embraced the use of `--env-file` right from NodeJS v20, it is an awesome addition!

However, in most cases the file that we pass in has INI format, which is quite expected. And INI files support sections (`[section_name]`), and we do not want NodeJS to push all values from all sections automatically into `NODE_ENV`, because some may end up overriding useful configuration inside `NODE_ENV` that's there by default.


### What is the feature you are proposing to solve the problem?

For NodeJS to support optional section name(s), so only from those the values would go into `NODE_ENV`.

For example, supporting `--env-sec`, to take one or more section names, so only from those to load the variables:

```
--env-sec=sec1,sec2
```

Or alternatively extend `--env-file` syntax, say by appending `#` + section name(s):

```
--env-file=env/dev.ini#sec1,sec2
```

So above it would load `env/dev.ini`, and push everything only from sections `sec1` and `sec2` into `NODE_ENV`. I personally prefer the latter syntax, to avoid too many parameters to be passed in just for loading configuration.

### What alternatives have you considered?

Without any such support, we have to split an INI file into several, one for NodeJS, and one for the rest of the application, which is a significant inconvenience.

### Afterthought

As an extra benefit, such a feature would make it possible to consolidate environment configurations inside a single INI file when needed:

```ini
[dev]
DB_HOST=localhost

[prod]
DB_HOST=123.234.125.68
```

Presently, NodeJS will just end up with the last value as an override, which is against the INI logic. Sections need to be respected when they are used, since NodeJS already has partial support for INI files, in effect, so this addition would make it a complete support.

It would be sweet, if for the above example we could just specify:

```
node --env-file=env/config.ini#dev
```
",['feature request'],open,2025-06-16T16:51:36Z,,performance,['feature request'],True,,
nodejs/node,58726,fs: non-bigint `stat` can give 0.20566138856% bigger results,"### Version

v24.2.0, v25.0.0-pre

### Platform

```text
Linux tumba 6.14.8-gentoo-yuran #2 SMP Tue May 27 17:51:23 +08 2025 x86_64 Intel(R) Core(TM)2 Quad CPU Q8200 @ 2.33GHz GenuineIntel GNU/Linux
```

### Subsystem

fs

### What steps will reproduce the bug?

import fs from 'node:fs/promises';
const f = '/tmp/deleteme-utimes-issue-file';
await fs.writeFile(f, '');

console.log('|', 'set', '|', 'got', '|', 'got/set', '|');
console.log('|', '---', '|', '---', '|', '---', '|');

for (let i = 1; i < Number.MAX_SAFE_INTEGER; i *= 3) {
        await fs.utimes(f, i, i);
        const { mtimeMs } = await fs.stat(f);
        console.log('|', i, '|', mtimeMs, '|', mtimeMs / i, '|');
}

await fs.rm(f);

### How often does it reproduce? Is there a required condition?

Reproduces on one specific PC all the time. Couldn't reproduce on any other machine so far.

### What is the expected behavior? Why is that the expected behavior?

| set | got | got/set |
| --- | --- | --- |
| 1 | 1000 | 1000 |
| 3 | 3000 | 1000 |
| 9 | 9000 | 1000 |
| 27 | 27000 | 1000 |
| 81 | 81000 | 1000 |
| 243 | 243000 | 1000 |
| 729 | 729000 | 1000 |
| 2187 | 2187000 | 1000 |
| 6561 | 6561000 | 1000 |
| 19683 | 19683000 | 1000 |
| 59049 | 59049000 | 1000 |
| 177147 | 177147000 | 1000 |
| 531441 | 531441000 | 1000 |
| 1594323 | 1594323000 | 1000 |
| 4782969 | 4782969000 | 1000 |
| 14348907 | 14348907000 | 1000 |
| 43046721 | 43046721000 | 1000 |
| 129140163 | 129140163000 | 1000 |
| 387420489 | 387420489000 | 1000 |
| 1162261467 | 1162261467000 | 1000 |
| 3486784401 | 3486784401000 | 1000 |
| 10460353203 | 10460353203000 | 1000 |
| 31381059609 | 15032385535000 | 479.0273407685939 |
| 94143178827 | 15032385535000 | 159.67578025619795 |
| 282429536481 | 15032385535000 | 53.22526008539932 |
| 847288609443 | 15032385535000 | 17.741753361799773 |
| 2541865828329 | 15032385535000 | 5.913917787266591 |
| 7625597484987 | 15032385535000 | 1.9713059290888637 |
| 22876792454961 | 15032385535000 | 0.6571019763629545 |
| 68630377364883 | 15032385535000 | 0.21903399212098484 |
| 205891132094649 | 15032385535000 | 0.07301133070699495 |
| 617673396283947 | 15032385535000 | 0.024337110235664983 |
| 1853020188851841 | 15032385535000 | 0.008112370078554995 |
| 5559060566555523 | 15032385535000 | 0.0027041233595183315 |

Expected because 1 second is 1000 milliseconds

### What do you see instead?

| set | got | got/set |
| --- | --- | --- |
| 1 | 1002.0566138856454 | 1002.0566138856454 |
| 3 | 3006.169841656936 | 1002.0566138856453 |
| 9 | 9018.509524970808 | 1002.0566138856453 |
| 27 | 27055.528574912427 | 1002.0566138856454 |
| 81 | 81166.58572473728 | 1002.0566138856454 |
| 243 | 243499.75717421185 | 1002.0566138856454 |
| 729 | 730499.2715226355 | 1002.0566138856453 |
| 2187 | 2191497.814567907 | 1002.0566138856456 |
| 6561 | 6574493.443703719 | 1002.0566138856454 |
| 19683 | 19723480.33111116 | 1002.0566138856454 |
| 59049 | 59170440.99333348 | 1002.0566138856454 |
| 177147 | 177511322.98000044 | 1002.0566138856454 |
| 531441 | 532533968.9400013 | 1002.0566138856454 |
| 1594323 | 1597601906.820004 | 1002.0566138856454 |
| 4782969 | 4792805720.4600115 | 1002.0566138856454 |
| 14348907 | 14378417161.380035 | 1002.0566138856454 |
| 43046721 | 43135251484.14011 | 1002.0566138856454 |
| 129140163 | 129405754452.42032 | 1002.0566138856454 |
| 387420489 | 388217263357.2609 | 1002.0566138856453 |
| 1162261467 | 1164651790071.783 | 1002.0566138856456 |
| 3486784401 | 3493955370215.3486 | 1002.0566138856454 |
| 10460353203 | 10481866110646.045 | 1002.0566138856453 |
| 31381059609 | 15063301347825.656 | 480.0125150492224 |
| 94143178827 | 15063301347825.656 | 160.0041716830741 |
| 282429536481 | 15063301347825.656 | 53.33472389435804 |
| 847288609443 | 15063301347825.656 | 17.778241298119347 |
| 2541865828329 | 15063301347825.656 | 5.926080432706449 |
| 7625597484987 | 15063301347825.656 | 1.975360144235483 |
| 22876792454961 | 15063301347825.656 | 0.6584533814118276 |
| 68630377364883 | 15063301347825.656 | 0.2194844604706092 |
| 205891132094649 | 15063301347825.656 | 0.0731614868235364 |
| 617673396283947 | 15063301347825.656 | 0.024387162274512136 |
| 1853020188851841 | 15063301347825.656 | 0.008129054091504046 |
| 5559060566555523 | 15063301347825.656 | 0.002709684697168015 |

### Additional information

This issue causes `test/parallel/test-fs-cp.mjs`, `test/parallel/test-fs-promises.js`, `test/parallel/test-fs-stat-bigint.js`, and `test/parallel/test-fs-utimes-y2K38.js` fail for me locally every time. 😧

This issue persists for `statSync()`, too.
This issue persists between different filesystems.

This issue does not appear when using `bigint` option.
This issue does not appear when using `touch`/`stat`, or similar functions in other languages.

I suspect some weird bug with floating point.",['fs'],closed,2025-06-16T13:58:06Z,2025-06-18T16:36:56Z,bug,['fs'],True,2.0,
nodejs/node,58723,Thread dead lock when napi_call_threadsafe_function in some case,"### Version

_No response_

### Platform

```text

```

### Subsystem

_No response_

### What steps will reproduce the bug?

codes under here.
when call counts greater than max_queue_size and queue is already filling, the thread maybe sleeping until next times tsfn queue is fuling or release is called.
```cc
Napi::Value Tsfn(const Napi::CallbackInfo &info) {
  Napi::Env env = info.Env();
  std::atomic<uint32_t> *extraQueuedCounts = new std::atomic<uint32_t>{0};
  napi_threadsafe_function tsfn = nullptr;
  napi_create_threadsafe_function(
      env, nullptr, nullptr, Napi::String::New(env, ""hello""), MAX_QUEUE_SIZE, 1,
      nullptr, nullptr, nullptr,
      [](napi_env, napi_value, void *, void *data) {
        std::cout << ""executed: "" << (uintptr_t)data << std::endl;
      },
      &tsfn);
  // It fulled queue of tsfn
  for (uint32_t i = 0; i < MAX_QUEUE_SIZE; i++) {
    napi_call_threadsafe_function(tsfn, (void *)uintptr_t(i),
                                  napi_tsfn_blocking);
  }
  for (uint32_t i = 0; i < MAX_QUEUE_SIZE; i++) {
    std::thread(
        [&i](napi_threadsafe_function tsfn, std::atomic<uint32_t> *counter) {
          std::cout << ""waiting: "" << gettid() << std::endl;
          napi_call_threadsafe_function(tsfn, (void *)uintptr_t(i + 3),
                                        napi_tsfn_blocking);
          (*counter)++;
          std::cout << ""called: "" << gettid() << std::endl;
          // release tsfn after all task queued
          if (counter->load() == MAX_QUEUE_SIZE) {
            napi_release_threadsafe_function(tsfn, napi_tsfn_release);
          }
        },
        tsfn, extraQueuedCounts)
        .detach();
  }
  std::cout << ""queued count: "" << extraQueuedCounts->load() << std::endl;
  return env.Undefined();
}
```

### How often does it reproduce? Is there a required condition?

sometimes

### What is the expected behavior? Why is that the expected behavior?

thread should be awake if queue is not filled

### What do you see instead?

thread is blocked

### Additional information

_No response_",['node-api'],open,2025-06-16T07:35:20Z,,bug,['node-api'],True,,
nodejs/node,58720,Crash at `uv_write2` with `Assertion failed` on Darwin,"### Version

v24.1.0

### Platform

```text
Darwin host.local 23.5.0 Darwin Kernel Version 23.5.0: Wed May  1 20:12:58 PDT 2024; root:xnu-10063.121.3~5/RELEASE_ARM64_T6000 arm64 Darwin
```

### Subsystem

net

### What steps will reproduce the bug?

I don't know

### How often does it reproduce? Is there a required condition?

Every 1-5 days and I don't know after what it crashes

### What is the expected behavior? Why is that the expected behavior?

It shouldn't crash.

### What do you see instead?

https://gist.github.com/Kamillaova/6814bcefb3b3ebdb3da3836614b8f5f6

```
Assertion failed: (n <= stream->write_queue_size), function uv__write_req_update, file src/unix/stream.c, line 694.
Process 81494 stopped
* thread #1, name = 'MainThread', queue = 'com.apple.main-thread', stop reason = hit program assert
    frame #4: 0x00000001044935dc libuv.1.dylib`uv__write + 780
libuv.1.dylib`uv__write:
->  0x1044935dc <+780>: adr    x0, #0xb61d               ; ""uv__write""
    0x1044935e0 <+784>: nop
    0x1044935e4 <+788>: adr    x1, #0xb007               ; ""src/unix/stream.c""
    0x1044935e8 <+792>: nop
Target 0: (node) stopped.
(lldb) bt
* thread #1, name = 'MainThread', queue = 'com.apple.main-thread', stop reason = hit program assert
    frame #0: 0x0000000189c76a60 libsystem_kernel.dylib`__pthread_kill + 8
    frame #1: 0x0000000189caec20 libsystem_pthread.dylib`pthread_kill + 288
    frame #2: 0x0000000189bbba30 libsystem_c.dylib`abort + 180
    frame #3: 0x0000000189bbad20 libsystem_c.dylib`__assert_rtn + 284
  * frame #4: 0x00000001044935dc libuv.1.dylib`uv__write + 780
    frame #5: 0x000000010449319c libuv.1.dylib`uv_write2 + 428
    frame #6: 0x0000000100267e80 node`non-virtual thunk to node::LibuvStreamWrap::DoWrite(node::WriteWrap*, uv_buf_t*, unsigned long, uv_stream_s*) + 68
    frame #7: 0x000000010025f628 node`node::StreamBase::Write(uv_buf_t*, unsigned long, uv_stream_s*, v8::Local<v8::Object>, bool) + 444
    frame #8: 0x00000001002602b0 node`node::StreamBase::WriteBuffer(v8::FunctionCallbackInfo<v8::Value> const&) + 604
    frame #9: 0x0000000100261580 node`void node::StreamBase::JSMethod<&node::StreamBase::WriteBuffer(v8::FunctionCallbackInfo<v8::Value> const&)>(v8::FunctionCallbackInfo<v8::Value> const&) + 188
    frame #10: 0x00000001010a2818 node`Builtins_CallApiCallbackGeneric + 152
    frame #11: 0x000000014813c0cc
    frame #12: 0x0000000148039d38
    frame #13: 0x000000014803a348
    frame #14: 0x00000001485d46d4
    frame #15: 0x000000014850d29c
    frame #16: 0x00000001010df648 node`Builtins_AsyncFunctionAwaitResolveClosure + 72
    frame #17: 0x00000001011b45f8 node`Builtins_PromiseFulfillReactionJob + 56
    frame #18: 0x00000001010cea50 node`Builtins_RunMicrotasks + 560
    frame #19: 0x000000010109e7b0 node`Builtins_JSRunMicrotasksEntry + 176
    frame #20: 0x00000001004e13bc node`v8::internal::(anonymous namespace)::Invoke(v8::internal::Isolate*, v8::internal::(anonymous namespace)::InvokeParams const&) + 1508
    frame #21: 0x00000001004e1dec node`v8::internal::(anonymous namespace)::InvokeWithTryCatch(v8::internal::Isolate*, v8::internal::(anonymous namespace)::InvokeParams const&) + 104
    frame #22: 0x00000001004e1fb0 node`v8::internal::Execution::TryRunMicrotasks(v8::internal::Isolate*, v8::internal::MicrotaskQueue*) + 72
    frame #23: 0x00000001005170c0 node`v8::internal::MicrotaskQueue::RunMicrotasks(v8::internal::Isolate*) + 356
    frame #24: 0x0000000100517b04 node`v8::internal::MicrotaskQueue::PerformCheckpoint(v8::Isolate*) + 128
    frame #25: 0x000000010002923c node`node::InternalCallbackScope::Close() + 332
    frame #26: 0x0000000100028bec node`node::InternalCallbackScope::~InternalCallbackScope() + 20
    frame #27: 0x00000001000ac9b0 node`node::Environment::RunTimers(uv_timer_s*) + 792
    frame #28: 0x00000001044823f0 libuv.1.dylib`uv__run_timers + 132
    frame #29: 0x0000000104486114 libuv.1.dylib`uv_run + 612
    frame #30: 0x0000000100029fcc node`node::SpinEventLoopInternal(node::Environment*) + 272
    frame #31: 0x0000000100178b24 node`node::NodeMainInstance::Run() + 268
    frame #32: 0x00000001000dc960 node`node::Start(int, char**) + 792
    frame #33: 0x00000001899260e0 dyld`start + 2360
(lldb)
```

### Additional information

https://github.com/mtcute/mtcute/blob/73e32b831a678d84640c8b9f9a5fe85f7fd8b30e/packages/core/src/network/session-connection.ts#L1645","['libuv', 'needs more info']",open,2025-06-15T22:07:02Z,,bug,"['libuv', 'needs more info']",True,,
nodejs/node,58695,libuv assertion failed on Windows,"### Version

22.16.0

### Platform

```text
Latest Windows 11 build
```

### Subsystem

libuv

### What steps will reproduce the bug?

Create a .cmd file:

`start """" ""node someScript.js""`

As far as I can tell, the script can have any contents - doesn't even need to try and get `process.title`.

This causes an assertion to fail here: https://github.com/nodejs/node/blob/v22.16.0/deps/uv/src/win/util.c#L412

### How often does it reproduce? Is there a required condition?

Always

### What is the expected behavior? Why is that the expected behavior?

It doesn't throw an error on Node v20.12.2.

### What do you see instead?

```
Assertion failed: process_title, file c:\ws\deps\uv\src\win\util.c, line 412
```

### Additional information

_No response_","['windows', 'libuv']",closed,2025-06-12T15:01:04Z,2025-06-15T11:37:16Z,bug,"['windows', 'libuv']",True,2.0,
nodejs/node,58689,Remove `Symbol.dispose` integration in `setTimeout` and `setInterval`,"As part of the `[Symbol.dispose]` integration, the `Timeout` return type of `setTimeout` and `setInterval` support disposing (https://github.com/nodejs/node/pull/48633). This was stabilized last week (https://github.com/nodejs/node/pull/58467).

I think this integration should be removed, as the web platform `setTimeout` / `setInterval` do not support `Symbol.dispose` and never can, because it returns a `number`.

This means that folks may start writing _new_ code that is incompatible between browser and Node, just because they use the `Symbol.dispose` integration here. That would be unfortunate.

It would also cause one more incompatibility between server side platforms with web `setTimeout`, and Node `setTimeout` (e.g Cloudflare Workers) (cc @jasnell).

@mcollina said in person that this was made stable recently enough to still remove it.",['tsc-agenda'],open,2025-06-12T09:02:24Z,,bug,['tsc-agenda'],True,,
golang/go,74331,nice to have: faster generic instantiation location for serialization support,"In generating serialization code for structs that contain parameterized generic types,
I current utilize ""golang.org/x/tools/go/packages""

and its Load() function. To give specifics, see here for instance:

https://github.com/glycerine/greenpack/blob/master/parse/generics.go#L124

So greenpack serialization, abstractly similar to protocol buffers (which does
not support generics at all), can support some generic type serialization. 

However it is off by default, since scanning for generics instantiation makes
""go:generate greenpack"" very slow.

The Go compiler is fast, and must also do the work of locating and processing
instantiations during compilation. 

It would be nice to be able to leverage this speed in serialization libraries too.

I don't know the most appropriate API, but perhaps awareness of the pain point 
might enable a feature in the future to accomplish the aim described above
if an opportunity presented itself, or it even ""almost feel out for free"" during a refactor.

Generic types could then be truly first class citizens in Go data. 

Again, not really a bug--just a ""this would really be nice to have.""

Thank you.",['FeatureRequest'],closed,2025-06-22T08:33:26Z,2025-06-22T16:09:39Z,performance,['featurerequest'],True,0.0,
golang/go,74330,x/net/idna: punycode labels ending with hyphen (xn--example-) should be rejected per updated UTS-46,"### Go version

go version go1.24.4 linux/amd64

### Output of `go env` in your module/workspace:

```shell
AR='ar'
CC='gcc'
CGO_CFLAGS='-O2 -g'
CGO_CPPFLAGS=''
CGO_CXXFLAGS='-O2 -g'
CGO_ENABLED='1'
CGO_FFLAGS='-O2 -g'
CGO_LDFLAGS='-O2 -g'
CXX='g++'
GCCGO='gccgo'
GO111MODULE=''
GOAMD64='v1'
GOARCH='amd64'
GOAUTH='netrc'
GOBIN='/home/kiso/.local/share/mise/installs/go/1.24.4/bin'
GOCACHE='/home/kiso/.cache/go-build'
GOCACHEPROG=''
GODEBUG=''
GOENV='/home/kiso/.config/go/env'
GOEXE=''
GOEXPERIMENT=''
GOFIPS140='off'
GOFLAGS=''
GOGCCFLAGS='-fPIC -m64 -pthread -Wl,--no-gc-sections -fmessage-length=0 -ffile-prefix-map=/tmp/go-build1616535208=/tmp/go-build -gno-record-gcc-switches'
GOHOSTARCH='amd64'
GOHOSTOS='linux'
GOINSECURE=''
GOMOD='/home/kiso/s/golang/text/go.mod'
GOMODCACHE='/home/kiso/go/pkg/mod'
GONOPROXY=''
GONOSUMDB=''
GOOS='linux'
GOPATH='/home/kiso/go'
GOPRIVATE=''
GOPROXY='https://proxy.golang.org,direct'
GOROOT='/home/kiso/.local/share/mise/installs/go/1.24.4'
GOSUMDB='sum.golang.org'
GOTELEMETRY='local'
GOTELEMETRYDIR='/home/kiso/.config/go/telemetry'
GOTMPDIR=''
GOTOOLCHAIN='auto'
GOTOOLDIR='/home/kiso/.local/share/mise/installs/go/1.24.4/pkg/tool/linux_amd64'
GOVCS=''
GOVERSION='go1.24.4'
GOWORK=''
PKG_CONFIG='pkg-config'
```

### What did you do?

https://go.dev/play/p/Yn4dKzNY2Tr

### What did you see happen?

```
.com <nil>
example.com <nil>
```

### What did you expect to see?

Go's IDNA implementation currently accepts Punycode labels ending with hyphens (e.g., ""xn--example-"") and produces unexpected results.
UTS-46 Revision 33 now specifies these should be treated as errors.
https://www.unicode.org/reports/tr46/tr46-33.html#Modifications

This issue was already partially noted as a TODO in Go's IDNA test files:
https://github.com/golang/text/blob/master/internal/export/idna/idna10.0.0_test.go

I reported a similar issue in rust-url, which led to the specification being updated.
- https://rustsec.org/advisories/RUSTSEC-2024-0421.html
- https://bugzilla.mozilla.org/show_bug.cgi?id=1887898

I have a local fix ready and would like to contribute it. 
Should this be filed against x/text/idna since the relevant code appears to be generated?

Note:
I initially reported this to Google Bug Hunters, but was advised to report it on GitHub since it's not a sensitive security issue.


",['LibraryProposal'],open,2025-06-21T16:41:43Z,,bug,['libraryproposal'],True,,
golang/go,74329,x/tools/gopls: SignatureHelp activeParameter always 0 after v0.18.1,"After commit 2880aae, `SignatureInformation.activeParameter` does not have omitempty tag and always marshal. The problem is that its never assigned to anything and always `0`, which overrides actual value in `SignatureHelp.activeParameter`, as [stated](https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/#signatureInformation) in spec.

Solution is have same value as in `SignatureHelp.activeParameter` in `SignatureInformation.activeParameter`. The fix is minimal—just a one-line change —and I've submitted a PR.","['gopls', 'Tools', 'BugReport']",open,2025-06-21T09:03:17Z,,bug,"['gopls', 'tools', 'bugreport']",True,,
golang/go,74328,go test: go test coverage profile contains packages from GOPATH when GOPATH is set in the same directory,"### Go version

any

### Output of `go env` in your module/workspace:

```shell
GOPATH=$(pwd)/.go
```

### What did you do?

Run
``` go
go test ./... -cover -coverprofile=ut.cov -covermode=set -coverpkg=./...
```

### What did you see happen?

`ut.cov` file is too large and has coverage profile for packages in GOPATH

### What did you expect to see?

`ut.cov` containing coverage profile of all packages except the GOPATH",['BugReport'],closed,2025-06-21T06:16:46Z,2025-06-21T06:27:16Z,bug,['bugreport'],True,0.0,
golang/go,74326,crypto/rsa: TestNPrimeKeyGeneration failures,"```
#!watchflakes
default <- pkg == ""crypto/rsa"" && test == ""TestNPrimeKeyGeneration""
```

Issue created automatically to collect these failures.

Example ([log](https://ci.chromium.org/b/8711525225067255169)):

    === RUN   TestNPrimeKeyGeneration
        rsa_test.go:162: DecryptPKCS1v15: crypto/rsa: decryption error
    --- FAIL: TestNPrimeKeyGeneration (0.01s)


— [watchflakes](https://go.dev/wiki/Watchflakes)
",['NeedsInvestigation'],open,2025-06-20T19:10:54Z,,security,['needsinvestigation'],True,,
golang/go,74325,cmd/go: TestScript/get_insecure failures,"```
#!watchflakes
default <- pkg == ""cmd/go"" && test == ""TestScript/get_insecure""
```

Issue created automatically to collect these failures.

Example ([log](https://ci.chromium.org/b/8711525224055553681)):

    === RUN   TestScript/get_insecure
    === PAUSE TestScript/get_insecure
    === CONT  TestScript/get_insecure
        script_test.go:139: 2025-06-20T17:21:52Z
        script_test.go:141: $WORK=/home/swarming/.swarming/w/ir/x/t/cmd-go-test-1726111965/tmpdir2926691246/get_insecure419322864
    2025/06/20 17:21:52 serving /auth/or404?go-get=1
    2025/06/20 17:21:52 serving /auth?go-get=1
    2025/06/20 17:21:52 open /home/swarming/.swarming/w/ir/x/w/goroot/src/cmd/go/testdata/vcstest/auth.txt: no such file or directory
    2025/06/20 17:21:52 serving /?go-get=1
    2025/06/20 17:21:52 serving /git?go-get=1
    ...
            [exit status 1]
            # Modules: Try again with GOINSECURE (should succeed). (626.761s)
            > env GOINSECURE=insecure.go-get-issue-15410.appspot.com
            > env GONOSUMDB=insecure.go-get-issue-15410.appspot.com
            > go get -d insecure.go-get-issue-15410.appspot.com/pkg/p
            [stderr]
            go: -d flag is deprecated. -d=true is a no-op
            go: unrecognized import path ""insecure.go-get-issue-15410.appspot.com/pkg/p"": reading http://insecure.go-get-issue-15410.appspot.com/pkg/p?go-get=1: 500 Internal Server Error
        script_test.go:163: FAIL: testdata/script/get_insecure.txt:21: go get -d insecure.go-get-issue-15410.appspot.com/pkg/p: exit status 1
    --- FAIL: TestScript/get_insecure (627.71s)


— [watchflakes](https://go.dev/wiki/Watchflakes)
",['NeedsInvestigation'],open,2025-06-20T19:10:52Z,,bug,['needsinvestigation'],True,,
golang/go,74324,proposal: encoding/json/v2: permit SkipFunc for MarshalTo/UnmarshalFrom methods,"### Proposal Details

TL;DR, I propose permitting `SkipFunc` as being allowed for [`MarshalerTo`](https://pkg.go.dev/encoding/json/v2#MarshalerTo) or [`UnmarshalerFrom`](https://pkg.go.dev/encoding/json/v2#UnmarshalerFrom) methods. However, this also means that we will document that code should avoid directly calling `MarshalerTo` and `UnmarshalFrom` methods.

<hr>

Currently, [the `SkipFunc` sentinel error](https://pkg.go.dev/encoding/json/v2#SkipFunc) may only be returned by [`MarshalToFunc`](https://pkg.go.dev/encoding/json/v2#MarshalToFunc) and [`UnmarshalFromFunc`](https://pkg.go.dev/encoding/json/v2#UnmarshalToFunc) caller-specified functions, but may not be returned by a [`MarshalerTo`](https://pkg.go.dev/encoding/json/v2#MarshalerTo) or [`UnmarshalerFrom`](https://pkg.go.dev/encoding/json/v2#UnmarshalerFrom) type-specified method.

The rationale for this restriction is because it is relatively common for users to directly call the legacy `MarshalJSON` method declared on a type (e.g., `v.MarshalJSON()`), rather than indirectly calling `MarshalJSON` by calling `json.Marshal` (e.g., `json.Marshal(v)`) and letting it auto-detect the `MarshalJSON` method.

Based on prior precedence, it is conceivably common that users could also directly call the newer `MarshalJSONTo` or `UnmarshalJSONFrom` methods. We forbade `SkipFunc` from being returned, otherwise it would be a potentially surprising error for a direct caller to receive.

However, I'm looking at existing use cases of the legacy `MarshalJSON` method that I would like to migrate to `MarshalJSONTo`, and I see cases where supporting `SkipFunc` in a method would be beneficial. For example, I see logic like the following:
```go
func (d device) MarshalJSON() ([]byte, error) {
	if condition1 {
		// Declare the deviceCopy type as being memory equivalent to device,
		// but without any of the methods of device to avoid infinite recursion.
		type deviceCopy device
		return json.Marshal(deviceCopy(d))
	}

	... // some other custom marshal logic
}
```

This pattern of declaring a type is a hack and every single use has the same comment about why a type was being declared. It would be more ideal to do:
```go
func (d device) MarshalJSONTo(enc *jsontext.Encoder) error {
	if condition1 {
		return json.SkipFunc
	}

	... // some other custom marshal logic
}
```

If we want to make this change, it needs to be before the final release of ""encoding/json/v2"" (doesn't need to block Go 1.25) since it cannot be changed after the fact as it requires a documented semantic on the `MarshalerTo` and `UnmarshalerFrom` interfaces that such methods should probably never be directly called by users unless want to directly deal with sentinel errors.

\cc @johanbrandhorst @mvdan @neild ","['Proposal', 'LibraryProposal']",open,2025-06-20T18:52:12Z,,performance,"['proposal', 'libraryproposal']",True,,
golang/go,74323,"cmd/go: ""test timed out after ... running tests: ..."" attached to one of many subtests in JSON mode, can be less visible compared to non-JSON output","Consider the output from `go test` without `-json` flag in a situation where a test timeout happens while multiple subtests are still running (as happened in #74279):

```sh
$ go version
go version go1.25rc1 darwin/arm64

# in golang.org/x/tools/gopls/internal/test/marker package
$ go test -count=1 -timeout=20s ./... 
panic: test timed out after 20s
	running tests:
		Test/codeaction/fill_struct_resolve.txt (1s)
		Test/codeaction/issue64558.txt (0s)
		Test/codeaction/issue70268.txt (0s)
		Test/codeaction/moveparam.txt (1s)
		Test/codeaction/moveparam_issue70599.txt (1s)
		Test/codeaction/removeparam_formatting.txt (1s)
		Test/codeaction/removeparam_funcvalue.txt (1s)
		Test/codeaction/removeparam_imports.txt (1s)
		Test/codeaction/removeparam_resolve.txt (1s)
		Test/codeaction/splitlines.txt (2s)

goroutine 273028 [running]:
testing.(*M).startAlarm.func1()
	/usr/local/go/src/testing/testing.go:2679 +0x2b0
created by time.goFunc
	/usr/local/go/src/time/sleep.go:215 +0x38

goroutine 1 [chan receive]:
testing.(*T).Run(0x140003881c0, {0x104c4f030?, 0x14000045af8?}, 0x1052171d0)
	/usr/local/go/src/testing/testing.go:2002 +0x378
testing.runTests.func1(0x140003881c0)
	/usr/local/go/src/testing/testing.go:2474 +0x38
testing.tRunner(0x140003881c0, 0x14000045c28)
	/usr/local/go/src/testing/testing.go:1931 +0xc8
testing.runTests(0x140003c3a70, {0x105a54ec0, 0x1, 0x1}, {0x140004989a8?, 0x140004989d8?, 0x105a95520?})
	/usr/local/go/src/testing/testing.go:2472 +0x3b8
testing.(*M).Run(0x140003961e0)
	/usr/local/go/src/testing/testing.go:2334 +0x530
golang.org/x/tools/gopls/internal/test/marker.TestMain(0x140003961e0)
	/Users/gopher/go/src/golang.org/x/tools/gopls/internal/test/marker/marker_test.go:63 +0x54
main.main()
	_testmain.go:47 +0x88

goroutine 67 [chan receive]:
golang.org/x/tools/gopls/internal/lsprpc.(*streamServer).ServeStream(0x140000be2a0, {0x10522e850, 0x14007384b10}, {0x105233188, 0x1400758c140})
[…]
goroutine 273488 [runnable]:
golang.org/x/tools/gopls/internal/cache.execActions.func1()
	/Users/gopher/go/src/golang.org/x/tools/gopls/internal/cache/analysis.go:894
created by golang.org/x/tools/gopls/internal/cache.execActions in goroutine 273185
	/Users/gopher/go/src/golang.org/x/tools/gopls/internal/cache/analysis.go:894 +0x50
FAIL	golang.org/x/tools/gopls/internal/test/marker	20.916s
FAIL
$ echo $?
1
```

Compare with the output of `go test` in the same situation, with `-json` flag:

```sh
$ go test -json -count=1 -timeout=20s ./...
[…]
{""Time"":""2025-06-20T12:45:40.364095-04:00"",""Action"":""run"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt""}
[…]
{""Time"":""2025-06-20T12:45:40.364106-04:00"",""Action"":""pause"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt""}
[…]
{""Time"":""2025-06-20T12:46:00.037725-04:00"",""Action"":""cont"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt""}
{""Time"":""2025-06-20T12:46:00.037727-04:00"",""Action"":""output"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt"",""Output"":""=== CONT  Test/codeaction/removeparam_resolve.txt\n""}
{""Time"":""2025-06-20T12:46:00.168447-04:00"",""Action"":""output"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt"",""Output"":""panic: test timed out after 20s\n""}
{""Time"":""2025-06-20T12:46:00.168471-04:00"",""Action"":""output"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt"",""Output"":""\trunning tests:\n""}
{""Time"":""2025-06-20T12:46:00.168473-04:00"",""Action"":""output"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Test"":""Test/codeaction/removeparam_resolve.txt"",""Output"":""\t\tTest/codeaction/removeparam_resolve.txt (0s)\n""}
[…]
{""Time"":""2025-06-20T12:46:00.248881-04:00"",""Action"":""output"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Output"":""FAIL\tgolang.org/x/tools/gopls/internal/test/marker\t20.629s\n""}
{""Time"":""2025-06-20T12:46:00.248887-04:00"",""Action"":""fail"",""Package"":""golang.org/x/tools/gopls/internal/test/marker"",""Elapsed"":20.629}
$ echo $?                                  
1
```

Notably, the ""test timed out after ... running tests: ..."" message was attached to the output of a single subtest that was in the process of running, ""Test/codeaction/removeparam_resolve.txt"", and not anywhere else. In this particular instance, that test hadn't finished running and has no corresponding ""fail"" event. As things stand, when looking at a visualization of structured test output, it can be easy to miss this information, which seems to be a regression compared to the normal non-structured test output where it's quite prominent.

Perhaps there's room for improvement here. Maybe the output would be better to attach at the package-level instead of the test-level, since it refers to multiple package tests that were running, if that's viable? Maybe something else can be done?

CC @golang/command-line, @adonovan, @cherrymui.","['NeedsInvestigation', 'GoCommand']",open,2025-06-20T17:07:45Z,,performance,"['needsinvestigation', 'gocommand']",True,,
golang/go,74322,proposal: encoding/json/v2: MarshallJSONTo: Skip fields when marshalling to json,"### Proposal Details

One issue that we faced in the old Go JSON implementation is the inability to remove a field entirely when marshalling to JSON (when implementing the MarshalJSON func).

This feature is still not possible in the json/v2 implementation. While it is possible to set the exported field value to JSON null, removing the field completely does not seem possible.

Is there anything I am missing or there is currently no way to achieve this?

Previously, there was a proposal to return a SkipFieldErr error from the MarshalJSON which the encoder would interpret as to remove the field from the generated json.",['Proposal'],open,2025-06-20T16:39:32Z,,bug,['proposal'],True,,
golang/go,74314,cmd/link: duplicated definition of symbol github.com/ebitengine/purego.syscall15XABI0 when running with ASAN,"### Go version

go1.24.4 

### Output of `go env` in your module/workspace:

```shell
AR='ar'
CC='gcc'
CGO_CFLAGS='-O2 -g'
CGO_CPPFLAGS=''
CGO_CXXFLAGS='-O2 -g'
CGO_ENABLED='1'
CGO_FFLAGS='-O2 -g'
CGO_LDFLAGS='-O2 -g'
CXX='g++'
GCCGO='gccgo'
GO111MODULE=''
GOAMD64='v1'
GOARCH='amd64'
GOAUTH='netrc'
GOBIN=''
GOCACHE='/root/.cache/go-build'
GOCACHEPROG=''
GODEBUG=''
GOENV='/root/.config/go/env'
GOEXE=''
GOEXPERIMENT=''
GOFIPS140='off'
GOFLAGS=''
GOGCCFLAGS='-fPIC -m64 -pthread -Wl,--no-gc-sections -fmessage-length=0 -ffile-prefix-map=/tmp/go-build2314400207=/tmp/go-build -gno-record-gcc-switches'
GOHOSTARCH='amd64'
GOHOSTOS='linux'
GOINSECURE=''
GOMOD='/go/keeda/go.mod'
GOMODCACHE='/go/pkg/mod'
GONOPROXY=''
GONOSUMDB=''
GOOS='linux'
GOPATH='/go'
GOPRIVATE=''
GOPROXY='https://proxy.golang.org,direct'
GOROOT='/usr/local/go'
GOSUMDB='sum.golang.org'
GOTELEMETRY='local'
GOTELEMETRYDIR='/root/.config/go/telemetry'
GOTMPDIR=''
GOTOOLCHAIN='local'
GOTOOLDIR='/usr/local/go/pkg/tool/linux_amd64'
GOVCS=''
GOVERSION='go1.24.4'
GOWORK=''
PKG_CONFIG='pkg-config'
```

### What did you do?

I have been trying to update our project which uses Go 1.24.1 to 1.24.4 but I see the same [issue which I noticed](https://github.com/golang/go/issues/73617) when updating to 1.24.3. The code sample to reproduce the issue was run on the image `golang:1.24.4-bookworm`.

```sh
mkdir keeda && cd keeda
go mod init sanjayts.net/keeda
```

```
cat > keeda.go << EOF
package main

/*
#cgo LDFLAGS: -L${SRCDIR} -lkeeda
#include <stdio.h>

int do_it() {
        printf(""%s\n"", ""keeda report"");
        return 0;
}
*/
import ""C""

import _ ""github.com/ebitengine/purego""
import ""fmt""

func main() {
        fmt.Printf(""%s\n"", InvokeCGO())
}

func InvokeCGO() string {
        return fmt.Sprintf(""answer_from_cgo: %d"", C.do_it())
}
EOF
```

```
go mod tidy
ASAN_OPTIONS=report_globals=0 go run -asan keeda.go
```







### What did you see happen?

The error message is
```
link: duplicated definition of symbol github.com/ebitengine/purego.syscall15XABI0, from github.com/ebitengine/purego (type SRODATA size 8) and github.com/ebitengine/purego (type SNOPTRBSS size 64)
```

### What did you expect to see?

I would have expected the code to work as expected and simply output the CGO return value. The output when using 1.24.1 is
```
keeda report
answer_from_cgo: 0
```","['NeedsInvestigation', 'compiler/runtime']",open,2025-06-20T15:02:37Z,,performance,"['needsinvestigation', 'compiler/runtime']",True,,
golang/go,74313,net: udp server error,"### Go version

go version go1.24.4 linux/amd64

### Output of `go env` in your module/workspace:

```shell
AR='ar'
CC='gcc'
CGO_CFLAGS='-O2 -g'
CGO_CPPFLAGS=''
CGO_CXXFLAGS='-O2 -g'
CGO_ENABLED='1'
CGO_FFLAGS='-O2 -g'
CGO_LDFLAGS='-O2 -g'
CXX='g++'
GCCGO='gccgo'
GO111MODULE=''
GOAMD64='v1'
GOARCH='amd64'
GOAUTH='netrc'
GOBIN=''
GOCACHE='/home/fuhz/.cache/go-build'
GOCACHEPROG=''
GODEBUG=''
GOENV='/home/fuhz/.config/go/env'
GOEXE=''
GOEXPERIMENT=''
GOFIPS140='off'
GOFLAGS=''
GOGCCFLAGS='-fPIC -m64 -pthread -Wl,--no-gc-sections -fmessage-length=0 -ffile-prefix-map=/tmp/go-build1848721630=/tmp/go-build -gno-record-gcc-switches'
GOHOSTARCH='amd64'
GOHOSTOS='linux'
GOINSECURE=''
GOMOD='/home/fuhz/src/udpserver/go.mod'
GOMODCACHE='/home/fuhz/go/pkg/mod'
GONOPROXY=''
GONOSUMDB=''
GOOS='linux'
GOPATH='/home/fuhz/go'
GOPRIVATE=''
GOPROXY='https://goproxy.cn,direct'
GOROOT='/opt/go'
GOSUMDB='sum.golang.org'
GOTELEMETRY='local'
GOTELEMETRYDIR='/home/fuhz/.config/go/telemetry'
GOTMPDIR=''
GOTOOLCHAIN='auto'
GOTOOLDIR='/opt/go/pkg/tool/linux_amd64'
GOVCS=''
GOVERSION='go1.24.4'
GOWORK=''
PKG_CONFIG='pkg-config'
```

### What did you do?

I write a udp server to register clients incoming, and send list of clients.

my server main code:
```
addr, err := net.ResolveUDPAddr(""udp4"", fmt.Sprintf("":%v"", flag.Arg(0)))
	if err != nil {
		panic(err)
	}
	var buffer [1024]byte
	var store = list.New()
	store.Init()
	c, err := net.ListenUDP(""udp4"", addr)
	if err != nil {
		panic(err)
	}
	defer c.Close()

	for {
		log.Println(""listen udp:"", c.LocalAddr().String())
		c.SetDeadline(time.Now().Add(time.Second * 30))
		n, raddr, err := c.ReadFrom(buffer[:])
		if n == 0 || err != nil {
			break
		}

		if !contains(store, raddr.String()) {
			store.PushBack(raddr.String())
		}

		log.Println(string(buffer[:n]), raddr.String())
		c.WriteTo([]byte(""from=""+c.LocalAddr().String()), raddr)
		if string(buffer[:n]) == ""list"" {
			res := []string{}
			p := store.Front()
			for {
				if p == nil {
					break
				}
				res = append(res, p.Value.(string))
				p = p.Next()
			}
			data := strings.Join(res, "";"")
			c.WriteTo([]byte(""list=""+data), raddr)
			log.Println(""list"")
		}

	}
```

my client main code:
```
	conn, err := net.DialUDP(""udp"", nil, uaddr)
	if err != nil {
		return err
	}
	once.Do(func() {
		go udpLoop(c)
	})

	n, err := conn.Write([]byte(msg))
	if err != nil {
		return err
	}
	if n == 0 {
		return errors.New(""send null"")
	}
	return nil
}

func udpLoop(c *net.UDPConn) {

	var buffer [1024]byte
	for {
		n, raddr, err := c.ReadFromUDP(buffer[:])
		if n == 0 || err != nil {
			break
		}
		fmt.Printf(""%v:%v"", string(buffer[:n]), raddr.String())
	}
}

```

### What did you see happen?

The server only reply the first client. 
The message from second client can not be received. 

Seriously, after the second client send the message, the server seems to work full speed and blocked, the cpu work 100%, and the deadline time is not work.

### What did you expect to see?

The server should reply every client incoming. The CPU load should be very low. ",['BugReport'],closed,2025-06-20T14:16:19Z,2025-06-20T14:55:41Z,security,['bugreport'],True,0.0,
golang/go,74312,x/pkgsite: variable DiscardHandler not listed under Variables in log/slog,"### What is the URL of the page with the issue?

https://pkg.go.dev/log/slog#pkg-variables

### What is your user agent?

Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/137.0.0.0 Safari/537.36

### Screenshot

![Image](https://github.com/user-attachments/assets/38b71139-8545-44e4-ab80-799b20b7454c)

### What did you do?

During code review, I wanted to share a colleague a link to the newly added DiscardHandler. While searching in my browser for it, I quickly learned that it was a variable and I wanted to send him a link to the variable so I went to the variable section but that was empty.


### What did you see happen?

I was expecting to see DiscardHandler in the list of variables.
Also i could not find it in the object tree.

### What did you expect to see?

I expected to see the variable mentioned under the Variables section or somewhere else in the object tree.

Now that I had a closer look also variables in other packages are not consistently added to the variables section (e.g net/http/DefaultTransport) . Maybe the policy is to only list variables that 'deserve' to be mentioned in the variables list but sometimes (like now) I found this confusing.

As a suggestion variables could also be added under the types header so In this case it would go under Handler (https://pkg.go.dev/log/slog#Handler) like also is done for constructors.","['Documentation', 'pkgsite']",closed,2025-06-20T10:57:13Z,2025-06-20T11:01:17Z,bug,"['documentation', 'pkgsite']",True,0.0,
golang/go,74309,crypto/cipher: docs links for aes.NewCipher link to internal package,"### Go version

go version go1.24.4

### Output of `go env` in your module/workspace:

```shell
(omitted: the issue is misleading content of the public document)
```

### What did you do?

- Read the public documentation for crypto/cipher.NewGCMWithRandomNonce
- Observed that the documentation for the cipher.Block parameter links to an internal package
- Investigated the standard library source code at https://github.com/golang/go/blob/master/src/crypto/cipher/gcm.go to understand why
- Confirmed that the source code itself imports and uses an internal aes package, not the public crypto/aes

### What did you see happen?

The doc engine possibly pointed to the correct link (the function of the internal package) but the function of the internal package cannot be used by developers(the users of standard go package).

The documentation is misleading, as it doesn't guide the user on how to correctly use the public API.

### What did you expect to see?

For public APIs, I expect the documentation to link to the corresponding public types and functions that a developer should use.

In this case, the link should direct to crypto/aes.NewCipher(e.g., by explicitly writing the url to the correct function, not relying on the doc engine to generate the link which may point to the wrong one), as that is the function a user must call to satisfy the cipher.Block requirement. The internal implementation details of the crypto/cipher package should not be exposed in the user-facing documentation for that package.","['Documentation', 'FixPending']",closed,2025-06-20T00:14:06Z,2025-06-20T18:09:59Z,bug,"['documentation', 'fixpending']",True,0.0,
golang/go,74308,proposal: net/http: Add support for custom Pooler dynamic dispatching to http1 and http2 client processes,"### Proposal Details

Problem Statement:

The standard http.Client / http.Transport in Go does not expose all the control points you would need to fully manage these required aspects to supply a form of user specified client-side connection balancing / connection-pooling strategies:

- ✅ DNS resolution (partial support)
- ✅ Dialing (full support)

- ❌ Connection pooling policy (no support)
- ❌ Connection selection / retrieval policy (no support)
- ❌ External or shared pools specified by the code author (no support)

---

Givens:

1. we can tell the client not to cache connections by setting the transport level DisableKeepAlives to true (note that this is different from the TCP level KeepAlives)
2. When a connection is closed under these circumstances it's not clear if the close is being requested because the default pooling is disabled at the transport level vs some other protocol level issue, connection flaw has been detected, transaction has an unknown completion state, or transaction has been partially completed.
3. Implementing a full transport and RoundTripper to fully implement a custom resolver strategy and round-robin pooling capability is non-trivial and likely to lead to significant security issues and bugs.
4. Significant complexity and overhead in deployment architecture is utilized to resolve these issues out of the program (using mesh frameworks, moving to gRPC, forcing the use of http2 by all clients, integrating provider-bespoke service-discovery libs managed by cloud providers)

---

Proposal:

Before a client would re-pool a connection internally or close it because the transport level DisableKeepAlives is true, check if the connection has implemented a `Pooler` interface with one function `PutToPool() bool` which when called if it exists circumvents the default pooling practice regardless of result and removes the need to call Close() on the connection when the result of the call is true.

This allows for the dialer to consistently act as the pool fetcher or connection instance creator and opens up the world of possibilities to authors to control both the LIFO vs FIFO behavior of the queue, testing connection state, and setting tcp level timeouts on releasing to the pool vs acquiring from the pool. Connection max-lifetimes can be easily implemented should people prefer it.

The usage possibilities unlocked is high, the complexity added is low, the reuse of trust/proven protocol practices established in the SDK is high.

It is an all around win-win-win.","['Proposal', 'LibraryProposal']",closed,2025-06-19T22:19:15Z,2025-06-19T22:30:08Z,security,"['proposal', 'libraryproposal']",True,0.0,
golang/go,73842,cmd/go: -test.gocoverdir cannot be used for non-curdir packages,"### Go version

go version go1.24.3 linux/amd64

### Output of `go env` in your module/workspace:

```shell
AR='ar'
CC='gcc'
CGO_CFLAGS='-O2 -g'
CGO_CPPFLAGS=''
CGO_CXXFLAGS='-O2 -g'
CGO_ENABLED='1'
CGO_FFLAGS='-O2 -g'
CGO_LDFLAGS='-O2 -g'
CXX='g++'
GCCGO='gccgo'
GO111MODULE=''
GOAMD64='v1'
GOARCH='amd64'
GOAUTH='netrc'
GOBIN=''
GOCACHE='/home/cyphar/.cache/go-build'
GOCACHEPROG=''
GODEBUG=''
GOENV='/home/cyphar/.config/go/env'
GOEXE=''
GOEXPERIMENT=''
GOFIPS140='off'
GOFLAGS=''
GOGCCFLAGS='-fPIC -m64 -pthread -Wl,--no-gc-sections -fmessage-length=0 -ffile-prefix-map=/tmp/go-build213853727=/tmp/go-build -gno-record-gcc-switches'
GOHOSTARCH='amd64'
GOHOSTOS='linux'
GOINSECURE=''
GOMOD='/home/cyphar/.local/src/github.com/opencontainers/umoci/go.mod'
GOMODCACHE='/home/cyphar/.local/pkg/mod'
GONOPROXY=''
GONOSUMDB=''
GOOS='linux'
GOPATH='/home/cyphar/.local'
GOPRIVATE=''
GOPROXY='https://proxy.golang.org,direct'
GOROOT='/usr/lib64/go/1.24'
GOSUMDB='sum.golang.org'
GOTELEMETRY='local'
GOTELEMETRYDIR='/home/cyphar/.config/go/telemetry'
GOTMPDIR=''
GOTOOLCHAIN='local'
GOTOOLDIR='/usr/lib64/go/1.24/pkg/tool/linux_amd64'
GOVCS=''
GOVERSION='go1.24.3'
GOWORK=''
PKG_CONFIG='pkg-config'
```

### What did you do?

I'm trying to migrate an existing project that uses a bunch of hacks to get coverage from integration and unit tests to using `go build -cover`/`GOCOVERDIR=foo` and `go test -cover -test.gocoverdir=foo` instead. However, it turns out that `go test ./...` behaviour changes with `-test.gocoverdir=foo`.

You can verify this in any project by just observing the output difference between `go test -cover ./...` and `go test -cover -test.gocoverdir=foo ./...`, but here's an example:

```bash
% mkdir -p gotest/{a,b,c,d,e,f,g}
% cd gotest
% go mod init gotest
go: creating new go.mod: module gotest
go: to add module requirements and sums:
        go mod tidy
% for dir in */; do echo ""package ${dir%/}"" >""$dir/doc.go""; done
% echo ""package main"" > main.go
% go test -cover ./...
?       gotest  [no test files]
?       gotest/a        [no test files]
?       gotest/b        [no test files]
?       gotest/c        [no test files]
?       gotest/d        [no test files]
?       gotest/e        [no test files]
?       gotest/f        [no test files]
?       gotest/g        [no test files]
% go test -cover -test.gocoverdir=foo ./...
?       gotest  [no test files]
```

As far as I can tell, `-test.gocoverdir` has had this behaviour since at least Go 1.14 (though I believe `-test.gocoverdir` was an implementation detail that wasn't widely used until `GOCOVERDIR` and `go build -cover` support were added in Go 1.20).

EDIT: Upon some further testing, it turns out that even naming subpackages doesn't work:

```
% go test -cover ./a ./b ./c ./d ./e ./f ./g
?       gotest/a        [no test files]
?       gotest/b        [no test files]
?       gotest/c        [no test files]
?       gotest/d        [no test files]
?       gotest/e        [no test files]
?       gotest/f        [no test files]
?       gotest/g        [no test files]
% go test -cover -test.gocoverdir=foo ./a ./b ./c ./d ./e ./f ./g
?       gotest  [no test files]
```

Even if you are only running a single test package:

```
% go test -cover ./a
?       gotest/a        [no test files]
% go test -cover -test.gocoverdir=foo ./a
?       gotest  [no test files]
```

### What did you see happen?

Only the current directory had its tests run:

```
% go test -cover -test.gocoverdir=foo ./...
?       gotest  [no test files]
```

`-coverpkg=./...` doesn't affect the output.

### What did you expect to see?

You would expect `./...` to recursively run the tests like regular `go test` does:

```
% go test -cover -test.gocoverdir=foo ./...
?       gotest  [no test files]
?       gotest/a        [no test files]
?       gotest/b        [no test files]
?       gotest/c        [no test files]
?       gotest/d        [no test files]
?       gotest/e        [no test files]
?       gotest/f        [no test files]
?       gotest/g        [no test files]
```

... or at least return an error if the behaviour is intentional. And named test packages should absolutely have their tests run.

Silently not running tests is quite concerning behaviour, and I only noticed this because I have a minimum coverage percentage for my project that was broken by switching to `-test.gocoverdir=...`. I wouldn't have noticed otherwise that my unit tests weren't running. I wonder how many people have switched and haven't noticed that they are running fewer tests than they did before.

~~The obvious workaround is to manually list the package names with `go list ./...`.~~

EDIT: `go test -cover -test.gocoverdir=foo $(go list ./...)` doesn't work. You need to run the test for each subpackage in a subshell in that directory.",['BugReport'],closed,2025-05-23T09:08:00Z,2025-05-23T12:23:31Z,bug,['bugreport'],True,0.0,
rust-lang/rust,142880,rustc 1.89.0-nightly: `rustc interrupted by SIGILL`,"<!--
Thank you for finding an Internal Compiler Error! 🧊  If possible, try to provide
a minimal verifiable example. You can read ""Rust Bug Minimization Patterns"" for
how to create smaller examples.
http://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/
-->

### Code

GitHub Actions Output showing the full error and backtrace: <https://github.com/polyphony-chat/chorus/actions/runs/15807792411/job/44555097989>

Commit Hash `5c7d20b2d1bb1dcf37f304bcba80f354e95b28d2` on git repository https://github.com/polyphony-chat/chorus

### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.89.0-nightly (d4e1159b8 2025-06-21)
binary: rustc
commit-hash: d4e1159b8c97478778b09a4cc1c7adce5653b8bf
commit-date: 2025-06-21
host: x86_64-unknown-linux-gnu
release: 1.89.0-nightly
LLVM version: 20.1.7
```

### Error output

```
error: could not compile `chorus` (test ""auth""); 1 warning emitted
Caused by:
  process didn't exit successfully: `/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/bin/rustc --crate-name auth --edition=2021 tests/auth.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --emit=dep-info,link -C embed-bitcode=no -C debuginfo=2 --allow=unexpected_cfgs --check-cfg 'cfg(tarpaulin_include)' --test --cfg 'feature=""backend""' --cfg 'feature=""client""' --cfg 'feature=""default""' --cfg 'feature=""flate2""' --cfg 'feature=""poem""' --cfg 'feature=""rt""' --cfg 'feature=""rt-multi-thread""' --cfg 'feature=""sqlx""' --cfg 'feature=""sqlx-pg-uint""' --cfg 'feature=""voice""' --cfg 'feature=""voice_gateway""' --cfg 'feature=""voice_udp""' --check-cfg 'cfg(docsrs,test)' --check-cfg 'cfg(feature, values(""backend"", ""client"", ""default"", ""flate2"", ""poem"", ""rt"", ""rt-multi-thread"", ""sqlx"", ""sqlx-pg-uint"", ""voice"", ""voice_gateway"", ""voice_udp""))' -C metadata=bfdb65a70906b62c -C extra-filename=-9e5caad9bf6e38e1 --out-dir /home/runner/work/chorus/chorus/target/llvm-cov-target/debug/deps 
warning: build failed, waiting for other jobs to finish...
warning: `chorus` (test ""user"") generated 1 warning (run `cargo fix --test ""user""` to apply 1 suggestion)
error: command `/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/bin/cargo test --no-run --message-format json-render-diagnostics --workspace --all-targets --all-features --target-dir /home/runner/work/chorus/chorus/target/llvm-cov-target` exited with code 101
error: process didn't exit successfully: `/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/bin/cargo nextest run --manifest-path /home/runner/work/chorus/chorus/Cargo.toml --target-dir /home/runner/work/chorus/chorus/target/llvm-cov-target --all-targets --all-features --workspace` (exit status: 101)
Error: Process completed with exit code 1.
```

<!--
Include a backtrace in the code block by setting `RUST_BACKTRACE=1` in your
environment. E.g. `RUST_BACKTRACE=1 cargo build`.
-->
<details><summary><strong>Backtrace</strong></summary>
<p>

```
 error: rustc interrupted by SIGILL, printing backtrace
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x3bd930f)[0x7fbcbd5d930f]
/lib/x86_64-linux-gnu/libc.so.6(+0x45330)[0x7fbcb9645330]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(+0x90bd34a)[0x7fbcb8abd34a]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm19SelectionDAGBuilder5visitERKNS_11InstructionE+0x1e8)[0x7fbcb7984ae8]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm16SelectionDAGISel20SelectAllBasicBlocksERKNS_8FunctionE+0x1537)[0x7fbcb79867f9]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm16SelectionDAGISel20runOnMachineFunctionERNS_15MachineFunctionE+0x197)[0x7fbcb79723f3]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm22SelectionDAGISelLegacy20runOnMachineFunctionERNS_15MachineFunctionE+0x355)[0x7fbcb7a50455]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm13FPPassManager13runOnFunctionERNS_8FunctionE+0x918)[0x7fbcb78b8318]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm13FPPassManager11runOnModuleERNS_6ModuleE+0x2f)[0x7fbcb78b7945]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/libLLVM.so.20.1-rust-1.89.0-nightly(_ZN4llvm6legacy15PassManagerImpl3runERNS_6ModuleE+0x2c9)[0x7fbcb7d9641d]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x6336182)[0x7fbcbfd36182]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x6335ca5)[0x7fbcbfd35ca5]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x63332d7)[0x7fbcbfd332d7]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x6332fb4)[0x7fbcbfd32fb4]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(_RINvNtNtCs69ZsSultW86_3std3sys9backtrace28___rust_begin_short_backtraceNCINvXs0_CscfSxlorf8Tz_18rustc_codegen_llvmNtB1g_18LlvmCodegenBackendNtNtNtCs2qCHdRY94cF_17rustc_codegen_ssa6traits7backend19ExtraBackendMethods18spawn_named_threadNCINvNtNtB2k_4back5write10spawn_workB1O_E0uE0uEB1g_+0x21e)[0x7fbcbfd319de]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x6441187)[0x7fbcbfe41187]
/home/runner/.rustup/toolchains/nightly-x86_64-unknown-linux-gnu/lib/librustc_driver-e4d0d5450005c30a.so(+0x644283d)[0x7fbcbfe4283d]
/lib/x86_64-linux-gnu/libc.so.6(+0x9caa4)[0x7fbcb969caa4]
/lib/x86_64-linux-gnu/libc.so.6(+0x129c3c)[0x7fbcb9729c3c]
note: we would appreciate a report at https://github.com/rust-lang/rust
```

</p>
</details>
","['I-ICE', 'T-compiler', 'C-bug', 'needs-triage']",open,2025-06-22T15:55:19Z,,security,"['i-ice', 't-compiler', 'c-bug', 'needs-triage']",True,,
rust-lang/rust,142866,ICE with `-Znext-solver=globally`: `index out of bounds`,"### Code

This is derived from #142863 and ICEs only with `-Znext-solver=globally`.

```Rust
trait Trait<T> {}
struct A<T>(T);
struct B<T>(T);

trait IncompleteGuidance {}

impl<T> Trait<()> for A<T>
where
    T: IncompleteGuidance,
{
}

impl<T, U> Trait<()> for B<T>
where
    A<T>: Trait<U>,
{
}

fn impls_trait<T: Trait<()>>() {}

fn main() {
    impls_trait::<B<()>>();
}
```


### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.89.0-nightly (d4e1159b8 2025-06-21)
binary: rustc
commit-hash: d4e1159b8c97478778b09a4cc1c7adce5653b8bf
commit-date: 2025-06-21
host: x86_64-unknown-linux-gnu
release: 1.89.0-nightly
LLVM version: 20.1.7
```

### Error output

```
<output>
```

<!--
Include a backtrace in the code block by setting `RUST_BACKTRACE=1` in your
environment. E.g. `RUST_BACKTRACE=1 cargo build`.
-->
<details><summary><strong>Backtrace</strong></summary>
<p>

```
error[E0207]: the type parameter `U` is not constrained by the impl trait, self type, or predicates
  --> src/main.rs:13:9
   |
13 | impl<T, U> Trait<()> for B<T>
   |         ^ unconstrained type parameter

thread 'rustc' panicked at /rust/deps/ena-0.14.3/src/snapshot_vec.rs:199:10:
index out of bounds: the len is 1 but the index is 1
stack backtrace:
   0: __rustc::rust_begin_unwind
   1: core::panicking::panic_fmt
   2: core::panicking::panic_bounds_check
   3: <rustc_infer::infer::InferCtxt>::shallow_resolve
   4: <rustc_infer::infer::InferCtxt>::resolve_vars_if_possible::<rustc_type_ir::binder::Binder<rustc_middle::ty::context::TyCtxt, rustc_type_ir::predicate::TraitPredicate<rustc_middle::ty::context::TyCtxt>>>
   5: <rustc_trait_selection::error_reporting::TypeErrCtxt>::note_obligation_cause_code::<rustc_span::ErrorGuaranteed, rustc_middle::ty::predicate::Predicate>
   6: <rustc_trait_selection::error_reporting::TypeErrCtxt>::note_obligation_cause
   7: <rustc_trait_selection::error_reporting::TypeErrCtxt>::report_selection_error
   8: <rustc_trait_selection::error_reporting::TypeErrCtxt>::report_fulfillment_errors
   9: <rustc_hir_typeck::fn_ctxt::FnCtxt>::check_expr_call
  10: <rustc_hir_typeck::fn_ctxt::FnCtxt>::check_expr_with_expectation_and_args
  11: <rustc_hir_typeck::fn_ctxt::FnCtxt>::check_expr_block
  12: <rustc_hir_typeck::fn_ctxt::FnCtxt>::check_expr_with_expectation_and_args
  13: rustc_hir_typeck::check::check_fn
  14: rustc_hir_typeck::typeck_with_inspect::{closure#0}
      [... omitted 1 frame ...]
  15: rustc_hir_analysis::check_crate
  16: rustc_interface::passes::analysis
      [... omitted 1 frame ...]
  17: rustc_interface::passes::create_and_enter_global_ctxt::<core::option::Option<rustc_interface::queries::Linker>, rustc_driver_impl::run_compiler::{closure#0}::{closure#2}>::{closure#2}::{closure#0}
  18: rustc_interface::interface::run_compiler::<(), rustc_driver_impl::run_compiler::{closure#0}>::{closure#1}
note: Some details are omitted, run with `RUST_BACKTRACE=full` for a verbose backtrace.

error: the compiler unexpectedly panicked. this is a bug.

note: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md

note: please make sure that you have updated to the latest nightly

note: please attach the file at `/home/ansgar/code/tmp/ffff/rustc-ice-2025-06-22T08_22_47-15436.txt` to your bug report

note: compiler flags: --crate-type bin -C embed-bitcode=no -C debuginfo=2 -C incremental=[REDACTED] -Z next-solver=globally

note: some of the compiler flags provided by cargo are hidden

query stack during panic:
#0 [typeck] type-checking `main`
#1 [analysis] running analysis passes on this crate
end of query stack
```

</p>
</details>


<!-- TRIAGEBOT_START -->

<!-- TRIAGEBOT_ASSIGN_START -->

<!-- TRIAGEBOT_ASSIGN_END -->
<!-- TRIAGEBOT_END -->","['I-ICE', 'T-compiler', 'C-bug', 'requires-nightly', 'WG-trait-system-refactor']",open,2025-06-22T08:25:04Z,,bug,"['i-ice', 't-compiler', 'c-bug', 'requires-nightly', 'wg-trait-system-refactor']",True,,
rust-lang/rust,142865,rustc on NixOS produces SIGBUS: access to undefined memory,"I published a reproducible example at https://github.com/Noah765/rust-bug. Adding the dependency `tokio` with the macros feature enabled results in the error. Interestingly, although the output states that the compilation of `quote` failed, compilation succeeds when `tokio` is replaced with `quote`.

### Meta
I am using NixOS and installed Rust using `rustup`. I added a flake to the example repository that provides a devshell with the `rustup` version I used. The issue persists when using nightly, as well as when installing `cargo` from nixpkgs instead of using `rustup`.

`rustc --version --verbose`:
```
rustc 1.87.0 (17067e9ac 2025-05-09)
binary: rustc
commit-hash: 17067e9ac6d7ecb70e50f92c1944e545188d2359
commit-date: 2025-05-09
host: x86_64-unknown-linux-gnu
release: 1.87.0
LLVM version: 20.1.1
```

<details><summary>Backtrace</summary>
<p>

```
   Compiling proc-macro2 v1.0.95
   Compiling unicode-ident v1.0.18
   Compiling pin-project-lite v0.2.16
   Compiling quote v1.0.40
   Compiling syn v2.0.104
error: rustc interrupted by SIGBUS, printing backtrace

/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x39177df) [0x7ffff3f177df]
/nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66/lib/libc.so.6(+0x419c0) [0x7ffff02419c0]
/nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66/lib/libc.so.6(+0x17f081) [0x7ffff037f081]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(_RNvMs2_NtCs2kjfqayDDYo_6object5writeNtB5_7Section11append_data+0x108) [0x7ffff6750d5e]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x6150ea4) [0x7ffff6750ea4]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x5fcbe3f) [0x7ffff65cbe3f]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(_RNvNtNtCs2ZezlIswSFH_17rustc_codegen_ssa4back4link11link_binary+0x586) [0x7ffff62e2da2]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(_RNvMNtCs6PtJWl2j4pF_15rustc_interface7queriesNtB2_6Linker4link+0x455) [0x7ffff672dc31]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x6124039) [0x7ffff6724039]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(_RINvNtNtCseJswNlh1fGO_3std3sys9backtrace28___rust_begin_short_backtraceNCNCINvNtCs6PtJWl2j4pF_15rustc_interface4util26run_in_thread_with_globalsNCINvB1e_31run_in_thread_pool_with_globalsNCINvNtB1g_9interface12run_compileruNCNvCsj20AIVrSq7d_17rustc_driver_impl12run_compiler0Es_0uE0uE00uEB3C_+0x148) [0x7ffff6564f08]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x5f657f4) [0x7ffff65657f4]
/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/lib/librustc_driver-9c23edfdcf82221e.so(+0x5f66bf7) [0x7ffff6566bf7]
/nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66/lib/libc.so.6(+0x9af08) [0x7ffff029af08]
/nix/store/q4wq65gl3r8fy746v9bbwgx4gzn0r2kl-glibc-2.40-66/lib/libc.so.6(+0x1230ac) [0x7ffff03230ac]

note: we would appreciate a report at https://github.com/rust-lang/rust
error: could not compile `quote` (lib)

Caused by:
  process didn't exit successfully: `/home/noah/.rustup/toolchains/stable-x86_64-unknown-linux-gnu/bin/rustc --crate-name quote --edition=2018 /home/noah/.cargo/registry/src/index.crates.io-1949cf8c6b5b557f/quote-1.0.40/src/lib.rs --error-format=json --json=diagnostic-rendered-ansi,artifacts,future-incompat --diagnostic-width=238 --crate-type lib --emit=dep-info,metadata,link -C embed-bitcode=no --cfg 'feature=""default""' --cfg 'feature=""proc-macro""' --check-cfg 'cfg(docsrs,test)' --check-cfg 'cfg(feature, values(""default"", ""proc-macro""))' -C metadata=f3ea2777483e0cff -C extra-filename=-633ca24bad203381 --out-dir /home/noah/projects/rust-bug/target/debug/deps -L dependency=/home/noah/projects/rust-bug/target/debug/deps --extern proc_macro2=/home/noah/projects/rust-bug/target/debug/deps/libproc_macro2-7d83e77cb55998ce.rmeta --cap-lints allow` (signal: 7, SIGBUS: access to undefined memory)
warning: build failed, waiting for other jobs to finish...
```

</p>
</details>
","['I-crash', 'T-compiler', 'C-bug', 'O-NixOS']",open,2025-06-22T06:55:32Z,,security,"['i-crash', 't-compiler', 'c-bug', 'o-nixos']",True,,
rust-lang/rust,142863,rustc hangs when resolving trait impl with invalid type parameters,"_The code is generated by a fuzzer and reduced manually_

<!--
Thank you for filing a bug report! 🐛 Please provide a short summary of the bug,
along with any information you feel relevant to replicating the bug.
-->

I tried this code:
**When implementing a trait for a generic type, replacing the expected generic parameters with undefined identifiers (eg. NonExistentTrait) causes the Rust compiler to hang during coherence checking**

```rust
trait Trait<T: ?Sized, V: ?Sized, D: ?Sized> {}
struct A<T: ?Sized>(T);
struct B<T: ?Sized>(T);

trait IncompleteGuidance<T: ?Sized, V: ?Sized> {}

trait ImplGuidance<T: ?Sized, V: ?Sized> {}
impl<T: ?Sized> ImplGuidance<u32, u8> for T {}

impl<T: ?Sized, U: ?Sized, V: ?Sized, D: ?Sized> Trait<U, V, D> for A<T>
where
    T: IncompleteGuidance<U, V>,
    A<T>: Trait<U, D, V>,
    B<T>: Trait<U, V, D>,
    (): ToU8<D>,
{
}

trait ToU8<T: ?Sized> {}
impl ToU8<u8> for () {}

impl<T: ?Sized, U: ?Sized, V: ?Sized, D: ?Sized>
    Trait<NonExistentTrait, NonExistentTrait, NonExistentTrait> for B<T>
where
    T: ImplGuidance<U, V>,
    A<T>: Trait<U, V, D>,
{
}

fn impls_trait<T: ?Sized + Trait<U, V, D>, U: ?Sized, V: ?Sized, D: ?Sized>() {}
fn with_bound<X>()
{
    impls_trait::<B<X>, _, _, _>();
}
fn main() {
    with_bound::<u32>();
}
```
### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.89.0-nightly (d4e1159b8 2025-06-21)
binary: rustc
commit-hash: d4e1159b8c97478778b09a4cc1c7adce5653b8bf
commit-date: 2025-06-21
host: x86_64-pc-windows-msvc
release: 1.89.0-nightly
LLVM version: 20.1.7
```
### -Z time-passe

```
time:   0.001; rss:   16MB ->   17MB (   +1MB)  parse_crate
time:   0.000; rss:   20MB ->   20MB (   +0MB)  crate_injection
time:   0.007; rss:   20MB ->   23MB (   +3MB)  expand_crate
time:   0.008; rss:   20MB ->   23MB (   +3MB)  macro_expand_crate
time:   0.000; rss:   23MB ->   23MB (   +0MB)  maybe_building_test_harness
time:   0.000; rss:   23MB ->   23MB (   +0MB)  AST_validation
time:   0.000; rss:   23MB ->   23MB (   +0MB)  finalize_imports
time:   0.000; rss:   23MB ->   23MB (   +0MB)  compute_effective_visibilities
time:   0.000; rss:   23MB ->   23MB (   +0MB)  finalize_macro_resolutions
time:   0.012; rss:   23MB ->   36MB (  +13MB)  late_resolve_crate
time:   0.000; rss:   36MB ->   36MB (   +0MB)  resolve_main
time:   0.000; rss:   36MB ->   36MB (   +0MB)  resolve_check_unused
error[E0412]: cannot find type `NonExistentTrait` in this scope
  --> .\test.rs:23:11
   |
23 |     Trait<NonExistentTrait, NonExistentTrait, NonExistentTrait> for B<T>
   |           ^^^^^^^^^^^^^^^^ not found in this scope
   |
help: you might be missing a type parameter
   |
22 | impl<T: ?Sized, U: ?Sized, V: ?Sized, D: ?Sized, NonExistentTrait>
   |                                                ++++++++++++++++++

error[E0412]: cannot find type `NonExistentTrait` in this scope
  --> .\test.rs:23:29
   |
23 |     Trait<NonExistentTrait, NonExistentTrait, NonExistentTrait> for B<T>
   |                             ^^^^^^^^^^^^^^^^ not found in this scope
   |
help: you might be missing a type parameter
   |
22 | impl<T: ?Sized, U: ?Sized, V: ?Sized, D: ?Sized, NonExistentTrait>
   |                                                ++++++++++++++++++

error[E0412]: cannot find type `NonExistentTrait` in this scope
  --> .\test.rs:23:47
   |
23 |     Trait<NonExistentTrait, NonExistentTrait, NonExistentTrait> for B<T>
   |                                               ^^^^^^^^^^^^^^^^ not found in this scope
   |
help: you might be missing a type parameter
   |
22 | impl<T: ?Sized, U: ?Sized, V: ?Sized, D: ?Sized, NonExistentTrait>
   |                                                ++++++++++++++++++

time:   0.048; rss:   36MB ->   37MB (   +0MB)  resolve_report_errors
time:   0.000; rss:   37MB ->   37MB (   +0MB)  resolve_postprocess
time:   0.068; rss:   23MB ->   37MB (  +14MB)  resolve_crate
time:   0.000; rss:   34MB ->   34MB (   +0MB)  write_dep_info
time:   0.000; rss:   34MB ->   34MB (   +0MB)  complete_gated_feature_checking
time:   0.000; rss:   35MB ->   35MB (   +0MB)  drop_ast
time:   0.000; rss:   35MB ->   35MB (   +0MB)  looking_for_entry_point
time:   0.000; rss:   35MB ->   35MB (   +0MB)  looking_for_derive_registrar
time:   0.000; rss:   36MB ->   36MB (   +0MB)  unused_lib_feature_checking
time:   0.003; rss:   35MB ->   36MB (   +1MB)  misc_checking_1
time:   0.002; rss:   36MB ->   41MB (   +5MB)  coherence_checking
```


</p>
</details>
","['T-compiler', 'C-bug', 'I-hang', 'S-has-mcve', 'fixed-by-next-solver']",open,2025-06-22T03:09:36Z,,bug,"['t-compiler', 'c-bug', 'i-hang', 's-has-mcve', 'fixed-by-next-solver']",True,,
rust-lang/rust,142859,FR: Add a `--fail-fast` option to libtest,"I'd like to add an option to the CLI of the standard test runner so that it stops running tests after the first one fails. This would be useful in situations where you just want to find whether any test fails. I don't propose to change the default.

My immediate motivation is that cargo-mutants just needs to see whether any test fails, and it's a waste of time to continue running tests after one failure has been found. 

More generally this is a feature many test runners have and that people seem to find useful. For example, failing fast is the default in nextest: <https://nexte.st/docs/running/#failing-fast>, Bazel has `--test_runner_fail_fast`, and pytest has `--exitfirst`. And of course `cargo test` fails fast by default at the test target level.

Today, `cargo test` will fail fast by default at the test target level: if any tests fail, it won't run any more. However, within the test target, there's no way to fail fast. This can be confusing, but it would be disruptive to change it now.

I discovered that the logic for this actually already exists, it's just not exposed in the CLI. #142807 adds an option. With that change, you can run `cargo test -- --fail-fast -Zunstable-options` and it will stop after the first test fails.

When multiple threads are used the tests are run in nondeterministic order, and so in a tree with multiple failing tests, with this option on, it's nondeterministic which tests will get run before the process stops. I don't think that's surprising to people who just want to know of any one failure, and the order can be made predictable by running on a single thread.

I have read that people would like to move away from the current libtest architecture and so apparently there has been a soft feature freeze for some months or years. However since this is a small change in the implementation and shouldn't introduce any compatibility concerns I hope it could still be considered.

Crates can work around the absence of this feature in libtest by setting `harness = false` and using Nextest or some other harness, but that's a large transition and I think it would be nice to have it in the standard library: at least, that would help cargo-mutants get better performance on most crates.

cc @rust-lang/testing-devex
","['T-libs-api', 'C-feature-request', 'A-libtest', 'T-testing-devex']",open,2025-06-22T00:54:22Z,,performance,"['t-libs-api', 'c-feature-request', 'a-libtest', 't-testing-devex']",True,,
rust-lang/rust,142858,error: failed to build archive failed to map object file: memory map must have a non-zero length,"<!--
Thank you for finding an Internal Compiler Error! 🧊  If possible, try to provide
a minimal verifiable example. You can read ""Rust Bug Minimization Patterns"" for
how to create smaller examples.
http://blog.pnkfx.org/blog/2019/11/18/rust-bug-minimization-patterns/
-->

Sorry in advance if I messed this up but I've never bothered to report a bug before. I'm not sure if this even is a bug

Here's all the important-looking stuff:

thread 'coordinator' panicked at /private/tmp/rust-20250515-8123-mdgm7y/rustc-1.87.0-src/compiler/rustc_codegen_ssa/src/back/write.rs:1692:29:
/private/tmp/rust-20250515-8123-mdgm7y/rustc-1.87.0-src/compiler/rustc_codegen_ssa/src/back/write.rs:1692:29: worker thread panicked

note: rustc 1.87.0 (17067e9ac 2025-05-09) (Homebrew) running on aarch64-apple-darwin

note: compiler flags: --crate-type staticlib --crate-type cdylib --crate-type rlib -C embed-bitcode=no -C debuginfo=2 -C split-debuginfo=unpacked -C incremental=[REDACTED]

error: unable to copy /Users/burakunlu/rust/compressor/compressor_tauri/src-tauri/target/debug/incremental/compressor_tauri_lib-08bee5v42d0id/s-h8iowq8lvm-1btnd36-working/59tyakjllmb4oichnejy2o23a.o to /Users/burakunlu/rust/compressor/compressor_tauri/src-tauri/target/debug/deps/compressor_tauri_lib.59tyakjllmb4oichnejy2o23a.rcgu.o: No such file or directory (os error 2)

### Code

```Rust

#[tauri::command]
pub fn parallel_compress() -> Vec<CompressionResult>  {

    let input_path = get_input_path();
    let output_path = get_output_path();

    println!(""Input path: {}"", input_path.display());
    println!(""Output path: {}"", output_path.display());

    // Clear the output folder before compressing new images
    crate::utility::clear_output_folder().expect(""Failed to clear output folder"");
    fs::create_dir_all(&output_path).expect(""Failed to recreate output directory"");
    println!(""Output folder cleared and recreated."");

    //wait a few milliseconds to ensure the folder is cleared
    std::thread::sleep(std::time::Duration::from_millis(500));

    let input_files: Vec<PathBuf> = match fs::read_dir(&*input_path) {
        Ok(entries) => entries
            .filter_map(|res| res.ok())
            .map(|e| e.path())
            .filter(|p| p.is_file())
            .collect(),
        Err(e) => {
            eprintln!(""Failed to read directory: {}"", e);
            Vec::new()
        }
    };

    println!(""Found {} input files."", input_files.len());

    let results: Vec<CompressionResult> = input_files.par_iter().filter_map(|input| {
        let file_stem = input.file_stem().unwrap().to_string_lossy();
        let ext = input.extension().unwrap().to_string_lossy();
        let compressed_path = output_path.join(format!(""{}_compressed.{}"", file_stem, ext));

        let original_size: u64 = std::fs::metadata(&input)
            .map(|metadata| metadata.len())
            .unwrap_or(0);

        println!(""Compressing: {} to {}"", input.display(), compressed_path.display());

        println!(""Input exists? {}"", input.exists());

        let mut comp = Compressor::new(&input, &compressed_path);
        comp.set_factor(Factor::new(0.8, 1.0));
        match comp.compress_to_jpg() {
            Ok(_) => {
                println!(""Success!! Compressed: {} to {}"", input.display(), compressed_path.display());

                let compressed_size = std::fs::metadata(&compressed_path)
                    .map(|metadata| metadata.len())
                    .unwrap_or(0);
                    
                let reduction_percent = if original_size > 0 {
                    100.0 * (original_size as f32 - compressed_size as f32) / original_size as f32
                } else {
                    0.0
                };

                let result = CompressionResult {
                    original_path: input.display().to_string(),
                    compressed_path: compressed_path.display().to_string(),
                    original_size,
                    compressed_size,
                    reduction_percent,
                };
                
                println!(""Reduced size by {:.1}%"", reduction_percent);

                return Some(result);
            },
            Err(e) => {
                eprintln!(""Failed to compress {}: {}"", input.display(), e);
                None
            }
        }
    })
    .collect();

    println!(""Compression completed."");
    results
}

```


### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.87.0 (17067e9ac 2025-05-09) (Homebrew)
binary: rustc
commit-hash: 17067e9ac6d7ecb70e50f92c1944e545188d2359
commit-date: 2025-05-09
host: aarch64-apple-darwin
release: 1.87.0
LLVM version: 20.1.4
```

### Error output

```

thread 'coordinator' panicked at /private/tmp/rust-20250515-8123-mdgm7y/rustc-1.87.0-src/compiler/rustc_codegen_ssa/src/back/write.rs:1692:29:
/private/tmp/rust-20250515-8123-mdgm7y/rustc-1.87.0-src/compiler/rustc_codegen_ssa/src/back/write.rs:1692:29: worker thread panicked
stack backtrace:
   0:        0x10d4f6ea0 - <std::sys::backtrace::BacktraceLock::print::DisplayBacktrace as core::fmt::Display>::fmt::h92c4e918781d801b
   1:        0x10d55b230 - core::fmt::write::h8f75e776556839a0
   2:        0x10d50bd48 - std::io::Write::write_fmt::hc2a765a75039a837
   3:        0x10d4f6d54 - std::sys::backtrace::BacktraceLock::print::ha7a698681566e125
   4:        0x10d501bc8 - std::panicking::default_hook::{{closure}}::hf90e930ff3e69c2d
   5:        0x10d501ac4 - std::panicking::default_hook::had80bb8af3f6815c
   6:        0x10abd0a88 - <alloc[ec5599a6ff6f777b]::boxed::Box<rustc_driver_impl[2db6a7acee9181d8]::install_ice_hook::{closure#1}> as core[cd2ca16b82fa16d0]::ops::function::Fn<(&dyn for<'a, 'b> core[cd2ca16b82fa16d0]::ops::function::Fn<(&'a std[6ff5e211387c1c03]::panic::PanicHookInfo<'b>,), Output = ()> + core[cd2ca16b82fa16d0]::marker::Send + core[cd2ca16b82fa16d0]::marker::Sync, &std[6ff5e211387c1c03]::panic::PanicHookInfo)>>::call
   7:        0x10d502280 - std::panicking::rust_panic_with_hook::h77f9a822db4ac97a
   8:        0x10d0629e0 - std[6ff5e211387c1c03]::panicking::begin_panic::<alloc[ec5599a6ff6f777b]::string::String>::{closure#0}
   9:        0x10d0626d8 - std[6ff5e211387c1c03]::sys::backtrace::__rust_end_short_backtrace::<std[6ff5e211387c1c03]::panicking::begin_panic<alloc[ec5599a6ff6f777b]::string::String>::{closure#0}, !>
  10:        0x10d6b8f8c - std[6ff5e211387c1c03]::panicking::begin_panic::<alloc[ec5599a6ff6f777b]::string::String>
  11:        0x10d07fca0 - rustc_middle[1921f7fa52b9505d]::util::bug::opt_span_bug_fmt::<rustc_span[16a7c46a06ed0f8]::span_encoding::Span>::{closure#0}
  12:        0x10d07f9a4 - rustc_middle[1921f7fa52b9505d]::ty::context::tls::with_opt::<rustc_middle[1921f7fa52b9505d]::util::bug::opt_span_bug_fmt<rustc_span[16a7c46a06ed0f8]::span_encoding::Span>::{closure#0}, !>::{closure#0}
  13:        0x10d07f970 - rustc_middle[1921f7fa52b9505d]::ty::context::tls::with_context_opt::<rustc_middle[1921f7fa52b9505d]::ty::context::tls::with_opt<rustc_middle[1921f7fa52b9505d]::util::bug::opt_span_bug_fmt<rustc_span[16a7c46a06ed0f8]::span_encoding::Span>::{closure#0}, !>::{closure#0}, !>
  14:        0x10d6d76c8 - rustc_middle[1921f7fa52b9505d]::util::bug::bug_fmt
  15:        0x10ae75e1c - std[6ff5e211387c1c03]::sys::backtrace::__rust_begin_short_backtrace::<<rustc_codegen_llvm[17a84dc1d755849b]::LlvmCodegenBackend as rustc_codegen_ssa[546b227f8b29fa6b]::traits::backend::ExtraBackendMethods>::spawn_named_thread<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::start_executing_work<rustc_codegen_llvm[17a84dc1d755849b]::LlvmCodegenBackend>::{closure#5}, core[cd2ca16b82fa16d0]::result::Result<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::CompiledModules, ()>>::{closure#0}, core[cd2ca16b82fa16d0]::result::Result<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::CompiledModules, ()>>
  16:        0x10aecbfd8 - <<std[6ff5e211387c1c03]::thread::Builder>::spawn_unchecked_<<rustc_codegen_llvm[17a84dc1d755849b]::LlvmCodegenBackend as rustc_codegen_ssa[546b227f8b29fa6b]::traits::backend::ExtraBackendMethods>::spawn_named_thread<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::start_executing_work<rustc_codegen_llvm[17a84dc1d755849b]::LlvmCodegenBackend>::{closure#5}, core[cd2ca16b82fa16d0]::result::Result<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::CompiledModules, ()>>::{closure#0}, core[cd2ca16b82fa16d0]::result::Result<rustc_codegen_ssa[546b227f8b29fa6b]::back::write::CompiledModules, ()>>::{closure#1} as core[cd2ca16b82fa16d0]::ops::function::FnOnce<()>>::call_once::{shim:vtable#0}
  17:        0x10d4e3464 - std::sys::pal::unix::thread::Thread::new::thread_start::h30d0ef7640bc7718
  18:        0x1847e2c0c - __pthread_cond_wait

error: the compiler unexpectedly panicked. this is a bug.

note: we would appreciate a bug report: https://github.com/rust-lang/rust/issues/new?labels=C-bug%2C+I-ICE%2C+T-compiler&template=ice.md

note: rustc 1.87.0 (17067e9ac 2025-05-09) (Homebrew) running on aarch64-apple-darwin

note: compiler flags: --crate-type staticlib --crate-type cdylib --crate-type rlib -C embed-bitcode=no -C debuginfo=2 -C split-debuginfo=unpacked -C incremental=[REDACTED]

note: some of the compiler flags provided by cargo are hidden

query stack during panic:
end of query stack
error: unable to copy /Users/burakunlu/rust/compressor/compressor_tauri/src-tauri/target/debug/incremental/compressor_tauri_lib-08bee5v42d0id/s-h8iowq8lvm-1btnd36-working/59tyakjllmb4oichnejy2o23a.o to /Users/burakunlu/rust/compressor/compressor_tauri/src-tauri/target/debug/deps/compressor_tauri_lib.59tyakjllmb4oichnejy2o23a.rcgu.o: No such file or directory (os error 2)```

<!--
Include a backtrace in the code block by setting `RUST_BACKTRACE=1` in your
environment. E.g. `RUST_BACKTRACE=1 cargo build`.
-->
<details><summary><strong>Backtrace</strong></summary>
<p>

```
RUST_BACKTRACE=1 cargo build
   Compiling objc2-exception-helper v0.1.1
   Compiling mozjpeg-sys v2.2.3
   Compiling objc2 v0.6.1
   Compiling block2 v0.6.1
   Compiling objc2-core-foundation v0.3.1
   Compiling dispatch2 v0.2.0
   Compiling objc2-foundation v0.3.1
   Compiling objc2-core-graphics v0.3.1
   Compiling mozjpeg v0.10.13
   Compiling image_compressor v1.5.2
   Compiling objc2-quartz-core v0.3.1
   Compiling objc2-cloud-kit v0.3.1
   Compiling objc2-core-data v0.3.1
   Compiling objc2-core-image v0.3.1
   Compiling objc2-app-kit v0.3.1
   Compiling objc2-web-kit v0.3.1
   Compiling tao v0.33.0
   Compiling muda v0.16.1
   Compiling window-vibrancy v0.6.0
   Compiling rfd v0.15.3
   Compiling wry v0.51.2
   Compiling tauri-runtime-wry v2.6.0
   Compiling tauri v2.5.1
   Compiling tauri-plugin-fs v2.3.0
   Compiling tauri-plugin-opener v2.3.0
   Compiling tauri-plugin-dialog v2.2.2
   Compiling compressor_tauri v0.1.0 (/Users/burakunlu/rust/compressor/compressor_tauri/src-tauri)
warning: unused import: `std::path::PathBuf`
 --> src/lib.rs:4:5
  |
4 | use std::path::PathBuf;
  |     ^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_imports)]` on by default

error: failed to build archive at `/Users/burakunlu/rust/compressor/compressor_tauri/src-tauri/target/debug/deps/libcompressor_tauri_lib.a`: failed to map object file: memory map must have a non-zero length

warning: `compressor_tauri` (lib) generated 1 warning
error: could not compile `compressor_tauri` (lib) due to 1 previous error; 1 warning emitted
```

</p>
</details>
","['I-ICE', 'T-compiler', 'C-bug', 'S-needs-repro']",open,2025-06-22T00:51:55Z,,bug,"['i-ice', 't-compiler', 'c-bug', 's-needs-repro']",True,,
rust-lang/rust,142855,`run-make`: cross-compiling C to `android` fails,"In https://github.com/rust-lang/rust/pull/141856 we ran into this error when enabling cross-compilation of a test that compiles C code and links together objects:

```
---- [run-make] tests/run-make/c-link-to-rust-va-list-fn stdout ----

error: rmake recipe failed to complete
status: exit status: 1
command: cd ""/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/c-link-to-rust-va-list-fn/rmake_out"" && env -u RUSTFLAGS AR=""llvm-ar"" BUILD_ROOT=""/checkout/obj/build/x86_64-unknown-linux-gnu"" CARGO=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage1-tools-bin/cargo"" CC=""/android/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/armv7a-linux-androideabi21-clang"" CC_DEFAULT_FLAGS=""-DANDROID -ffunction-sections -fdata-sections -fPIC"" CXX=""/android/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/armv7a-linux-androideabi21-clang++"" CXX_DEFAULT_FLAGS=""-DANDROID -ffunction-sections -fdata-sections -fPIC"" HOST_RUSTC_DYLIB_PATH=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib"" LD_LIBRARY_PATH=""/checkout/obj/build/x86_64-unknown-linux-gnu/bootstrap-tools/x86_64-unknown-linux-gnu/release/deps:/checkout/obj/build/x86_64-unknown-linux-gnu/stage0/lib/rustlib/x86_64-unknown-linux-gnu/lib"" LD_LIB_PATH_ENVVAR=""LD_LIBRARY_PATH"" LLVM_BIN_DIR=""/checkout/obj/build/x86_64-unknown-linux-gnu/ci-llvm/bin"" LLVM_COMPONENTS=""aarch64 aarch64asmparser aarch64codegen aarch64desc aarch64disassembler aarch64info aarch64utils aggressiveinstcombine all all-targets amdgpu amdgpuasmparser amdgpucodegen amdgpudesc amdgpudisassembler amdgpuinfo amdgputargetmca amdgpuutils analysis arm armasmparser armcodegen armdesc armdisassembler arminfo armutils asmparser asmprinter avr avrasmparser avrcodegen avrdesc avrdisassembler avrinfo binaryformat bitreader bitstreamreader bitwriter bpf bpfasmparser bpfcodegen bpfdesc bpfdisassembler bpfinfo cfguard cgdata codegen codegentypes core coroutines coverage csky cskyasmparser cskycodegen cskydesc cskydisassembler cskyinfo debuginfobtf debuginfocodeview debuginfodwarf debuginfogsym debuginfologicalview debuginfomsf debuginfopdb demangle dlltooldriver dwarflinker dwarflinkerclassic dwarflinkerparallel dwp engine executionengine extensions filecheck frontendatomic frontenddriver frontendhlsl frontendoffloading frontendopenacc frontendopenmp fuzzercli fuzzmutate globalisel hexagon hexagonasmparser hexagoncodegen hexagondesc hexagondisassembler hexagoninfo hipstdpar instcombine instrumentation interfacestub interpreter ipo irprinter irreader jitlink libdriver lineeditor linker loongarch loongarchasmparser loongarchcodegen loongarchdesc loongarchdisassembler loongarchinfo lto m68k m68kasmparser m68kcodegen m68kdesc m68kdisassembler m68kinfo mc mca mcdisassembler mcjit mcparser mips mipsasmparser mipscodegen mipsdesc mipsdisassembler mipsinfo mirparser msp430 msp430asmparser msp430codegen msp430desc msp430disassembler msp430info native nativecodegen nvptx nvptxcodegen nvptxdesc nvptxinfo objcarcopts objcopy object objectyaml option orcdebugging orcjit orcshared orctargetprocess passes powerpc powerpcasmparser powerpccodegen powerpcdesc powerpcdisassembler powerpcinfo profiledata remarks riscv riscvasmparser riscvcodegen riscvdesc riscvdisassembler riscvinfo riscvtargetmca runtimedyld sandboxir scalaropts selectiondag sparc sparcasmparser sparccodegen sparcdesc sparcdisassembler sparcinfo support symbolize systemz systemzasmparser systemzcodegen systemzdesc systemzdisassembler systemzinfo tablegen target targetparser telemetry textapi textapibinaryreader transformutils vectorize webassembly webassemblyasmparser webassemblycodegen webassemblydesc webassemblydisassembler webassemblyinfo webassemblyutils windowsdriver windowsmanifest x86 x86asmparser x86codegen x86desc x86disassembler x86info x86targetmca xray xtensa xtensaasmparser xtensacodegen xtensadesc xtensadisassembler xtensainfo"" LLVM_FILECHECK=""/checkout/obj/build/x86_64-unknown-linux-gnu/ci-llvm/bin/FileCheck"" PYTHON=""/usr/bin/python3"" REMOTE_TEST_CLIENT=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage0-tools-bin/remote-test-client"" RUSTC=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/bin/rustc"" RUSTC_LINKER=""/android/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/armv7a-linux-androideabi21-clang"" RUSTDOC=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/bin/rustdoc"" SOURCE_ROOT=""/checkout"" TARGET=""arm-linux-androideabi"" TARGET_EXE_DYLIB_PATH=""/checkout/obj/build/x86_64-unknown-linux-gnu/stage2/lib/rustlib/arm-linux-androideabi/lib"" ""/checkout/obj/build/x86_64-unknown-linux-gnu/test/run-make/c-link-to-rust-va-list-fn/rmake""
stdout: none
--- stderr -------------------------------
command failed at line 16
Command { cmd: ""/android/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/armv7a-linux-androideabi21-clang"" ""-DANDROID"" ""-ffunction-sections"" ""-fdata-sections"" ""-fPIC"" ""test.c"" ""libcheckrust.a"" ""-o"" ""test"" ""-lm"" ""-lrt"" ""-ldl"" ""-lpthread"", stdin_buf: None, stdin: None, stdout: None, stderr: None, drop_bomb: DropBomb { command: ""/android/ndk/toolchains/llvm/prebuilt/linux-x86_64/bin/armv7a-linux-androideabi21-clang"", defused: true, armed_location: Location { file: ""/checkout/tests/run-make/c-link-to-rust-va-list-fn/rmake.rs"", line: 12, col: 5 } }, already_executed: true }
output status: `exit status: 1`
=== STDOUT ===



=== STDERR ===
ld.lld: error: unable to find library -lrt
```

It could be that `-lrt` should not be passed, based on https://developer.android.com/ndk/guides/stable_apis#c_library

> Note that on Android, unlike Linux, there are no separate libpthread or librt libraries. That functionality is included directly in libc, which does not need to be explicitly linked against.","['A-testsuite', 'O-android', 'A-cross', 'T-compiler', 'C-bug', 'A-run-make']",open,2025-06-21T23:34:53Z,,performance,"['a-testsuite', 'o-android', 'a-cross', 't-compiler', 'c-bug', 'a-run-make']",True,,
rust-lang/rust,142853,"""conflicting implementations of trait"" for two distinct types","<!--
Thank you for filing a bug report! 🐛 Please provide a short summary of the bug,
along with any information you feel relevant to replicating the bug.
-->
I tried this code:
```rust
trait T {}
impl T for <&'static i32 as core::ops::Deref>::Target {}
impl T for () {}
```

I expected to see this happen: successful compilation, since `<&'static i32 as core::ops::Deref>::Target` is `i32` (clearly not `()`)

Instead, this happened: compilation failed with
```text
error[E0119]: conflicting implementations of trait `T` for type `<&'static i32 as Deref>::Target`
 --> src/lib.rs:3:1
  |
2 | impl T for <&'static i32 as core::ops::Deref>::Target {}
  | --------------------------------------------- first implementation here
3 | impl T for () {}
  | ^^^^^^^^^^^^^ conflicting implementation for `<&'static i32 as Deref>::Target`
```

It should be noted, that substituting `<&'static i32 as Deref>::Target` for `i32` removes the error, i.e. the following code compiles:
```rust
trait T {}
impl T for i32 {}
impl T for () {}
```

### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->
`rustc --version --verbose`:
```
rustc 1.87.0 (17067e9ac 2025-05-09)
binary: rustc
commit-hash: 17067e9ac6d7ecb70e50f92c1944e545188d2359
commit-date: 2025-05-09
host: x86_64-unknown-linux-gnu
release: 1.87.0
LLVM version: 20.1.1
```
In my testing, all of the following reproduced this behavior:
- stable 1.87.0
- beta 1.88.0-beta.5 (2025-06-01)
- nightly 1.89.0-nightly (2025-06-11)

<!--
Include a backtrace in the code block by setting `RUST_BACKTRACE=1` in your
environment. E.g. `RUST_BACKTRACE=1 cargo build`.
-->
(no backtrace produced)
","['C-bug', 'needs-triage']",open,2025-06-21T22:14:41Z,,bug,"['c-bug', 'needs-triage']",True,,
rust-lang/rust,142852,RwLock::try_write should say that it fails with WouldBlock if there's a shared lock,"### Location

https://doc.rust-lang.org/std/sync/struct.RwLock.html#method.try_write

### Summary

The docs for `RwLock::try_write` say:
> This function will return the [WouldBlock](https://doc.rust-lang.org/std/sync/enum.TryLockError.html#variant.WouldBlock) error if the `RwLock` could not be acquired because it was already locked exclusively.

I believe it should say ""because it already has a _shared or exclusive lock_"", based on how `RwLock` works (and based on my reading of the code). The sibling methods (`read`, `write`) clarify this detail correctly, and `try_write`'s docs appear to be copied from `try_read` (where this description is correct), so I think this is just a small oversight from copying the description.

(For context, I was initially checking whether `RwLock` had some way to indicate that the lock was writer-locked, and this description confused me at first.)","['A-docs', 'needs-triage']",open,2025-06-21T22:01:13Z,,security,"['a-docs', 'needs-triage']",True,,
rust-lang/rust,142847,`io::stdin().read_to_end()` drops a byte on certain Unicode input (Windows only),"<!--
Thank you for filing a bug report! 🐛 Please provide a short summary of the bug,
along with any information you feel relevant to replicating the bug.
-->

### Description

The method [`io::stdin().read_to_end()`](https://doc.rust-lang.org/std/io/trait.Read.html#method.read_to_end) appears to drop a byte when reading certain Unicode input on **Windows**. The issue occurs when using `Vec::new()`, and affects only certain input strings.

```rust
use std::io::{self, Read, Write};
use std::str;

fn main() -> io::Result<()> {
    let mut stdout = io::stdout();

    write!(stdout, ""Enter content : "")?;
    stdout.flush()?;

    // let mut buffer = Vec::with_capacity(1024);  // Reads correctly
    let mut buffer = Vec::new();  // Fails to read correctly
    
    // Paste the provided input and press Ctrl+Z (or Ctrl+D on Linux)
    io::stdin().read_to_end(&mut buffer)?;

    println!(""\nBytes read : {:?}"", buffer);

    match str::from_utf8(&buffer) {
        Ok(s) => println!(""UTF-8 - OK: {}"", s),
        Err(e) => println!(""UTF-8 - ERROR: {}"", e),
    }

    Ok(())
}
```
With the input:
```
8216]:есть какое нибудь бюджетное
```
The resulting read contains the sequence of bytes:

```
... 208, 208, 181 ... 0
```
<details>
Bytes read : [56, 50, 49, 54, 93, 58, 208, 181, 209, 129, 209, 130, 209, 140, 32, 208, 186, 208, 176, 208, 186, 208, 190, 208, 181, 32, 208, 189, 208, 184, 208, 177, 209, 131, 208, 180, 209, 140, 32, 208, 177, 209, 142, 208, 180, 208, 208, 181, 209, 130, 208, 189, 208, 190, 208, 181, 0]
</details>

instead of the expected:

```
... 208, 182, 208, 181 ...
```
<details>
Bytes read : [56, 50, 49, 54, 93, 58, 208, 181, 209, 129, 209, 130, 209, 140, 32, 208, 186, 208, 176, 208, 186, 208, 190, 208, 181, 32, 208, 189, 208, 184, 208, 177, 209, 131, 208, 180, 209, 140, 32, 208, 177, 209, 142, 208, 180, 208, 182, 208, 181, 209, 130, 208, 189, 208, 190, 208, 181, 10]
</details>

As correctly returned by [`io::stdin().read_line()`](https://doc.rust-lang.org/std/io/struct.Stdin.html#method.read_line) or [`io::stdin().read_to_end()`](https://doc.rust-lang.org/std/io/trait.Read.html#method.read_to_end) on Linux.

### Symptoms

* The issue occurs only with specific Unicode inputs (such as the example above).
* Removing a character (the first one for example) from the input causes the issue to disappear.
* When the character loss occurs, `read_to_end()` appends a null byte at the end of the buffer.
* The issue only occurs when using:
```rust
let mut buffer = Vec::new();
std::io::stdin().read_to_end(&mut buffer)?;
```
* The issueis NOT observed when using:
```rust
let mut buffer = Vec::with_capacity(1024);
std::io::stdin().read_to_end(&mut buffer)?;
```
* Importantly, **no error is returned by the [`io::stdin().read_to_end()`](https://doc.rust-lang.org/std/io/trait.Read.html#method.read_to_end) call** when this happens.

### Notes
* The behavior only appears when using `read_to_end()` with `Vec::new()`.
* The behavior is not present when using a **preallocated buffer** (`Vec::with_capacity(1024)`), nor when using `read_line()`.

### Meta
`rustc --version --verbose`:
```
rustc 1.87.0 (17067e9ac 2025-05-09)
binary: rustc
commit-hash: 17067e9ac6d7ecb70e50f92c1944e545188d2359
commit-date: 2025-05-09
host: x86_64-pc-windows-msvc
release: 1.87.0
LLVM version: 20.1.1
```","['O-windows', 'A-Unicode', 'C-bug', 'T-libs', 'A-io']",open,2025-06-21T21:10:58Z,,bug,"['o-windows', 'a-unicode', 'c-bug', 't-libs', 'a-io']",True,,
rust-lang/rust,142840,Compile-time resource exhaustion from type complexity via recursive generic traits,"<!--
Thank you for filing a bug report! 🐛 Please provide a short summary of the bug,
along with any information you feel relevant to replicating the bug.
-->

I tried this code:

```rust
use std::marker::PhantomData;

pub trait Seq {}

pub struct Empty;
impl Seq for Empty {}

// `Branch` to connect Branch<A,B>
pub struct Branch<L: Seq, R: Seq> {
    _p: PhantomData<(L, R)>,
}
impl<L: Seq, R: Seq> Seq for Branch<L, R> {}

// Define L-system rewrite rules
// `A` and `B` are the basic elements of the sequence.
pub struct A;
pub struct B;
impl Seq for A {}
impl Seq for B {}

// `Rewrite` trait defines the rewriting rules
pub trait Rewrite {
    type Result: Seq;
}

// Rule 1: A -> Branch(A, B)
impl Rewrite for A {
    type Result = Branch<A, B>;
}

// Rule 2: B -> A
impl Rewrite for B {
    type Result = A;
}

// Recursively rewrite the entire sequence tree. Similar to L-system concepts:
// N=0: A
// N=1: Branch<A, B>
// N=2: Branch<Rewrite(A), Rewrite(B)> -> Branch<Branch<A, B>, A>
// N=3: Branch<Rewrite(Branch<A, B>), Rewrite(A)> -> Branch<Branch<Branch<A, B>, A>, Branch<A, B>>
// Fibonacci-like growth of the sequence tree.
impl Rewrite for Empty {
    type Result = Empty;
}
impl<L: Seq, R: Seq> Rewrite for Branch<L, R>
where
    L: Rewrite,
    R: Rewrite,
{
    type Result = Branch<<L as Rewrite>::Result, <R as Rewrite>::Result>;
}

// Define traits for iteration and forced evaluation
// `Nat` and `Succ`/`Zero` are used for type-level counting.
// Represents numbers at the type level.
pub trait Nat {}
pub struct Zero;
impl Nat for Zero {}
pub struct Succ<N: Nat>(PhantomData<N>);
impl<N: Nat> Nat for Succ<N> {}

// `ApplyRewrite` trait applies the specified rewriting rules N times.
pub trait ApplyRewrite<N: Nat> {
    type Result: Seq;
}

// Base case: 0 iterations, the result is the type itself.
impl<S: Seq> ApplyRewrite<Zero> for S {
    type Result = S;
}

// Recursive step: N+1 iterations = apply N iterations, then rewrite the result once.
impl<S: Seq, P: Nat> ApplyRewrite<Succ<P>> for S
where
    S: ApplyRewrite<P>,
    <S as ApplyRewrite<P>>::Result: Rewrite,
{
    type Result = <<S as ApplyRewrite<P>>::Result as Rewrite>::Result;
}

// Define a more complex hash calculation trait
/// `SeqHash` trait is used to compute the hash value of a sequence at compile time.
pub trait SeqHash {
    const HASH: u64;
}

//  Define the hash values for the basic elements and branches. (random large primes)
impl SeqHash for Empty {
    const HASH: u64 = 0x9e3779b97f4a7c15;
}
impl SeqHash for A {
    const HASH: u64 = 0x6a09e667f3bcc908;
}
impl SeqHash for B {
    const HASH: u64 = 0xbb67ae8584caa73b;
}

impl<L: Seq, R: Seq> SeqHash for Branch<L, R>
where
    L: SeqHash,
    R: SeqHash,
{
    // Introduce a complex hash calculation method, using various bitwise operations and constants
    const HASH: u64 = ((L::HASH.wrapping_mul(0x94d049bb133111eb).rotate_left(19))
        ^ (R::HASH.wrapping_mul(0xbf58476d1ce4e5b9).rotate_right(23))
            .wrapping_add(0xc4ceb9fe1a85ec53))
    .wrapping_mul(0x9e3779b97f4a7c15) // A large prime constant, Empty
    .rotate_left(37)
    .wrapping_add(L::HASH ^ R::HASH);
}

// main function to trigger the compile-time evaluation.
fn main() {
    // Define initial state.
    type InitialState = A;

    // Note: the following is harmful. Set iteration count to N=40.
    // Complex successor tree
    // Result: Compilation bomb! Compilation leads to OOM, takes a very long time, and causes a Denial of Service.
    type N40 = Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Succ<Zero>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>>;

    // Generate final result type.
    type FinalState = <InitialState as ApplyRewrite<N40>>::Result;

    // Force the compiler to evaluate and traverse the type.
    const FINAL_HASH: u64 = <FinalState as SeqHash>::HASH;

    // Print the result to ensure it won't be optimized away.
    println!(
        ""Compilation succeeded! The final complex hash calculated at compile-time is: {}"",
        FINAL_HASH
    );
}

```

I expected to see this happen: compile finished 

Instead, this happened: compile stuck
### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.87.0 (17067e9ac 2025-05-09)
binary: rustc
commit-hash: 17067e9ac6d7ecb70e50f92c1944e545188d2359
commit-date: 2025-05-09
host: aarch64-apple-darwin
release: 1.87.0
LLVM version: 20.1.1
```

<!--
Include a backtrace in the code block by setting `RUST_BACKTRACE=1` in your
environment. E.g. `RUST_BACKTRACE=1 cargo build`.
-->
<details><summary>Backtrace</summary>
<p>

```
<backtrace>
```

</p>
</details>
","['A-trait-system', 'T-compiler', 'I-compilemem', 'C-bug', 'I-hang', 'E-needs-mcve']",open,2025-06-21T18:20:07Z,,performance,"['a-trait-system', 't-compiler', 'i-compilemem', 'c-bug', 'i-hang', 'e-needs-mcve']",True,,
rust-lang/rust,142838,A path towards erroring on nonsense attributes,"### Description

There are quite a few attributes that have been accidentally allowed in positions that make no sense. For example:

```rust
#[windows_subsystem = ""windows""]
pub struct Bar {
    #[no_link]
    pub field: u32,
}
```

```
warning: crate-level attribute should be an inner attribute: add an exclamation mark: `#![foo]`
 --> src/lib.rs:1:1
  |
1 | #[windows_subsystem = ""windows""]
  | ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  |
  = note: `#[warn(unused_attributes)]` on by default

warning: `#[no_link]` is ignored on struct fields, match arms and macro defs
 --> src/lib.rs:3:5
  |
3 |     #[no_link]
  |     ^^^^^^^^^^
```

In [`check_attr.rs`](https://github.com/rust-lang/rust/blob/master/compiler/rustc_passes/src/check_attr.rs) there are various comments along the lines of ""we accidentally allowed this"". Some attributes are even not checked at all. In almost all cases, the attribute does nothing and is simply ignored.

### Proposal

Once the [attribute rework](https://github.com/rust-lang/compiler-team/issues/796) is completed we can consistently and reliably handle these cases. I propose that once that is done, we start on a path to turning these into errors.

I'd like to hear the lang team's thoughts on this. In particular,
- For the cases where the attribute does nothing and there is no behavioral change to consider, that we turn them into a hard error over a future edition.
- That we start emitting ""this will be an error in a future release"" diagnostics for these cases.

https://github.com/rust-lang/rust/issues/142836 is adjacent and related to this issue, but different; that one asks for a decision about behavior in ambiguous situations, this one is about getting rid of obvious nonsense.


@rustbot labels +I-lang-nominated","['C-enhancement', 'A-attributes', 'T-lang', 'T-compiler', 'I-lang-nominated', 'P-lang-drag-2']",open,2025-06-21T17:40:10Z,,bug,"['c-enhancement', 'a-attributes', 't-lang', 't-compiler', 'i-lang-nominated', 'p-lang-drag-2']",True,,
rust-lang/rust,142836,Warn or error on duplicate attributes,"During the [port of built-in attributes](https://github.com/rust-lang/rust/issues/131229) we've found that some attributes give an error if repeated, some a warning, and some a ""future error"". i.e. warning for now saying that some day it's going to be an error. 

@JonathanBrouwer started changing some to used with future error, and I think that's not unreasonable. For example, #[used] will under his PR error when used multiple times. See  https://github.com/rust-lang/rust/pull/142818#discussion_r2160010274, https://github.com/rust-lang/rust/pull/142818#discussion_r2159982637 and https://github.com/rust-lang/rust/pull/142823#discussion_r2160015573

There is some value in allowing duplicates. For example, an attribute macro might emit #[used] and also #[allow(duplicate_attributes)] to make a function used regardless of a user making already having marked it as used. That saves the attribute macro from checking if the attribute is already there. Is that a good usecase? I don't know. However, since we currently do have all three options, I thought it might be good to open a discussion on what we should actually want, in general.

Some comments were made [on zulip](https://rust-lang.zulipchat.com/#narrow/channel/131828-t-compiler/topic/attribute.20conflicts/with/525167772) already. The questions to be answered are:

- Do we want the attributes that warn now to keep warning or to promise future error
- Attributes that promise future error now, when is that future? Do we actually want to make them an error or instead downgrade them to just a warning? See also https://github.com/rust-lang/rust/issues/142838
- Can we even come up with a policy or is it inherently attribute-dependent

And, if answers to those questions are complicated, what policy should we maintain for future attributes. Should list-like attributes always allow duplicates? Also if they're nested?

Some examples of the *current state* before the refactorings in progress. The refactorings can maintain the status quo, but maybe we want to formalize that.

## duplicates obviously allowed

```rust
#[repr(C)]
#[repr(align(8))]
struct Foo;
```
## duplicates allowed with warning of future error

```rust
#[inline(always)]
#[inline(never)] //~ WARN will be an error in the future
#[inline] //~ WARN will be an error in the future
fn foo() {}
```

## duplicates allowed with a warning

```rust
#[cold]
#[cold] //~ WARN unused attribute
fn foo() {}

// NOTE: we might want to make this an error or warn-future-error? 
// but again, we have no policy why this is different, or not different than inline for example
#[used(compiler)]
#[used(linker)] // WARN unused attribute
fn bar() {}
```

## duplicates disallowed

This one seems obvious

```rust
#[deprecated = ""a""]
#[deprecated = ""b""] //~ ERROR duplicate
fn foo() {}
```

This one also, sort of, though the keys are disjoint so in theory not much wrong with it.

```rust
#[deprecated(since=""a"")]
#[deprecated(note = ""reason"")] //~ ERROR duplicate
fn foo() {}
```

But this one less. It seems like splitting this over two attributes is not so different from repr for example.

```rust
#[proc_macro_derive(Foo, attributes(a, b, c))]
#[proc_macro_derive(attributes(e, f, g))] //~ ERORR duplicate
fn foo() {}
```

Similarly,

```rust
#[collapse_debuginfo(yes)]
#[collapse_debuginfo(external)]//~ ERORR duplicate
fn foo() {}
```

is not so different from inline or used, while this is a hard error and those two are future error or warning respectively.


Finally, there is also no real consensus which attribute takes precedence, the last or the first for built-in attributes. That one seems harder to fix since it might break people's code. It's easy to keep it as is, though we could think about changing that over an edition. Food for thought.


cc: @mejrs @JonathanBrouwer @oli-obk @bjorn3 
","['A-attributes', 'T-lang', 'I-lang-nominated', 'P-lang-drag-2']",open,2025-06-21T16:45:11Z,,performance,"['a-attributes', 't-lang', 'i-lang-nominated', 'p-lang-drag-2']",True,,
rust-lang/rust,142835,rustdoc HTML shouldn't rely on HIR pretty-printing for attributes,"Oh no :( The rustdoc HTML backend shouldn't use HIR pretty-printing at all. Fortunately, rustdoc only displays a fixed set of attrs: `export_name`, `link_section`, `no_mangle`, `non_exhaustive` and `repr` but for `repr` we don't rely on HIR pretty-printing.

Using HIR pretty is busted anyway, since it doesn't escape HTML. E.g., `#[unsafe(link_section = ""<script>alert()</script>"")]` triggers an alert.

_Originally posted by @fmease in https://github.com/rust-lang/rust/pull/142823#discussion_r2160078687_
            ","['T-rustdoc', 'A-attributes', 'C-bug', 'A-rustdoc-ui', 'T-rustdoc-frontend']",open,2025-06-21T16:33:47Z,,bug,"['t-rustdoc', 'a-attributes', 'c-bug', 'a-rustdoc-ui', 't-rustdoc-frontend']",True,,
rust-lang/rust,142834,rustc hangs in misc_checking_1,"The code is generated by a fuzzer and reduced manually
<!--
Thank you for filing a bug report! 🐛 Please provide a short summary of the bug,
along with any information you feel relevant to replicating the bug.
-->

I tried this code:

```rust
trait Trait {}
struct W<T>(T);
impl<T, U> Trait for W
where
    W<T>: Trait,
    W<U>: Trait,
{
    type NewAssoc<T, U>
        = (&'a (), &'b ())
    where
        W<U>: Trait;
}
fn main() {
}
```


### Meta
<!--
If you're using the stable version of the compiler, you should also check if the
bug also exists in the beta or nightly versions.
-->

`rustc --version --verbose`:
```
rustc 1.89.0-nightly (5526a2f47 2025-06-20)
binary: rustc
commit-hash: 5526a2f47cd676ceeedc08cf71ae75ce2e9284ae
commit-date: 2025-06-20
host: x86_64-pc-windows-msvc
release: 1.89.0-nightly
LLVM version: 20.1.7
```

### -Z time-passes

```
time:   0.000; rss:   16MB ->   17MB (   +1MB)  parse_crate
time:   0.000; rss:   19MB ->   20MB (   +0MB)  crate_injection
time:   0.007; rss:   20MB ->   22MB (   +3MB)  expand_crate
time:   0.008; rss:   20MB ->   22MB (   +3MB)  macro_expand_crate
time:   0.000; rss:   22MB ->   23MB (   +0MB)  AST_validation
time:   0.000; rss:   23MB ->   23MB (   +0MB)  finalize_imports
time:   0.000; rss:   23MB ->   23MB (   +0MB)  compute_effective_visibilities
time:   0.000; rss:   23MB ->   23MB (   +0MB)  finalize_macro_resolutions
error[E0403]: the name `T` is already used for a generic parameter in this item's generic parameters
 --> .\test.rs:8:19
  |
3 | impl<T, U> Trait for W
  |      - first use of `T`
...
8 |     type NewAssoc<T, U>
  |                   ^ already used

error[E0403]: the name `U` is already used for a generic parameter in this item's generic parameters
 --> .\test.rs:8:22
  |
3 | impl<T, U> Trait for W
  |         - first use of `U`
...
8 |     type NewAssoc<T, U>
  |                      ^ already used

error[E0437]: type `NewAssoc` is not a member of trait `Trait`
  --> .\test.rs:8:5
   |
8  | /     type NewAssoc<T, U>
9  | |         = (&'a (), &'b ())
10 | |     where
11 | |         W<U>: Trait;
   | |____________________^ not a member of trait `Trait`

error[E0261]: use of undeclared lifetime name `'a`
 --> .\test.rs:9:13
  |
9 |         = (&'a (), &'b ())
  |             ^^ undeclared lifetime
  |
help: consider introducing lifetime `'a` here
  |
8 |     type NewAssoc<'a, T, U>
  |                   +++
help: consider introducing lifetime `'a` here
  |
3 | impl<'a, T, U> Trait for W
  |      +++

error[E0261]: use of undeclared lifetime name `'b`
 --> .\test.rs:9:21
  |
9 |         = (&'a (), &'b ())
  |                     ^^ undeclared lifetime
  |
help: consider introducing lifetime `'b` here
  |
8 |     type NewAssoc<'b, T, U>
  |                   +++
help: consider introducing lifetime `'b` here
  |
3 | impl<'b, T, U> Trait for W
  |      +++

time:   0.093; rss:   23MB ->   28MB (   +5MB)  late_resolve_crate
time:   0.000; rss:   28MB ->   28MB (   +0MB)  resolve_main
time:   0.000; rss:   28MB ->   28MB (   +0MB)  resolve_check_unused
time:   0.000; rss:   28MB ->   28MB (   +0MB)  resolve_postprocess
time:   0.099; rss:   23MB ->   28MB (   +6MB)  resolve_crate
time:   0.001; rss:   28MB ->   28MB (   +0MB)  write_dep_info
time:   0.000; rss:   28MB ->   28MB (   +0MB)  complete_gated_feature_checking
time:   0.000; rss:   29MB ->   29MB (   +0MB)  drop_ast
time:   0.000; rss:   30MB ->   30MB (   +0MB)  looking_for_entry_point
time:   0.000; rss:   30MB ->   30MB (   +0MB)  looking_for_derive_registrar
time:   0.000; rss:   31MB ->   31MB (   +0MB)  unused_lib_feature_checking
time:   0.003; rss:   30MB ->   31MB (   +1MB)  misc_checking_1
error[E0107]: missing generics for struct `W`
 --> .\test.rs:3:22
  |
3 | impl<T, U> Trait for W
  |                      ^ expected 1 generic argument
  |
note: struct defined here, with 1 generic parameter: `T`
 --> .\test.rs:2:8
  |
2 | struct W<T>(T);
  |        ^ -
help: add missing generic argument
  |
3 | impl<T, U> Trait for W<T>
  |                       +++
```

</p>
</details>
","['A-trait-system', 'T-compiler', 'C-bug', 'I-hang', 'fixed-by-next-solver']",open,2025-06-21T15:58:29Z,,bug,"['a-trait-system', 't-compiler', 'c-bug', 'i-hang', 'fixed-by-next-solver']",True,,
redis/redis,14142,[CRASH] Redis keep crashing,"Hi - About a week ago redis we started using redis in our app and started crashing. Our system admin suspects this is a redis bug. I am including some information below:


**Crash report**

```
Jun 19 17:28:02 server.co systemd[1]: redis.service: Main process exited, code=dumped, status=6/ABRT
░░ Subject: Unit process exited
░░ Defined-By: systemd
░░ Support: https://wiki.almalinux.org/Help-and-Support
░░
░░ An ExecStart= process belonging to unit redis.service has exited.
```

```
------ FAST MEMORY TEST ------
3831371:C 19 Jun 2025 21:37:01.047 # Bio thread for job type #0 terminated
2436112:M 19 Jun 2025 21:37:01.540 # Background saving terminated by signal 11


=== REDIS BUG REPORT START: Cut & paste starting from here ===
2436112:M 19 Jun 2025 21:37:05.298 # Redis 6.2.18 crashed by signal: 11, si_code: 1
2436112:M 19 Jun 2025 21:37:05.298 # Accessing address: 0xffffffffffffffff
2436112:M 19 Jun 2025 21:37:05.298 # Crashed running the instruction at: 0x55ab8422d014

------ STACK TRACE ------
EIP:
/usr/bin/redis-server 127.0.0.1:6379(dictSdsKeyCompare+0x34)[0x55ab8422d014]

Backtrace:
/lib64/libc.so.6(+0x3ebf0)[0x7f82ad83ebf0]
/usr/bin/redis-server 127.0.0.1:6379(dictSdsKeyCompare+0x34)[0x55ab8422d014]
/usr/bin/redis-server 127.0.0.1:6379(dictFind+0x75)[0x55ab84232635]
/usr/bin/redis-server 127.0.0.1:6379(lookupKey+0x16)[0x55ab8425e9e6]
/usr/bin/redis-server 127.0.0.1:6379(lookupKeyReadWithFlags+0x6e)[0x55ab8425eafe]
/usr/bin/redis-server 127.0.0.1:6379(getGenericCommand+0x34)[0x55ab84272c44]
/usr/bin/redis-server 127.0.0.1:6379(call+0xfd)[0x55ab8423fa9d]
/usr/bin/redis-server 127.0.0.1:6379(processCommand+0x633)[0x55ab842428e3]
/usr/bin/redis-server 127.0.0.1:6379(processInputBuffer+0x113)[0x55ab84252c03]
/usr/bin/redis-server 127.0.0.1:6379(+0x12824c)[0x55ab8430f24c]
/usr/bin/redis-server 127.0.0.1:6379(aeProcessEvents+0x2e2)[0x55ab84231152]
/usr/bin/redis-server 127.0.0.1:6379(aeMain+0x1d)[0x55ab8423134d]
/usr/bin/redis-server 127.0.0.1:6379(main+0x369)[0x55ab8422ca09]
/lib64/libc.so.6(+0x295d0)[0x7f82ad8295d0]
/lib64/libc.so.6(__libc_start_main+0x80)[0x7f82ad829680]
/usr/bin/redis-server 127.0.0.1:6379(_start+0x25)[0x55ab8422cf15]
```


```
redis-check-rdb /var/lib/redis/dump.rdb
[offset 0] Checking RDB file /var/lib/redis/dump.rdb
[offset 27] AUX FIELD redis-ver = '6.2.18'
[offset 41] AUX FIELD redis-bits = '64'
[offset 53] AUX FIELD ctime = '1750385588'
[offset 68] AUX FIELD used-mem = '28616400'
[offset 84] AUX FIELD aof-preamble = '0'
[offset 86] Selecting DB ID 0
[offset 12107] Selecting DB ID 1
[offset 1937098] Selecting DB ID 3
[offset 9885307] Selecting DB ID 10
[offset 11712827] Checksum OK
[offset 11712827] \o/ RDB looks OK! \o/
[info] 12673 keys read
[info] 201 expires
[info] 9 already expired
```

**Additional information**

1. Almalinux: 5.14.0-503.34.1.el9_5.x86_64

",['crash report'],open,2025-06-20T14:18:41Z,,security,['crash report'],True,,
redis/redis,14116,[NEW] Support for GEO filtering with Vector Sets,"**The problem/use-case that the feature addresses**

I would love to be able to filter by geo location with the new vector sets datatype using latitude/longitude and a distance radius.
",['class:feature'],open,2025-06-10T20:29:54Z,,bug,['class:feature'],True,,
redis/redis,14093,[CRASH] Crashing randomly every other day,"**Crash report**

```
276:C 30 May 2025 15:02:12.510 * DB saved on disk
276:C 30 May 2025 15:02:12.530 * Fork CoW for RDB: current 1 MB, peak 1 MB, average 1 MB
1:M 30 May 2025 15:02:12.647 * Background saving terminated with success
1:M 30 May 2025 15:07:18.946 * 100 changes in 300 seconds. Saving...
1:M 30 May 2025 15:07:18.974 * Background saving started by pid 277
277:C 30 May 2025 15:07:21.459 * DB saved on disk
277:C 30 May 2025 15:07:21.485 * Fork CoW for RDB: current 1 MB, peak 1 MB, average 1 MB
1:M 30 May 2025 15:07:21.597 * Background saving terminated with success


=== REDIS BUG REPORT START: Cut & paste starting from here ===
1:M 30 May 2025 15:11:37.925 # Redis 8.0.1 crashed by signal: 11, si_code: 1
1:M 30 May 2025 15:11:37.925 # Accessing address: 0x71a307400000

------ INFO OUTPUT ------
1:signal-handler (1748610697) Crashed running signal handler. Providing reduced version of recursive crash report.
1:M 30 May 2025 15:11:37.925 # Redis 8.0.1 crashed by signal: 11, si_code: 1
1:M 30 May 2025 15:11:37.925 # Accessing address: 0x5c41e3fe94c8

=== REDIS BUG REPORT END. Make sure to include from START to END. ===
```

**Additional information**

1. Im using redis:8.0.1-alpine3.21 docker image
2. I cant seem to reproduce it. The container has crashed once every other day, and im not sure why
3. I have 3 redis docker containers running, and only the one of them are crashing. I am activly using Redisearch in this container, and the other two im not.

Im not sure if this is the right place, or if i should post this in the Redisearch repo..",['crash report'],open,2025-05-30T20:34:16Z,,bug,['crash report'],True,,
redis/redis,14084,[CRASH] Redis 6.2.7 crashed by signal: 11 (kernel version 5.14.0-533.el9.x86_64),"
**Crash report**

Paste the complete crash log between the quotes below. Please include a few lines from the log preceding the crash report to provide some context.

```
=== REDIS BUG REPORT START: Cut & paste starting from here ===
38:M 05 May 2025 20:12:50.333 # Redis 6.2.7 crashed by signal: 11, si_code: 1
38:M 05 May 2025 20:12:50.333 # Accessing address: 0xffffffffffffffff
38:M 05 May 2025 20:12:50.333 # Crashed running the instruction at: 0x4c8c7d

------ STACK TRACE ------
EIP:
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0[0x4c8c7d]

Backtrace:
/lib64/libc.so.6(+0x54de0)[0x7f21c69d9de0]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0[0x4c8c7d]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(activeExpireCycle+0x253)[0x4c8f83]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(databasesCron+0x57)[0x439667]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(serverCron+0x15a)[0x43cdda]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(aeProcessEvents+0xf9)[0x434c89]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(aeMain+0x1d)[0x43508d]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(main+0x309)[0x431289]
/lib64/libc.so.6(+0x3fee0)[0x7f21c69c4ee0]
/lib64/libc.so.6(__libc_start_main+0x80)[0x7f21c69c4f90]
/usr/local/bin/redis-server 0.0.0.0:6340 [cluster] 6340 0(_start+0x25)[0x431725]

------ REGISTERS ------
38:M 05 May 2025 20:12:50.334 #
RAX:0000000000000000 RBX:0000000000000000
RCX:0000000004dcd0d0 RDX:00007f1f37751d80
RDI:0000000000000000 RSI:0000000000000000
RBP:fffffe695deb90e3 RSP:00007fff267b95a0
R8 :0000000000000004 R9 :0000000000000006
R10:00007fff267b95a0 R11:0000000000000000
R12:00007f21c6423140 R13:0000000000000004
R14:0000000000b62766 R15:00000196a2146f1d
RIP:00000000004c8c7d EFL:0000000000010206
CSGSFS:002b000000000033
38:M 05 May 2025 20:12:50.334 # (00007fff267b95af) -> 000634691fd20c42
38:M 05 May 2025 20:12:50.334 # (00007fff267b95ae) -> 00000000000061a8
38:M 05 May 2025 20:12:50.334 # (00007fff267b95ad) -> 0000000000000000
38:M 05 May 2025 20:12:50.334 # (00007fff267b95ac) -> 0000000000000014
38:M 05 May 2025 20:12:50.334 # (00007fff267b95ab) -> 0000000000000000
38:M 05 May 2025 20:12:50.334 # (00007fff267b95aa) -> 0000000100000001
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a9) -> 0000000000000190
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a8) -> 0000000000000014
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a7) -> 0000000000000005
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a6) -> 0000000000000000
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a5) -> 0000000000000001
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a4) -> 00007f21c6423140
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a3) -> 00000000004c8f83
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a2) -> 0000000000000004
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a1) -> fffffe695deb90e3
38:M 05 May 2025 20:12:50.334 # (00007fff267b95a0) -> 0000000068191bc2

```

**Additional information**

1. The issue does not occur when running on kernel version 5.14.0-383.el9.x86_64.
2. The issue is present when running on kernel version 5.14.0-533.el9.x86_64
4. The issue happens in production systems  after running for 1 or 2days 
5. Redis server is running in cluster mode. 
6. Redis server is running in docker container and multiple containers are bin packed to the same baremetal host.
7. In clusters, where  we upgraded kernal of Baremetal host of a single redis server instance to version 5.14.0-533.el9.x86_64, the crash repeatedly occurs to the containerized redis instance once every 1-2 days. The rest of the containerized redis instances running on  kernel version 5.14.0-383.el9.x86_64 have no issues.
8. Heap usage is at 20-30% when the crash occurs. 
9. There is no activity logged in redis logs right before the crash (the previous logged activity is an AOF rewrite logged several minutes ago )
10. Additional crashes

```=== REDIS BUG REPORT START: Cut & paste starting from here ===38:M 06 May 2025 10:03:00.063 # Redis 6.2.7 crashed by signal: 11, si_code: 18:M 06 May 2025 10:03:00.063 # Accessing address: (nil)
38:M 06 May 2025 10:03:00.063 # Crashed running the instruction at: 0x4ce964

------ STACK TRACE ------
EIP:
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(raxRemove+0x284)[0x4ce964]

Backtrace:
/lib64/libc.so.6(+0x54de0)[0x7fd4f5f6cde0]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(raxRemove+0x284)[0x4ce964]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(slotToKeyUpdateKey+0x199)[0x45b8f9]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(dbAsyncDelete+0xe9)[0x4ba2b9]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(deleteExpiredKeyAndPropagate+0x2f)[0x45bb2f]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0[0x4c8cb6]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(activeExpireCycle+0x253)[0x4c8f83]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(databasesCron+0x57)[0x439667]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(serverCron+0x15a)[0x43cdda]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(aeProcessEvents+0xf9)[0x434c89]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(aeMain+0x1d)[0x43508d]
/usr/local/bin/redis-server 0.0.0.0:6310 [cluster] 6310 0(main+0x309)[0x431289]
```


```
=== REDIS BUG REPORT START: Cut & paste starting from here ===
51:C 23 May 2025 14:26:50.669 # Redis 6.2.7 crashed by signal: 11, si_code: 1
51:C 23 May 2025 14:26:50.669 # Accessing address: 0xffffffffffffffff
51:C 23 May 2025 14:26:50.669 # Crashed running the instruction at: 0x466548

------ STACK TRACE ------
EIP:
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rdbSaveObject+0x4b8)[0x466548]

Backtrace:
/lib64/libc.so.6(+0x54de0)[0x7f4b2e406de0]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rdbSaveObject+0x4b8)[0x466548]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rdbSaveKeyValuePair+0x71)[0x466961]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rdbSaveRio+0x21c)[0x4670cc]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rewriteAppendOnlyFile+0x1e6)[0x486566]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(rewriteAppendOnlyFileBackground+0xd9)[0x486c09]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(serverCron+0x7a9)[0x43d429]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(aeProcessEvents+0xf9)[0x434c89]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(aeMain+0x1d)[0x43508d]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(main+0x309)[0x431289]
/lib64/libc.so.6(+0x3fee0)[0x7f4b2e3f1ee0]
/lib64/libc.so.6(__libc_start_main+0x80)[0x7f4b2e3f1f90]
redis-aof-rewrite 0.0.0.0:6340 [cluster] 6340 0(_start+0x25)[0x431725]
```",['crash report'],open,2025-05-28T01:22:30Z,,bug,['crash report'],True,,
redis/redis,14056,"[CRASH] <Redis 7.0.12>crashed by signal: 6, si_code: -6","------ STACK TRACE ------
EIP:
/usr/lib64/libc.so.6(gsignal+0x10b)[0x7f776105046b]

Backtrace:
/usr/lib64/libpthread.so.0(+0x134c0)[0x7f77611e24c0]
/usr/lib64/libc.so.6(gsignal+0x10b)[0x7f776105046b]
/usr/lib64/libc.so.6(abort+0x151)[0x7f7761051791]
/usr/lib64/libc.so.6(+0x31e6a)[0x7f7761048e6a]
/usr/lib64/libc.so.6(+0x31ee2)[0x7f7761048ee2]
./redis-server *:36379(sdsIncrLen+0xc6)[0x456176]
./redis-server *:36379(readQueryFromClient+0x1ff)[0x46a3ef]
./redis-server *:36379[0x50592a]
./redis-server *:36379(aeProcessEvents+0x1a2)[0x444282]
./redis-server *:36379(aeMain+0x1d)[0x44466d]
./redis-server *:36379(main+0x32b)[0x44043b]
/usr/lib64/libc.so.6(__libc_start_main+0xe7)[0x7f776103cb27]
./redis-server *:36379(_start+0x2a)[0x440b0a]

------ REGISTERS ------
2346891:S 18 May 2025 08:19:27.482 # 
RAX:0000000000000000 RBX:0000000000000006
RCX:00007f776105046b RDX:0000000000000000
RDI:0000000000000002 RSI:00007ffddfa73210
RBP:00007f776119a268 RSP:00007ffddfa73210
R8 :0000000000000000 R9 :00007ffddfa73210
R10:0000000000000008 R11:0000000000000246
R12:00000000005ae540 R13:00000000005ae5b8
R14:00000000000001aa R15:0000000000000001
RIP:00007f776105046b EFL:0000000000000246
CSGSFS:002b000000000033
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321f) -> 0000000000000000
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321e) -> 0000000000000000
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321d) -> 0000000000000000
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321c) -> 00000000018857dc
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321b) -> 00000000018856b0
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa7321a) -> 00000000018857dc
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73219) -> 0000000001885739
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73218) -> 00000000018856b0
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73217) -> 00000000018856b0
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73216) -> 0000000001885715
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73215) -> 00000000018856b0
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73214) -> 0000015efbad8000
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73213) -> 00007f7761090c87
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73212) -> 0000000000000001
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73211) -> 00000000018856b0
2346891:S 18 May 2025 08:19:27.482 # (00007ffddfa73210) -> 0000000000000000

------ INFO OUTPUT ------
# Server
redis_version:7.0.12
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:5432b32353acc306
redis_mode:standalone
os:Linux 4.19.90-52.15.v2207.ky10.x86_64 x86_64
arch_bits:64
monotonic_clock:POSIX clock_gettime
multiplexing_api:epoll
atomicvar_api:c11-builtin
gcc_version:7.3.0
process_id:2346891
process_supervised:no
run_id:06763fdc62cfe1a2167f07732ced69689dc6f09b
tcp_port:36379
server_time_usec:1747527567469889
uptime_in_seconds:17848398
uptime_in_days:206
hz:10
configured_hz:10
lru_clock:2697103
executable:/app/bocz/redis-7.0.12/src/./redis-server
config_file:/app/bocz/redis-7.0.12/redis.conf
io_threads_active:0

# Clients
connected_clients:7
cluster_connections:0
maxclients:10000
client_recent_max_input_buffer:20480
client_recent_max_output_buffer:0
blocked_clients:0
tracking_clients:0
clients_in_timeout_table:0

# Memory
used_memory:36942064
used_memory_human:35.23M
used_memory_rss:48488448
used_memory_rss_human:46.24M
used_memory_peak:62248208
used_memory_peak_human:59.36M
used_memory_peak_perc:59.35%
used_memory_overhead:2819156
used_memory_startup:859168
used_memory_dataset:34122908
used_memory_dataset_perc:94.57%
allocator_allocated:37059832
allocator_active:40497152
allocator_resident:44347392
total_system_memory:15439519744
total_system_memory_human:14.38G
used_memory_lua:31744
used_memory_vm_eval:31744
used_memory_lua_human:31.00K
used_memory_scripts_eval:0
number_of_cached_scripts:0
number_of_functions:0
number_of_libraries:0
used_memory_vm_functions:32768
used_memory_vm_total:64512
used_memory_vm_total_human:63.00K
used_memory_functions:184
used_memory_scripts:184
used_memory_scripts_human:184B
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:1.09
allocator_frag_bytes:3437320
allocator_rss_ratio:1.10
allocator_rss_bytes:3850240
rss_overhead_ratio:1.09
rss_overhead_bytes:4141056
mem_fragmentation_ratio:1.31
mem_fragmentation_bytes:11547264
mem_not_counted_for_evict:33976
mem_replication_backlog:1086716
mem_total_replication_buffers:1086712
mem_clients_slaves:0
mem_clients_normal:76480
mem_cluster_links:0
mem_aof_buffer:0
mem_allocator:jemalloc-5.2.1
active_defrag_running:0
lazyfree_pending_objects:0
lazyfreed_objects:0

# Persistence
loading:0
async_loading:0
current_cow_peak:0
current_cow_size:0
current_cow_size_age:0
current_fork_perc:0.00
current_save_keys_processed:0
current_save_keys_total:0
rdb_changes_since_last_save:125
rdb_bgsave_in_progress:0
rdb_last_save_time:1747527452
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:0
rdb_current_bgsave_time_sec:-1
rdb_saves:58263
rdb_last_cow_size:1822720
rdb_last_load_keys_expired:0
rdb_last_load_keys_loaded:11999
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_rewrites:0
aof_rewrites_consecutive_failures:0
aof_last_write_status:ok
aof_last_cow_size:0
module_fork_in_progress:0
module_fork_last_cow_size:0

# Stats
total_connections_received:1077192
total_commands_processed:149542638
instantaneous_ops_per_sec:16
total_net_input_bytes:199539526560
total_net_output_bytes:55000042538
total_net_repl_input_bytes:194991034740
total_net_repl_output_bytes:0
instantaneous_input_kbps:12.17
instantaneous_output_kbps:4.44
instantaneous_input_repl_kbps:11.95
instantaneous_output_repl_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
expire_cycle_cpu_milliseconds:0
evicted_keys:0
evicted_clients:0
total_eviction_exceeded_time:0
current_eviction_exceeded_time:0
keyspace_hits:0
keyspace_misses:2
pubsub_channels:1
pubsub_patterns:0
pubsubshard_channels:0
latest_fork_usec:1541
total_forks:58263
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0
total_active_defrag_time:0
current_active_defrag_time:0
tracking_total_keys:0
tracking_total_items:0
tracking_total_prefixes:0
unexpected_error_replies:0
total_error_replies:5866
dump_payload_sanitizations:0
total_reads_processed:141595050
total_writes_processed:257417105
io_threaded_reads_processed:0
io_threaded_writes_processed:0
reply_buffer_shrinks:5334302
reply_buffer_expands:5333747

# Replication
role:slave
master_host:10.106.96.96
master_port:36379
master_link_status:up
master_last_io_seconds_ago:0
master_sync_in_progress:0
slave_read_repl_offset:261355466348
slave_repl_offset:261355466348
slave_priority:100
slave_read_only:1
replica_announced:1
connected_slaves:0
master_failover_state:no-failover
master_replid:1dbd98479985a5dee4a1552253588aa389db1224
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:261355466348
second_repl_offset:-1
repl_backlog_active:1
repl_backlog_size:1048576
repl_backlog_first_byte_offset:261354397625
repl_backlog_histlen:1068724

# CPU
used_cpu_sys:14527.248176
used_cpu_user:16285.373974
used_cpu_sys_children:738.753618
used_cpu_user_children:4827.441923
used_cpu_sys_main_thread:13936.465339
used_cpu_user_main_thread:15912.230226

# Modules

# Commandstats
cmdstat_del:calls=9360988,usec=80792171,usec_per_call=8.63,rejected_calls=0,failed_calls=0
cmdstat_publish:calls=52537938,usec=396591744,usec_per_call=7.55,rejected_calls=0,failed_calls=0
cmdstat_subscribe:calls=4,usec=14,usec_per_call=3.50,rejected_calls=0,failed_calls=0
cmdstat_decr:calls=154,usec=99,usec_per_call=0.64,rejected_calls=0,failed_calls=0
cmdstat_set:calls=25074462,usec=132860137,usec_per_call=5.30,rejected_calls=0,failed_calls=0
cmdstat_multi:calls=32963,usec=18672,usec_per_call=0.57,rejected_calls=0,failed_calls=0
cmdstat_command:calls=0,usec=0,usec_per_call=0.00,rejected_calls=26,failed_calls=0
cmdstat_command|docs:calls=5,usec=6155,usec_per_call=1231.00,rejected_calls=26,failed_calls=0
cmdstat_get:calls=2,usec=18,usec_per_call=9.00,rejected_calls=0,failed_calls=0
cmdstat_slowlog|get:calls=2,usec=6,usec_per_call=3.00,rejected_calls=0,failed_calls=0
cmdstat_auth:calls=952420,usec=4552606,usec_per_call=4.78,rejected_calls=0,failed_calls=8
cmdstat_lrem:calls=180,usec=2657,usec_per_call=14.76,rejected_calls=0,failed_calls=0
cmdstat_config|get:calls=4,usec=539,usec_per_call=134.75,rejected_calls=0,failed_calls=0
cmdstat_exec:calls=32963,usec=428821,usec_per_call=13.01,rejected_calls=0,failed_calls=0
cmdstat_client|setname:calls=8,usec=10,usec_per_call=1.25,rejected_calls=0,failed_calls=0
cmdstat_flushall:calls=1,usec=3933,usec_per_call=3933.00,rejected_calls=0,failed_calls=0
cmdstat_info:calls=5750878,usec=560596041,usec_per_call=97.48,rejected_calls=4556,failed_calls=0
cmdstat_incr:calls=3566,usec=11814,usec_per_call=3.31,rejected_calls=0,failed_calls=0
cmdstat_rpush:calls=2970,usec=38379,usec_per_call=12.92,rejected_calls=0,failed_calls=0
cmdstat_quit:calls=951554,usec=383724,usec_per_call=0.40,rejected_calls=0,failed_calls=0
cmdstat_ping:calls=54829633,usec=93298561,usec_per_call=1.70,rejected_calls=1246,failed_calls=0
cmdstat_cluster|info:calls=2,usec=8,usec_per_call=4.00,rejected_calls=0,failed_calls=2
cmdstat_cluster|nodes:calls=2,usec=4,usec_per_call=2.00,rejected_calls=0,failed_calls=2
cmdstat_pexpireat:calls=11939,usec=15567,usec_per_call=1.30,rejected_calls=0,failed_calls=0

# Errorstats
errorstat_ERR:count=4
errorstat_NOAUTH:count=5854
errorstat_WRONGPASS:count=8

# Latencystats
latency_percentiles_usec_del:p50=8.031,p99=23.039,p99.9=43.007
latency_percentiles_usec_publish:p50=7.007,p99=32.127,p99.9=56.063
latency_percentiles_usec_subscribe:p50=3.007,p99=5.023,p99.9=5.023
latency_percentiles_usec_decr:p50=1.003,p99=2.007,p99.9=3.007
latency_percentiles_usec_set:p50=4.015,p99=23.039,p99.9=45.055
latency_percentiles_usec_multi:p50=1.003,p99=2.007,p99.9=11.007
latency_percentiles_usec_command|docs:p50=1236.991,p99=1253.375,p99.9=1253.375
latency_percentiles_usec_get:p50=5.023,p99=13.055,p99.9=13.055
latency_percentiles_usec_slowlog|get:p50=3.007,p99=3.007,p99.9=3.007
latency_percentiles_usec_auth:p50=4.015,p99=25.087,p99.9=41.215
latency_percentiles_usec_lrem:p50=13.055,p99=41.215,p99.9=53.247
latency_percentiles_usec_config|get:p50=20.095,p99=272.383,p99.9=272.383
latency_percentiles_usec_exec:p50=12.031,p99=31.103,p99.9=52.223
latency_percentiles_usec_client|setname:p50=1.003,p99=3.007,p99.9=3.007
latency_percentiles_usec_flushall:p50=3948.543,p99=3948.543,p99.9=3948.543
latency_percentiles_usec_info:p50=96.255,p99=149.503,p99.9=197.631
latency_percentiles_usec_incr:p50=2.007,p99=22.015,p99.9=28.031
latency_percentiles_usec_rpush:p50=10.047,p99=47.103,p99.9=69.119
latency_percentiles_usec_quit:p50=0.001,p99=1.003,p99.9=9.023
latency_percentiles_usec_ping:p50=2.007,p99=8.031,p99.9=18.047
latency_percentiles_usec_cluster|info:p50=2.007,p99=6.015,p99.9=6.015
latency_percentiles_usec_cluster|nodes:p50=1.003,p99=3.007,p99.9=3.007
latency_percentiles_usec_pexpireat:p50=1.003,p99=9.023,p99.9=15.039

# Cluster
cluster_enabled:0

# Keyspace
db0:keys=8912,expires=7416,avg_ttl=0

------ CLIENT LIST OUTPUT ------
id=3 addr=10.106.96.96:36379 laddr=10.106.96.95:33080 fd=12 name= age=17848397 idle=0 flags=M db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=0 argv-mem=0 multi-mem=0 rbs=1024 rbp=46 obl=0 oll=0 omem=0 tot-mem=42752 events=r cmd=set user=(superuser) redir=-1 resp=2
id=4 addr=10.106.96.94:49064 laddr=10.106.96.95:36379 fd=8 name=sentinel-070a7353-cmd age=17848397 idle=1 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=20474 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=0 omem=0 tot-mem=22272 events=r cmd=ping user=default redir=-1 resp=2
id=5 addr=10.106.96.94:49080 laddr=10.106.96.95:36379 fd=9 name=sentinel-070a7353-pubsub age=17848397 idle=1 flags=P db=0 sub=1 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=0 argv-mem=0 multi-mem=0 rbs=1024 rbp=280 obl=0 oll=0 omem=0 tot-mem=1856 events=r cmd=subscribe user=default redir=-1 resp=2
id=6 addr=10.106.96.92:40054 laddr=10.106.96.95:36379 fd=10 name=sentinel-1a644222-cmd age=17848397 idle=0 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=20474 argv-mem=0 multi-mem=0 rbs=1024 rbp=0 obl=0 oll=0 omem=0 tot-mem=22272 events=r cmd=ping user=default redir=-1 resp=2
id=7 addr=10.106.96.92:40058 laddr=10.106.96.95:36379 fd=11 name=sentinel-1a644222-pubsub age=17848397 idle=1 flags=P db=0 sub=1 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=0 argv-mem=0 multi-mem=0 rbs=1024 rbp=280 obl=0 oll=0 omem=0 tot-mem=1856 events=r cmd=subscribe user=default redir=-1 resp=2
id=573635 addr=10.106.96.93:39838 laddr=10.106.96.95:36379 fd=13 name=sentinel-06c4c7a5-pubsub age=8344478 idle=1 flags=P db=0 sub=1 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=0 argv-mem=0 multi-mem=0 rbs=1024 rbp=280 obl=0 oll=0 omem=0 tot-mem=1856 events=r cmd=subscribe user=default redir=-1 resp=2
id=573636 addr=10.106.96.93:39822 laddr=10.106.96.95:36379 fd=14 name=sentinel-06c4c7a5-cmd age=8344478 idle=1 flags=N db=0 sub=0 psub=0 ssub=0 multi=-1 qbuf=0 qbuf-free=20474 argv-mem=0 multi-mem=0 rbs=2048 rbp=1024 obl=0 oll=0 omem=0 tot-mem=23296 events=r cmd=ping user=default redir=-1 resp=2

------ MODULES INFO OUTPUT ------

------ CONFIG DEBUG OUTPUT ------
io-threads 1
sanitize-dump-payload no
activedefrag no
lazyfree-lazy-expire no
lazyfree-lazy-user-del no
slave-read-only yes
lazyfree-lazy-server-del no
lazyfree-lazy-user-flush no
list-compress-depth 0
io-threads-do-reads no
repl-diskless-load disabled
replica-read-only yes
client-query-buffer-limit 1gb
lazyfree-lazy-eviction no
proto-max-bulk-len 512mb
repl-diskless-sync yes

------ FAST MEMORY TEST ------
2346891:S 18 May 2025 08:19:27.483 # Bio thread for job type #0 terminated
2346891:S 18 May 2025 08:19:27.483 # Bio thread for job type #1 terminated
2346891:S 18 May 2025 08:19:27.483 # Bio thread for job type #2 terminated
*** Preparing to test memory region 68b000 (2301952 bytes)
*** Preparing to test memory region 186e000 (135168 bytes)
*** Preparing to test memory region 7f774cbca000 (78643200 bytes)
*** Preparing to test memory region 7f77516cb000 (8388608 bytes)
*** Preparing to test memory region 7f7751ecc000 (8388608 bytes)
*** Preparing to test memory region 7f77526cd000 (8388608 bytes)
*** Preparing to test memory region 7f7752ece000 (8388608 bytes)
*** Preparing to test memory region 7f7760400000 (8388608 bytes)
*** Preparing to test memory region 7f7760d81000 (24576 bytes)
*** Preparing to test memory region 7f7760e42000 (8192 bytes)
*** Preparing to test memory region 7f7760fb0000 (8192 bytes)
*** Preparing to test memory region 7f7761015000 (8192 bytes)
*** Preparing to test memory region 7f77611cb000 (16384 bytes)
*** Preparing to test memory region 7f77611ec000 (16384 bytes)
*** Preparing to test memory region 7f7761299000 (4096 bytes)
*** Preparing to test memory region 7f776142d000 (8192 bytes)
*** Preparing to test memory region 7f776144b000 (4096 bytes)
*** Preparing to test memory region 7f7761474000 (4096 bytes)
.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O.O
Fast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.

------ DUMPING CODE AROUND EIP ------
Symbol: gsignal (base: 0x7f7761050360)
Module: /usr/lib64/libc.so.6 (base 0x7f7761017000)
$ xxd -r -p /tmp/dump.hex /tmp/dump.bin
$ objdump --adjust-vma=0x7f7761050360 -D -b binary -m i386:x86-64 /tmp/dump.bin
------
2346891:S 18 May 2025 08:19:28.171 # dump of function (hexdump of 395 bytes):
5349c7c0ffffffff89fb41ba0800000031ff4881ec1001000064488b042528000000488984240801000031c04989e148b8ffffff7ffeffffff4c8984248800000048898424800000004c89842490000000488db424800000004c898424980000004c898424a00000004c89ca4c898424a80000004c898424b0000000b80e0000004c898424b80000004c898424c00000004c898424c80000004c898424d00000004c898424d80000004c898424e00000004c898424e80000004c898424f00000004c898424f80000000f05b92700000089c80f054889c7b8ba0000000f0589c689dab8ea0000000f05483d00f0ffff773f4189c041ba0800000031d24c89cebf02000000b80e0000000f05488b8c24080100006448330c25280000004489c0751d4881c4100100005bc3660f1f440000488b15d1791700f7d8648902ebb6e85d040d00662e0f1f8400000000000f1f0085ff780cf7dfe9950200000f1f440000488b05a179170064c70016000000b8ffffffffc3662e0f1f84000000000066909066662e0f1f8400000000

=== REDIS BUG REPORT END. Make sure to include from START to END. ===

       Please report the crash by opening an issue on github:

           http://github.com/redis/redis/issues

  If a Redis module was involved, please open in the module's repo instead.

  Suspect RAM error? Use redis-server --test-memory to verify it.

  Some other issues could be detected by redis-server --check-system",['crash report'],open,2025-05-19T02:31:17Z,,performance,['crash report'],True,,
redis/redis,13933,redis on start up,"so, i downloaded redis via chocolatey for windows as i need it for a project, but when i tried using it i noticed that every time my pc starts up i need to manually turn on redis every time by typing redis-server, i also tried downloading redis via wsl in which i found that the command sudo systemctl enable redis-server automatically starts redis in the background. i also had experience with redis on mac and the command brew services start redis also starts redis on startup. now back to the window's chocolatey version i tried using the command redis-server --daemonize yes, and went to the redis.conf file and set daemon to yes as well and none of that worked, is there a command to automatically start redis on startup of pc?",['state:to-be-closed'],closed,2025-04-09T22:50:44Z,2025-04-10T20:01:08Z,bug,['state:to-be-closed'],True,0.0,
redis/redis,13902,"Upgrade RediSearch-2.10.15, but unable to start redis","I compile and install for Redisearch 2.10.15 in Alpine linux,  but restart redis output:

P.S. redisearch 2.10.12 is ok. 

=== REDIS BUG REPORT START: Cut & paste starting from here ===
1:M 26 Mar 2025 18:45:49.966 # Redis 7.4.2 crashed by signal: 11, si_code: 1
1:M 26 Mar 2025 18:45:49.967 # Accessing address: 0

------ INFO OUTPUT ------
# Server
redis_version:7.4.2
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:e3436508b9b6fcbb
redis_mode:standalone
os:Linux 6.13.7-orbstack-00283-g9d1400e7e9c6 aarch64
arch_bits:64
monotonic_clock:POSIX clock_gettime
multiplexing_api:epoll
atomicvar_api:c11-builtin
gcc_version:14.2.0
process_id:1
process_supervised:no
run_id:47f0395b57e0d52263403d86f1bbaeced646823e
tcp_port:6379
server_time_usec:1742985949966640
uptime_in_seconds:0
uptime_in_days:0
hz:10
configured_hz:10
lru_clock:14932701
executable:/data/redis-server
config_file:/etc/redis/redis.conf
io_threads_active:0

# Clients
connected_clients:0
cluster_connections:0
maxclients:10000
client_recent_max_input_buffer:0
client_recent_max_output_buffer:0
blocked_clients:0
tracking_clients:0
pubsub_clients:0
watching_clients:0
clients_in_timeout_table:0
total_watched_keys:0
total_blocking_keys:0
total_blocking_keys_on_nokey:0

# Memory
used_memory:1081952
used_memory_human:1.03M
used_memory_rss:0
used_memory_rss_human:0B
used_memory_peak:1081952
used_memory_peak_human:1.03M
used_memory_peak_perc:100.17%
used_memory_overhead:192
used_memory_startup:0
used_memory_dataset:1081760
used_memory_dataset_perc:99.98%
allocator_allocated:0
allocator_active:0
allocator_resident:0
allocator_muzzy:0
total_system_memory:8386043904
total_system_memory_human:7.81G
used_memory_lua:31744
used_memory_vm_eval:31744
used_memory_lua_human:31.00K
used_memory_scripts_eval:0
number_of_cached_scripts:0
number_of_functions:0
number_of_libraries:0
used_memory_vm_functions:32768
used_memory_vm_total:64512
used_memory_vm_total_human:63.00K
used_memory_functions:192
used_memory_scripts:192
used_memory_scripts_human:192B
maxmemory:0
maxmemory_human:0B
maxmemory_policy:noeviction
allocator_frag_ratio:nan
allocator_frag_bytes:0
allocator_rss_ratio:nan
allocator_rss_bytes:0
rss_overhead_ratio:nan
rss_overhead_bytes:0
mem_fragmentation_ratio:nan
mem_fragmentation_bytes:0
mem_not_counted_for_evict:0
mem_replication_backlog:0
mem_total_replication_buffers:0
mem_clients_slaves:0
mem_clients_normal:0
mem_cluster_links:0
mem_aof_buffer:0
mem_allocator:jemalloc-5.3.0
mem_overhead_db_hashtable_rehashing:0
active_defrag_running:0
lazyfree_pending_objects:0
lazyfreed_objects:0

# Persistence
loading:0
async_loading:0
current_cow_peak:0
current_cow_size:0
current_cow_size_age:0
current_fork_perc:0.00
current_save_keys_processed:0
current_save_keys_total:0
rdb_changes_since_last_save:0
rdb_bgsave_in_progress:0
rdb_last_save_time:1742985949
rdb_last_bgsave_status:ok
rdb_last_bgsave_time_sec:-1
rdb_current_bgsave_time_sec:-1
rdb_saves:0
rdb_last_cow_size:0
rdb_last_load_keys_expired:0
rdb_last_load_keys_loaded:0
aof_enabled:0
aof_rewrite_in_progress:0
aof_rewrite_scheduled:0
aof_last_rewrite_time_sec:-1
aof_current_rewrite_time_sec:-1
aof_last_bgrewrite_status:ok
aof_rewrites:0
aof_rewrites_consecutive_failures:0
aof_last_write_status:ok
aof_last_cow_size:0
module_fork_in_progress:0
module_fork_last_cow_size:0

# Stats
total_connections_received:0
total_commands_processed:3
instantaneous_ops_per_sec:0
total_net_input_bytes:0
total_net_output_bytes:0
total_net_repl_input_bytes:0
total_net_repl_output_bytes:0
instantaneous_input_kbps:0.00
instantaneous_output_kbps:0.00
instantaneous_input_repl_kbps:0.00
instantaneous_output_repl_kbps:0.00
rejected_connections:0
sync_full:0
sync_partial_ok:0
sync_partial_err:0
expired_subkeys:0
expired_keys:0
expired_stale_perc:0.00
expired_time_cap_reached_count:0
expire_cycle_cpu_milliseconds:0
evicted_keys:0
evicted_clients:0
evicted_scripts:0
total_eviction_exceeded_time:0
current_eviction_exceeded_time:0
keyspace_hits:0
keyspace_misses:0
pubsub_channels:0
pubsub_patterns:0
pubsubshard_channels:0
latest_fork_usec:0
total_forks:0
migrate_cached_sockets:0
slave_expires_tracked_keys:0
active_defrag_hits:0
active_defrag_misses:0
active_defrag_key_hits:0
active_defrag_key_misses:0
total_active_defrag_time:0
current_active_defrag_time:0
tracking_total_keys:0
tracking_total_items:0
tracking_total_prefixes:0
unexpected_error_replies:0
total_error_replies:0
dump_payload_sanitizations:0
total_reads_processed:0
total_writes_processed:0
io_threaded_reads_processed:0
io_threaded_writes_processed:0
client_query_buffer_limit_disconnections:0
client_output_buffer_limit_disconnections:0
reply_buffer_shrinks:0
reply_buffer_expands:0
eventloop_cycles:0
eventloop_duration_sum:0
eventloop_duration_cmd_sum:0
instantaneous_eventloop_cycles_per_sec:0
instantaneous_eventloop_duration_usec:0
acl_access_denied_auth:0
acl_access_denied_cmd:0
acl_access_denied_key:0
acl_access_denied_channel:0

# Replication
role:master
connected_slaves:0
master_failover_state:no-failover
master_replid:cd47c69ee6270495b4f6b63901a880f979e46a52
master_replid2:0000000000000000000000000000000000000000
master_repl_offset:0
second_repl_offset:-1
repl_backlog_active:0
repl_backlog_size:1048576
repl_backlog_first_byte_offset:0
repl_backlog_histlen:0

# CPU
used_cpu_sys:0.014116
used_cpu_user:0.015202
used_cpu_sys_children:0.001000
used_cpu_user_children:0.000997
used_cpu_sys_main_thread:0.014219
used_cpu_user_main_thread:0.014219

# Modules

# Commandstats
cmdstat_info:calls=2,usec=28,usec_per_call=14.00,rejected_calls=0,failed_calls=0
cmdstat_config|get:calls=1,usec=3,usec_per_call=3.00,rejected_calls=0,failed_calls=0

# Errorstats

# Latencystats
latency_percentiles_usec_info:p50=4.015,p99=24.063,p99.9=24.063
latency_percentiles_usec_config|get:p50=3.007,p99=3.007,p99.9=3.007

# Cluster
cluster_enabled:0

# Keyspace

------ CLIENT LIST OUTPUT ------

------ MODULES INFO OUTPUT ------

------ CONFIG DEBUG OUTPUT ------
sanitize-dump-payload no
client-query-buffer-limit 1gb
slave-read-only yes
lazyfree-lazy-user-flush no
io-threads-do-reads no
io-threads 1
lazyfree-lazy-user-del no
activedefrag no
proto-max-bulk-len 512mb
lazyfree-lazy-expire no
replica-read-only yes
repl-diskless-load disabled
lazyfree-lazy-eviction no
repl-diskless-sync yes
list-compress-depth 0
lazyfree-lazy-server-del no

------ FAST MEMORY TEST ------
*** Preparing to test memory region aaaae7a84000 (704512 bytes)
*** Preparing to test memory region aaaaf7525000 (12288 bytes)
*** Preparing to test memory region ffff933b3000 (16384 bytes)
*** Preparing to test memory region ffff93a7e000 (8192 bytes)
*** Preparing to test memory region ffff93a80000 (9961472 bytes)
*** Preparing to test memory region ffff94500000 (13631488 bytes)
*** Preparing to test memory region ffff9527a000 (81920 bytes)
*** Preparing to test memory region ffff952bf000 (4096 bytes)
*** Preparing to test memory region ffff95311000 (233472 bytes)
*** Preparing to test memory region ffff9534a000 (8192 bytes)
*** Preparing to test memory region ffff9574f000 (12288 bytes)
*** Preparing to test memory region ffff958c8000 (94208 bytes)
*** Preparing to test memory region ffff958e0000 (4096 bytes)
*** Preparing to test memory region ffff958e7000 (8192 bytes)
.O.O.O.O.O.O.O.O.O.O.O.O.O.O
Fast memory test PASSED, however your memory can still be broken. Please run a memory test for several hours if possible.

=== REDIS BUG REPORT END. Make sure to include from START to END. ===

       Please report the crash by opening an issue on github:

           http://github.com/redis/redis/issues

  If a Redis module was involved, please open in the module's repo instead.

  Suspect RAM error? Use redis-server --test-memory to verify it.

  Some other issues could be detected by redis-server --check-system",['state:to-be-closed'],closed,2025-03-30T07:05:01Z,2025-04-07T07:08:21Z,bug,['state:to-be-closed'],True,8.0,
redis/redis,13636,BUG: Redis Sentinel (7.2.4) liveness or readiness probe timeout,"We’re encountering an issue with Redis in Sentinel mode. Everything works as expected, but the Redis and Sentinel containers in the pod are reporting timeouts on probes. Fortunately, the containers are not restarting. 
Somebody also reported similar issue in the https://github.com/bitnami/charts/issues/29985  

If I exec into the pod and run some of the probes directly (e.g. /health/redis_liveness.sh) everything works as expected and response is PONG and RC is correctly 0.  

```yaml
Events:
  Type     Reason     Age                      From     Message
  ----     ------     ----                     ----     -------
  Warning  Unhealthy  37m (x619 over 2d18h)    kubelet  Liveness probe failed: command ""sh -c /health/redis_liveness.sh"" timed out
  Warning  Unhealthy  22m (x638 over 2d18h)    kubelet  Liveness probe failed: command ""sh -c /health/sentinel_liveness.sh"" timed out
  Warning  Unhealthy  12m (x664 over 2d18h)    kubelet  Readiness probe failed: command ""sh -c /health/redis_readiness.sh"" timed out
  Warning  Unhealthy  2m48s (x652 over 2d18h)  kubelet  Readiness probe failed: command ""sh -c /health/sentinel_liveness.sh"" timed out
```

```yaml
        livenessProbe:
          exec:
            command:
            - sh
            - -c
            - /health/redis_liveness.sh
          failureThreshold: 5
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 40

        readinessProbe:
          exec:
            command:
            - sh
            - -c
            - /health/redis_readiness.sh
          failureThreshold: 5
          initialDelaySeconds: 30
          periodSeconds: 20
          successThreshold: 1
          timeoutSeconds: 40
```

**To reproduce**

Run Sentinel mode of Redis i 3 replicas.

**Expected behavior**

No timeouts on probes.

**Additional information**
Kubernetes 1.30.5
OS: Ubuntu 22.04.5 LTS   
Kernel: 5.15.0-122-generic   
CNI: Cilium 1.16.2
containerd://1.6.30",['sentinel'],open,2024-11-04T12:28:50Z,,security,['sentinel'],True,,
redis/redis,13628,[BUG] Unexpected behavior of XREAD STREAMS stream +,"**Describe the bug**

After last element of stream was removed, `XREAD STREAMS stream +` returns `nil`, but stream is not empty.

**To reproduce**

```
127.0.0.1:6379> XADD stream * f 1
""1730271076300-0""
127.0.0.1:6379> XADD stream * f 2
""1730271126476-0""
127.0.0.1:6379> XREAD STREAMS stream +
1) 1) ""stream""
   2) 1) 1) ""1730271126476-0""
         2) 1) ""f""
            2) ""2""
127.0.0.1:6379> XREVRANGE stream + - COUNT 1
1) 1) ""1730271126476-0""
   2) 1) ""f""
      2) ""2""
127.0.0.1:6379> XDEL stream 1730271126476-0
(integer) 1
127.0.0.1:6379> XREVRANGE stream + - COUNT 1
1) 1) ""1730271076300-0""
   2) 1) ""f""
      2) ""1""
127.0.0.1:6379> XREAD STREAMS stream +
(nil)
127.0.0.1:6379>
```

**Expected behavior**

The same as for `XREVRANGE stream + - COUNT 1`

**Additional information**

Redis server info:

```
redis_version:7.4.1
redis_git_sha1:00000000
redis_git_dirty:0
redis_build_id:7fd3520e9c14a41b
redis_mode:standalone
os:Linux 5.16.17-sun50iw6 aarch64
arch_bits:64
monotonic_clock:POSIX clock_gettime
multiplexing_api:epoll
atomicvar_api:c11-builtin
gcc_version:10.2.1
```

apt version: `6:7.4.1-1rl1~bullseye1` installed from `https://packages.redis.io/deb`",['class:bug'],closed,2024-10-30T07:11:08Z,2025-02-25T05:40:25Z,bug,['class:bug'],True,117.0,
redis/redis,13612,[BUG] High RSS Memory Usage Even with Active Defrag,"**Describe the bug**

Hello! We have been observing a strange issue since upgrading our redis standalone servers from 6.2.5 to 7.2.5. Occasionally, one of our redis servers will start growing in RSS memory until the system is running out of memory. We have activedefrag enabled and it starts running during this time but it doesn't seem to help. Can someone help take a look and see what is going on? I captured some data when this occurred last. If we need more data I will have to wait until it happens again to get back with it.


`MEMORY STATS`
```
 1) ""peak.allocated""
 2) (integer) 9155310640
 3) ""total.allocated""
 4) (integer) 9088238672
 5) ""startup.allocated""
 6) (integer) 859496
 7) ""replication.backlog""
 8) (integer) 0
 9) ""clients.slaves""
10) (integer) 0
11) ""clients.normal""
12) (integer) 18185184
13) ""cluster.links""
14) (integer) 0
15) ""aof.buffer""
16) (integer) 0
17) ""lua.caches""
18) (integer) 1416
19) ""functions.caches""
20) (integer) 184
21) ""db.0""
22) 1) ""overhead.hashtable.main""
    2) (integer) 547207768
    3) ""overhead.hashtable.expires""
    4) (integer) 382011752
    5) ""overhead.hashtable.slot-to-keys""
    6) (integer) 0
23) ""overhead.total""
24) (integer) 948265800
25) ""keys.count""
26) (integer) 10324751
27) ""keys.bytes-per-key""
28) (integer) 880
29) ""dataset.bytes""
30) (integer) 8139972872
31) ""dataset.percentage""
32) ""89.57447814941406""
33) ""peak.percentage""
34) ""99.26740264892578""
35) ""allocator.allocated""
36) (integer) 9088373168
37) ""allocator.active""
38) (integer) 12528521216
39) ""allocator.resident""
40) (integer) 12667953152
41) ""allocator-fragmentation.ratio""
42) ""1.3785219192504883""
43) ""allocator-fragmentation.bytes""
44) (integer) 3440148048
45) ""allocator-rss.ratio""
46) ""1.0111291408538818""
47) ""allocator-rss.bytes""
48) (integer) 139431936
49) ""rss-overhead.ratio""
50) ""0.9998315572738647""
51) ""rss-overhead.bytes""
52) (integer) -2134016
53) ""fragmentation""
54) ""1.393649697303772""
55) ""fragmentation.bytes""
56) (integer) 3577581536
```

`MALLOC-STATS`
```
___ Begin jemalloc statistics ___
Version: ""5.3.0-0-g0""
Build-time option settings
  config.cache_oblivious: false
  config.debug: false
  config.fill: true
  config.lazy_lock: false
  config.malloc_conf: """"
  config.opt_safety_checks: false
  config.prof: false
  config.prof_libgcc: false
  config.prof_libunwind: false
  config.stats: true
  config.utrace: false
  config.xmalloc: false
Run-time option settings
  opt.abort: false
  opt.abort_conf: false
  opt.cache_oblivious: false
  opt.confirm_conf: false
  opt.retain: true
  opt.dss: ""secondary""
  opt.narenas: 8
  opt.percpu_arena: ""disabled""
  opt.oversize_threshold: 8388608
  opt.hpa: false
  opt.hpa_slab_max_alloc: 65536
  opt.hpa_hugification_threshold: 1992294
  opt.hpa_hugify_delay_ms: 10000
  opt.hpa_min_purge_interval_ms: 5000
  opt.hpa_dirty_mult: ""0.25""
  opt.hpa_sec_nshards: 4
  opt.hpa_sec_max_alloc: 32768
  opt.hpa_sec_max_bytes: 262144
  opt.hpa_sec_bytes_after_flush: 131072
  opt.hpa_sec_batch_fill_extra: 0
  opt.metadata_thp: ""disabled""
  opt.mutex_max_spin: 600
  opt.background_thread: false (background_thread: true)
  opt.dirty_decay_ms: 10000 (arenas.dirty_decay_ms: 10000)
  opt.muzzy_decay_ms: 0 (arenas.muzzy_decay_ms: 0)
  opt.lg_extent_max_active_fit: 6
  opt.junk: ""false""
  opt.zero: false
  opt.tcache: true
  opt.tcache_max: 32768
  opt.tcache_nslots_small_min: 20
  opt.tcache_nslots_small_max: 200
  opt.tcache_nslots_large: 20
  opt.lg_tcache_nslots_mul: 1
  opt.tcache_gc_incr_bytes: 65536
  opt.tcache_gc_delay_bytes: 0
  opt.lg_tcache_flush_small_div: 1
  opt.lg_tcache_flush_large_div: 1
  opt.thp: ""default""
  opt.stats_print: false
  opt.stats_print_opts: """"
  opt.stats_print: false
  opt.stats_print_opts: """"
  opt.stats_interval: -1
  opt.stats_interval_opts: """"
  opt.zero_realloc: ""free""
Arenas: 9
Quantum size: 8
Page size: 4096
Maximum thread-cached size class: 32768
Number of bin size classes: 39
Number of thread-cache bin size classes: 44
Number of large size classes: 196
Allocated: 9088438136, active: 12537638912, metadata: 139436448 (n_thp 0), resident: 12677103616, mapped: 12690853888, retained: 1994452992
Count of realloc(non-null-ptr, 0) calls: 0
Background threads: 1, num_runs: 74773, run_interval: 9706952082 ns
                           n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds
background_thread            15920251      21               0       0               0       0               1       0               0         0               0           0
max_per_bg_thd                8447672      11               0       0               0       0               3       0               0         0               0           0
ctl                          31840495      43               0       0               0       0               1       0               0         0               0           0
prof                                0       0               0       0               0       0               0       0               0         0               0           0
prof_thds_data                      0       0               0       0               0       0               0       0               0         0               0           0
prof_dump                           0       0               0       0               0       0               0       0               0         0               0           0
prof_recent_alloc                   0       0               0       0               0       0               0       0               0         0               0           0
prof_recent_dump                    0       0               0       0               0       0               0       0               0         0               0           0
prof_stats                          0       0               0       0               0       0               0       0               0         0               0           0
Merged arenas stats:
assigned threads: 1
uptime: 725830571650076
dss allocation precedence: ""N/A""
decaying:  time       npages       sweeps     madvises       purged
   dirty:   N/A           30        59808       593498      1893267
   muzzy:   N/A            0            0            0            0
                            allocated         nmalloc   (#/sec)         ndalloc   (#/sec)       nrequests   (#/sec)           nfill   (#/sec)          nflush   (#/sec)
small:                     8760041336       554242742       763       446073706       614     67182704643     92559        85734598       118        29525034        40
large:                      328396800         1215150         1         1214086         1        11320091        15         1215150         1          859012         1
total:                     9088438136       555457892       765       447287792       616     67194024734     92575        86949748       119        30384046        41

active:                   12537638912
mapped:                   12690853888
retained:                  1994452992
base:                       139338144
internal:                       98304
metadata_thp:                       0
tcache_bytes:                  103760
tcache_stashed_bytes:               0
resident:                 12677103616
abandoned_vm:                       0
extent_avail:                       1
                           n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds
large                        15829375      21               0       0               0       0               2       0               0         0               0           0
extent_avail                 17998331      24               0       0               2       0          104942       0               0         0               0           0
extents_dirty                22838844      31               0       0              58       0          119674       0               0         0               0           0
extents_muzzy                15864762      21               0       0               0       0               2       0               0         0               0           0
extents_retained             17626774      24               0       0               6       0          119698       0               0         0               0           0
decay_dirty                  17250502      23               0       0               1       0          297186       0               0         0               0           0
decay_muzzy                  15978550      22               0       0               0       0          296934       0               0         0               0           0
base                         32529371      44               0       0               0       0               2       0               0         0               0           0
tcache_list                  15829376      21               0       0               0       0               2       0               0         0               0           0
hpa_shard                           0       0               0       0               0       0               0       0               0         0               0           0
hpa_shard_grow                      0       0               0       0               0       0               0       0               0         0               0           0
hpa_sec                             0       0               0       0               0       0               0       0               0         0               0           0
bins:           size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests   (#/sec)  nshards      curregs     curslabs  nonfull_slabs regs pgs   util       nfills (#/sec)     nflushes (#/sec)       nslabs     nreslabs (#/sec)      n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds
                   8   0         5992      1460121       2      1459372       2    165227552       227        1          749            2              0  512   1  0.731       908665       1       751437       1           19        15835       0        17489496      24               0       0               0       0               2       0               0         0               0           0
                  16   1    165063952     53338498      73     43022001      59  19912092842     27433        1     10316497        42768          21276  256   1  0.942     10855872      14      1551039       2        78512     23817166      32        73137144     100               0       0               0       0         6578224       9               0         0               0           0
                  24   2    865151040    164045682     226    127997722     176   8437774623     11625        1     36047960        73048          55411  512   3  0.963     14373712      19      2039254       2        95160     65526118      90       198481414     273               0       0               0       0        24699694      34               0         0               0           0
                  32   3    328121216     47508388      65     37254600      51  11295660858     15562        1     10253788        85030          40353  128   1  0.942      6842004       9      1592562       2       158625     18131374      24        69605730      95               0       0               0       0         7114564       9               0         0               0           0
                  40   4         5440       534324       0       534188       0   2931833591      4039        1          136            1              0  512   5  0.265       521512       0       251277       0            1            0       0        16602165      22               0       0               0       0               2       0               0         0               0           0
                  48   5       109056      1985674       2      1983402       2    354711849       488        1         2272           21             15  256   3  0.422      1258241       1      1048496       1          353       817728       1        18185250      25               0       0               0       0           57184       0               0         0               0           0
                  56   6    905802688     71069706      97     54894658      75   1922065392      2648        1     16175048        33453          17199  512   7  0.944      9502332      13      1586140       2        54004     24549924      33        94025222     129               0       0               0       0        10067686      13               0         0               0           0
                  64   7    220889984     20255554      27     16804148      23   9163599655     12624        1      3451406        57263          27030   64   1  0.941      3259472       4      1498164       2       134042      7486391      10        37275666      51               0       0               0       0         2912754       4               0         0               0           0
                  80   8     68633040     10648106      14      9790193      13   4291824716      5912        1       857913         3689           3351  256   5  0.908      2192822       3      1504358       2        13474      4109182       5        26367533      36               0       0               0       0         1574130       2               0         0               0           0
                  96   9     17339232      2499640       3      2319023       3    859528950      1184        1       180617         1532            682  128   3  0.921      1000405       1      1121574       1         4790      1638823       2        18579568      25               0       0               0       0          370174       0               0         0               0           0
                 112  10     62473936      5700197       7      5142394       7    574210007       791        1       557803         2320           1654  256   7  0.939      2136234       2      1322845       1         5747      3710376       5        20741666      28               0       0               0       0          476220       0               0         0               0           0
                 128  11     80135040     18561135      25     17935080      24    337172693       464        1       626055        22087          19550   32   1  0.885      6767882       9      1566604       2       107037     12767896      17        32374751      44               0       0               0       0         1755476       2               0         0               0           0
                 160  12   2426561600     56990302      78     41824292      57   2579470684      3553        1     15166010       119315          44864  128   5  0.993      7166304       9      1513051       2       186127     23672807      32        88689395     122               0       0               0       0        12148526      16               0         0               0           0
                 192  13   1408278144     31675569      43     24340787      33   2049712618      2823        1      7334782       119689          58758   64   3  0.957      5002488       6      1479207       2       200693     12090507      16        52419929      72               0       0               0       0         6362682       8               0         0               0           0
                 224  14    949042304     29418908      40     25182112      34   2048964999      2822        1      4236796        74111          69745  128   7  0.446      2849561       3      1491051       2       110749      8303720      11        60875629      83               0       0               0       0         1408028       1               0         0               0           0
                 256  15     20811776      1491703       2      1410407       1     44440621        61        1        81296         5296           1595   16   1  0.959       747211       1       776031       1        21314      1062821       1        17647301      24               0       0               0       0          228230       0               0         0               0           0
                 320  16    322758720     17105458      23     16096837      22    163920020       225        1      1008621       115337         111938   64   5  0.136      1210962       1      1267071       1       206011      1561018       2        48252296      66               0       0               0       0         1153456       1               0         0               0           0
                 384  17    492847104      4230320       5      2946864       4     22604066        31        1      1283456        40108              0   32   3      1      1338847       1      1067491       1        67691      1704949       2        20171049      27               0       0               0       0          333398       0               0         0               0           0
                 448  18     13349056      1277906       1      1248109       1      3152267         4        1        29797          475            213   64   7  0.980      1040379       1       630996       0         1311      1153062       1        17614587      24               0       0               0       0           63762       0               0         0               0           0
                 512  19     40167936      1413530       1      1335077       1      3221982         4        1        78453         9822            119    8   1  0.998       968131       1       722665       0        27368      1087814       1        17760997      24               0       0               0       0           98412       0               0         0               0           0
                 640  20    116151680      1510154       2      1328667       1      3868401         5        1       181487         5672              0   32   5  0.999       984093       1       630889       0        11067      1151388       1        17813467      24               0       0               0       0           51560       0               0         0               0           0
                 768  21    130656000       800815       1       630690       0      2335944         3        1       170125        10633              0   16   3  0.999       507694       0       285925       0        17375       566498       0        16834672      23               0       0               0       0           25354       0               0         0               0           0
                 896  22     84373632       633803       0       539636       0      1370478         1        1        94167         2943              0   32   7  0.999       443954       0       367760       0         4943       224736       0        16705338      23               0       0               0       0           14328       0               0         0               0           0
                1024  23     28119040      4382005       6      4354545       5      6779850         9        1        27460         6869             15    4   1  0.999      1908121       2      1613523       2        32073      4316967       5        19406739      26               0       0               0       0           13934       0               0         0               0           0
                1280  24      4357120        68112       0        64708       0        78116         0        1         3404          213              1   16   5  0.998        61798       0        39568       0          408        52685       0        15937093      21               0       0               0       0            7270       0               0         0               0           0
                1536  25      1015296        50198       0        49537       0        43369         0        1          661           87             20    8   3  0.949        38045       0        36189       0          342        38659       0        15906588      21               0       0               0       0            3350       0               0         0               0           0
                1792  26       684544        41289       0        40907       0        53208         0        1          382           26             12   16   7  0.918        38242       0        29987       0          107        23204       0        15899656      21               0       0               0       0            2710       0               0         0               0           0
                2048  27      1288192      4957078       6      4956449       6      6486777         8        1          629          319              9    2   1  0.985      1431194       1      1285085       1       360643      4650579       6        18909840      26               0       0               0       0            6118       0               0         0               0           0
                2560  28       768000        14111       0        13811       0        13860         0        1          300           43             24    8   5  0.872        13441       0        10157       0           86         8192       0        15854369      21               0       0               0       0            1646       0               0         0               0           0
                3072  29       439296        34197       0        34054       0        32242         0        1          143           40             13    4   3  0.893        31317       0        30906       0          153         9327       0        15892405      21               0       0               0       0             850       0               0         0               0           0
                3584  30       340480        17907       0        17812       0        17699         0        1           95           13              2    8   7  0.913        17454       0        16204       0           55         3026       0        15863489      21               0       0               0       0             532       0               0         0               0           0
                4096  31      1421312       461127       0       460780       0       376549         0        1          347          347              0    1   1      1       259944       0       344160       0       461127            0       0        16896310      23               0       0               0       0            3288       0               0         0               0           0
                5120  32       378880        15199       0        15125       0        15139         0        1           74           21              5    4   5  0.880        14958       0        13920       0           85         2254       0        15858668      21               0       0               0       0             400       0               0         0               0           0
                6144  33       344064         4787       0         4731       0         4623         0        1           56           31              5    2   3  0.903         4363       0         2799       0          467         3298       0        15837168      21               0       0               0       0             238       0               0         0               0           0
                7168  34       157696         2176       0         2154       0         2143         0        1           22            7              4    4   7  0.785         1950       0         1161       0          110         1194       0        15832719      21               0       0               0       0             110       0               0         0               0           0
                8192  35      1540096        21667       0        21479       0        18668         0        1          188          188              0    1   2      1        17908       0        19952       0        21667            0       0        15889896      21               0       0               0       0            1888       0               0         0               0           0
               10240  36       276480         2210       0         2183       0         2255         0        1           27           16              4    2   5  0.843         2092       0         1407       0          253         1760       0        15833207      21               0       0               0       0              96       0               0         0               0           0
               12288  37       110592        13676       0        13667       0        13732         0        1            9            9              0    1   3      1        13509       0        13024       0        13676            0       0        15869608      21               0       0               0       0              48       0               0         0               0           0
               14336  38        71680         1510       0         1505       0         1605         0        1            5            4              2    2   7  0.625         1485       0         1105       0          282          813       0        15832266      21               0       0               0       0              34       0               0         0               0           0
large:          size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests (#/sec)  curlextents
               16384  39      1769472       316178       0       316070       0       364172       0          108
               20480  40     15667200       832600       1       831835       1     10874836      14          765
               24576  41       737280         5624       0         5594       0         7639       0           30
               28672  42       802816        17034       0        17006       0        29725       0           28
               32768  43      1277952         1189       0         1150       0         1194       0           39
               40960  44        40960          248       0          247       0          248       0            1
               49152  45            0         2541       0         2541       0         2541       0            0
               57344  46            0        35906       0        35906       0        35906       0            0
               65536  47      1900544          957       0          928       0          957       0           29
               81920  48        81920         1249       0         1248       0         1249       0            1
               98304  49            0          113       0          113       0          113       0            0
              114688  50            0          301       0          301       0          301       0            0
              131072  51      1835008          266       0          252       0          266       0           14
              163840  52            0          298       0          298       0          298       0            0
              196608  53            0           90       0           90       0           90       0            0
              229376  54            0          125       0          125       0          125       0            0
              262144  55      6553600          133       0          108       0          133       0           25
              327680  56       327680          112       0          111       0          112       0            1
              393216  57            0           50       0           50       0           50       0            0
              458752  58            0            8       0            8       0            8       0            0
              524288  59      5242880           43       0           33       0           43       0           10
              655360  60       655360            8       0            7       0            8       0            1
              786432  61            0            8       0            8       0            8       0            0
              917504  62            0           20       0           20       0           20       0            0
             1048576  63      2097152           18       0           16       0           18       0            2
                     ---
             2097152  67     12582912           12       0            6       0           12       0            6
                     ---
             4194304  71      8388608            5       0            3       0            5       0            2
                     ---
             8388608  75            0            3       0            3       0            3       0            0
                     ---
            16777216  79            0            3       0            3       0            3       0            0
                     ---
            33554432  83            0            3       0            3       0            3       0            0
                     ---
            67108864  87            0            3       0            3       0            3       0            0
                     ---
           134217728  91    268435456            2       0            0       0            2       0            2
                     ---
extents:        size ind       ndirty        dirty       nmuzzy        muzzy    nretained     retained       ntotal        total
                4096   0           10        40960            0            0        21144     86605824        21154     86646784
                8192   1           10        81920            0            0        15494    126926848        15504    127008768
                     ---
             8388608  39            0            0            0            0            1      8388608            1      8388608
            10485760  40            0            0            0            0            1     10485760            1     10485760
                     ---
            16777216  43            0            0            0            0            1     16777216            1     16777216
            20971520  44            0            0            0            0            1     20971520            1     20971520
                     ---
            33554432  47            0            0            0            0            2     67108864            2     67108864
            41943040  48            0            0            0            0            1     41943040            1     41943040
                     ---
            67108864  51            0            0            0            0            1     67108864            1     67108864
            83886080  52            0            0            0            0            1     83886080            1     83886080
                     ---
          1342177280  68            0            0            0            0            1   1464250368            1   1464250368
                     ---
Bytes in small extent cache: 0
HPA shard stats:
  Purge passes: 0 (0 / sec)
  Purges: 0 (0 / sec)
  Hugeifies: 0 (0 / sec)
  Dehugifies: 0 (0 / sec)

  In full slabs:
      npageslabs: 0 huge, 0 nonhuge
      nactive: 0 huge, 0 nonhuge
      ndirty: 0 huge, 0 nonhuge
      nretained: 0 huge, 0 nonhuge
  In empty slabs:
      npageslabs: 0 huge, 0 nonhuge
      nactive: 0 huge, 0 nonhuge
      ndirty: 0 huge, 0 nonhuge
      nretained: 0 huge, 0 nonhuge

                size ind npageslabs_huge    nactive_huge     ndirty_huge  npageslabs_nonhuge     nactive_nonhuge      ndirty_nonhuge   nretained_nonhuge
                     ---
arenas[0]:
assigned threads: 1
uptime: 725830571650076
dss allocation precedence: ""secondary""
decaying:  time       npages       sweeps     madvises       purged
   dirty: 10000           30        59808       593486      1801107
   muzzy:     0            0            0            0            0
                            allocated         nmalloc   (#/sec)         ndalloc   (#/sec)       nrequests   (#/sec)           nfill   (#/sec)          nflush   (#/sec)
small:                     8760041336       554242742       763       446073706       614     67182704643     92559        85734598       118        29525034        40
large:                       59961344         1215136         1         1214074         1        11320077  ",,,,,bug,[],True,,
     15         1215136         1          859012         1,,,,,,,,performance,[],True,,
total:                     8820002680       555457878       765       447287780       616     67194024720     92575        86949734       119        30384046        41,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
active:                   12269203456,,,,,,,,performance,[],True,,
mapped:                   12420321280,,,,,,,,performance,[],True,,
retained:                  1677783040,,,,,,,,performance,[],True,,
base:                       139244752,,,,,,,,performance,[],True,,
internal:                       98304,,,,,,,,performance,[],True,,
metadata_thp:                       0,,,,,,,,performance,[],True,,
tcache_bytes:                  103760,,,,,,,,performance,[],True,,
tcache_stashed_bytes:               0,,,,,,,,performance,[],True,,
resident:                 12408573952,,,,,,,,performance,[],True,,
abandoned_vm:                       0,,,,,,,,performance,[],True,,
extent_avail:                       0,,,,,,,,performance,[],True,,
                           n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds,,,,,,,,performance,[],True,,
large                         7960125      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extent_avail                 10129062      13               0       0               2       0          104941       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_dirty                14969568      20               0       0              58       0          119673       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_muzzy                 7995512      11               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_retained              9757493      13               0       0               6       0          119697       0               0         0               0           0,,,,,,,,performance,[],True,,
decay_dirty                   9234703      12               0       0               1       0          148985       0               0         0               0           0,,,,,,,,performance,[],True,,
decay_muzzy                   8034898      11               0       0               0       0          148831       0               0         0               0           0,,,,,,,,performance,[],True,,
base                         16790858      23               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
tcache_list                   7960126      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_shard                           0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_shard_grow                      0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_sec                             0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
bins:           size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests   (#/sec)  nshards      curregs     curslabs  nonfull_slabs regs pgs   util       nfills (#/sec)     nflushes (#/sec)       nslabs     nreslabs (#/sec)      n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds,,,,,,,,performance,[],True,,
                   8   0         5992      1460121       2      1459372       2    165227552       227        1          749            2              0  512   1  0.731       908665       1       751437       1           19        15835       0         9620246      13               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
                  16   1    165063952     53338498      73     43022001      59  19912092842     27433        1     10316497        42768          21276  256   1  0.942     10855872      14      1551039       2        78512     23817166      32        65267894      89               0       0               0       0         6578223       9               0         0               0           0,,,,,,,,performance,[],True,,
                  24   2    865151040    164045682     226    127997722     176   8437774623     11625        1     36047960        73048          55411  512   3  0.963     14373712      19      2039254       2        95160     65526118      90       190612164     262               0       0               0       0        24699693      34               0         0               0           0,,,,,,,,performance,[],True,,
                  32   3    328121216     47508388      65     37254600      51  11295660858     15562        1     10253788        85030          40353  128   1  0.942      6842004       9      1592562       2       158625     18131374      24        61736480      85               0       0               0       0         7114563       9               0         0               0           0,,,,,,,,performance,[],True,,
                  40   4         5440       534324       0       534188       0   2931833591      4039        1          136            1              0  512   5  0.265       521512       0       251277       0            1            0       0         8732915      12               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
                  48   5       109056      1985674       2      1983402       2    354711849       488        1         2272           21             15  256   3  0.422      1258241       1      1048496       1          353       817728       1        10316000      14               0       0               0       0           57183       0               0         0               0           0,,,,,,,,performance,[],True,,
                  56   6    905802688     71069706      97     54894658      75   1922065392      2648        1     16175048        33453          17199  512   7  0.944      9502332      13      1586140       2        54004     24549924      33        86155972     118               0       0               0       0        10067685      13               0         0               0           0,,,,,,,,performance,[],True,,
                  64   7    220889984     20255554      27     16804148      23   9163599655     12624        1      3451406        57263          27030   64   1  0.941      3259472       4      1498164       2       134042      7486391      10        29406416      40               0       0               0       0         2912753       4               0         0               0           0,,,,,,,,performance,[],True,,
                  80   8     68633040     10648106      14      9790193      13   4291824716      5912        1       857913         3689           3351  256   5  0.908      2192822       3      1504358       2        13474      4109182       5        18498283      25               0       0               0       0         1574129       2               0         0               0           0,,,,,,,,performance,[],True,,
                  96   9     17339232      2499640       3      2319023       3    859528950      1184        1       180617         1532            682  128   3  0.921      1000405       1      1121574       1         4790      1638823       2        10710318      14               0       0               0       0          370173       0               0         0               0           0,,,,,,,,performance,[],True,,
                 112  10     62473936      5700197       7      5142394       7    574210007       791        1       557803         2320           1654  256   7  0.939      2136234       2      1322845       1         5747      3710376       5        12872416      17               0       0               0       0          476219       0               0         0               0           0,,,,,,,,performance,[],True,,
                 128  11     80135040     18561135      25     17935080      24    337172693       464        1       626055        22087          19550   32   1  0.885      6767882       9      1566604       2       107037     12767896      17        24505501      33               0       0               0       0         1755475       2               0         0               0           0,,,,,,,,performance,[],True,,
                 160  12   2426561600     56990302      78     41824292      57   2579470684      3553        1     15166010       119315          44864  128   5  0.993      7166304       9      1513051       2       186127     23672807      32        80820145     111               0       0               0       0        12148525      16               0         0               0           0,,,,,,,,performance,[],True,,
                 192  13   1408278144     31675569      43     24340787      33   2049712618      2823        1      7334782       119689          58758   64   3  0.957      5002488       6      1479207       2       200693     12090507      16        44550679      61               0       0               0       0         6362681       8               0         0               0           0,,,,,,,,performance,[],True,,
                 224  14    949042304     29418908      40     25182112      34   2048964999      2822        1      4236796        74111          69745  128   7  0.446      2849561       3      1491051       2       110749      8303720      11        53006379      73               0       0               0       0         1408027       1               0         0               0           0,,,,,,,,performance,[],True,,
                 256  15     20811776      1491703       2      1410407       1     44440621        61        1        81296         5296           1595   16   1  0.959       747211       1       776031       1        21314      1062821       1         9778051      13               0       0               0       0          228229       0               0         0               0           0,,,,,,,,performance,[],True,,
                 320  16    322758720     17105458      23     16096837      22    163920020       225        1      1008621       115337         111938   64   5  0.136      1210962       1      1267071       1       206011      1561018       2        40383046      55               0       0               0       0         1153455       1               0         0               0           0,,,,,,,,performance,[],True,,
                 384  17    492847104      4230320       5      2946864       4     22604066        31        1      1283456        40108              0   32   3      1      1338847       1      1067491       1        67691      1704949       2        12301799      16               0       0               0       0          333397       0               0         0               0           0,,,,,,,,performance,[],True,,
                 448  18     13349056      1277906       1      1248109       1      3152267         4        1        29797          475            213   64   7  0.980      1040379       1       630996       0         1311      1153062       1         9745337      13               0       0               0       0           63761       0               0         0               0           0,,,,,,,,performance,[],True,,
                 512  19     40167936      1413530       1      1335077       1      3221982         4        1        78453         9822            119    8   1  0.998       968131       1       722665       0        27368      1087814       1         9891747      13               0       0               0       0           98411       0               0         0               0           0,,,,,,,,performance,[],True,,
                 640  20    116151680      1510154       2      1328667       1      3868401         5        1       181487         5672              0   32   5  0.999       984093       1       630889       0        11067      1151388       1         9944217      13               0       0               0       0           51559       0               0         0               0           0,,,,,,,,performance,[],True,,
                 768  21    130656000       800815       1       630690       0      2335944         3        1       170125        10633              0   16   3  0.999       507694       0       285925       0        17375       566498       0         8965422      12               0       0               0       0           25353       0               0         0               0           0,,,,,,,,performance,[],True,,
                 896  22     84373632       633803       0       539636       0      1370478         1        1        94167         2943              0   32   7  0.999       443954       0       367760       0         4943       224736       0         8836088      12               0       0               0       0           14327       0               0         0               0           0,,,,,,,,performance,[],True,,
                1024  23     28119040      4382005       6      4354545       5      6779850         9        1        27460         6869             15    4   1  0.999      1908121       2      1613523       2        32073      4316967       5        11537489      15               0       0               0       0           13933       0               0         0               0           0,,,,,,,,performance,[],True,,
                1280  24      4357120        68112       0        64708       0        78116         0        1         3404          213              1   16   5  0.998        61798       0        39568       0          408        52685       0         8067843      11               0       0               0       0            7269       0               0         0               0           0,,,,,,,,performance,[],True,,
                1536  25      1015296        50198       0        49537       0        43369         0        1          661           87             20    8   3  0.949        38045       0        36189       0          342        38659       0         8037338      11               0       0               0       0            3349       0               0         0               0           0,,,,,,,,performance,[],True,,
                1792  26       684544        41289       0        40907       0        53208         0        1          382           26             12   16   7  0.918        38242       0        29987       0          107        23204       0         8030406      11               0       0               0       0            2709       0               0         0               0           0,,,,,,,,performance,[],True,,
                2048  27      1288192      4957078       6      4956449       6      6486777         8        1          629          319              9    2   1  0.985      1431194       1      1285085       1       360643      4650579       6        11040590      15               0       0               0       0            6117       0               0         0               0           0,,,,,,,,performance,[],True,,
                2560  28       768000        14111       0        13811       0        13860         0        1          300           43             24    8   5  0.872        13441       0        10157       0           86         8192       0         7985119      11               0       0               0       0            1645       0               0         0               0           0,,,,,,,,performance,[],True,,
                3072  29       439296        34197       0        34054       0        32242         0        1          143           40             13    4   3  0.893        31317       0        30906       0          153         9327       0         8023155      11               0       0               0       0             849       0               0         0               0           0,,,,,,,,performance,[],True,,
                3584  30       340480        17907       0        17812       0        17699         0        1           95           13              2    8   7  0.913        17454       0        16204       0           55         3026       0         7994239      11               0       0               0       0             531       0               0         0               0           0,,,,,,,,performance,[],True,,
                4096  31      1421312       461127       0       460780       0       376549         0        1          347          347              0    1   1      1       259944       0       344160       0       461127            0       0         9027060      12               0       0               0       0            3287       0               0         0               0           0,,,,,,,,performance,[],True,,
                5120  32       378880        15199       0        15125       0        15139         0        1           74           21              5    4   5  0.880        14958       0        13920       0           85         2254       0         7989418      11               0       0               0       0             399       0               0         0               0           0,,,,,,,,performance,[],True,,
                6144  33       344064         4787       0         4731       0         4623         0        1           56           31              5    2   3  0.903         4363       0         2799       0          467         3298       0         7967918      10               0       0               0       0             237       0               0         0               0           0,,,,,,,,performance,[],True,,
                7168  34       157696         2176       0         2154       0         2143         0        1           22            7              4    4   7  0.785         1950       0         1161       0          110         1194       0         7963469      10               0       0               0       0             109       0               0         0               0           0,,,,,,,,performance,[],True,,
                8192  35      1540096        21667       0        21479       0        18668         0        1          188          188              0    1   2      1        17908       0        19952       0        21667            0       0         8020646      11               0       0               0       0            1887       0               0         0               0           0,,,,,,,,performance,[],True,,
               10240  36       276480         2210       0         2183       0         2255         0        1           27           16              4    2   5  0.843         2092       0         1407       0          253         1760       0         7963957      10               0       0               0       0              95       0               0         0               0           0,,,,,,,,performance,[],True,,
               12288  37       110592        13676       0        13667       0        13732         0        1            9            9              0    1   3      1        13509       0        13024       0        13676            0       0         8000358      11               0       0               0       0              47       0               0         0               0           0,,,,,,,,performance,[],True,,
               14336  38        71680         1510       0         1505       0         1605         0        1            5            4              2    2   7  0.625         1485       0         1105       0          282          813       0         7963016      10               0       0               0       0              33       0               0         0               0           0,,,,,,,,performance,[],True,,
large:          size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests (#/sec)  curlextents,,,,,,,,performance,[],True,,
               16384  39      1769472       316178       0       316070       0       364172       0          108,,,,,,,,performance,[],True,,
               20480  40     15667200       832600       1       831835       1     10874836      14          765,,,,,,,,performance,[],True,,
               24576  41       737280         5624       0         5594       0         7639       0           30,,,,,,,,performance,[],True,,
               28672  42       802816        17034       0        17006       0        29725       0           28,,,,,,,,performance,[],True,,
               32768  43      1277952         1189       0         1150       0         1194       0           39,,,,,,,,performance,[],True,,
               40960  44        40960          248       0          247       0          248       0            1,,,,,,,,performance,[],True,,
               49152  45            0         2541       0         2541       0         2541       0            0,,,,,,,,performance,[],True,,
               57344  46            0        35906       0        35906       0        35906       0            0,,,,,,,,performance,[],True,,
               65536  47      1900544          957       0          928       0          957       0           29,,,,,,,,performance,[],True,,
               81920  48        81920         1249       0         1248       0         1249       0            1,,,,,,,,performance,[],True,,
               98304  49            0          113       0          113       0          113       0            0,,,,,,,,performance,[],True,,
              114688  50            0          301       0          301       0          301       0            0,,,,,,,,performance,[],True,,
              131072  51      1835008          266       0          252       0          266       0           14,,,,,,,,performance,[],True,,
              163840  52            0          298       0          298       0          298       0            0,,,,,,,,performance,[],True,,
              196608  53            0           90       0           90       0           90       0            0,,,,,,,,performance,[],True,,
              229376  54            0          125       0          125       0          125       0            0,,,,,,,,performance,[],True,,
              262144  55      6553600          133       0          108       0          133       0           25,,,,,,,,performance,[],True,,
              327680  56       327680          112       0          111       0          112       0            1,,,,,,,,performance,[],True,,
              393216  57            0           50       0           50       0           50       0            0,,,,,,,,performance,[],True,,
              458752  58            0            8       0            8       0            8       0            0,,,,,,,,performance,[],True,,
              524288  59      5242880           43       0           33       0           43       0           10,,,,,,,,performance,[],True,,
              655360  60       655360            8       0            7       0            8       0            1,,,,,,,,performance,[],True,,
              786432  61            0            8       0            8       0            8       0            0,,,,,,,,performance,[],True,,
              917504  62            0           20       0           20       0           20       0            0,,,,,,,,performance,[],True,,
             1048576  63      2097152           18       0           16       0           18       0            2,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
             2097152  67     12582912           12       0            6       0           12       0            6,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
             4194304  71      8388608            5       0            3       0            5       0            2,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
extents:        size ind       ndirty        dirty       nmuzzy        muzzy    nretained     retained       ntotal        total,,,,,,,,performance,[],True,,
                4096   0           10        40960            0            0        21144     86605824        21154     86646784,,,,,,,,performance,[],True,,
                8192   1           10        81920            0            0        15494    126926848        15504    127008768,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
          1342177280  68            0            0            0            0            1   1464250368            1   1464250368,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
Bytes in small extent cache: 0,,,,,,,,performance,[],True,,
HPA shard stats:,,,,,,,,performance,[],True,,
  Purge passes: 0 (0 / sec),,,,,,,,performance,[],True,,
  Purges: 0 (0 / sec),,,,,,,,performance,[],True,,
  Hugeifies: 0 (0 / sec),,,,,,,,performance,[],True,,
  Dehugifies: 0 (0 / sec),,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
  In full slabs:,,,,,,,,performance,[],True,,
      npageslabs: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nactive: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      ndirty: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nretained: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
  In empty slabs:,,,,,,,,performance,[],True,,
      npageslabs: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nactive: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      ndirty: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nretained: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
                size ind npageslabs_huge    nactive_huge     ndirty_huge  npageslabs_nonhuge     nactive_nonhuge      ndirty_nonhuge   nretained_nonhuge,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
arenas[8]:,,,,,,,,performance,[],True,,
assigned threads: 0,,,,,,,,performance,[],True,,
uptime: 717554192152229,,,,,,,,performance,[],True,,
"dss allocation precedence: """"secondary""""",,,,,,,,performance,[],True,,
decaying:  time       npages       sweeps     madvises       purged,,,,,,,,performance,[],True,,
   dirty:     0            0            0           12        92160,,,,,,,,performance,[],True,,
   muzzy:     0            0            0            0            0,,,,,,,,performance,[],True,,
                            allocated         nmalloc   (#/sec)         ndalloc   (#/sec)       nrequests   (#/sec)           nfill   (#/sec)          nflush   (#/sec),,,,,,,,performance,[],True,,
small:                              0               0         0               0         0               0         0               0         0               0         0,,,,,,,,performance,[],True,,
large:                      268435456              14         0              12         0              14         0              14         0               0         0,,,,,,,,performance,[],True,,
total:                      268435456              14         0              12         0              14         0              14         0               0         0,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
active:                     268435456,,,,,,,,performance,[],True,,
mapped:                     270532608,,,,,,,,performance,[],True,,
retained:                   316669952,,,,,,,,performance,[],True,,
base:                           93392,,,,,,,,performance,[],True,,
internal:                           0,,,,,,,,performance,[],True,,
metadata_thp:                       0,,,,,,,,performance,[],True,,
tcache_bytes:                       0,,,,,,,,performance,[],True,,
tcache_stashed_bytes:               0,,,,,,,,performance,[],True,,
resident:                   268529664,,,,,,,,performance,[],True,,
abandoned_vm:                       0,,,,,,,,performance,[],True,,
extent_avail:                       1,,,,,,,,performance,[],True,,
                           n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds,,,,,,,,performance,[],True,,
large                         7869250      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extent_avail                  7869269      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_dirty                 7869276      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_muzzy                 7869250      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
extents_retained              7869281      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
decay_dirty                   8015799      11               0       0               0       0          148201       0               0         0               0           0,,,,,,,,performance,[],True,,
decay_muzzy                   7943652      11               0       0               0       0          148103       0               0         0               0           0,,,,,,,,performance,[],True,,
base                         15738513      21               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
tcache_list                   7869250      10               0       0               0       0               1       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_shard                           0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_shard_grow                      0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
hpa_sec                             0       0               0       0               0       0               0       0               0         0               0           0,,,,,,,,performance,[],True,,
bins:           size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests   (#/sec)  nshards      curregs     curslabs  nonfull_slabs regs pgs   util       nfills (#/sec)     nflushes (#/sec)       nslabs     nreslabs (#/sec)      n_lock_ops (#/sec)       n_waiting (#/sec)      n_spin_acq (#/sec)  n_owner_switch (#/sec)   total_wait_ns   (#/sec)     max_wait_ns  max_n_thds,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
large:          size ind    allocated      nmalloc (#/sec)      ndalloc (#/sec)    nrequests (#/sec)  curlextents,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
             8388608  75            0            3       0            3       0            3       0            0,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            16777216  79            0            3       0            3       0            3       0            0,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            33554432  83            0            3       0            3       0            3       0            0,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            67108864  87            0            3       0            3       0            3       0            0,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
           134217728  91    268435456            2       0            0       0            2       0            2,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
extents:        size ind       ndirty        dirty       nmuzzy        muzzy    nretained     retained       ntotal        total,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
             8388608  39            0            0            0            0            1      8388608            1      8388608,,,,,,,,performance,[],True,,
            10485760  40            0            0            0            0            1     10485760            1     10485760,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            16777216  43            0            0            0            0            1     16777216            1     16777216,,,,,,,,performance,[],True,,
            20971520  44            0            0            0            0            1     20971520            1     20971520,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            33554432  47            0            0            0            0            2     67108864            2     67108864,,,,,,,,performance,[],True,,
            41943040  48            0            0            0            0            1     41943040            1     41943040,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
            67108864  51            0            0            0            0            1     67108864            1     67108864,,,,,,,,performance,[],True,,
            83886080  52            0            0            0            0            1     83886080            1     83886080,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
Bytes in small extent cache: 0,,,,,,,,performance,[],True,,
HPA shard stats:,,,,,,,,performance,[],True,,
  Purge passes: 0 (0 / sec),,,,,,,,performance,[],True,,
  Purges: 0 (0 / sec),,,,,,,,performance,[],True,,
  Hugeifies: 0 (0 / sec),,,,,,,,performance,[],True,,
  Dehugifies: 0 (0 / sec),,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
  In full slabs:,,,,,,,,performance,[],True,,
      npageslabs: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nactive: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      ndirty: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nretained: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
  In empty slabs:,,,,,,,,performance,[],True,,
      npageslabs: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nactive: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      ndirty: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
      nretained: 0 huge, 0 nonhuge,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
                size ind npageslabs_huge    nactive_huge     ndirty_huge  npageslabs_nonhuge     nactive_nonhuge      ndirty_nonhuge   nretained_nonhuge,,,,,,,,performance,[],True,,
                     ---,,,,,,,,performance,[],True,,
--- End jemalloc statistics ---,,,,,,,,performance,[],True,,
```,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
**To reproduce**,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
Unsure what causes this issue to reproduce.,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
**Expected behavior**,,,,,,,,performance,[],True,,
,,,,,,,,performance,[],True,,
I expect active defrag running to help with external memory fragmentation,,,,,,,,performance,[],True,,
",['memory efficiency'],open,2024-10-21T23:08:10Z,
",,,,,,,,performance,[],True,,
facebook/react,33614,[Compiler Bug]: new mutation aliasing model incorrectly detects a frozen value mutation when mutating a set created via passing the set constructor a frozen value,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAgdgQwEYBsEByCA7gLJQAumFAlhOgIK42Zg3oDmpEAJgrsgowoCADrpxNALYAHCDAoACYIqhgEAZSoUEigL6KAZjAhTFokDASY4FC5NnylK8rlob+CW-qMmzFgDoAgHooGmCpKDcadXxbCKjaWK87EHFxBAAPOQVFOHowJQYZGUUAXkUACgBKcoA+ZXFFPIKlAG1k2wQeABpFdQoPOJ0eAF1y1XUtagRK9BJFDyUAHn6hdg5FBprqppb0QsV6IZTugGEAC0xOXQrKgDdMXBFkNZgN2rKG4D3m-IOlPNiCcujwJkDFggKJVOiNduhms0aIYqkCQSMAlcwA8niJqrUfgjEc00Z5QQE+PgdDjngh4cSDPx1I0icTScNugFMDweDS8b99AKBujunMSCKePTBRIiVYKLAEctXO4yUpYd0ysB1TwDMdVecrjdNXqOTxLtcOAgDME6uI9OIQHogA

### Repro steps

1) In an event handler, create a Set by passing the Set constructor a frozen value like a piece of state or a prop (i.e. `const derivedSet = new Set(frozen)`)
2) Mutate it by deleting/adding an element

### How often does this bug happen?

Every time

### What version of React are you using?

19.1

### What version of React Compiler are you using?

6c7b1a1d9898025bb087a3b97d875091e4f67cf3","['Type: Bug', 'Status: Unconfirmed']",open,2025-06-22T13:45:28Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33612,Bug: renderToPipeableStream is missing in Bun exports,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.10.0

## Steps To Reproduce

1. Run under Bun and Node and see the export differense without a reason

```ts
import { createServer } from ""node:http"";
import { renderToPipeableStream } from ""react-dom/server""; // in bun it uses server.bun and in node server.node

function App() {
  return <div>Hello World</div>;
}

function handleRequest(res) {
  // ... in your server handler ...
  const stream = renderToPipeableStream(<App />, {
    onShellReady() {
      res.statusCode = 200;
      res.setHeader(""Content-type"", ""text/html"");
      stream.pipe(res);
    },
    // ...
  });
}

const http = createServer((req, res) => handleRequest(res));

http.listen(3000, () => {
  console.log(""Server is running on port 3000"");
});
```

```bash
> bun .\a.tsx
1 | (function (entry, fetcher)
              ^
SyntaxError: Export named 'renderToPipeableStream' not found in module '...\node_modules\react-dom\server.bun.js'.
      at loadAndEvaluateModule (1:11)

Bun v1.2.17-canary.50+41d10ed01 (Windows x64)
> bunx tsx .\a.tsx
Server is running on port 3000
```

as we can see it really missing here: https://github.com/facebook/react/blob/main/packages/react-dom/src/server/ReactDOMFizzServerBun.js

It works fine if you force .node export:


```ts
import { createServer } from ""node:http"";
import { renderToPipeableStream } from ""react-dom/server.node"";

function App() {
  return <div>Hello World</div>;
}

function handleRequest(res) {
  // ... in your server handler ...
  const stream = renderToPipeableStream(<App />, {
    onShellReady() {
      res.statusCode = 200;
      res.setHeader(""Content-type"", ""text/html"");
      stream.pipe(res);
    },
    // ...
  });
}

const http = createServer((req, res) => handleRequest(res));

http.listen(3000, () => {
  console.log(""Server is running on port 3000"");
});
```

## The current behavior

Export named 'renderToPipeableStream' not found in module '...\node_modules\react-dom\server.bun.js'.

It brokes react-router usage on Bun


## The expected behavior

It should works as in node export
",['Status: Unconfirmed'],open,2025-06-22T12:32:24Z,,bug,['status: unconfirmed'],True,,
facebook/react,33610,[Compiler Bug]:,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAMygOzgFwJYSYAEAwtJjgBQCURwAOsUXIWDkTAmkQLxFRgEAJS6UADNQDcjIs1bsA2iyw4Aur36CAyjgCGOBJRq8AfBy4A6OLE4UpM8zljEAPABM8ANxPBlFAL4uAPQe3oz+IP5AA

### Repro steps

1. Try pasting the following code in React compiler Playground
```
function Count() {
  const ref = useRef(0);
  const [count] = useState(() => ref.current);
  return <div>{count}</div>
}
```
2. This should throw an error, as it violates the **Rules of react** , specifically where it says ""Components and Hooks must be pure""
https://react.dev/reference/rules#components-and-hooks-must-be-pure

**Ref docs clearly says this is an anti pattern**

![Image](https://github.com/user-attachments/assets/65265f74-ac86-40ac-9512-b8a5ba10dd64)

### How often does this bug happen?

Every time

### What version of React are you using?

19

### What version of React Compiler are you using?

19.1.0","['Type: Bug', 'Status: Unconfirmed']",open,2025-06-22T09:59:15Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33609,Bug: validateDOMNesting needs to be updated for new customisable form widgets,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.1.0

## Steps To Reproduce

1. Implement a select box with the new styling API. For example, follow the MDN tutorial, specifically [this point](https://developer.mozilla.org/en-US/docs/Learn_web_development/Extensions/Forms/Customizable_select#customizable_select_markup).

Link to code example: (Pure html/css reproduction of `<button>` working inside of `<select>`): https://codepen.io/web-dot-dev/pen/gbOKyRZ

## The current behavior
An error in the console:
> In HTML, `<button>` cannot be a child of `<select>`.
> This will cause a hydration error.

## The expected behavior
No error.

## Additional context
- For now, only Chomium browsers support this: https://caniuse.com/mdn-css_properties_appearance_base-select
- Some time ago, a similar issue #27572 was opened and resolved, but it only mentioned the `<hr/>` tag. The reason for supporting that seems to have been different than this issue.
- While I opened this issue with the primary focus on the `<button>` element, now also more elements are supported within the `<option>` element - [source](https://developer.chrome.com/blog/a-customizable-select#a_select_can_now_include_rich_html_content). __Should I open a separate issue for that, or do we track everything related here?__
    - Additionally, the CSS spec mentions that there will be HTML spec changes to __all form controls__ to allow for new styling API - [source](https://drafts.csswg.org/css-ui/#issue-0c60b9fd). That means that possibly in the future, different child elements will be permitted on different form controls.

### The spec
Not all relevant specs were updated. While the CSS spec is ready, HTML isn't. Issues and PRs related to this are tracked [here](https://github.com/whatwg/html/issues/9799).

### Loosely related
I also opened an issue in `@types/react` for adding a definition of a new element related to this new customisable select: https://github.com/DefinitelyTyped/DefinitelyTyped/discussions/73079",['Status: Unconfirmed'],open,2025-06-22T07:41:14Z,,bug,['status: unconfirmed'],True,,
facebook/react,33608,谷歌留痕,谷歌留痕怎么做【TG:@koxi55】谷歌留痕技术,['Status: Unconfirmed'],closed,2025-06-22T05:56:44Z,2025-06-22T05:56:48Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33607,谷歌留痕霸屏,谷歌留痕霸屏【TG:@koxi55】谷歌留痕,['Status: Unconfirmed'],closed,2025-06-22T05:55:42Z,2025-06-22T05:55:46Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33606,谷歌留痕地址采集工具,谷歌留痕地址采集工具【TG:@koxi55】谷歌留痕霸屏,['Status: Unconfirmed'],closed,2025-06-22T05:53:57Z,2025-06-22T05:54:01Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33605,google搜索留痕技术,google搜索留痕技术【TG:@koxi55】谷歌留痕网址采集,['Status: Unconfirmed'],closed,2025-06-22T05:49:57Z,2025-06-22T05:50:09Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33604,谷歌搜索留痕技术,谷歌搜索留痕技术【TG:@koxi55】google搜索留痕技术,['Status: Unconfirmed'],closed,2025-06-22T05:49:15Z,2025-06-22T05:49:18Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33603,谷歌关键词推广代发,谷歌关键词推广软件【TG:@koxi55】谷歌搜索留痕技术,['Status: Unconfirmed'],closed,2025-06-22T05:48:42Z,2025-06-22T05:48:45Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33602,谷歌发帖软件出售,谷歌发帖软件出售【TG:@koxi55】谷歌关键词推广软件,['Status: Unconfirmed'],closed,2025-06-22T05:46:28Z,2025-06-22T05:46:33Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33601,google发帖收录代发,google发帖收录代发【TG:@koxi55】谷歌各种发帖软件出售,['Status: Unconfirmed'],closed,2025-06-22T05:44:46Z,2025-06-22T05:44:54Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33600,谷歌留痕工具,谷歌留痕工具出售【TG:@koxi55】 google发帖收录代发,['Status: Unconfirmed'],closed,2025-06-22T05:43:45Z,2025-06-22T05:43:48Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33599,谷歌留痕软件,谷歌留痕软件【TG:@koxi55】谷歌留痕工具出售,['Status: Unconfirmed'],closed,2025-06-22T05:42:04Z,2025-06-22T05:42:08Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33598,谷歌搜索留痕,谷歌搜索留痕【TG:@koxi55】谷歌留痕软件,['Status: Unconfirmed'],closed,2025-06-22T05:35:50Z,2025-06-22T05:35:55Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33597,google留痕排名代做,google留痕排名代做【TG:@koxi55】谷歌搜索留痕怎么做,['Status: Unconfirmed'],closed,2025-06-22T05:35:12Z,2025-06-22T05:35:16Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33596,谷歌收录留痕,谷歌收录留痕【TG:@koxi55】google留痕排名,['Status: Unconfirmed'],closed,2025-06-22T05:32:16Z,2025-06-22T05:32:21Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33595,谷歌留痕收录端口,谷歌留痕收录端口【TG:@koxi55】google霸屏收录,['Status: Unconfirmed'],closed,2025-06-22T05:31:30Z,2025-06-22T05:31:35Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33594,google留痕霸屏排名,google留痕霸屏排名【TG:@koxi55】谷歌留痕收录端口,['Status: Unconfirmed'],closed,2025-06-22T05:30:25Z,2025-06-22T05:30:28Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33593,谷歌留痕收录,谷歌留痕收录【TG:@koxi55】google留痕霸屏排名,['Status: Unconfirmed'],closed,2025-06-22T05:26:33Z,2025-06-22T05:26:37Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33586,Bug:,"When using the React Developer Tools extension (v6.1.2) together with a popup-opening library (e.g. react-oauth-popup), I consistently get a SecurityError: Failed to read a named property '[react.memo_cache_sentinel]' from 'Window' in the console once the popup closes. This error originates from the DevTools hook (installHook.js) and seems to interfere with normal React lifecycle (e.g. passive effects) in development.

React version: 18.3.0

Library involved:

react-oauth-popup v2.x (or any code that opens a popup via window.open without noopener)

Steps To Reproduce
Create a React component that renders a button inside <OAuthPopup> (or manually calls window.open for OAuth).

Install and enable React Developer Tools (Chrome extension).

Click the button to open the popup and then close it (either via onClose callback or user closing the window).

Observe console for multiple SecurityError: Failed to read a named property '[react.memo_cache_sentinel]' from 'Window'.

Minimal reproduction
```
import React from 'react';
import OAuthPopup from 'react-oauth-popup';

export default function App() {
  return (
    <OAuthPopup
      url=""https://example.com/oauth""
      onCode={(code) => console.log(code)}
      onClose={() => console.log('closed')}
      title=""OAuth""
      width={600}
      height={600}
    >
      <button>Open OAuth Popup</button>
    </OAuthPopup>
  );
}

```

The current behavior
On popup close, React Developer Tools extension (hook) attempts to read internal React fields from the popup or main window.

This triggers a SecurityError logged in the console:
`
SecurityError: Failed to read a named property '[react.memo_cache_sentinel]' from 'Window': An attempt was made to break through the security policy of the user agent.
`
React then throws Error: Should not already be working. in the callstack, disrupting normal component updates in development.

The expected behavior
The DevTools hook should gracefully handle the absence of window.opener or blocked frame access and not throw a SecurityError.

Closing a popup opened by React-based libraries should not cause React internals to crash or log errors in development.








",['Status: Unconfirmed'],open,2025-06-21T09:44:32Z,,bug,['status: unconfirmed'],True,,
facebook/react,33585,"[DevTools Bug]: Showing ""This page doesn’t appear to be using React"" even in react.dev","### Website or app

https://react.dev/

### Repro steps

Don't know why, but when I install **React Developer Tool** extension and **React Scan** extension on my Brave browser (1.79.126) , the React Developer Tool won't work, but after deleting React Scan, the React Developer Tool works again.

![Image](https://github.com/user-attachments/assets/c34f89de-5a8e-4aa5-a123-2c1e16210207)

### How often does this bug happen?

Every time

### DevTools package (automated)

_No response_

### DevTools version (automated)

_No response_

### Error message (automated)

_No response_

### Error call stack (automated)

```text

```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text

```","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",open,2025-06-21T03:33:11Z,,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,,
facebook/react,33580,Bug: Rendered more hooks than during the previous render when component calls use(thenable) after hydration inside a transition,"Observing `Rendered more hooks than during the previous render` being incorrectly thrown when at least all the following conditions are met:
- the app is rendered as a string then hydrated using `hydrateRoot`
- a subtree, wrapped in an error boundary and suspense, throws an error during render
- a subtree runs an effect that:
  - causes a cascading update
  - immediately after runs a `startTransition`
  - the `startTransition` updates state in a parent component to a newly created `Promise`
  - the parent state conditionally reads the state with `use` only when its a promise
- at least 1 hook, that cannot be called conditionally, is ran after the `use` call in the parent component

Remove any one conditions and the `Rendered more hooks than during the previous render` behavior no longer exists.

Wrapping the client entry point (the subtree that calls `use`) in a `Suspense` boundary also causes the `Rendered more hooks than during the previous render` to no longer exist.

Every condition that changes the outcome of the reproduction is documented inline with the source code.

Related issues (in next.js & react)
https://github.com/facebook/react/issues/33556
https://github.com/vercel/next.js/issues/63121
https://github.com/vercel/next.js/issues/63388
https://github.com/vercel/next.js/issues/78396
https://github.com/vercel/next.js/issues/80483

React version: 
- react@19.1.0
- react@19.2.0-canary-197d6a04-20250424

## Steps To Reproduce

1. git clone https://github.com/RobPruzan/rendered-more-hooks-repro
2. pnpm install && pnpm run dev
3. open browser console
4. expect:
```
 Uncaught Error: Rendered more hooks than during the previous render.
    at updateWorkInProgressHook (react-dom_client.js?v=457007cf:4342:19)
    at updateMemo (react-dom_client.js?v=457007cf:5063:20)
    at Object.useMemo (react-dom_client.js?v=457007cf:16761:20)
    at exports.useMemo (chunk-E6KUT42S.js?v=19f5b077:916:36)
    at Page (/src/BugRepro.tsx:38:3)
    at react-stack-bottom-frame (react-dom_client.js?v=457007cf:17422:20)
    at renderWithHooks (react-dom_client.js?v=457007cf:4204:24)
    at updateFunctionComponent (react-dom_client.js?v=457007cf:6617:21)
    at beginWork (react-dom_client.js?v=457007cf:7652:20)
    at runWithFiberInDEV (react-dom_client.js?v=457007cf:1483:72)
```


Link to code example:
https://codesandbox.io/p/github/RobPruzan/rendered-more-hooks-repro/sync-again

> you may need to refresh the codesandbox at least once to see the error. I'm not sure if this is because non determinism, or codesandbox is swallowing some of the logs. I don't observe any non determinism locally.

## The current behavior
React throws `Rendered more hooks than during the previous render` and does not finish rendering

## The expected behavior
The app to render with no uncaught errors
",['Status: Unconfirmed'],open,2025-06-20T03:22:31Z,,bug,['status: unconfirmed'],True,,
facebook/react,33577,[Compiler Bug]: Compiler tries to assign to variables that does not exist,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCASgmGgF4IDyARmTAG4IwEC+BAZjBAwEAOiAACMBAEM4eALRSYaKQHooeNABswogNzCAdphz4iBAAoQc7GAGEIBvAgAeeADQky9xy7zmBWGDcfAJCopIy8orKcnCCOAYIjjog+gaGLiaEcQZghJbWHAQAvAQAFIYEZnAAFloAJpIGHlJGGFIaDgAisB1oDh4A7mj1eDUlIiB4SgDmMxyUvKIeAHRrWAFBXG6VBJK8OwYAlCUAfES7ANobVmAe+wC6E6QI3k6u-rdlN4H3CAcWKwQGxvXxHNJVHJ5MzTNBzBb-YKlH5gNK7F6Uah0JgsGxlYj7ZAEWHwmCLDwOTG0BDccGGXaSPCwAwEAxQTSaNJcNIgLhAA

### Repro steps

`t2` is not defined, so there's a runtime JS error (`ReferenceError: assignment to undeclared variable t2`).

Screenshot of buggy output for reference when bug is fixed in compiler:

<img width=""559"" alt=""Image"" src=""https://github.com/user-attachments/assets/095c4ae4-d08a-4c96-8732-31c9ea77174e"" />

---

Note that removing `width = ""triggerRef""` _or_ `const { triggerRef } = props;` makes the bug disappear.

### How often does this bug happen?

Every time

### What version of React are you using?

N/A

### What version of React Compiler are you using?

RC ","['Type: Bug', 'Component: React Compiler']",open,2025-06-19T14:24:26Z,,bug,"['type: bug', 'component: react compiler']",True,,
facebook/react,33559,[Compiler Bug]: Compiler optimizes away useMemo with manual dependencies,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCAsghhAQL4EBmMEGBA5DAgIZx5sDcAHQB2IgPRiCAQQAmMgmQA2DAGLCAFADcuiqAgCUBNMLBoZCAngAWF0hSo08NMhesWEADywJeCeQCMEKy5NNFwROAgTQiVVYQIAXgIPRIA+ZKFRYU8cfEYoYV4w+LsASXNhPDQ8AE8tHT0AGiMKqtq1Q2ARAgJI6JaESuqaxIGh9o1tXQNMns48WBKySmp1dUME9Prp-WaAbTNBtpqAXX1M2hEQWiA

### Repro steps

We have a hook like this that basically returns the previous value if the calculated identity of the value hasn't changed (e.g. Dayjs object and its unix timestamp)

```ts
function useIdentity(value, identityFn) {
  const identity = identityFn(value);
  return useMemo(() => value, [identity]);
}
```

I noticed the tests for this were failing after enabling React Compiler.

This hook violates the rules-of-react and has the linter directives to disable it. But for some reason the compiler isn't able to detect the violation.

If I write the hook like this, the optimization is skipped as expected.

```ts
const selfFn = x => x;
function useIdentity(value, identityFn) {
  const identity = identityFn(value);
  return useMemo(() => selfFn(value), [identity]);
}
```

So I guess the hook doesn't respect the manual optimization because the `() => value`  expression is too simple and thinks it can be optimized without issues.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.2","['Type: Bug', 'Compiler: todo']",open,2025-06-18T12:33:24Z,,bug,"['type: bug', 'compiler: todo']",True,,
facebook/react,33556,"Bug: ""Rendered more hooks than ..."" throws when it shouldn't with multiple suspends","React version: 19.1.0

I've tried hard to create a minimal reproduction for this one with just React and failed, but for reasons I'll describe I still suspect this might be a React bug and not only a Next.js one.

There are several reproductions over in the Next.js repo: [#63121](https://github.com/vercel/next.js/issues/63121) [#63388](https://github.com/vercel/next.js/issues/63388) [#78396](https://github.com/vercel/next.js/issues/78396) [#80483](https://github.com/vercel/next.js/issues/80483)

This one is very, very hard to describe so sorry for a lengthy post. In essence, I think there are situations where transitions changing out a currently pending promise passed to `use` results in ""Rendered too many hooks"" being thrown, even when there are no conditional hooks or early returns.

This is not enough however, there seems to be some extra secret ingredient that is required to trigger this which I have not found, maybe incremental hydration?

## Why I think this is a bug

This is happening in code paths where there are no conditional hooks being rendered. (Well, there is in the Next case, but it's a `NODE_ENV` check and the bug happens even when that is removed)

Besides the Next.js reproductions, which vary in _how_ they trigger the bug, I've also seen this happen on a separate code path in our repo, in user land-code where there are also no conditional hooks or early returns. That code path also has two possible Suspends in the same custom hook. This also uses the Next app router, but unlike the reproductions above, the stack trace does not lead to Next.js internals. This internal bug is very hard to reproduce consistently unfortunately.

## Some debugging details

* I have been debugging [#78396](https://github.com/vercel/next.js/issues/78396) with a local Next.js build
* The bug is triggered on [this line in `app-router.tsx`](https://github.com/vercel/next.js/blob/19762ee2f5ee355c40f14a767c43311688bf98b7/packages/next/src/client/components/app-router.tsx#L211), but the actual error seems to stem from [this line in `useActionQueue`](https://github.com/vercel/next.js/blob/19762ee2f5ee355c40f14a767c43311688bf98b7/packages/next/src/client/components/use-action-queue.ts#L53) (?)
  * `return isThenable(state) ? use(state) : state`
* I removed the `if (process.env.NODE_ENV !== 'production') {` conditional hook case just to be sure
* I added a few logs to `useActionQueue`, when the bug triggers this is what has happened:

![Image](https://github.com/user-attachments/assets/5d765f4b-bf26-4bb7-a1d4-ba90afc9231e)

* That is, a server action is still pending when a redirect happens
* The error happen when the redirect _fulfills_
* If the server action is removed, bug goes away
* If I add enough delay for the `redirect` so the server action has time to finish, the bug goes away, that is, this is fine:

![Image](https://github.com/user-attachments/assets/d8f290ea-75b7-4456-9e7e-277604dc7aa1)

* I have also added a breakpoint to the error itself inside of `updateWorkInProgressHook`
  * `currentHook` exists but does not have a `.next`
  * `workInProgressHook` exists but does not have a `.next`
  * This is the stack trace, from `beginWork`:

![Image](https://github.com/user-attachments/assets/f575092b-874d-4188-8505-bde94ba68fb3)

I know this is very fuzzy and I'm sorry I don't have more details, but this is where my React debugging skills runs out and I still wanted to report it as there is some good evidence at least part of this bug lies on the React side of things.

I'm happy to provide whatever more details I can help with.",['Status: Unconfirmed'],open,2025-06-17T19:44:26Z,,bug,['status: unconfirmed'],True,,
facebook/react,33555,[DevTools Bug]:  Unnecessary Re-render Highlight on Sibling Component in React DevTools,"### Website or app

https://codesandbox.io/p/sandbox/agitated-monad-h4ykn2?file=%2Fsrc%2FApp.js%3A12%2C13

### Repro steps

* Open the provided CodeSandbox 
* Click the ""Open in new Tab"" button in the sandbox preview.
* Open the React DevTools panel.
* In the DevTools settings, enable ""Highlight updates when components render"".
* Observe that the Test button(B) is highlighted every time the timer value changes.

### How often does this bug happen?

Every time

### DevTools package (automated)

_No response_

### DevTools version (automated)

_No response_

### Error message (automated)

_No response_

### Error call stack (automated)

```text

```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text

```","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",open,2025-06-17T17:53:36Z,,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,,
facebook/react,33545,Bug: useOptimistic shows wrong value when other actions happen in the background,"Any unrelated background action blocks useOptimistic’s heuristic as to when to revert to the real value.

React version: 19.1.

## Steps To Reproduce

1. Open [the demo](https://codesandbox.io/p/sandbox/use-optimistic-unrelated-forked-t3n88k)

    <details><summary>Code backup</summary>
    
    ```js
    import { useOptimistic, useState } from ""react"";
    
    const sleep = (ms) => new Promise((resolve) => setTimeout(resolve, ms));
    
    export default function App() {
      const [a, setA] = useState(0);
      const [optimisticA, setOptimisticA] = useOptimistic(a);
      async function incA() {
        const newVal = optimisticA + 1;
        setOptimisticA(newVal);
        await sleep(1000);
        return Error(""failed"");
      }
    
      async function unrelatedSlow() {
        await sleep(20000);
      }
    
      return (
        <div className=""App"">
          <div>
            <form action={incA}>
              {optimisticA} <button disabled={optimisticA !== a}>Inc</button>
            </form>
          </div>
          <div>
            <form action={unrelatedSlow}>
              <button>Unrelated slow</button>{"" ""}
            </form>
          </div>
        </div>
      );
    }
    
    ```

2. Click on Inc.
3. Observe how after 1 second and a simulated server failure the number goes back to 0.
4. Click on Unrelated slow.
5. Click on Inc.

## The current behavior
The number stays at 1 for 20 seconds, until the unrelated action completes.

![Image](https://github.com/user-attachments/assets/93bdb143-b2dc-404d-be95-3496ff00efae)

## The expected behavior
After 1 second number goes back to 0, whether or not we have launched an unrelated slow action.

![Image](https://github.com/user-attachments/assets/e1086dae-d2ae-40cf-bbe8-7431d60d8b25)",['Status: Unconfirmed'],open,2025-06-16T23:04:08Z,,performance,['status: unconfirmed'],True,,
facebook/react,33542,"Bug: onSelect does not fire when contentEditable equals ""plaintext-only""","React's `onSelect` event callback does not fire when contentEditable is set to `plaintext-only`. `plaintext-only` is a valid value for the [contenteditable attribute](https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Global_attributes/contenteditable#value). 

This was previously reported, #29813, but never resolved. Since then, all current browsers have added support for `plaintext-only`. [Caniuse contenteditable=""plaintext-only""](https://caniuse.com/mdn-html_global_attributes_contenteditable_plaintext-only).

React version: 19.1.0

## Steps To Reproduce

1. Create a `div` with `contentEditable=""plaintext-only""`
2. Define an `onSelect` event handler
3. `onSelect` is never fired

Link to code example: https://codesandbox.io/p/sandbox/ynhpk7

## The current behavior
No `onSelect` event is fired when contentEditable is set to `plaintext-only`

## The expected behavior
`contentEditable=""plaintext-only""` is handled in the same way as `contentEditable={true}` and `onSelect` events are fired.",['Status: Unconfirmed'],open,2025-06-16T18:50:48Z,,bug,['status: unconfirmed'],True,,
facebook/react,33541,Bug: React date input not working with iOS voiceover,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1. Add input with input type date like in this codesandbox https://codesandbox.io/p/sandbox/x6ctp5?file=%2Fsrc%2FApp.js
2. Access codesandbox link https://x6ctp5.csb.app/ or similar on browser on an iPhone with voiceover on
3. When the datepicker is focused, calander doesn't become visible, which blocks voiceover users from using this element

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->
https://codesandbox.io/p/sandbox/x6ctp5?file=%2Fsrc%2FApp.js

## The current behavior
- Calendar doesn't show up in datepicker when element is selected in voiceover

## The expected behavior
- Calander should show up when selected","['Type: Bug', 'Browser: Safari', 'Component: DOM']",open,2025-06-16T16:54:39Z,,bug,"['type: bug', 'browser: safari', 'component: dom']",True,,
facebook/react,33537,Bug: Detached DOM Elements(leading memory leaks) when HTML element removed from DOM,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.1 (or previous versions)

## Steps To Reproduce

1. render HTML elements conditionally (e.g. boolean `expanded` state

```tsx
return <>
  ...
  {expanded && <div>foo</div>}
</>
```

2. toggle state to add HTML elements to DOM, and again, remove from DOM

```tsx
const [expanded, setExpanded] = useState(false);
return <>
  <button onClick={() => setExpanded((prev) => !prev)}>click</button>
  {expanded && <div>foo</div>}
</>
```

and it causes detached DOM elements.

<img width=""608"" alt=""Image"" src=""https://github.com/user-attachments/assets/9c56bbf0-35b4-4374-92c1-2580c8458608"" />

But it is just for html element (e.g. `<div>, <span>, ...`), Component does not leave detached DOM elements.

e.g. seperate `<div>foo</div>` into `<Foo />`

```tsx
function Foo() {
  return <div>foo</div>
}
```

and doing the same thing

```tsx
...
return <>
  ...
  {expanded && <Foo />}
</>
```

And it does NOT leave detached DOM elements

Link to code example: https://jpjc6x.csb.app/ (original code [here](https://codesandbox.io/p/devbox/fast-sun-forked-jpjc6x?workspaceId=ws_P1kPHJcWfBAZ6ct4VP59FD) )

I'm not sure if this is considered a bug that needs to be fixed, but I'd at least like to know what difference between the two cases is causing this (html elements being left with a detached DOM, but components not).

## The current behavior

remains detached DOM elements, causing memory leaks

## The expected behavior

no detached DOM elements",['Status: Unconfirmed'],closed,2025-06-15T10:03:39Z,2025-06-16T12:31:33Z,bug,['status: unconfirmed'],True,1.0,
facebook/react,33536,Bug: Server functions report false positive errors for MobX observables,"Server functions will falsely report an error in development when called with a MobX observable, but the value is (usually) correctly serialized.

As far as I can tell, this is because MobX observables are Proxies, and either add `.toJSON()` methods to wrapped values which return different values in `JSON.stringify()` than the ""original value"", or they add a special `Symbol(mobx administration)` to objects which are skipped over in serialization.

This is probably more of a [MobX issue](https://github.com/mobxjs/mobx/issues/4561), but I want to report it here in case React is able to refine the heuristic for when these errors are reported, as the current message can be confusing.

<img width=""700"" alt=""Image"" src=""https://github.com/user-attachments/assets/09c5bd4c-c5c2-4865-b6f1-5dcdf3bceff8"" />

React version: 19.1.0

## Steps To Reproduce

1. Create a server function which accepts any parameter.
2. On a dev server, call the server function with a MobX observable value.

Link to code example: https://codesandbox.io/p/devbox/2w4qqc

## The current behavior
Server functions falsely report an error in development when serializing MobX observable values.

## The expected behavior
Ideally, server functions would report errors only if the serialized shape doesn't match the original value's shape, and the current errors with MobX would appear more as warnings.

Another idea, which is more of an enhancement than a bug fix, is to let data expose a React-known symbol method like `[Symbol.for(react.toRSC)]()` which React would call and use the result of over the `.toJSON()` value. It would then be up to libraries like MobX to implement the symbol method.",['Status: Unconfirmed'],open,2025-06-15T01:09:51Z,,bug,['status: unconfirmed'],True,,
facebook/react,33534,Bug: Server functions error when returning a client reference,"Returning a temporary client reference from a server function causes an error.

My understanding of the issue is that `async` functions will automatically check return values for `.then()` methods in order to flatten nested promises. However, client references in server functions [guard access to virtually all properties](https://github.com/facebook/react/blob/6b7e207cabe4c1bc9390d862dd9228e94e9edf4b/packages/react-server/src/ReactFlightServerTemporaryReferences.js#L74-L79).

<img width=""882"" alt=""Image"" src=""https://github.com/user-attachments/assets/f39a08b2-51a0-4d72-acac-adab03218284"" />

React version: 19.1.0

## Steps To Reproduce

1. Create a server function which would return a client reference.
2. Call the server function from the client with a client reference (non-RSC-serializable value).

Link to code example:
https://codesandbox.io/p/devbox/server-function-cant-return-client-reference-477k4c

## The current behavior
The server function errors before returning a client reference.

## The expected behavior
The server function should return the same client reference without error. Client references should not guard accessing the `then` property, and should instead return `undefined`.
",['Status: Unconfirmed'],open,2025-06-14T21:03:18Z,,bug,['status: unconfirmed'],True,,
facebook/react,33519,"Bug: [React Refresh] React Refresh edge case, class fields are mistakenly treated as React Component","React version: all React version

## Steps To Reproduce

Related issue https://github.com/web-infra-dev/rsbuild/issues/4730

Link to code example:

https://github.com/dartess/rsbuild-class-hmr

## The current behavior

hmr not works when change `Feature value`. `Rspack` and `Webpack` have same issue.

## The expected behavior

hmr works",['Status: Unconfirmed'],open,2025-06-12T17:03:01Z,,bug,['status: unconfirmed'],True,,
facebook/react,33510,Feature Request,,['Status: Unconfirmed'],closed,2025-06-11T18:31:50Z,2025-06-11T19:38:58Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33503,Bug: React 19 - Suspense Siblings Fall Back to Sequential Loading Under Load,"Originally posted in [this issue](https://github.com/facebook/react/issues/29898#issuecomment-2960843341).

The same code can execute sequentially or concurrently depending on the performance of the react application and the device.

In a challenging performance situation, Suspense siblings initialize as a waterfall instead of concurrently.

React version: 19.1.0

## Steps To Reproduce


### Source Code Links: Two Different Suspense-using libraries

- Using @tanstack/react-query: [codesandbox.io](https://codesandbox.io/p/sandbox/magical-star-m4mh8w?file=%2Fsrc%2FApp.tsx%3A3%2C35-3%2C56)
- Using @apollo/client: [codesandbox.io](https://codesandbox.io/p/sandbox/bold-herschel-knp4jx)

### Repro Steps:

1. Open the app in a new tab ([Example link for @tankstack/react-query](https://m4mh8w.csb.app/))

<img width=""500"" alt=""Image"" src=""https://github.com/user-attachments/assets/806fd4c7-cd2b-4483-ae18-c57b6c3e3e19"" />

2. Open network tools and refresh the page
3. Notice that the requests to dummyjson are made **in parallel**

<img width=""500"" alt=""Image"" src=""https://github.com/user-attachments/assets/50909f37-b1a3-4d98-8aa0-12004d0f00fa"" />

4. Visit the performance tab in chrome devtools and apply 20x slowdown

<img width=""500"" alt=""Image"" src=""https://github.com/user-attachments/assets/774e21d7-8339-4331-9389-1412c62106cf"" />

5. Refresh the page
6. Notice that the requests to dummyjson are made **in sequence**

<img width=""500"" alt=""Image"" src=""https://github.com/user-attachments/assets/bebff552-cde7-4a4e-8318-434c4b5bd9b5"" />
",['Status: Unconfirmed'],closed,2025-06-11T02:16:20Z,2025-06-11T22:27:28Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33502,[Compiler Bug]: Functions defined in render that return primitives don't have usages memoized,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCAyngIZ4IEC+BAZjBBgQOQwJVx4cBuADoA7UUygi+aCCIIAhKgBMAFAEoioggTiywhANq7JtGABoCZPAGFoI0wF0CAXhJlKNBCoAMa4WLlmSWlZAgQADywEETA0ADcEW2woajwZEXVNQO0mXAIVABsEQjQXAm8BAlKAHgIATga6yrQAahaNYC1tBi7tbjxYOQBmf216US6AekmCJKwUhCUw3gALAm4RJQQYAEIu3RjCCKiY+IQANSoCqDpXY+jYhLmUmnT1fy7+wYJqgCMUvChWTWApoOAAa2cwEyzgAfJZirYTNsVHI4QQ5C0CABGNT0WFI+zIIjGezbRjAe6nBKXa4IejVSb-PCAkSw0TjAISKRpUIAcQgEFUHX2ekMpNMFishMcZVIFFSXl8H0C3JCcipj0SbHmqTeIuyzDyhWKVTKFTNtUaTSqbQN3R6hq+MDkxDiVxuxKGDFGjqmMwAchBCLpkrQljw4GsNltdqLDmFIg8zrSbmVNWdnnrZO8JoFnXI-gCgSIQWDIdCNOjpXZTKiXPDMTi8QTa8TgBLyUQMzSPQgAHTuukMpnFtkcvNq3lyACCBUgAqFmU6gQO+gIRlr2yliK3MCcrnlHloPj8ee00wIQZDOoWEdW62isb2q7FiZOWtTt3fyaet+zGRngEfTFN8RYsiWZYQlCMLwjWyIwPW6JNri+Iyu2nYwBSPYXH2I7Mqy7IiJy4jBNOP7UtqYavDm9pGjA+RFCU5rND89SNM0dpZGMnygS6BAjByID0EAA

### Repro steps

Loving the compiler so far! Here's a bit of an inconsistency I've discovered - apologies if it's been brought up elsewhere.

If a function:

- is defined in the body of a component
- returns a primitive value, instead of an object

calls to it won't be memoized, even if it's particularly expensive.

Here's an example of what I mean: `expensiveComputation` is called every render (i.e. every time the button is clicked).

```jsx
function Bad() {
  const [counter, setCounter] = useState(0);

  function expensiveComputation() {
    for (let i = 0; i < 9999; i++) {
    }
    return 3;
  }

  // Computed each render!
  const expensiveValue = expensiveComputation();

  return <button onClick={() => setCounter(n => n + 1)}>Count: {counter} {expensiveValue}</button>
}
```

What's interesting is that the function reference itself is actually memoized - it's just calls to it that aren't.
```jsx
  let t0;
  if ($[0] === Symbol.for(""react.memo_cache_sentinel"")) {
    t0 = function expensiveComputation() {
      for (let i = 0; i < 9999; i++) {}
      return 3;
    };
    $[0] = t0;
  } else {
    t0 = $[0];
  }
  const expensiveComputation = t0;
```

Again, this issue does not occur if the function returns an object:

```jsx
function Good() {
  const [counter, setCounter] = useState(0);

  function expensiveComputation() {
    for (let i = 0; i < 9999; i++) {
    }
    return { value: 3 };
  }

  // Not computed each render!
  const expensiveValue = expensiveComputation();

  return <button onClick={() => setCounter(n => n + 1)}>Count: {counter} {expensiveValue.value}</button>
}
```

Or if the function is defined outside the component: 

```jsx
function AlsoGood() {
  const [counter, setCounter] = useState(0);

  // Not computed each render!
  const expensiveValue = expensiveComputation();

  return <button onClick={() => setCounter(n => n + 1)}>Count: {counter} {expensiveValue}</button>
}

function expensiveComputation() {
  for (let i = 0; i < 9999; i++) {
  }
  return 3;
}
```




### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.2","['Type: Bug', 'Status: Unconfirmed']",open,2025-06-11T01:48:19Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33498,Bug: Context.Consumer re-rendering children with unchanged context value in react 19.,"After upgrading to react 19, I noticed a performance regression due to unexpected re-rendering in my react app.

I have a setup with a context that gets updated, but some child trees override that context with their own value and do not always update when the outermost context updates.

In react 18, as expected, children consuming the context (either via `useContext` or `Context.Consumer`) did not re-render when the outermost context value updated, as long as their tree had an additional context provider that kept a stable context value.

In react 19, this behavior is maintained for `useContext`, but `Context.Consumer` re-renders its children.

React 18 example: https://codesandbox.io/p/sandbox/dqzj8j
React 19 example: https://codesandbox.io/p/sandbox/j9zrsy

The code is the exact same other than the react dep version.

You can see in the React 18 example, both `ChildA` and `ChildB` never render again as they are wrapped in `memo` and the context value does not change in their tree. In the react 19 example though, `ChildB` re-renders every time the value in the outermost context updates, even though that context is re-provided for the tree containing `ChildB`.

---

**Update 16/06:** I've noticed that in react 19, the `useContext` example DOES run the component and do most of the work involved, it just doesn't actually commit the render. I observed this by putting a `console.log` in the component to see if it's running.

The concern here isn't because we depend on side effects or anything like that, it's that some of our components are unfortunately quite expensive to run, and this context is consumed everywhere!

Until now, we've been running on the assumption that as long as the context value for that subtree remained stable, that components would not re-run (which was true pre react 19)

It took a while for us to understand this as this manifests as work being done to run all the consumers (visible in chrome performance profile), but then the work missing from the flamegraph in react profiler since nothing is actually rendered. (You can see it accounted for in the total render time in the timeline tab of react profiler though)

[Here's](https://codesandbox.io/p/devbox/modest-roman-forked-k3dtws?workspaceId=ws_97qDTdYsHzPsCzLfZRrEpQ) what we are doing for a workaround right now to avoid the perf penalty. We're creating a second context and using `useContext(FooOverride) || use(Foo)` to conditionally call the ""main"" context.



",['Status: Unconfirmed'],open,2025-06-10T14:34:50Z,,performance,['status: unconfirmed'],True,,
facebook/react,33489,Bug: infinite re-renders when queueing state updates via promises during render,"React version: 18.3.1

## Steps To Reproduce

1. [Created a sandbox to illustrate the issue](https://codesandbox.io/p/sandbox/react-18-playground-forked-w2jds3?file=%2Fsrc%2FApp.tsx).
2. Open and it ""trigger"".
3. Check the console. 100 renders are scheduled after hitting trigger, despite `setState` sets the same value.

## The current behavior

* You will see more than 100 re-renders until we stop it, otherwise it would indefinitely run.

* This does not happen on React 17, React 18 with legacy root and React 19 (at least in the sandbox, could be due to auto-optimization of the component via the compiler). Happens in all React 18 versions.

## The expected behavior

* Calling `setState` with the same value already set, even in an asynchronous promise, should not re-trigger the render of the component, even if the operation of updating the state asynchronously within a component is not officially supported.",['Status: Unconfirmed'],open,2025-06-09T21:00:34Z,,bug,['status: unconfirmed'],True,,
facebook/react,33479,Bug: [React 18] `act` in tests can alter autobatching behavior compared to production in 18.3.1,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 18.3.1

## Steps To Reproduce
*Please refer to the CodeSandbox link below for a complete repro.*

1. Trigger a fetch request by clicking a button that internally calls two setState calls: `setIsLoading(true)` followed by `setIsLoading(false)` once the API call completes.
2. Use `act` to mimic the behavior in a test using React Testing Library:

```js
<button
    onClick={async () => {
      act(() => {
        handleClick();
      });
      await act(async () => {
        await waitForAPICall();
      });
    }}
  >
```

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example: https://codesandbox.io/p/devbox/practical-neumann-g82dcv?workspaceId=ws_8edRzHnWwZWJh5UnZUEo7c

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior
- We see `Trigger onComplete callback for fetch API` is not logged in the console, because `setIsLoading(true)` and `setIsLoading(false)` are batched into a single render, causing the callback of `useEffect` not to run.

- This behavior does not match the production app (`act` is not used), where the two state updates trigger separate renders as expected.

- Removing `act` from the logic results in two renders, though it causes a React warning (""Warning: An update to App inside a test was not wrapped in act(...)"") in tests.

Additional observations:

- If I don't await fetch params before the `setIsLoading(true)` call (No `await getFetchParams()`), the test still causes two re-renders, even inside `act`.

- This issue does not occur when upgrading to React 19.1.0.

Based on these observations, it appears that using `act` in tests can alter the autobatching behavior in React 18.3.1, potentially reducing test reliability.

## The expected behavior
- Using `act` in tests should preserve the same autobatching behavior seen in production.
- In this case, `setIsLoading(true)` and `setIsLoading(false)` should result in two separate renders inside tests, just as they do in a real app.
",['Status: Unconfirmed'],open,2025-06-07T09:26:45Z,,bug,['status: unconfirmed'],True,,
facebook/react,33461,Bug: Getting 409 Error for CustomPouchError with pouchdb-browser,"<!--
  

-->

React version:
17.0.2

## Steps To Reproduce

1. Calling this code giving exception - 
2. updateCompanyConfiguration({
      _rev:
        companyConfigurations && companyConfigurations._rev
          ? companyConfigurations._rev
          : """",
      ...$_companyConfiguration,
    })
      .then((response) => {
        if (response.ok) {
          console.log(response);
        } 
      })
      .catch((error) => {
        console.log(error);
      });

3. Code is giving exception- 
export function updateCompanyConfiguration(doc) {
  let _rev = doc._rev;
  delete doc._rev;
  return companyConfigurationDB.put({
    _id: ""1"",
    _rev: _rev,
    ...doc,
  });
}

4. Exception 
Exception:  at new CustomPouchError (http://localhost:3000/static/js/vendors~main.chunk.js:162322:20)
    at createError (http://localhost:3000/static/js/vendors~main.chunk.js:162331:10)
    at updateDoc (http://localhost:3000/static/js/vendors~main.chunk.js:165828:15)
    at nextDoc (http://localhost:3000/static/js/vendors~main.chunk.js:165927:9)
    at http://localhost:3000/static/js/vendors~main.chunk.js:165936:5
    at Map.forEach (<anonymous>)
    at processDocs (http://localhost:3000/static/js/vendors~main.chunk.js:165913:13)
    at idbProcessDocs (http://localhost:3000/static/js/vendors~main.chunk.js:166255:5)
    at checkDone (http://localhost:3000/static/js/vendors~main.chunk.js:166273:9)
    at IDBRequest.readMetadata (http://localhost:3000/static/js/vendors~main.chunk.js:166281:7)

<img width=""238"" alt=""Image"" src=""https://github.com/user-attachments/assets/2016fc8f-0db4-4eb8-8274-9efd1c5af104"" />


<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],open,2025-06-06T13:14:12Z,,bug,['status: unconfirmed'],True,,
facebook/react,33460,"Bug:  In the unmount function returned by createRoot, an imprecise comparison statement causes the first unmount failed, affecting subsequent program operations.","
<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

<img width=""669"" alt=""Image"" src=""https://github.com/user-attachments/assets/769da050-8abc-4417-bdfe-b69fa93518b0"" />

<img width=""419"" alt=""Image"" src=""https://github.com/user-attachments/assets/1426baad-11ed-41df-9335-8cdd7ac3be2c"" />

React version: 19.1.0

## Steps To Reproduce
1. Start a react app, and unmount， it failed.
This can cause some problems when applied as a multi-instance child in a micro frontend
<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],open,2025-06-06T07:57:45Z,,bug,['status: unconfirmed'],True,,
facebook/react,33437,Bug: same inline styles are considered different by hydration,"Hi, I got this error in my console:
```
A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. This can happen if a SSR-ed Client Component used:

- A server/client branch `if (typeof window !== 'undefined')`.
- Variable input such as `Date.now()` or `Math.random()` which changes each time it's called.
- Date formatting in a user's locale which doesn't match the server.
- External changing data without sending a snapshot of it along with the HTML.
- Invalid HTML tag nesting.

It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.

https://react.dev/link/hydration-mismatch

  ...
                  <Banner>
                    <BannerComponent__BannerWrapper style={{...}}>
                      <div
                        style={{
+                         --banner-color: ""#CDECDE""
-                         --banner-color: ""#CDECDE""
+                         --text-color: ""#686ae5""
-                         --text-color: ""#686ae5""
+                         --btn-color: ""#CDFFAA""
-                         --btn-color: ""#CDFFAA""
+                         --btn-text-color: ""#ff0000""
-                         --btn-text-color: ""#ff0000""
                        }}
                        className=""BannerComponent__BannerWrapper-sc-1o07lih-0 ctOXQs""
                      >
                  ...
                ...
```

The weird thing is that the parts of code that are supposed to be different are actually completely equal. I checked in notepad++ with hidden chars displayed and even line endings are same, all the chars are same. So i guess there's nothing to throw error about. How can this even happen?

Also, shouldn't react hydration algorithm cut some slack for such stuff as inline styles? I browsers can have differences in implementations of attributes if they are calculated dynamically, so it can happen that there would be some differences in spaces or capital vs. lowercase hex codes. These are stuff that shouldn't matter and are in fact same. I think it is not possible to achieve 100% identity of react's output on backend and every browser's implementation of values.",['Status: Unconfirmed'],open,2025-06-04T21:31:12Z,,bug,['status: unconfirmed'],True,,
facebook/react,33435,Bug:,"I'm having a very specific issue inside a complex project that I can't give a minimal reproduction example of.

Basically I mount a React component using `createRoot(document.getElementByid('...')).render(<MyComponent />`

For some reason, `<MyComponent />` can end up being unmounted due to an error in one of its children.

I know that description is very vague, but do you have any idea what could cause the root element mounted using `createRoot().render()` to be unmounted? This would be very helpful to try to debug a more precise portion of the code I have.

I haven't found anything in the docs indicating that a component mounted using `createRoot().render()` could ever be unmounted without explicitly calling `.unmount()` (which I don't).",['Status: Unconfirmed'],open,2025-06-04T11:35:07Z,,bug,['status: unconfirmed'],True,,
facebook/react,33428,Bug: performance: `createPortal()` attaches listeners even in contained roots,"I'm working on a new virtualization engine for the MUI X Data Grid and other components. I was hoping to be able to do some work outside of react for performance reasons, and to tie React in with portals, but the base cost of adding portals is too high for that use-case due to the event listeners that are added on new roots. 

React version: 19

## Steps To Reproduce

1. Create a portal inside the app's main root

Link to code example: https://stackblitz.com/edit/mui-virtual-exploration


## The current behavior

React attaches event listeners to new portal roots even when the root node is contained by the main app root node. It creates a lot of overhead for cases where multiple portals are attached at once.

<img src=""https://github.com/user-attachments/assets/59ccb728-b742-454c-b28e-26433e9d1f63"" width=""450"" />

## The expected behavior

No added listeners if the root is contained in the main root.

",['Status: Unconfirmed'],open,2025-06-03T19:08:33Z,,bug,['status: unconfirmed'],True,,
facebook/react,33423,Bug: profiler incorrectly reports 'The parent component rendered',"React version: 19.0.0

Devtools version: 6.1.2 (5/7/2025)

Chrome: 136.0.7103.114 

Windows 11

## Steps To Reproduce

1. Go to this codesandbox link https://codesandbox.io/p/sandbox/optimistic-ritchie-forked-yhhjl4 
2. Specifically open the preview in a new tab at https://yhhjl4.csb.app/ otherwise react devtools won't attach
3. Enable ""Highlight updates when components render"" in react dev tools
4. Click the numbered button to cause a rerender

<summary>
Full code (click to show)

<details>

```tsx
import { useState, useRef } from ""react"";

const Count = () => {
  const [count, setCount] = useState(0);
  return <button onClick={() => setCount((c) => c + 1)}>{count}</button>;
};

export function Greeting() {
  const renderCount = useRef(0);
  renderCount.current++;
  console.log(""Greeting rendered"");
  return <span>Hello World! (rendered {renderCount.current} times)</span>;
}

export default function App() {
  return (
    <div>
      <Count />
      <div>
        <Greeting />
      </div>
    </div>
  );
}
```

</details>
</summary>

## The current behavior

The Greeting component will flash as being rerendered even though it isn't

![Image](https://github.com/user-attachments/assets/19acd9a6-6a25-499e-89dd-0fe8bcb954a7)

If you record via the profiler, the cause is given as ""The parent component rendered"", but it did not

![Image](https://github.com/user-attachments/assets/e2943445-85d2-42dd-8d2f-7c4ab3715ace)

## The expected behavior

It neither flashes, nor is reported in the profiler flamegraph after being recorded. It didn't rerender.

----

Here's some variants I tested:

✅= Greeting correctly reported as **not** rerendering
❌ = Greeting incorrectly reported as rerendering

```tsx
//✅ Same level
<Count />
<Greeting />

//✅ Greeting above
<div>
    <Greeting />
    <div><Count /></div>
</div>

// ❌ Greeting below in div
<Count />
<div>
    <Greeting />
</div>

// ❌ Greeting below in empty fragment 
<Count />
<>
    <Greeting />
</>
```

---

This is the same as #19732. Reopening here as per the directions in https://github.com/facebook/react/issues/19732#issuecomment-2061919359

",['Component: Developer Tools'],open,2025-06-03T16:20:59Z,,bug,['component: developer tools'],True,,
facebook/react,33419,Feature Request: [react-hooks/exhaustive-deps] Add option to ignore specific values in hook dependency arrays,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.1.0

## Steps To Reproduce

1. Create eg. const {push}= useRouter()
2. Use that setter inside a `useEffect` or `useCallback` or another hook
3. Leave the dependency array empty or intentionally exclude the function
4. Observe a warning from `react-hooks/exhaustive-deps`

Example:

```tsx
const {push}= useRouter()

useEffect(() => {
  // do something
  push(""something""); // I don't need to add `push` to dependencies, but I get a warning
}, []);
```


## The current behavior
The linter produces a warning:
`React Hook useEffect has a missing dependency: 'push'. Either include it or remove the dependency array.
`
Even though ""push"" is a stable function, the linter still suggests adding it. The current workaround is to disable the rule entirely for that line:
`// eslint-disable-next-line react-hooks/exhaustive-dep`

However, this disables the entire rule, which increases the risk of overlooking important dynamic dependencies in more complex hooks.

## The expected behavior

I’d like to have a way to ignore specific values in the dependency array without disabling the whole rule.
For example, something like:
`// eslint-disable-next-line react-hooks/exhaustive-deps --ignore push`

This would allow developers to suppress false positives selectively, while still benefiting from the rule’s guidance on other dependencies.

## Why this matters

1. It avoids the risk of over-disabling the rule entirely with eslint-disable-next-line.
2. It allows safe, intentional handling of well-known stable values (e.g., setState, context dispatchers, router methods).
3. It improves the developer experience, especially in large codebases using hooks heavily.

Thank you for considering this feature!
",['Status: Unconfirmed'],open,2025-06-03T12:39:23Z,,bug,['status: unconfirmed'],True,,
facebook/react,33418,Bug: better-auth incompatibility with react-19 regarding export of useSyncExternalStore & useRef," pnpm run build

> clairly@0.1.0 build D:\0.MASUMKHAN\PROJECTS-TECHNEXT\clairly
> next build

   ▲ Next.js 15.3.1
   - Environments: .env

   Creating an optimized production build ...
Failed to compile.

./node_modules/.pnpm/better-auth@1.2.5_typescript@5.7.3/node_modules/better-auth/dist/client/react/index.mjs
Attempted import error: 'useRef' is not exported from 'react' (imported as 'useRef').     

Import trace for requested module:
./node_modules/.pnpm/better-auth@1.2.5_typescript@5.7.3/node_modules/better-auth/dist/client/react/index.mjs
./lib/auth-client.ts

./node_modules/.pnpm/better-auth@1.2.5_typescript@5.7.3/node_modules/better-auth/dist/client/react/index.mjs
Attempted import error: 'useSyncExternalStore' is not exported from 'react' (imported as 'useSyncExternalStore').

Import trace for requested module:
./node_modules/.pnpm/better-auth@1.2.5_typescript@5.7.3/node_modules/better-auth/dist/client/react/index.mjs
./lib/auth-client.ts


> Build failed because of webpack errors
 ELIFECYCLE  Command failed with exit code 1.",['Status: Unconfirmed'],open,2025-06-03T10:17:25Z,,bug,['status: unconfirmed'],True,,
facebook/react,33417,Bug: ❤️,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-06-03T07:48:15Z,2025-06-03T10:56:03Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33416,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-06-03T06:02:49Z,2025-06-03T12:33:14Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33410,Bug: useId generates invalid ids for SVG elements.,"React version: 19.1.0

Following https://github.com/facebook/react/pull/32001 the `useId` hook now generates identifiers wrapped in `«»` in place of `::` to avoid issues in CSS selectors. However, chevrons are not allowed in the id attribute of SVG elements, which must be valid XML 1.0 names.

In practice, user agents do not enforce such a requirement and SVG renders properly, though some HTML validators will complain.

More problematic is that using `outerHTML` on an `<svg>` element in order to export it as a separate file now produces an invalid SVG document, which third party software less lenient than browsers will refuse to open. That is how I discovered the issue; the SVG files exported from my web app could no longer be imported by my image editor following the change in `useId`.

Link to an example: https://codesandbox.io/p/sandbox/divine-forest-my4y8w
Validating the rendered page with the Nu HTML checker gives us:
> Error: Bad value «r0» for attribute id on element circle: Not a valid XML 1.0 name.

## The current behavior

`useId` generates an id wrapped in `«»` which is *technically* not allowed in SVG element ids.

## The expected behavior

`useId` should either produce valid XML 1.0 names, or the documentation should explicitly warn that its generated ids are not valid for foreign elements.

## Workaround

As a workaround, I've wrapped `useId` in a function that replaces `«»` with a pair of underscores.",['Component: DOM'],closed,2025-06-03T01:25:03Z,2025-06-10T10:50:03Z,bug,['component: dom'],True,7.0,
facebook/react,33398,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-06-01T13:39:47Z,2025-06-03T12:43:14Z,bug,['status: unconfirmed'],True,1.0,
facebook/react,33397,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-06-01T13:39:45Z,2025-06-03T10:55:59Z,bug,['status: unconfirmed'],True,1.0,
facebook/react,33396,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-06-01T13:39:41Z,2025-06-03T12:43:10Z,bug,['status: unconfirmed'],True,1.0,
facebook/react,33391,Bug: [eslint-plugin-react-hooks] No `react-hooks/exhaustive-deps` warning when an unstable reference is passed to hook's callback parameter,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.1.0
eslint-plugin-react-hooks version: 5.2.0

## Steps To Reproduce

1.
    ```bash
    git clone https://github.com/aweebit/eslint-plugin-react-hooks-unstable-reference-issue.git`
    cd eslint-plugin-react-hooks-unstable-reference-issue
    npm install
    ```
2. Run `npm run lint` and observe how there are no warnings.
3. Run `npm start`, open the served page in your browser and look at the console output.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to example repository: https://github.com/aweebit/eslint-plugin-react-hooks-unstable-reference-issue

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

Here is the full example code:

```js
import { createElement, useEffect, useReducer } from ""react"";
import { createRoot } from ""react-dom/client"";

let bar = () => console.log(""good"");

function Example() {
  console.log(""rendering"");
  const [updateTrigger, triggerUpdate] = useReducer(() => ({}), {});

  useEffect(() => {
    const timeout = setTimeout(triggerUpdate);
    return () => clearTimeout(timeout);
  }, []);

  useEffect(bar, [updateTrigger]);

  return null;
}

createRoot(
  /** @type {HTMLDivElement} */ (document.getElementById(""root""))
).render(createElement(Example));

setTimeout(() =>
  setTimeout(() => {
    console.log(""changing bar"");
    bar = () => console.log(""evil"");
  })
);
```

## The current behavior

No ESLint warnings

## The expected behavior

```
15:3  warning  React Hook useEffect received a function whose dependencies are unknown. Pass an inline function instead  react-hooks/exhaustive-deps
```

## Details

The expected behavior is what happens if you write

```js
const foo = { bar: () => console.log(""good"") };
```

and replace `bar` with `foo.bar` everywhere.

The warning makes perfect sense since there is no way for the linter plugin to know for sure `foo.bar` doesn't change between renders. But there is also no way for it to know it if a variable declared with `let` such as `bar` is passed! That's why a warning also has to be produced in that case.

On the other hand, if the variable passed was declared with `const`, it is fine to not produce any warning because in that case, the plugin would have a guarantee it's a stable reference.

The issue was discovered in https://github.com/facebook/react/issues/31207#issuecomment-2925440287.",['Status: Unconfirmed'],open,2025-05-31T17:54:48Z,,bug,['status: unconfirmed'],True,,
facebook/react,33361,Bug: formMethod specified on the submit button doesn't override the method from useFormStatus.,"React version: 19.1

When using formMethod on a submit button (<button type=""submit"" formMethod={""post""}> or <input type=""submit"" formMethod={""post""}>), it should override the parent form's method. However, it does not.

## Steps To Reproduce

1. Open example (link below)
2. Click to any ""Submit button""
3. under the text input field will ""method"" will be shown.

Link to code example:

https://codesandbox.io/p/sandbox/react-dev-forked-ks99yw

## The current behavior

Displayed method: dialog

## The expected behavior

Displayed method: post
",['Status: Unconfirmed'],open,2025-05-27T21:01:13Z,,bug,['status: unconfirmed'],True,,
facebook/react,33360,[Compiler Bug]:,"### What kind of issue is this?

- [ ] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [x] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

http://github.com/yungsters/react

### Repro steps

I'm encountering a failure when running `yarn` from a fresh checkout of `facebook/react`:

```
$ git clone git@github.com:yungsters/react.git
$ cd react/compiler
$ yarn
```

This is the failure output:

```
$ yarn
yarn install v1.22.21
[1/4] 🔍  Resolving packages...

… omitted …

[4/4] 🔨  Building fresh packages...
[-/5] ⢀ waiting...
[2/5] ⢀ react-forgive
[-/5] ⢀ waiting...
[5/5] ⢀ snap
error /Users/yungsters/Projects/yungsters/react/compiler/node_modules/snap: Command failed.
Exit code: 1
Command: ./scripts/link-react-compiler-runtime.sh && perl -p -i -e 's/react\.element/react.transitional.element/' ../../node_modules/fbt/lib/FbtReactUtil.js && perl -p -i -e 's/didWarnAboutUsingAct = false;/didWarnAboutUsingAct = true;/' ../../node_modules/react-dom/cjs/react-dom-test-utils.development.js
Arguments: 
Directory: /Users/yungsters/Projects/yungsters/react/compiler/node_modules/snap
Output:




```

### How often does this bug happen?

Every time

### What version of React are you using?

N/A

### What version of React Compiler are you using?

main","['Type: Bug', 'Status: Unconfirmed']",open,2025-05-27T18:54:24Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33359,Bug:  [Error: Expected a suspended thenable. This is a bug in React. Please file an issue.] {   digest: '1832240620' },"
React version: 19.1.0

## Steps To Reproduce

the code example provided is a sub-directory of a repository, however it is completely independent.
1. open a terminal.
2. run `npm run dev`.
3. then proceed to visit the homepage of the project

Link to code example: https://github.com/solacode-ahw/solacode.ir/tree/development/home


## The current behavior
Right now nothing loads and in terminal I receive the following messages:
```
 ✓ Starting...
 ✓ Ready in 4.7s
 ✓ Compiled /middleware in 396ms (101 modules)
 ○ Compiling / ...
 ✓ Compiled / in 2.6s (833 modules)
 ⨯ [Error: Expected a suspended thenable. This is a bug in React. Please file an issue.] {
  digest: '1832240620'
}
 ⨯ [Error: failed to pipe response] {
  [cause]: [Error: Expected a suspended thenable. This is a bug in React. Please file an issue.] {
    digest: '1832240620'
  }
}
 GET / 500 in 5128ms
 ○ Compiling /_error ...
 ✓ Compiled /_error in 1841ms (1162 modules)

``` 

## The expected behavior
Load the page without this error",['Status: Unconfirmed'],open,2025-05-27T17:06:36Z,,bug,['status: unconfirmed'],True,,
facebook/react,33356,Bug: salam,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-26T16:02:27Z,2025-05-26T16:02:31Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33353,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-24T22:37:01Z,2025-05-25T14:04:38Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33352,Bug: renderToPipeableStream doesn't initiate streaming if the first node is a Fragment until the promise in Suspense resolves,"`renderToPipeableStream` behaves differently if the first element is a `div` or a `Fragment`. With a `div` it behaves well, it starts streamming just ahead, without waiting for the promise in `Suspense` to fullfill. With a `Fragment` it doesn't behaves well, it waits for the promise in `Suspense` to resolve to start streamming.
 
React version: 19.1.0

## Steps To Reproduce

1. Execute the code shown below with node, first do `renderToStream(""div"")`, and then do `renderToStream(React.Fragment)`
2. You will see the difference in behaviour. First case is good, second not.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

```javascript
const { renderToPipeableStream } = require(""react-dom/server"");
const React = require(""react"");

function renderToStream(Component) {
  const stream = renderToPipeableStream(
    React.createElement(
      Component,
      null,
      React.createElement(
        React.Suspense,
        null,
        new Promise((resolve) => setTimeout(resolve, 4000))
      )
    ),
    {
      onShellReady() {
        stream.pipe(process.stdout);
      },
    }
  );
}

renderToStream(""div""); // OK
renderToStream(React.Fragment); // NOT OK
```

## The current behavior
The current behavior is WRONG with `React.Fragment`. Enforces users to use an unnecessary parent `div` if they don't want to get stuck with a blank screen.

## The expected behavior
The expected behavior is there is no difference in behaviour with `React.Fragment` and `div`. `React.Fragment` should start streamming immediately, as `div` does, and not wait for the promise in `Suspense` to resolve.
",['Status: Unconfirmed'],open,2025-05-24T20:26:57Z,,bug,['status: unconfirmed'],True,,
facebook/react,33343,Bug: useActionState optimization too eager,"if the previous state parameter still exists when the server method exists, react will assume it was returned and ignore any data actually returned by the method.

React version: 
```
$ npm list --depth 1 
├─┬ @types/react-dom@19.1.5
│ └── @types/react@19.1.5 deduped
├─┬ next@15.3.2
...
├─┬ @types/react@19.1.5
│ ├── eslint-plugin-react-hooks@5.2.0
│ ├── eslint-plugin-react@7.37.5
│ ├── UNMET OPTIONAL DEPENDENCY babel-plugin-react-compiler@*
│ ├── react-dom@19.1.0 deduped
│ ├── react@19.1.0 deduped
├─┬ react-dom@19.1.0
│ ├── react@19.1.0 deduped
├── react@19.1.0
```

## Steps To Reproduce

1. on client component `const [serverState, formAction, isPending] = useActionState(myServerAction, initialState);
`
2. on server action `export async function myServerAction( prevState: MyData, post: FormData ): Promise<MyData> { const newState = prevState; ...and then update newState ... }` 


Link to code example:

See example code, started with `npx create-next-app@latest` today, at https://github.com/gcb/react_test_case_useActionState/tree/main/app

relevant files `app/client-form.tsx` and `app/server-action.ts`

## The current behavior

if server action return any value that was copied ""as reference"" (no need to get religious on js concepts, anything that prevents GC from wiping the source value counts), the server action (optimization?) will return no changes to the client.

for example 1,
```
export async function myServerAction( prevState: MyData, post: FormData ): Promise<MyData> {
	const newState = prevState; // bug. any change to object will be ignored.

	newState.message = ""hello from server"";
	console.log(newState);
	return newState;
}
```
server console will show:
> { ... message: ""hello from server""; }
but http request response sent to client will have empty changes (i.e. useActionState will keep client side value between re-renders)

example 2,
```
export async function myServerAction( prevState: MyData, post: FormData ): Promise<MyData> {
	const newState: MyData = { message: 'server value', data: prevState.data }; 
	const newTitle = post.get('title');
	if( newTitle ){
		newState.data.title = newTitle.valueOf() as string;
	} else {
		if( !newState.data.title ) newState.data.title = 'default from server';
	}
	newState.message = ""hello from server"";
	console.log(newState);
	return newState;
}
```
here server console will show updated values for all properties, but http response will signal that only '.message' was updated.

## The expected behavior

return the actual values returned by the server action.",['Resolution: Expected Behavior'],closed,2025-05-22T20:13:41Z,2025-05-23T08:20:58Z,bug,['resolution: expected behavior'],True,0.0,
facebook/react,33341,Bug: Hoisted <title> containing more than 1 JSX child will contain nothing,"React version: 19.1.0

## Steps To Reproduce

Add a `<title>` attribute with more than than 1 JSX child e.g.

`<title>{projectName} | Projects</title>`

or

`<title>{projectName}{section}</title>`

Link to code example: https://stackblitz.com/edit/vitejs-vite-nch86hgd?file=src%2FApp.tsx

## The current behavior

The title that gets hoisted to `<head>` is empty (i.e. `<title></title>`), with no console errors

## The expected behavior

The children are concatenated, e.g. `<title>My Project | Projects</title>`

You can of course work around the issue by ensuring there is only one child

`<title>{projectName + "" | Projects""}</title>`
","['Type: Enhancement', 'Component: DOM']",open,2025-05-22T15:48:28Z,,bug,"['type: enhancement', 'component: dom']",True,,
facebook/react,33324,Question: Suspense causes zombie entities in custom renderer due premature creation,"Hi, I’m reaching out to ask for help regarding an issue I’ve encountered when using Suspense with a custom React renderer that integrates with Babylon.js.

### Issue

I'm used to create the Babylon.js entities during the render phase, inside `createInstance` method. However, if React suspends, it may discard the entire tree before ever reaching the commit phase.

The problem is that my `createInstance` implementation immediately creates and attaches the Babylon entity to the scene graph. So, even though React throws the tree away, the entity stays in the scene and can't be cleaned up leading to ""zombie"" entities that were never committed but still exist.

This is expected behavior in React, it may build trees speculatively and discard them. So side-effects (like entity creation or mounting into a scene graph) must be deferred to the commit phase, not the render phase.

### Attempted workaround

To work around this, I’ve tried delaying Babylon.js entity creation until I’m sure React has committed the tree, by moving logic into `appendInitialChild`, `appendChildToContainer`, `appendChild`, `insertBefore`, `insertInContainerBefore`. 

```ts

appendInitialChild(parentInstance, child) {
   parentInstance.children.push(child);
   mountBabylonEntity(parentInstance, child);
}

appendChild(parentInstance, child) {
   parentInstance.children.push(child);
   mountBabylonEntity(parentInstance, child);
},

appendChildToContainer(container, child) {
   container.children.push(child);
   mountBabylonEntity(container, child);
},
 
insertBefore(parentInstance, child, beforeChild) {
   const index = parentInstance.children.findIndex(item => item.entity!.uniqueId === beforeChild.entity!.uniqueId);
   parentInstance.children.splice(index, 0, child);
   mountBabylonEntity(parentInstance, child);
},

insertInContainerBefore(container, child, beforeChild) {
   const index = container.children.findIndex(item => item.entity!.uniqueId === beforeChild.entity!.uniqueId);
   container.children.splice(index, 0, child);
   mountBabylonEntity(container, child);
}

```

Then i recursively mount the child entities only when React appears to be finalizing the tree.

```ts
// create recursively the Babylon.js instances
function mountBabylonEntity(parent: Instance | RootContainer, child: Instance, isReady: boolean) {

    const isParentRootContainer = parent.name === ROOT_IDENTIFIER; // true when the parent is a root container

    if (isParentRootContainer || isReady){
       finalTree.status = true;
       // generate child Babylon.js entity
       // generate parent Babylon.js entity
     
      for (const currentChild of child.children){
         mountBabylonEntity(child, currentChild, true);
      }
    }
}
```

This effectively delays creation until React commits the current child to container (`appendChildToContainer` is called, maybe wrong assumption). This kind of works, but  I'm unsure whether it's a good approach or if I'm misunderstanding how commit works in custom renderers.

### Code reference

You can see the relevant reconciler implementation here: https://github.com/simonedevit/reactylon/blob/delay-instance-creation/packages/library/src/reconciler.ts#L153.


### Versions

`react`: ^19
`react-reconciler`: 0.31.0",['Status: Unconfirmed'],open,2025-05-21T17:12:08Z,,bug,['status: unconfirmed'],True,,
facebook/react,33322,"[DevTools Bug] Cannot remove node ""25"" because no matching node was found in the Store.","### Website or app

https://vinaykumardku2zrjsivsfcbc.drops.nxtwave.tech/

### Repro steps

.

### How often does this bug happen?

Every time

### DevTools package (automated)

react-devtools-extensions

### DevTools version (automated)

6.1.2-4d6cf75921

### Error message (automated)

Cannot remove node ""25"" because no matching node was found in the Store.

### Error call stack (automated)

```text
at chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1228673
    at v.emit (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1195122)
    at chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1196729
    at bridgeListener (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1607819)
```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text
https://api.github.com/search/issues?q=Cannot remove node  because no matching node was found in the Store. in:title is:issue is:open is:public label:""Component: Developer Tools"" repo:facebook/react
```","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",open,2025-05-21T06:13:31Z,,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,,
facebook/react,33319,Bug: ViewTransition enter animation not working with useOptimistic,"The ViewTransition enter animation isn't executed when state is updated optimistically with useOptimistic. Exit animations work as expected. 

React version: 0.0.0-experimental-c4676e72-20250520

## Steps To Reproduce
1. Render a list of items that are stored with useOptimistic
2. Have a button to add an item to the list optimistically -> No animation
3. Switch out useOptimistic with useState
4. On button click the enter animation runs 

Link to code example: https://stackblitz.com/edit/vitejs-vite-2i7kmxtz?file=src%2FApp.tsx
Change useOptimistic to useState to see that the animation is executed with useState.

## The current behavior
Enter transitions don't work with useOptimistic.

## The expected behavior
Enter transitions are triggered when updating state optimistically with useOptimistic.",['Status: Unconfirmed'],open,2025-05-20T21:16:36Z,,bug,['status: unconfirmed'],True,,
facebook/react,33315,[Compiler Bug]: Todo: (BuildHIR::lowerExpression) Handle ??= operators in AssignmentExpression (164:164),"### What kind of issue is this?

- [ ] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [x] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [x] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAgHgBwjALgAjggDswCAVBM-AXnwAoBKWgPn2AB1j98AbBAugDcXHunwB+CXQCMAJgDMAFhHd8MAbG4AeACYBLAG4sAEgl68I+AOo5eu7QHoDxrgF8QboA

### Repro steps

Look at the repro link

### How often does this bug happen?

Every time

### What version of React are you using?

19

### What version of React Compiler are you using?

19.1.0-rc.2","['Type: Bug', 'Status: Unconfirmed']",open,2025-05-20T14:35:24Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33302,[Compiler Bug]: React fails to rerender list items when using compiler with zustand store,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBcMCAhnggQL4EBmMEGBA5AF5Rh7kB2AJqwDcAHV6Yc+IgS4IAygAtyAG2UQA7rQZMWHLjwEB6MuTh5DYJao3CxYhAA9JhOBF7cZYeQjx40vAHMwAgBeEhMqAAoASkjIrzwAGgIAn2jQgD4CSOAxAgY0ZSoYMGQiGkS8gjwIAIDlBAAxQuKyyPoWhBgASX50kKzc3nz813dCDqKu4LDUvBiAOknisFFhkYScgqmSsuIFg+Xp5IBtI57+AF0ygEJzsDPOi8utGmi1-IqqueadtvPev1BlV8mQ8LBhnNFvdHjtepcPrRKrw3u87LxHM4GFBeGY0G5PE0nnIfH5AmAYkQqmCIYSSb5-EFIiC6VY1OpmesRtliAlfsVkjU6g1+V1kmQ+U8wMkfk9kvdaECeSzuZKdsjudyhfUieqVSMJT5RSUNZr8rK9VzNfdTdy3izolU0Sj0WMPBAsH43DMCCcqsQ0PwyqwwIyGqwkf6CIHg-RyBhCgBPCNfdYBoNsVxQLDhyNp6MZ1gBJjZlOm9PB9RoPAKAC0-FqZbECPRmNwhH4CDjUCK2NxXuGAEEsFhKUNRt7CMQLQLqrUdcb5VKtGFZMb6WSmc7qT5aZzuQAefhoABuGX1wA9A7ACww5FHkSwTCwYCV+7NBAPAGEFGgsPruQAawQRMQmAJ8PRvQMaAAkYEF4cgACMGn4MCZy6R9nygvoYKtM03C-ZQ0DgQCwO1EUnlwj8RhPFQoAQMCIJfBZoNgwxzzwghomiXD9QPJ8EAyYAACk5AAeQAOQWbgYEZNB6ETdopWSXge2UZIACYeIPQwBI4w9DGPM8nTWXjeHoHE8QJH8-y2eCkJQ5ICKIkjklo5R6MVKl1hpGBhnffIj1PAhnOI0jgEpAYQt4Qiwsidz6J4-TNWABKEDoYB7OQhB+AIAB+NgspQiNg2PMAHJy1gqJGHSjOS51cJAGggA

### Repro steps

When running this example: https://stackblitz.com/edit/vitejs-vite-tnyshyjv?file=package.json,src%2FApp.jsx

Clicking the list items should toggle the text from `disabled` to `enabled`. It only does when `'use no memo';` is used. 

The `getFilter` function is referentially stable and the `map(Chips)` is cached using `getFilter` as a cache key. This however breaks because the function is using `get()` to retrieve up to date data from the zustand store. So even though the reference to the function remains the same the underlying data might have changed.

I'm not sure what a good solution would look like. I was thinking that one should be able to mark certain functions as `not memoizable`.

Currently I can only opt-out the entire file and when someone else uses `useFilterSettings` somewhere else they would be surprised.

Thanks





### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.2","['Type: Bug', 'Status: Unconfirmed']",open,2025-05-18T16:18:21Z,,bug,"['type: bug', 'status: unconfirmed']",True,,
facebook/react,33292,[DevTools Bug]: UI not using full window space,"### Website or app

tbd

### Repro steps

Sadly i dont know what could be the cause so i cant offer any way to reproduce it.
For me it is atleast not tied to a specific react application.

![Image](https://github.com/user-attachments/assets/054e62b7-83fd-4249-865a-a0cae3688b32)

### How often does this bug happen?

Every time

### DevTools package (automated)

_No response_

### DevTools version (automated)

_No response_

### Error message (automated)

_No response_

### Error call stack (automated)

```text

```

### Error component stack (automated)

```text

```

### GitHub query string (automated)

```text

```","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",closed,2025-05-16T15:55:38Z,2025-05-20T09:47:54Z,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,3.0,
facebook/react,33226,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-16T02:24:28Z,2025-05-16T16:22:04Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33225,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-16T02:24:25Z,2025-05-16T16:22:09Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33224,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-16T02:06:27Z,2025-05-16T02:06:33Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33223,[Compiler]: Suppressing ref validation errors makes it unclear why code accessing refs is unmemoized,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://stackblitz.com/edit/react-2u9hf3xf-vppqfxt7?file=src%2FTest.tsx,src%2FApp.tsx&terminal=dev

### Repro steps

Steps to reproduce:
- Open linked stackblitz
- Click ""Open preview in new tab""
- Open browser console
- Observe console statement (""_render_"") continuously printing, indicating an infinite rendering loop

Running the compiler on the following component will not optimize the `o` variable, even though `o` is passed as a dependency to the `useEffect`, thus leading to an infinite rendering loop:
```tsx
const Test = () => {
  const [, setState] = useState([]);
  // this should be memoized as it's passed as a dependency to the effect
  const o = {};
  useEffect(() => {
    setState([]);
  }, [o]);
  console.log('render');
  const myRef = useRef(1);
  return <div>{`${myRef.current}`}</div>;
};
```

The non-minified compiler output (`dist/assets/index-hash.js`) shows the lack of optimization:
```js
const Test = () => {
  const [, setState] = reactExports.useState([]);
  const o = {};
  reactExports.useEffect(() => {
    setState([]);
  }, [o]);
  console.log(""render"");
  const myRef = reactExports.useRef(1);
  return /* @__PURE__ */ jsxRuntimeExports.jsx(""div"", { children: `${myRef.current}` });
};
```

However, if the last line is replace with something not affected by the ref (such as `return 'here';`) the optimization does occur:
```js
const Test = () => {
  const $ = compilerRuntimeExports.c(6);
  let t0;
  if ($[0] === Symbol.for(""react.memo_cache_sentinel"")) {
    t0 = [];
    $[0] = t0;
  } else {
    t0 = $[0];
  }
  const [, setState] = reactExports.useState(t0);
  let t1;
  if ($[1] === Symbol.for(""react.memo_cache_sentinel"")) {
    t1 = {};
    $[1] = t1;
  } else {
    t1 = $[1];
  }
  const o = t1;
  let t2;
  if ($[2] !== setState) {
    t2 = () => {
      setState([]);
    };
    $[2] = setState;
    $[3] = t2;
  } else {
    t2 = $[3];
  }
  let t3;
  if ($[4] === Symbol.for(""react.memo_cache_sentinel"")) {
    t3 = [o];
    $[4] = t3;
  } else {
    t3 = $[4];
  }
  reactExports.useEffect(t2, t3);
  console.log(""render"");
  let t4;
  if ($[5] === Symbol.for(""react.memo_cache_sentinel"")) {
    t4 = /* @__PURE__ */ jsxRuntimeExports.jsx(""div"", { children: ""here"" });
    $[5] = t4;
  } else {
    t4 = $[5];
  }
  return t4;
};
```

This can be replicated by starting starting a project with `yarn create vite`, installing `babel-plugin-react-compiler` and updating `vite.config.ts`:
```ts
import { defineConfig } from ""vite"";
import react from ""@vitejs/plugin-react"";

export default defineConfig({
  plugins: [
    react({
      babel: {
        plugins: [[""babel-plugin-react-compiler"", {}]],
      },
    }),
  ],
  build: {
    minify: false,
  },
});
```

Versions:
```
  ""dependencies"": {
    ""react"": ""^19.1.0"",
    ""react-dom"": ""^19.1.0""
  },
  ""devDependencies"": {
    ""@eslint/js"": ""^9.25.0"",
    ""@types/react"": ""^19.1.2"",
    ""@types/react-dom"": ""^19.1.2"",
    ""@vitejs/plugin-react"": ""^4.4.1"",
    ""babel-plugin-react-compiler"": ""^19.1.0-rc.1"",
    ""eslint"": ""^9.25.0"",
    ""eslint-plugin-react-hooks"": ""^6.0.0-rc.1"",
    ""eslint-plugin-react-refresh"": ""^0.4.19"",
    ""globals"": ""^16.0.0"",
    ""typescript"": ""~5.8.3"",
    ""typescript-eslint"": ""^8.30.1"",
    ""vite"": ""^6.3.5""
  }
```

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Component: React Compiler', 'Compiler: Ref Validation']",open,2025-05-16T02:05:08Z,,performance,"['type: bug', 'component: react compiler', 'compiler: ref validation']",True,,
facebook/react,33210,[DevTools Bug]: Context display does not support HOC name tagging,"### Repro steps

We're using HOCs as a way to tag components with certain concerns, this gives us the ability to trim the React Devtools tree to trim down on components that are irrelevant or out of scope (or even specifically in scope).

![Image](https://github.com/user-attachments/assets/98b83e57-d148-4869-a27c-35d24a706bf8)

This works well, except that the name parsing does not apply for named contexts: 

```ts
const MyOverlayContext = createContext<ContextData | undefined>(undefined);
MyOverlayContext.displayName = 'overlay(MyOverlayContext)'
// shows up as overlay(MyOverlayContext).Provider, instead of MyOverlayContext.Provider [overlay]
() => <MyOverlayContext.Provider />
```

![Image](https://github.com/user-attachments/assets/601a949b-4052-44fd-8626-5896f52ba312)

(We're aware that this isn't how `ExoticNamedComponent` or HOCs are meant to be used, but they give us the ability to quickly search the tree for certain tags, quickly filter out many browser- or display-like nodes, like `<Button />`, <Icon />` and so on. If you're taking PRs, I would have a look at that, too.)


### How often does this bug happen?

Every time
","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",open,2025-05-15T11:56:01Z,,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,,
facebook/react,33209,[Compiler]: flags mutations of shared mutable refs and skips optimizations,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBcMCAhnggMIQB2VAHngDQFRgIBKCAZmxxr0mhAL4FeMCBgIAdEGXJw88gNyy6GuPTCFaUBghg9etQ8wIBeEoqpmRACgCU6zXW11dBAGIQIVgmcrAD4iDQISHUJtAypjPgDBewRmB31DeNNhFLwXDXCCMjxYOkCCiIAeACMoPDx6coiCemoAGzQ4AGtLYCDLUOBGpoI0XkCYjJMnSNijEwA6OFgyBgIAamsARldhiNFRRuChggBBABMzxoqAehq6+iPSgjy6UVcNFJx8SM9CE6wsAE+gMCtdrgQAMoAC3IZDObAwtXIVVaCAIdHoAFoAKoASQIADdyK0oAhQeCIfU4SNSuRCgl6gRyASIGgzgQ8DA0ABzblGemYlZnIxoOjcggAdyhCFKeGlhOJpJIMLFCDABQ8XgmcRMiU4JgcAAYXgUiiUyk9KukdXxksx5gAFKQEtn8okkhA9bVzPiiR67AgVXz+a7+3ZBvwEUPHCMhsOVa7Wn1Zcx4R3O10wMMvN4aECiIA

### Repro steps

Sometimes you need a shared, mutable value that isn’t tied to the UI but is used across multiple components. In these cases, you don’t want React to trigger re-renders when the value changes. To handle this, you can store the value in a ref and pass it down through context.

However, when a child component mutates this value (for example, inside an event handler), the compiler currently produces an error and causes optimizations to be skipped. I feel this is too restricted for what is otherwise a legitimate React pattern.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler', 'Compiler: Ref Validation']",open,2025-05-15T07:44:15Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler', 'compiler: ref validation']",True,,
facebook/react,33208,[Compiler]: passing `ref` to render prop will void optimization,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAejQAgDIEsBGMAhjAJ6ZwQC2ADhAHYL0AuYmVR5jCAJpsxEwIAHnTAJMAAxgIAZpP6DK9MFCoIYbAG64imGfR4bMNGBBpgAOvWVhmmAGIRBAXkwAKYBQAWuADY8BpgAvgCUmC4AfJjA1pgUDHb6chGYUOIASnLu9FB+fqEA3NZxmBiYAApEYGC49ADmybKKmN7OANaYuGxE+RAA7ryltvb4JKnpCABCJJ5NIUUl9PHlVTV1jTLNAsmGxqbmXWwAcgDyACqYvX4DQ8vJzLDLADw8uFqRwHC+AQZzWwtgs80G8PsV6MFwdYRpgAII0GipdzhKIxUoyR4wF5OCCff4pMIRaLPOo0KD2LYuYBbYJlSJAtA4yLgyHWEDBIA

### Repro steps

In some use cases, especially in library code, it is necessary to pass a `ref` to the consumer using render props. However, this currently results in an error and causes optimizations to be skipped.

Example:
```jsx
// `renderChildren` is a render prop; passing `ref` like this is not allowed
return <div>{renderChildren({ ref })}</div>;
```

In contrast, passing `ref` to hooks or JSX elements within render has no issues:
```jsx
const bar = useBar({ ref });
<input ref={ref} />
```

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler', 'Compiler: Ref Validation']",open,2025-05-15T05:39:44Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler', 'compiler: ref validation']",True,,
facebook/react,33204,[Compiler]: Detect use of callback refs for layout synchronization,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://stackblitz.com/edit/react-2u9hf3xf?file=src%2FApp.tsx,src%2FClippedText.tsx&terminal=dev

### Repro steps

There are two tabs, and each panel contains the same `<ClippedText>` component. This component measures the content height and conditionally renders a ""Read more"" button if the content overflows.

Steps to reproduce:

1.  At **Tab 1**, click the **""Read more""** button, and confirm that it expands as expected.

2.  Switch to **Tab 2** and observe that the **""Read more""** button does not appear, even if the content overflows.

The issue originates from tab switching being implemented using `display: none`, which prevents the ref callback in `<ClippedText>` from accessing layout information when the component is hidden. As a result, the content height cannot be measured correctly.

Notably, this behavior can be reproduced without the React Compiler by manually wrapping `<ClippedText>` in `memo()`. When using the React Compiler, disabling memoization requires adding `""use no memo""` in all relevant components.

While this may not strictly be considered a React Compiler bug, it highlights a class of issues where components rely on rerenders to synchronize layout-dependent side effects --- a pattern that is difficult to detect through conventional rules such as the Rules of Hooks. In such cases, automatic memoization introduced by the compiler can lead to subtle and hard-to-diagnose behavior changes.

For use cases involving visibility toggled via `display: none`, using `<Activity>` is likely a more reliable approach, as it is designed to manage component lifecycle transitions more accurately.

This issue was opened at the request of @josephsavona.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Component: React Compiler', 'Compiler: New Validation Ideas']",open,2025-05-14T19:36:35Z,,bug,"['component: react compiler', 'compiler: new validation ideas']",True,,
facebook/react,33198,[Compiler Bug]: compiler doesn't work with `@svgr/webpack`,"### What kind of issue is this?

- [ ] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [x] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/ellemedit/nextjs-react-compiler-not-work

### Repro steps

1. `bun dev`
2. open with React devtools
3. you can see component not memoized even react compiler configured:
   <img width=""1326"" alt=""Image"" src=""https://github.com/user-attachments/assets/2440ccb4-1f38-4fdf-8abf-7b3520e54310"" />
4. then you can edit `app/IconButton.tsx` to:
   ```tax
   ""use client"";

   import { ComponentProps } from ""react"";

   export function IconButton({ children, ...props }: ComponentProps<""button"">) {
     return <button {...props}>{children}</button>;
   }
   ```
5. `Cmd + K` and rerun `bun dev`
6. you can see component is memoized:
   <img width=""1326"" alt=""Image"" src=""https://github.com/user-attachments/assets/a99fd194-c561-44c6-9be5-3889aae8dec6"" />

both Turbopack and webpack behave same.

### How often does this bug happen?

Every time

### What version of React are you using?

19.2.0

### What version of React Compiler are you using?

rc.1","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",closed,2025-05-14T13:56:00Z,2025-05-31T00:25:34Z,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,16.0,
facebook/react,33197,"Bug: Conditional button rendering with button and submit inside a form causes type=""button"" to submit","React version: 19.1.0

## Steps To Reproduce

1. Render a `<form>` that uses `onSubmit`.

2. Inside it, conditionally render a button based on state (in the example, `step`).

3. Initially, render a `type=""button""` with an `onClick` handler (`nextFunc()`).

4. When clicked, it updates the state.

5. But when clicked, both `onClick` (`nextFunc`) and the form's `onSubmit` (`submitFunc`) are fired, even though the button is `type=""button""` and not `type=""submit""`.

Link to code example: https://codesandbox.io/p/sandbox/strange-murdock-n82pjy (open the console to check the logs)

## The current behavior
When clicking the ""Next"" button (`type=""button""`), BOTH the button’s `onClick` and the form’s `onSubmit` handlers are triggered.

_Important Note_: **This behavior does not occur if each button is given a unique key when rendered.**

## The expected behavior
The `type=""button""` button should trigger ONLY its `onClick` handler and the `type=""submit""` button should trigger ONLY the `onSubmit` handler.",['Status: Unconfirmed'],open,2025-05-14T12:23:58Z,,bug,['status: unconfirmed'],True,,
facebook/react,33196,[Compiler Bug]: Compiler errors when optimizing component with spread assignment in `if` in `while` loop,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAMygOzgFwJYSYAEUYCAKgmDgIwAUAlEcADrFFyHVEBuAhgBsoCIgF4SZAGqDhjNmyJEYCHLGJ0+MAOZgmogHzMFiogHcAFngEi6OGMKat2JogBMIAZQgBbFZcxaGtq6xi4A9GFEAHQxoSZ4aERBOgD8UQAOMBDpjnHhkXB8pFRECDBZMHkmmjpizNExNWAANESZ2ci8MiIAvlV9zkQDigMDbBjY+IQSFFQ4AEyMRuycmNz8QiLixdKbcpjGyqow6k16hk4uFlY2dg7LLoruXr44-oFnVRENUVUJSU00u0cg9HopvqYIDAANZgKqKJoZLLpOobYT9OLDIZsMaYCa4AjEYqUagAZiWlw4XBwXU2dR23X2hxUagBwXOoMU12sSTuCFygyenh8fjwAWSIUFRG+MV+UohUNhVSadWAPyarWBnTRvUxxlGIB6QA

### Repro steps

React compiler fails to optimize components like this: 
```js
function Component() {
  const value = useValue()

  const fn = (args) => {
    while (true) {
      // do something with args
      // ...

      // ✅ works outside of if
      args = { ...args, prop: value }

      if (args?.prop) {
        // ✅ works when assigning prop directly
        args.prop = value

        // 👇 Invariant: Invalid mutable range for scope. Scope @0 has range [0:21] but the valid range is [1:25]
        args = { ...args, prop: value }
      }
    }
  }

  // ...
}
```

### How often does this bug happen?

Every time

### What version of React are you using?

19.0.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Component: React Compiler']",open,2025-05-14T10:22:44Z,,bug,"['type: bug', 'component: react compiler']",True,,
facebook/react,33187,Bug: CSS not being applied properly in Chrome with React experimental (moveBefore),"React version: `0.0.0-experimental-3820740a-20250509`

I ran into what appears to be a paint bug in Chrome, which is only triggered by React experimental (not React stable), and doesn’t reproduce in either Firefox or Safari. Basically, after rerendering a list of elements with keys, the CSS is not being applied properly to the elements despite being correct in the dev tools.

I reported it at https://issues.chromium.org/issues/417426569, but I’m crossposting here as well in case someone can figure out how to reproduce it without React, or explain what is different between the latest stable version of React and React experimental.

## Steps to reproduce the problem
- Clone the repository at https://github.com/guillaumebrunerie/paint-bug
- Run `npm install` and `npm run dev`, open Chrome at `localhost:5173`, and open the dev tools.
- Note that the red rectangles are ordered from left to right when reading from top to bottom, this is correct.
- Click the ""Refresh"" button in the webpage a few times (it simply recreates a fresh set of data to render, in the same way as the initial set of data is created).
- Note that the red rectangle are no longer ordered from left to right, but checking the DOM in the dev tools, you can see that according to the `left: XX%` styles, they should be ordered.
- You can also try to change very slightly the value of a `left: XX%` style (for instance going from `13%` to `13.00001%`), it completely changes the position of the corresponding element, which shows that the element wasn’t painted at the correct position to begin with.

Source code (React): https://github.com/guillaumebrunerie/paint-bug/blob/main/src/main.jsx
CSS: https://github.com/guillaumebrunerie/paint-bug/blob/main/src/index.css

## Problem Description

The example creates a list of 10 random numbers between 0 and 90, sorts it, and then for each of them renders an element with width 10% and left XX%. The list is rendered using React keys based on the original order, which means that clicking refresh will reuse the existing elements, reorder them, and change their CSS.

I could only reproduce this issue with React experimental, but it seems clear to me that it is a Chrome issue, not a React issue, as the CSS is not being applied properly despite being correct in the DevTools. No idea what React experimental does differently than React stable, though.

The issue does not reproduce in either Firefox or Safari. Not sure if it is a regression, as I only recently switched to React experimental. I could reproduce it in Chrome Beta 137.0.7151.15 and in Chrome Canary 138.0.7177.0 as well.

![Image](https://github.com/user-attachments/assets/84a9644b-87d9-43fb-81f8-3b399bc47fce)

Video: https://github.com/user-attachments/assets/451c82c0-1939-4a66-9d3b-c5a499b90442
",['Type: Bug'],closed,2025-05-13T14:28:19Z,2025-06-19T08:04:49Z,bug,['type: bug'],True,36.0,
facebook/react,33181,[Compiler]: Detection for calling components as functions (instead of JSX),"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAMygOzgFwJYSYAEAsgJ4CCADlQBQCURwAOsUXIWDkQNpcCGOKGAA0RMAhwBlHIOEBdIgF4iwhDMEIAPACMIEADYJ+mAHy00-AxPoBuVqyJEYk2MS0ATPADdTjp0wCQmBEAGShpGQAkjgIALYMAL7+TrpQODiERIQAwgZ4cADWSsAMyqbikhrBtDgwUAj0iaYUHh5aAPQ66Zlm-p1evqzJmKwY2PhZ5DHxZSxsLkIw7lSm1cLIRHUNnavDIIlAA

### Repro steps

I am using conditional rendering ({status && MyItem}) in my JSX. When status is changed from false to true, the application crashes due to hooks not matching between renders. It works as expected without the compiler.

To reproduce, simply press the button in the example.

### How often does this bug happen?

Every time

### What version of React are you using?

18.2.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Feature Request', 'Component: React Compiler']",open,2025-05-12T18:57:29Z,,bug,"['type: feature request', 'component: react compiler']",True,,
facebook/react,33175,Bug: Detached nodes are created when portal is rendered conditionally,"I am creating a simple tooltip where tooltip content is rendered in a portal when hovered upon. This creates detached nodes. Added a github test repo and videos of the same.

React version:
""react"": ""^19.0.0"",
""react-dom"": ""^19.0.0""

## Steps To Reproduce

1. Clone the repo. [repo link](https://github.com/kart-c/react-dom-issue) 
2. Use `TooltipWithoutKey` in `App.tsx` file.
3. Hover multiple times.
4. Take heap snapshot.
5. Detached nodes are noticed.
6. Now use `TooltipWithKey` in `App.tsx` file.
7. No detached nodes noticed.

Also tried using the 3rd key argument for `createPortal`, but it did not work. Which is why the `Fragment` with key prop was used.


Link to code example: https://github.com/kart-c/react-dom-issue

### TooltipWithoutKey
https://github.com/user-attachments/assets/71f1ce54-69a7-4b67-a55b-7a6b9801c81c

### TooltipWithKey
https://github.com/user-attachments/assets/4fbcd12c-95fb-4b32-8c1d-48bcfa8b1dac

## The current behavior
Detached nodes are created.

## The expected behavior
Detached nodes should not be created.",['Status: Unconfirmed'],open,2025-05-12T12:35:45Z,,bug,['status: unconfirmed'],True,,
facebook/react,33174,Bug for facebook graph api (I know this might not relate the topic but please show it That someone from meta helps us),"Hi 
We and a lot of other Companies that uses GraphApi have a big problem and nobody cares about it...
We do not have any other places except Bug and Community and nobody cares we are losing millions!!

https://developers.facebook.com/support/bugs/1057960243061038/

The link above is the problem We and a lot of other companies have been facing... Please tell the responsible people we have to do layoffs after this cause of a very big loss.

Thanks in advance",['Status: Unconfirmed'],open,2025-05-12T09:42:42Z,,bug,['status: unconfirmed'],True,,
facebook/react,33173,[DevTools Bug] Minified React error #310; visit https://react.dev/errors/310 for the full message or use the non-minified dev environment for full errors and additional helpful warnings.,"### Website or app

Website：https://shangoue.meituan.com/#https://waimaieapp.meituan.com/igate/recoanalysis/dist/pc#traffic

### Repro steps

正常调试组件流程

### How often does this bug happen?

Every time

### DevTools package (automated)

react-devtools-extensions

### DevTools version (automated)

6.1.2-4d6cf75921

### Error message (automated)

Minified React error #310; visit https://react.dev/errors/310 for the full message or use the non-minified dev environment for full errors and additional helpful warnings.

### Error call stack (automated)

```text
at updateWorkInProgressHook (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:67241)
    at Object.updateCallback [as useCallback] (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:77030)
    at t.useCallback (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:279024)
    at InspectedElementContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1385327)
    at renderWithHooks (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:65679)
    at updateFunctionComponent (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:96375)
    at beginWork (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:110298)
    at performUnitOfWork (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:181627)
    at workLoopSync (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:181483)
    at renderRootSync (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:181267)
```

### Error component stack (automated)

```text
at InspectedElementContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1384551)
    at ma (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1371281)
    at div (<anonymous>)
    at InspectedElementErrorBoundaryWrapper (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1377591)
    at NativeStyleContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1409873)
    at div (<anonymous>)
    at div (<anonymous>)
    at OwnersListContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1319245)
    at SettingsModalContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1353036)
    at chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1449276
    at ma (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1371281)
    at div (<anonymous>)
    at div (<anonymous>)
    at ThemeProvider (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1373992)
    at chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1374189
    at div (<anonymous>)
    at div (<anonymous>)
    at div (<anonymous>)
    at ThemeProvider (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1373992)
    at TimelineContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1451289)
    at ProfilerContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1443080)
    at TreeContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1265121)
    at SettingsContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1293052)
    at ModalDialogContextController (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1430778)
    at DevTools_DevTools (chrome-extension://fmkadmapgofadopljbjfkapdkoienihi/build/main.js:1:1599996)
```

### GitHub query string (automated)

```text
https://api.github.com/search/issues?q=Minified React error #310; visit https://react.dev/errors/310 for the full message or use the non-minified dev environment for full errors and additional helpful warnings. in:title is:issue is:open is:public label:""Component: Developer Tools"" repo:facebook/react
```","['Type: Bug', 'Status: Unconfirmed', 'Component: Developer Tools']",open,2025-05-12T09:10:11Z,,bug,"['type: bug', 'status: unconfirmed', 'component: developer tools']",True,,
facebook/react,33172,Bug: Fix: Expose event.submitter in React Synthetic Form Events,"React version:
18.2.0 (also reproducible in React 19 RC)

Steps To Reproduce

1. Create a form with multiple <button type=""submit""> elements.
2. Add an onSubmit handler and log event.submitter.
3. Submit the form by clicking different buttons.

function App() {
  const handleSubmit = (e) => {
    e.preventDefault();
    console.log('Submitter:', e.submitter); // Always undefined
  };

  return (
    <form onSubmit={handleSubmit}>
      <button type=""submit"" value=""first"">First</button>
      <button type=""submit"" value=""second"">Second</button>
    </form>
  );
}


The current behavior
React’s synthetic submit event does not expose the submitter property (i.e., which button was used to trigger the form submission).

The expected behavior
event.submitter should reference the <button> or <input> that triggered the submit event, matching native DOM behavior in modern browsers (Chrome 86+, Firefox 83+, Safari 15.4+).
",['Status: Unconfirmed'],closed,2025-05-12T05:13:19Z,2025-05-12T05:13:56Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33171,[Compiler Bug]: React Compiler breaks SuperToken's react-native global fetch patch,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/vanstinator/supertokens-react-compiler-repro

### Repro steps

`react-native-supertokens` replaces `global.fetch` with it's own wrapper to facilitate automatic session token refreshing and a few other things. When the app is run with the React Compiler enabled `fetch` is broken and all calls to the function fail with `TypeError: Cannot read property 'doRequest' of undefined`.

I haven't followed compiler development very closely at all, so I didn't have enough context about what the compiler is doing to change the js runtime behavior to pull the thread much further than this.

The patching code in `react-native-supertokens` can be found here: https://github.com/supertokens/supertokens-react-native/blob/master/lib/ts/fetch.ts#L63-L91

The issue isn't specific to Android, it just happened to be the emulator I had open while debugging.

1. Run an Android emulator 
2. `npm install`
3. `npm run android`
4. The console should contain a dump of the response body from fetching `http://localhost:8081`
5. Open `app.json` and set `react-compiler` in the `experiments` block to `false`
6. Kill your metro process and restart it with `npx expo start --clear`, and refresh the app in the android emulator
7. The `fetch` call is broken and the console contains logs of `TypeError: Cannot read property 'doRequest' of undefined`

### How often does this bug happen?

Every time

### What version of React are you using?

19.0.0

### What version of React Compiler are you using?

19.0.0-beta-af1b7da-20250417","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",closed,2025-05-11T17:59:55Z,2025-05-17T23:36:28Z,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,6.0,
facebook/react,33169,Bug:  Potential misuse of NoLanes in executionContext check in scheduleUpdateOnFiber,"
### **React version:**

```txt
19.2.0
```

---

### Steps To Reproduce

1. Go to [`[scheduleUpdateOnFiber](https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberWorkLoop.js)`](https://github.com/facebook/react/blob/main/packages/react-reconciler/src/ReactFiberWorkLoop.js) function in `react-reconciler`
2. Find this line:

   ```js
   if ((executionContext & RenderContext) !== NoLanes && root === workInProgressRoot)
   ```
3. Notice that `executionContext` is a set of context flags (bitmask), while `NoLanes` refers to lane priorities and is not used in context checks anywhere else

---

###  Link to code example

No runtime code needed — this is a logic-level mismatch in the internal source file.

Relevant file:

* `packages/react-reconciler/src/ReactFiberWorkLoop.js`

---

### ❌ The current behavior

The line:

```js
(executionContext & RenderContext) !== NoLanes
```

uses `NoLanes` in a bitmask comparison with `executionContext`, which is inconsistent with surrounding usages that compare with `NoContext`.

`NoLanes` is defined in the Lane system and is intended for scheduling lanes, not execution contexts.

---

### ✅ The expected behavior

This line should likely be:

```js
(executionContext & RenderContext) !== NoContext
```

This matches similar checks throughout the codebase and would avoid incorrect context evaluation.

---",['Status: Unconfirmed'],open,2025-05-11T16:02:11Z,,bug,['status: unconfirmed'],True,,
facebook/react,33168,Bug: 'Sync with react.dev' is not working,"Hello,

This issue isn't directly related to React itself, as I didn't use the template.

Currently, the 'Sync with react.dev' workflow is broken, which prevents localizations from receiving newly updated commits.

Related issues:

- https://github.com/reactjs/translations.react.dev/issues/334
- https://github.com/reactjs/react.dev/issues/7790#issuecomment-2869119376

![Image](https://github.com/user-attachments/assets/c5b99034-64b1-441c-8a92-dcce266c19de)",['Status: Unconfirmed'],closed,2025-05-11T06:58:26Z,2025-05-14T12:54:46Z,bug,['status: unconfirmed'],True,3.0,
facebook/react,33167,谷歌蜘蛛池出租,谷歌每日千万蜘蛛蜘蛛池出租出售，【TG：tianko6666】代搭建谷歌蜘蛛池，谷歌各种灰色关键词推广，代做搜索留痕和外推发帖，谷歌单站排名,['Status: Unconfirmed'],closed,2025-05-10T10:20:09Z,2025-05-10T10:28:30Z,performance,['status: unconfirmed'],True,0.0,
facebook/react,33166,谷歌蜘蛛池出租，代搭建谷歌蜘蛛池,"谷歌强引蜘蛛池出租出售，每天1000万谷歌蜘蛛，【网站:ggpmseo.com】

![Image](https://github.com/user-attachments/assets/1746cabb-b0b9-4ab3-b9b8-6c70487eb144)

代搭建定制谷歌强引池蜘蛛，谷歌单站排名，代做谷歌外推发帖收录，谷歌搜索留痕收录，",['Status: Unconfirmed'],closed,2025-05-10T09:57:27Z,2025-05-10T09:57:45Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33155,Bug: ReactFlightWebpackPlugin does not write files with .mjs extension to the manifest,"I'm adding the ReactFlightWebpackPlugin to my project to use server components. The generated `react-client-manifest.json` does not have any chunks in it. Upon checking the code I see it is specifically only adding files with `.js` file extension to the chunk list here: https://github.com/facebook/react/blob/main/packages/react-server-dom-webpack/src/ReactFlightWebpackPlugin.js#L280 My project's webpack build generates files with `.mjs` file extensions.

I have a proposed fix PR here: https://github.com/facebook/react/pull/33028

React version: 19.1.0

## Steps To Reproduce

1. Configure webpack to generate files with a .mjs file extension. Example:
  ```js
module.exports = {
    //...
    output: {
      //...
      chunkFilename: '[name].mjs',
      filename: '[name].mjs',
    },
};
```
2. Add the plugin to the webpack config. Example:
  ```js
const ReactServerWebpackPlugin = require(""react-server-dom-webpack/plugin"");

module.exports = {
    //...
    plugins: [new ReactServerWebpackPlugin({ isServer: false })],
};
```
3. Set up one client component as directed in the documentation for server components.
4. Run the webpack build
5. Observe that the generated file `react-client-manifest.json` has empty arrays for the ""chunks"" list. Sample output:
```
{
  ""file://path/Example.tsx"": {
    ""id"": ""./path/Example.tsx"",
    ""chunks"": [],
    ""name"": ""*""
  }
}
```

Link to code example:
I don't have a full code example, but I have a fix PR here: https://github.com/facebook/react/pull/33028

## The current behavior
No chunks listed in `react-client-manifest.json`

## The expected behavior
Chunks listed in `react-client-manifest.json`. Testing locally after my PR I see these contents:
```
{
  ""file://path/Example.tsx"": {
    ""id"": ""./path/Example.tsx"",
    ""chunks"": [
      ""client0"",
      ""client0-2c4986f8fb78b0ce.mjs""
    ],
    ""name"": ""*""
  }
}
```",['Status: Unconfirmed'],closed,2025-05-08T19:05:10Z,2025-05-13T01:16:17Z,bug,['status: unconfirmed'],True,4.0,
facebook/react,33153,Bug: React error #421 isn't reported anymore,"React error [#421](https://react.dev/errors/421) isn't reported anymore (Suspense boundary received an update before it finished hydrating), which makes debugging this error quite challenging.

When Suspense receives an update while hydration, React switches to client rendering, which causes Suspense to show the fallback for a brief moment of time, creating a blink that deteriorates the UX.

React version: **19.1.0**

## Steps To Reproduce

1. clone the repository
2. run `npm i`
3. run `npm run dev`
4. open http://localhost:5173/
5. make sure you see the second div do a blink during hydration

Link to code example:
https://github.com/stanislav-halyn/react-19-missing-hydration-errors

## The current behavior
No hydration error reported neither to the console or `onRecoverableError`.

## The expected behavior
Hydration error should be reported either to the console or `onRecoverableError`.",['Status: Unconfirmed'],open,2025-05-08T11:30:55Z,,bug,['status: unconfirmed'],True,,
facebook/react,33138,[Compiler Bug]: function outlining changes runtime semantics inside expressions,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhAMygOzgFwJYSYAEAwhALYAOhCmOAFAJRHAA6xRMCOsxAPAGUcMPJgDmeNAE8iANwCGAGygIAvMADa7IjqL0mRVQD4WRAL6MAdDghCR4pgBptu-c2OmuPGMVbh5ACbyYAF+5swA1ER+fs4cOvQY2PiERGgQEAbA4URRMSBxunpJuATE6ZnM2RbWtsKiYk4uALpmAPRGANzsZiBmQA

### Repro steps

```tsx
function Component() {
  return <Stringify value={[
    (() => { }).toString(),
    (() => { }) + """",
    (function foo() { }) + """",
    (function foo() { }).toString(),
  ]}/>;
}
```

`() => { }` gets outlined to a temp global function, which results in a different toString value:
- `(() => { return ""sadasd"" }) + """"` -> `'() => { return ""sadasd"" }'`
- `(function _temp2() { return ""sadasd""; }).toString()` -> `'function _temp2() {\n  return ""sadasd"";\n}'`

Same probably happens to components that take functions as props and apply `.toString()` on them for whatever reason.

May not be a bug depending on how react defines this case. I think the only way of fixing this is not to outline lambdas in expressions. But I think this breaks the intended optimization entirely, so this might be just defined as an intended incompability.

### How often does this bug happen?

Every time

### What version of React are you using?

19

### What version of React Compiler are you using?

rc1","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",open,2025-05-07T16:12:13Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,,
facebook/react,33137,Feature Request: Simplify createReconciler,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:
```
    ""react"": ""19.1.0"",
    ""react-dom"": ""19.1.0"",
    ""react-reconciler"": ""0.32.0"",

    ""@types/react"": ""19.1.3"",
    ""@types/react-dom"": ""19.1.3"",
    ""@types/react-reconciler"": ""0.32.0"",

```

## Steps To Reproduce

The parameters of the createReconciler function are too complex. Is it possible to provide default values?

Using vscode to autocomplete the createReconciler function, it's very complicated

```ts
createReconciler({
  supportsMutation: false,
  supportsPersistence: false,
  createInstance: function (type: unknown, props: unknown, rootContainer: unknown, hostContext: unknown, internalHandle: createReconciler.OpaqueHandle): unknown {
    throw new Error(""Function not implemented."")
  },
  createTextInstance: function (text: string, rootContainer: unknown, hostContext: unknown, internalHandle: createReconciler.OpaqueHandle): unknown {
    throw new Error(""Function not implemented."")
  },
  appendInitialChild: function (parentInstance: unknown, child: unknown): void {
    throw new Error(""Function not implemented."")
  },
  finalizeInitialChildren: function (instance: unknown, type: unknown, props: unknown, rootContainer: unknown, hostContext: unknown): boolean {
    throw new Error(""Function not implemented."")
  },
  shouldSetTextContent: function (type: unknown, props: unknown): boolean {
    throw new Error(""Function not implemented."")
  },
  getRootHostContext: function (rootContainer: unknown): unknown {
    throw new Error(""Function not implemented."")
  },
  getChildHostContext: function (parentHostContext: unknown, type: unknown, rootContainer: unknown): unknown {
    throw new Error(""Function not implemented."")
  },
  getPublicInstance: function (instance: unknown): unknown {
    throw new Error(""Function not implemented."")
  },
  prepareForCommit: function (containerInfo: unknown): Record<string, any> | null {
    throw new Error(""Function not implemented."")
  },
  resetAfterCommit: function (containerInfo: unknown): void {
    throw new Error(""Function not implemented."")
  },
  preparePortalMount: function (containerInfo: unknown): void {
    throw new Error(""Function not implemented."")
  },
  scheduleTimeout: function (fn: (...args: unknown[]) => unknown, delay?: number): unknown {
    throw new Error(""Function not implemented."")
  },
  cancelTimeout: function (id: unknown): void {
    throw new Error(""Function not implemented."")
  },
  noTimeout: undefined,
  isPrimaryRenderer: false,
  getInstanceFromNode: function (node: any): createReconciler.Fiber | null | undefined {
    throw new Error(""Function not implemented."")
  },
  beforeActiveInstanceBlur: function (): void {
    throw new Error(""Function not implemented."")
  },
  afterActiveInstanceBlur: function (): void {
    throw new Error(""Function not implemented."")
  },
  prepareScopeUpdate: function (scopeInstance: any, instance: any): void {
    throw new Error(""Function not implemented."")
  },
  getInstanceFromScope: function (scopeInstance: any): unknown {
    throw new Error(""Function not implemented."")
  },
  detachDeletedInstance: function (node: unknown): void {
    throw new Error(""Function not implemented."")
  },
  supportsHydration: false,
  NotPendingTransition: undefined,
  HostTransitionContext: undefined,
  setCurrentUpdatePriority: function (newPriority: createReconciler.EventPriority): void {
    throw new Error(""Function not implemented."")
  },
  getCurrentUpdatePriority: function (): createReconciler.EventPriority {
    throw new Error(""Function not implemented."")
  },
  resolveUpdatePriority: function (): createReconciler.EventPriority {
    throw new Error(""Function not implemented."")
  },
  resetFormInstance: function (form: unknown): void {
    throw new Error(""Function not implemented."")
  },
  requestPostPaintCallback: function (callback: (time: number) => void): void {
    throw new Error(""Function not implemented."")
  },
  shouldAttemptEagerTransition: function (): boolean {
    throw new Error(""Function not implemented."")
  },
  trackSchedulerEvent: function (): void {
    throw new Error(""Function not implemented."")
  },
  resolveEventType: function (): null | string {
    throw new Error(""Function not implemented."")
  },
  resolveEventTimeStamp: function (): number {
    throw new Error(""Function not implemented."")
  },
  maySuspendCommit: function (type: unknown, props: unknown): boolean {
    throw new Error(""Function not implemented."")
  },
  preloadInstance: function (type: unknown, props: unknown): boolean {
    throw new Error(""Function not implemented."")
  },
  startSuspendingCommit: function (): void {
    throw new Error(""Function not implemented."")
  },
  suspendInstance: function (type: unknown, props: unknown): void {
    throw new Error(""Function not implemented."")
  },
  waitForCommitToBeReady: function (): ((initiateCommit: (...args: unknown[]) => unknown) => (...args: unknown[]) => unknown) | null {
    throw new Error(""Function not implemented."")
  }
})
```


For example, HostTransitionContext, in `""@types/react-reconciler"": ""0.31.0""`, I didn't pass in this parameter, and its default value seems to be https://github.com/facebook/react/blob/e5a8de81e57181692d33ce916dfd6aa23638ec92/packages/react-native-renderer/src/ReactFiberConfigFabric.js#L716 ?

Can this parameter be optional for custom renderers that don't need animation?


`""@types/react-reconciler"": ""0.32.0""` requires the following functions compared to `""@types/react-reconciler"": ""0.31.0""`
I believe that in most cases you can use the default implementation or provide a default error function? When you really need to use custom functions, add your own custom functions
```

    NotPendingTransition: undefined,
    resetFormInstance: function (): void {
      throw new Error(""Function not implemented."")
    },
    requestPostPaintCallback: function (): void {
      throw new Error(""Function not implemented."")
    },
    shouldAttemptEagerTransition: function (): boolean {
      throw new Error(""Function not implemented."")
    },
    trackSchedulerEvent: function (): void {
      throw new Error(""Function not implemented."")
    },
    resolveEventType: function (): null | string {
      throw new Error(""Function not implemented."")
    },
    resolveEventTimeStamp: function (): number {
      throw new Error(""Function not implemented."")
    },
    preloadInstance: function (): boolean {
      throw new Error(""Function not implemented."")
    },
    startSuspendingCommit: function (): void {
      throw new Error(""Function not implemented."")
    },
    suspendInstance: function (): void {
      throw new Error(""Function not implemented."")
    },
    waitForCommitToBeReady: function (): ((initiateCommit: (...args: unknown[]) => unknown) => (...args: unknown[]) => unknown) | null {
      throw new Error(""Function not implemented."")
    },
    HostTransitionContext: undefined
```",['Status: Unconfirmed'],closed,2025-05-07T10:47:02Z,2025-05-23T02:04:57Z,bug,['status: unconfirmed'],True,15.0,
facebook/react,33133,Bug: 【React19】 hydrateRoot issues a hydration warning when used with dangerouslySetInnerHTML and suppressHydrationWarning.,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19.1.0

## Steps To Reproduce

Using dangerouslySetInnerHTML or suppressHydrationWarning during hydration may result in client-side replacement of SSR-rendered DOM with empty content, rather than preserving the server-rendered markup.


 const {
        canHydrate = false,
        children,
    } = props;
const root = useRef<HTMLElement | null>(null)
useEffect(() => {
        if (
            root.current &&
            canHydrate
        ) {
            hydrateRoot(root.current, children)
        }
    }, [canHydrate, children])
 return (
        <section
            ref={root}
            dangerouslySetInnerHTML={{ __html: '' }}
            suppressHydrationWarning
        />
    )



## The current behavior
dangerouslySetInnerHTML and suppressHydrationWarning change the ssr html to empty, and then hydrate fail

## The expected behavior
dangerouslySetInnerHTML and suppressHydrationWarning cancel the hydration and keep the ssr html, and then manual hydration success",['Status: Unconfirmed'],open,2025-05-06T12:44:53Z,,bug,['status: unconfirmed'],True,,
facebook/react,33132,Bug: What the issues,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.Explain what the issue at the code send me at one format way 
2.give brief expalination about bug 

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],open,2025-05-06T09:18:11Z,,bug,['status: unconfirmed'],True,,
facebook/react,33124,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-05T17:48:44Z,2025-05-06T00:46:59Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33116,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-03T15:48:18Z,2025-05-04T03:42:20Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33115,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior
",['Status: Unconfirmed'],closed,2025-05-03T15:48:17Z,2025-05-04T03:42:11Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33103,Bug: Can't import react-devtools-core in NodeJS environment,"I'm writing a custom react renderer that completely runs inside NodeJS.

When I try to import `react-devtools-core`, this error occurs:

```
webpack://ReactDevToolsBackend/webpack/universalModuleDefinition:10
})(self, () => {
 ^


ReferenceError: self is not defined
    at Object.<anonymous> (webpack://ReactDevToolsBackend/webpack/universalModuleDefinition:10:2)
    at Module._compile (node:internal/modules/cjs/loader:1734:14)
    at Object.transformer (C:\Users\dennis\AppData\Local\pnpm-cache\dlx\gxuwnoud2xciwjjtv2xv6oox4u\19691f41bd2-2c40\node_modules\.pnpm\tsx@4.19.4\node_modules\tsx\dist\register-D2KMMyKp.cjs:2:1186)
    at Module.load (node:internal/modules/cjs/loader:1469:32)
    at Function._load (node:internal/modules/cjs/loader:1286:12)
    at TracingChannel.traceSync (node:diagnostics_channel:322:14)
    at wrapModuleLoad (node:internal/modules/cjs/loader:235:24)
    at Module.require (node:internal/modules/cjs/loader:1491:12)
    at require (node:internal/modules/helpers:135:16)
    at <anonymous> (C:\Users\dennis\source\Repos\TheAlan404\games-bot\src\devtools.ts:5:47)

Node.js v23.11.0
```

Repo to repro:
https://github.com/deniz-blue/games-bot/tree/dba1d46ab6346844cb05e4a1978f0275ba062bb1

I think this is an issue about how react compiles and publishes that package",['Status: Unconfirmed'],open,2025-05-02T18:38:09Z,,bug,['status: unconfirmed'],True,,
facebook/react,33090,Bug: Maximum update depth exceeded appears in frequent onDrop scenarios,"I have a question about useState. I am in a scenario based on drag and drop to sort elements. During use, I found that dispatch will be repeatedly executed. Why is setState executed repeatedly? ? ?

The manifestation is that onDrop is only once, but the internal setState is always executed until the error Maximum update depth exceeded is reported. The console reports the error as above.

React version:18.2.0

![Image](https://github.com/user-attachments/assets/efc68205-b90b-4aa0-a6fc-3a98ae47aed6)

## The current behavior

![Image](https://github.com/user-attachments/assets/a6bd16a3-69de-4e70-a9bc-dcbc5e38e2ef)

![Image](https://github.com/user-attachments/assets/d7bd0376-77cc-4317-b222-8def8e83b313)

## The expected behavior
it is expected that one onDrop corresponds to one setState, but if you drag several times, setState will be called n times",['Status: Unconfirmed'],open,2025-05-01T18:56:15Z,,bug,['status: unconfirmed'],True,,
facebook/react,33075,[Compiler Bug]: `for await` loop fails to optimize component.,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhHCA7MAXABAQwCMcZ85sEATXAXgLAE8M5cAKASloD5dgAdDLiG4AZhBgEA7vgCWeVuix4xEXBBG5C+GJ36DhQgQYC+R3KYwCEADwAO4vJQQj8UADbKozbDMy4AsgwAgra2HLwCZoo4uJQQAMoQALYI2AAWMhgA5rT0TCzhNDx6BmIS+NJybNHKEKrqmtq6kfpCFm0tQjCpsIIAPJQyAG5cABIIbm6qAOribpR9APSDIwDcAhYgxkA

### Repro steps

React compiler fails to optimize components that contain `for await` loops. I came across this bug while trying to deduce the cause of a significant amount of re-renders. In the react dev tools it showed the component was indeed auto-memoized, however it would still re-rerender when seeing the same props. When removing `for await` from my code the component properly memoized inputs. 

Later I tested this in the react compiler playground and noticed the very clear `Todo: (BuildHIR::lowerStatement) Handle for-await loops (10:12)` error message. Ideally this error could be addressed or surfaced to the user in order to prevent confusion on why a component marked as auto-memoized isn't actually being memoized.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1

### What version of React Compiler are you using?

rc","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",open,2025-04-30T22:31:20Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,,
facebook/react,33057,[Compiler Bug]: React Compiler breaks most functionality of TanStack Table,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/skoshx/react-compiler-bug-repro

(edit: Open in StackBlitz as https://stackblitz.com/github/skoshx/react-compiler-bug-repro)

### Repro steps

1. `bun install`
2. `bun dev`
3. Try to interact with the data table, nothing works: filter input doesn't work. columns dropdown doesn't work (clicking doesn't do anything), clicking on the checkboxes doesn't update react UI state.
4. disable `reactCompiler`, and all problems disappear

### How often does this bug happen?

Every time

### What version of React are you using?

""react"": ""^19.1.0""

### What version of React Compiler are you using?

""babel-plugin-react-compiler"": ""^19.1.0-rc.1"",","['Component: React Compiler', 'Type: Discussion']",open,2025-04-29T19:01:47Z,,bug,"['component: react compiler', 'type: discussion']",True,,
facebook/react,33054,[Compiler Bug]: non-null assertion on objects produces non working js,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwHYBcEwGYCGiABACoJhbAA6GxxOlyxlMmA5gNy0C+ttCAB4AHCDCzE4EDJTIUsAIRgQA1gjoBeYgAoAlMQ0A+YjTqTpsgNqMsAGhYIs5SgF0DtevQBKCIlgB0UGAIAMpYBDjEADxysgA+xBhQADbJxMbaSam63BgexDCOsHTa+fRRhmWeUQBGUFhY0sTSAMLJaHAqBiZ6BsY2BlpZaQD8Dk7y2sA2yNQgNnM8+szBE5SZKcm6PMakEOzsyQjRAPR1DdKVZp7R5410ACZoYAQ1Rw8awACENjzNGG0OiotMBekYpDIIEd-Ml9tobF9-DZtsYAApsbCnO6XKpRE5Xei6Xj8DBCUTicwyCTOLAtMSFOASLRg4ymegQqw2eyrGluDRVHx+QLBMIRY4xGnEBLDdI6YY5En0QpYYo6XEEm63er3f6AzqfFkMeSDRKbYhjHmTYBGpjEOYLEDEJbEFaOGkbbI7Mj7Q7is7anHXarYx7PV7vT4-eR-VrtfWg-RGEzENB4HTIymQaGw9jw+RI+T6Hhe9GYCR4kMa8r4-JEvIYHggHhAA

### Repro steps

running the following code will result in a `Cannot read properties of null (reading 'test')`
```ts
interface Test{
  test: string;
}

export const TestBroken = () => {
  const [test, setTest] =
    React.useState < Test | null > (null);

  return (
    <>
      <button onClick = {() => test == null ? setTest({test:""test""}) : setTest(null)}> Toggle </button>
      <button disabled={!test} onClick= {() =>console.log(test!.test)}> Print </button>
    </>
  )
}
```

this code runs fine when changing the non-null assertion into an if statement:
```diff
-      <button disabled={!test} onClick= {() =>console.log(test!.test)}> Print </button>
+     <button disabled={!test} onClick={() => { if (test) console.log(test.test) }}> Print </button>
```


### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",open,2025-04-29T16:15:42Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,,
facebook/react,33052,[Compiler Bug]: TypeError: isUndefined is not a function (it is undefined),"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/Robert27/react-compiler-repro

### Repro steps

This bug happens in my Expo app and only with the [calendar lib](https://github.com/howljs/react-native-calendar-kit).
The repro repo uses the react compiler version expo recommends, but it also happens with React 19.1 with the latest React compiler alpha version.

1. Navigate to `Calendar` tab.
2. Error: `TypeError: isUndefined is not a function (it is undefined)`

The only workaround is to completely disable the compiler. Using `'use no memo'` or disabling the file in the babel config does not work.

### How often does this bug happen?

Every time

### What version of React are you using?

19.0

### What version of React Compiler are you using?

19.0.0-beta-af1b7da-20250417","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",open,2025-04-29T09:07:21Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,,
facebook/react,33050,[Compiler]: skipped memoization due to potential modification after hook call,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCAyhBgngBZoB2A5gDQEAmEl1djTBAXwIAzGFQIBySNQC0AGzQAjCQG4AOgw1wIDMIVIIAwqTxUAEhAgBrAgF4CACgBuAQzlQEASjsA+IhoICbV1Cdhc8FzsiAld3BEF1TQZAmBpYZOAAwIIsMSwARmQSMm4aemYHYjCIwU8WLMDciCwAJiLOUt4KqvDIgU8sgUShjQ0EAA8cfGiDYz1zSxsRhhABIA

### Repro steps

Currently, the compiler memoizes the arguments of React hooks and regular functions when the arguments are non-primitive values. However, the behavior is inconsistent, and memoization is skipped when certain conditions are met:

1. The arguments passed to a React hook or regular function are non-primitive values (e.g., an object).
2. The argument object refers to another local variable, which is also non-primitive.
3. Both the React hook and the regular function reference the same local variable when constructing their arguments.

Here is a minimal example:
```js
const useCustomHook = (value) => {
  const data = { value };

  return {
    prop1: useSomething({ data }),
    prop2: doSomething({ data })
  };
};
```

In the example, memoization of the `{ data }` argument passed to both `useSomething` and `doSomething` is skipped.


### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Bug', 'Component: React Compiler']",open,2025-04-29T05:33:17Z,,bug,"['type: bug', 'component: react compiler']",True,,
facebook/react,33041,Reconsider providing a cleaner hook-based solution to derived state,"## Search terms

getDerivedStateFromProps, useState, useEffect, derived state

## Previous issues

- #14288
- #14738
- #14830
- #15523
- #16461
- #17712

## Essential reading

- [1] [You Might Not Need an Effect > Adjusting some state when a prop changes](https://react.dev/learn/you-might-not-need-an-effect#adjusting-some-state-when-a-prop-changes)
- [2] [You Probably Don't Need Derived State](https://legacy.reactjs.org/blog/2018/06/07/you-probably-dont-need-derived-state.html) (from the legacy docs)

## Abstract / TL;DR

Adjusting state when a prop or context changes makes sense more often than the official docs would have you believe. The pattern suggested in [1] is extremely underrated, but also unnecessarily confusing. React should offer and promote a less obscure hook-based solution to the problem so as to avoid the suggested solution's complexity and prevent developers from misemploying `useEffect`.

## Motivation

Here is the right way to reset state when some input changes, as suggested in [1]:

```typescript
const [count, setCount] = useState(initialCount);
const [prevInitialCount, setPrevInitialCount] = useState(initialCount);

if (initialCount !== prevInitialCount) {
  setPrevInitialCount(initialCount);
  setCount(initialCount);
}
```

The input in question (`initialCount` in this case) could be a prop, a context value, or some value derived from a combination of those.

From my experience, however, most people are either unaware of this pattern or find it too confusing to wrap their heads around, and therefore use an effect-based approach instead:

```typescript
const [count, setCount] = useState(initialCount);

useEffect(() => {
  setCount(initialCount);
}, [initialCount]);
```

The prevalence of this approach is hard to overstate. Using an effect is suggested in top answers to pretty much all questions about syncing state to props on StackOverflow ([example](https://stackoverflow.com/questions/54865764/react-usestate-does-not-reload-state-from-props), [example](https://stackoverflow.com/questions/54625831/how-to-sync-props-to-state-using-react-hooks-setstate), [example](https://stackoverflow.com/questions/68730502/react-usestate-with-state-that-updates-based-on-props)). All AI assistants I've asked also suggested this as their recommended solution. But most importantly, this is the approach I see used in the wild all the time, even by devs much more experienced than I am.

The problem with the approach is that effects only run after rendering is completed and, in most cases, after its results are committed to the DOM. This results in unnecessary rerenders and inconsistent intermediate states being displayed in the UI.

Unnecessary rerenders are also a drawback of the approach suggested in [1]: as explained there, if a function resetting some state is called while rendering, the render will finish, then its results are simply thrown away and a new render with the updated state begins. This is just compute time wasted for no reason! Can we really not do better than that?

Let's explore the drawbacks of both approaches with a more advanced example I've come up with.

<details>
<summary>
<h3>
This section is pretty long. You don't have to read all of it! Expand at your own risk 😛
</h3>
</summary>

```typescript
import {
  createContext,
  useContext,
  useEffect,
  useMemo,
  useReducer,
  useState,
} from ""react"";
import { createRoot } from ""react-dom/client"";

const ClientLanguageContext = createContext(""en""); // English is the default

function useClientLanguage() {
  return useContext(ClientLanguageContext);
}

function LanguageCheckboxes({
  additionalLanguages,
}: {
  additionalLanguages: string[];
}) {
  const clientLanguage = useClientLanguage();

  const languages = useMemo(
    () => new Set([clientLanguage, ...additionalLanguages]),
    [clientLanguage, additionalLanguages]
  );

  const [checkedLanguages, setCheckedLanguages] = useState(new Set<string>());

  useEffect(() => {
    setCheckedLanguages((prev) => {    
      // If the `languages` set has changed in a way that it no longer includes
      // some of the languages it included before, those removed languages also
      // have to be removed from `checkedLanguages`!

      // Compute the intersection of `languages` and previous `checkedLanguages`:
      const next = new Set(
        Array.from(prev).filter((language) => languages.has(language))
      );

      // Only actually adjust the value if languages have been removed:
      return next.size < prev.size ? next : prev;
    });
  }, [languages]);

  return (
    <>
      {Array.from(languages).map((language) => (
        <div key={language}>
          <label>
            <input
              value={language}
              type=""checkbox""
              checked={checkedLanguages.has(language)}
              onChange={(e) => {
                const nextCheckedLanguages = new Set(checkedLanguages);
                if (e.target.checked) nextCheckedLanguages.add(language);
                else nextCheckedLanguages.delete(language);
                setCheckedLanguages(nextCheckedLanguages);
              }}
            />
            {language}
          </label>
        </div>
      ))}
      <p>Checked languages: {Array.from(checkedLanguages).join("", "")}</p>
    </>
  );
}

const ADDITIONAL_LANGUAGES = [""de"", ""fr""];

function App() {
  const [clientLanguage, setClientLanguage] = useState(""en"");
  const [additionalLanguages, toggleAdditionalLanguages] = useReducer(
    (prev) => (prev.length ? [] : ADDITIONAL_LANGUAGES),
    ADDITIONAL_LANGUAGES
  );

  return (
    <ClientLanguageContext value={clientLanguage}>
      <p>
        Client language:
        <br />
        <input
          value={clientLanguage}
          onChange={(e) => setClientLanguage(e.target.value)}
        />
      </p>
      <p>
        <button onClick={toggleAdditionalLanguages}>
          Toggle additional languages
        </button>
      </p>
      <LanguageCheckboxes additionalLanguages={additionalLanguages} />
    </ClientLanguageContext>
  );
}

createRoot(document.getElementById(""root"")!).render(<App />);
```

This example app does not offer any useful functionality, but it is good at demonstrating all sorts of issues related to derived state. There will be more realistic examples below.

As you can see, I've chosen the wrong `useEffect` approach for this initial implementation. If you check all available languages and then click the toggle button, you will notice that “de” and “fr” disappear faster from the checkboxes than from the “Checked languages” list on the bottom, where they stay a few milliseconds longer. The reason is that the effect adjusting `checkedLanguages` is only executed after the render caused by the `additionalLanguages` update is completed and its result is reflected in the UI. This is simply how effects work in React, and the fact that we get to see an invalid state in the UI because of that is what makes the `useEffect` approach to derived state an absolute no-go. 

Let's now try the approach suggested in [1]:

```typescript
function LanguageCheckboxes({
  additionalLanguages,
}: {
  additionalLanguages: string[];
}) {
  const clientLanguage = useClientLanguage();

  const languages = useMemo(
    () => new Set([clientLanguage, ...additionalLanguages]),
    [clientLanguage, additionalLanguages]
  );

  const [checkedLanguages, setCheckedLanguages] = useState(new Set<string>());

  const [prevLanguages, setPrevLanguages] = useState(languages);
  if (languages !== prevLanguages) {
    setPrevLanguages(languages);

    // If the `languages` set has changed in a way that it no longer includes
    // some of the languages it included before, those removed languages also
    // have to be removed from `checkedLanguages`!

    // Compute the intersection of `languages` and `checkedLanguages`:
    const nextCheckedLanguages = new Set(
      Array.from(checkedLanguages).filter((language) => languages.has(language))
    );

    // Only adjust `checkedLanguages` if languages have been removed:
    if (nextCheckedLanguages.size < checkedLanguages.size) {
      setCheckedLanguages(nextCheckedLanguages);
    }
  }

  return /* ... */;
}
```

Well, this does seem to work, but unfortunately, it is not a good solution either. The reason is that the value of `languages` is computed with the `useMemo` hook, which, according to [the docs](https://react.dev/reference/react/useMemo), should only be used as a performance optimization. The code we write should work perfectly fine without it, but that is not the case here: since without `useMemo`, the identity of `languages` would change on every render, `setPrevLanguages(languages)` would end up being called in an infinite loop!

To overcome this complication, we have to store previous values of both inputs the `languages` variable is derived from (i.e. `clientLanguage` and `additionalLanguages`) instead of its own previous values:

```typescript
function LanguageCheckboxes({
  additionalLanguages,
}: {
  additionalLanguages: string[];
}) {
  const clientLanguage = useClientLanguage();

  const languages = useMemo(
    () => new Set([clientLanguage, ...additionalLanguages]),
    [clientLanguage, additionalLanguages]
  );

  const [checkedLanguages, setCheckedLanguages] = useState(new Set<string>());

  const [prevClientLanguage, setPrevClientLanguage] = useState(clientLanguage);
  const [prevAdditionalLanguages, setPrevAdditionalLanguages] =
    useState(additionalLanguages);

  if (
    clientLanguage !== prevClientLanguage ||
    additionalLanguages !== prevAdditionalLanguages
  ) {
    setPrevClientLanguage(clientLanguage);
    setPrevAdditionalLanguages(additionalLanguages);

    // If the `languages` set has changed in a way that it no longer includes
    // some of the languages it included before, those removed languages also
    // have to be removed from `checkedLanguages`!

    // Compute the intersection of `languages` and `checkedLanguages`:
    const nextCheckedLanguages = new Set(
      Array.from(checkedLanguages).filter((language) => languages.has(language))
    );

    // Only adjust `checkedLanguages` if languages have been removed:
    if (nextCheckedLanguages.size < checkedLanguages.size) {
      setCheckedLanguages(nextCheckedLanguages);
    }
  }

  return /* ... */;
}
```

This is the correct code that I think adheres to all React's official recommendations, but oh boy, is it cumbersome, fragile and confusing! Imagine deciding to extend `languages` by elements from yet another source beside `clientLanguage` and `additionalLanguages`. How easy is it to forget to add a `prevX` state variable for this new source? The linter is not there to remind us!

Furthermore, we haven't got rid of the unnecessary rerendering. The inconsistent result of the first render doesn't end up in the UI anymore and instead gets immediately thrown away as I've explained earlier, but still, that unnecessary first render does take place! Can we really not do better than that?

One idea that often comes to mind in the context of state synchronization is to use a different value for the `key` attribute whenever some input that the component's state is derived from changes. This is the recommended approach in [2], but unfortunately, it barely solves anything. There is a bunch of problems with the approach:

- It is useless in the context of custom hooks since there are no components involved in their definitions, and so we cannot really supply the key anywhere.
- Changing the key causes *all* of the component's internal state to be reset, which is rarely what we want.
- Changing the key causes a new DOM subtree to be created for the component. Besides being quite inefficient, this can also cause unwanted side effects such as the focused input within the component not being focused anymore after the remount.
- If the component's state is derived from more than one input values, the developer has to come up with a clever way to combine those values into a key.
- The responsibility of forcing the state reset is transferred to the component's consumers instead of being its implementation detail.

I hope this is enough to show how bad this key solution is in most cases.

Let's now have a look at the alternative I suggest.

</details>

## Proposal: Extend `useState` by a dependency array

The alternative isn't new, it has been suggested before a couple of times. I particularly like this definition from #14738:

> It would be useful if we could declare dependencies for `useState`, in the same way that we can for `useMemo`, and have the state reset back to the initial state if they change:
>
> ```javascript
> const [choice, setChoice] = useState(options[0], [options]);
> ```
>
> In order to allow preserving the current value if it's valid, React could supply `prevState` to the initial state factory function, if any exists, e.g.
>
> ```javascript
> const [choice, setChoice] = useState(prevState => {
>   if (prevState && options.includes(prevState) {
>     return prevState;
>  else {
>     return options[0];
>  }
> }, [options]);
> ```

This is a very natural solution requiring pretty much no mind shift at all since it simply brings `useState` in line with the other hooks accepting a dependency array – a concept well-known to all React developers.

The example with `LanguageCheckboxes` from the collapsed section above has demonstrated that in certain scenarios, adjusting state based on both the new input and the previous state value is needed. That is why the `prevState` part of the proposal is especially important.


This is how `LanguageCheckboxes` could be simplified with it:

<details>
<summary>Click to show code</summary>

```typescript
function LanguageCheckboxes({
  additionalLanguages,
}: {
  additionalLanguages: string[];
}) {
  const clientLanguage = useClientLanguage();

  const languages = useMemo(
    () => new Set([clientLanguage, ...additionalLanguages]),
    [clientLanguage, additionalLanguages]
  );

  const [checkedLanguages, setCheckedLanguages] = useState<Set<string>>(
    (prev) => {
      if (prev === undefined) return new Set();

      // If the `languages` set has changed in a way that it no longer includes
      // some of the languages it included before, those removed languages also
      // have to be removed from `checkedLanguages`!

      // Compute the intersection of `languages` and previous `checkedLanguages`:
      const next = new Set(
        Array.from(prev).filter((language) => languages.has(language))
      );

      // Only actually adjust the value if languages have been removed:
      return next.size < prev.size ? next : prev;
    },
    [languages]
  );

  return /* ... */;
}
```
</details>

This is very similar to the original `useEffect` solution people love for its readability, but without any of its drawbacks! Isn't that beautiful?

By the way, a user-land implementation of this proposal exists, see [`use-state-with-deps`](https://github.com/peterjuras/use-state-with-deps).

## More motivating examples

The proposal has been [rejected](https://github.com/facebook/react/issues/14738#issuecomment-461868904) before with the following argumentation:

> The idiomatic way to reset state based on props is here:
> 
> https://reactjs.org/docs/hooks-faq.html#how-do-i-implement-getderivedstatefromprops
> 
> In other words:
> 
> ```typescript
> const [selectedChoice, setSelectedChoice] = useState(options[0]);
> const [prevOptions, setPrevOptions] = useState(options);
> 
> if (options !== prevOptions) {
>   setPrevOptions(options);
>   setSelectedChoice(options[0]);
> }
> ```
> 
> I don't think we want to encourage this pattern commonly so we're avoiding adding a shorter way (although we considered your suggestion).

In general, I feel like the React team is trying to make me believe that adjusting state when some input value changes is not something I want to do. I cannot agree with that. Here are 2 examples of real-world scenarios where derived state makes perfect sense that I have encountered just recently:

1. `useRelativeTime`: a hook that returns the relative time string like “in 5 seconds” or “2 minutes ago” that it keeps up-to-date, for a given timestamp, in a given language. The current output value is kept in a state variable that may need to be adjusted when the input timestamp or language changes.

    <details>
    <summary>Click to show code</summary>

    ```typescript
    import { useEffect, useMemo, useRef, useState } from ""react"";
    import { createRoot } from ""react-dom/client"";

    const units: { name: Intl.RelativeTimeFormatUnit; milliseconds: number }[] = [
      { name: ""week"", milliseconds: 1000 * 60 * 60 * 24 * 7 },
      { name: ""day"", milliseconds: 1000 * 60 * 60 * 24 },
      { name: ""hour"", milliseconds: 1000 * 60 * 60 },
      { name: ""minute"", milliseconds: 1000 * 60 },
      { name: ""second"", milliseconds: 1000 },
    ];

    function relativeTimeHelper(
      timeInMs: number,
      rtf: Intl.RelativeTimeFormat
    ): readonly [output: string, nextBumpTime: number] {
      const now = Date.now();
      const diff = timeInMs - now;
      const absDiff = Math.abs(diff);

      const settleForUnit = (unit: (typeof units)[0]) => {
        const value = Math.trunc(diff / unit.milliseconds);
        const output = rtf.format(value, unit.name);
        const nextBumpTime =
          diff > 0 // time in the future
            ? now + (diff % unit.milliseconds) + 1
            : timeInMs + (-value + 1) * unit.milliseconds;
        return [output, nextBumpTime] as const;
      };

      for (const unit of units) {
        if (absDiff > unit.milliseconds) {
          return settleForUnit(unit);
        }
      }

      return settleForUnit(units[units.length - 1]);
    }

    function useRelativeTime(language: string, timeInMs?: number) {
      const rtf = useMemo(() => new Intl.RelativeTimeFormat(language), [language]);

      const [initialOutput, initialNextBumpTime] = useMemo(() => {
        return timeInMs !== undefined ? relativeTimeHelper(timeInMs, rtf) : [];
      }, [timeInMs, rtf]);

      // Does this part have to be so confusing? This would be so much cleaner:
      // const [output, setOutput] = useState(initialOutput, [initialOutput]);
      const [output, setOutput] = useState(initialOutput);
      const [prevInitialOutput, setPrevInitialOutput] = useState(initialOutput);
      if (initialOutput !== prevInitialOutput) {
        setPrevInitialOutput(initialOutput);
        setOutput(initialOutput);
      }

      useEffect(() => {
        if (timeInMs !== undefined) {
          const bump = () => {
            const [nextOutput, nextBumpTime] = relativeTimeHelper(timeInMs, rtf);
            setOutput(nextOutput);
            timeout = setTimeout(bump, nextBumpTime - Date.now());
          };

          let timeout = setTimeout(bump, initialNextBumpTime! - Date.now());
          return () => clearTimeout(timeout);
        }
      }, [timeInMs, rtf, initialNextBumpTime]);

      return output;
    }

    function App() {
      const time = useRef(Date.now() + 5000);
      const output = useRelativeTime(""en"", time.current);
      return output;
    }

    createRoot(document.getElementById(""root"")!).render(<App />);
    ```
    </details>
2. A component displaying hierarchical data from a tree structure. The components's toolbar includes an input that can be used to control the depth up to which the nodes' children are to be expanded. The data changes dynamically, so it can happen that a previously valid input value becomes invalid because it starts exceeding the overall (maximum) depth of the tree that has decreased. In that case, the input value has to be adjusted to match the new maximum depth.

Sure, adjusting state based on input changes is not something you do every day, but nonetheless, scenarios where this is necessary are manifold. I feel like by “avoiding adding a shorter way” so as not “to encourage this pattern”, React does more harm than good:

- The developers who don't know about the `prevState` pattern or don't understand it, those who find it too confusing or fail to see its advantages over the `usEffect` approach, as well as those who don't understand how effects work well enough, end up resorting to `useEffect` and introducing inconsistencies that I've illustrated above. This happens so often that I wouldn't be surprised if even Meta's own codebases included examples of this. I am sure that providing a clear API like the suggested enhanced `useState` hook would help reduce the frequency of such misuses of `useEffect`.
- The developers who do understand the `prevState` pattern and when to use it end up having to suffer from its deliberate clumsiness or rely on user-land solutions like the aforementioned `use-state-with-deps` library (which, by the way, was not exactly easy to find).

This is why I think the proposal should be reconsidered. If I haven't missed anything, it's been more than 5 years since the proposal was last brought up in this repository. The React landscape was very different back then, as the transition from class components to hooks was still ongoing. Maybe it wasn't entirely clear 5 years ago how often the `useEffect` hook would be misused. Also I suppose that developers would resort to class components whenever they wanted to avoid confusing patterns of the new and daunting hook world. This doesn't happen anymore. Taking all of that into consideration, I think the time has come to give the proposal a second look!
",['Status: Unconfirmed'],open,2025-04-28T10:52:44Z,,performance,['status: unconfirmed'],True,,
facebook/react,33038,"Bug: New Customizable Select: option containing span, Select containing button causes hydration warning","<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->
Customizable select elements have received support in Chromium 134:
https://developer.chrome.com/blog/a-customizable-select
https://developer.mozilla.org/en-US/docs/Learn_web_development/Extensions/Forms/Customizable_select

Creating selects with appearance base-select work fine in React, however an error is logged in dev mode in validating DOM nesting.

```
In HTML, <span> cannot be a child of <option>.
This will cause a hydration error.
```
and

```
In HTML, <button> cannot be a child of <select>.
This will cause a hydration error.
```
React version: 19.1.0

## Steps To Reproduce

1. Copy the example from MDN into a react project, or use my code sandbox
2. Open dev tools
3. Observe the warning

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:
https://codesandbox.io/p/sandbox/quiet-cdn-ylm323?file=%2Fsrc%2FApp.js%3A9%2C59

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior
A hydration warning is logged

## The expected behavior
No error logged, no hydration errors should be happening (?)",['Status: Unconfirmed'],open,2025-04-28T08:53:53Z,,bug,['status: unconfirmed'],True,,
facebook/react,33034,"Bug: Persistent Re-render Issue Despite Optimizations (React 18, Next.js, Hooks, Context)","## Bug Report: Excessive Re-renders in Component Despite Multiple Optimizations

**Description**

A specific component in our Next.js application exhibits a high number of re-renders (approx. 8-10) even *after* all asynchronous data fetching (from APIs and Context) is complete and related loading states are false. This occurs despite applying various standard React optimization techniques, including memoizing context providers, functions, and derived state.

**Steps to Reproduce**

Unfortunately, isolating this issue into a minimal reproducible example has proven difficult due to the component's reliance on multiple contexts and asynchronous operations within our specific application structure. However, the core setup involves:

1.  A dynamic route page component (e.g., `/app/items/[itemId]/details/[detailId]`).
2.  The component uses `useEffect` to fetch data from two separate API endpoints based on route parameters (`itemId`, `detailId`) upon mount and when parameters change.
3.  The component consumes data from two separate contexts (`AuthContext`, `FeatureFlagContext`) using `useContext`.
4.  The component manages multiple states using `useState` for the fetched data, loading status, and error status for both API calls.
5.  Data fetching functions are wrapped in `useCallback`.
6.  Context providers for `AuthContext` and `FeatureFlagContext` have their `value` prop memoized using `useMemo`.
7.  Derived state values (e.g., `isPageLoading`) are memoized using `useMemo`.
8.  All major functions within the component are memoized using `useCallback`.
9.  An attempt was made to consolidate multiple loading/error states into a single state object, which did not resolve the issue and potentially increased renders.
10. React Strict Mode is confirmed to be **disabled**.

**Expected Behavior**

After the initial loading phase and subsequent state updates settle (i.e., all loading states are `false`, data is populated), the component should render only once or twice more at most, ideally stabilizing without further renders until user interaction or prop changes occur.

**Actual Behavior**

Console logs show the component rendering approximately 8-10 times *after* all loading states (`bolumLoading`, `previewsLoading`, `limitLoading`) are `false`. This suggests that the sequence or batching of state updates within the asynchronous data fetching functions (`fetchItemData`, `fetchDetailData`) might be triggering an unexpected cascade of renders, even though the final state values are stable. The number of renders sometimes appeared to *increase* after applying `useCallback` to more functions or attempting state collocation.

**Environment**

*   **React:** `^18`
*   **Next.js:** `^15.3.1`
*   **Node.js:** [22.14.0]
*   **OS:** Linux (Pop!_OS 22.04 LTS)
*   **Browser:** [1.77.97 Chromium: 135.0.7049.84 ]

**Additional Context**

We have applied standard optimization techniques (`useMemo` for contexts/derived state, `useCallback` for functions) as documented. The persistence of these extra renders after stabilization is unexpected and difficult to debug further without deeper insight into React's internal scheduling or potential interactions between multiple asynchronous state updates within `useEffect`.

",['Status: Unconfirmed'],open,2025-04-26T21:21:42Z,,bug,['status: unconfirmed'],True,,
facebook/react,33033,Bug: form submit event does not expose event.submitter,"a form submit event provides an [`event.submitter`](https://developer.mozilla.org/en-US/docs/Web/API/SubmitEvent/submitter) property, which can be [passed to `new FormData(event.currentTarget, event.submitter)`](https://developer.mozilla.org/en-US/docs/Web/API/FormData/FormData#submitter).

currently, react's `FormEvent<HTMLFormElement>` does not expose `event.submitter` - it can only be accessed via `(event.nativeEvent as SubmitEvent).submitter`.

React version: 19.1

## Steps To Reproduce

Link to code example: https://github.com/stefanprobst/issue-react-form-event-submitter

1. clone above repo, `pnpm install && pnpm run dev`
2. click the submit button, and see that the nativeEvent has a submitter property, while the react synthetic event does not

## The current behavior

the submit event does not have a `submitter` property

## The expected behavior

the submit event's `submitter` property references the submit button (like the native SubmitEvent does)",['Status: Unconfirmed'],open,2025-04-26T13:39:57Z,,bug,['status: unconfirmed'],True,,
facebook/react,33032,[Compiler]: Effects with always-new dependencies fire less with memoization applied,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/guillaumebrunerie/react-compiler-bug

### Repro steps

- Start the linked repro with `npm run dev`.
- Hover the text, and note that the hover text appears to the right.
- Uncomment the `""use no memo""` directive in `src/App.tsx` and notice that the hover text now appears below.

There are no lint errors, but the compiler causes the component to behave differently, so I guess it’s a bug in the compiler?

I noticed this issue when setting up the React compiler in one of my projects, and noticed that some components started behaving incorrectly. It is custom code that implements anchor-like positioning in JS, so somewhat messy code with refs, layout effects, and calculating the size and position of DOM elements. Suddenly one on the popups ended up positioned at `(0, 0)` with the compiler active, and adding `""use no memo""` in the affected component made the issue go away.

The repro here is a simplified version, which still behaves differently with and without the compiler. I am not aware of breaking any rules of React, but it is very possible I’m hitting some undefined behavior in the order in which effects run or similar.

I couldn’t simplify it much further, in particular
- removing `useHover` to always return `true` makes the issue go away,
- replacing the `refContainer` by the ref itself makes the issue go away,
- removing `hoverRef` makes the issue go away.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1","['Type: Feature Request', 'Component: React Compiler']",open,2025-04-26T10:31:40Z,,bug,"['type: feature request', 'component: react compiler']",True,,
facebook/react,33031,[Compiler]: unnecessary memoization of non-primitive arguments in native React hooks,"### What kind of issue is this?

- [x] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [ ] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://playground.react.dev/#N4Igzg9grgTgxgUxALhASwLYAcIwC4AEwBUYCASggGYA0JZAyngIZ4IEC+BVMEGBAchgJmcPAIDcAHQB2suBBlhCpBAz4I8ACzQyA5gQC8BABTEAbswA2Udh2REClmwgcyoGAEYIYnAJRGAHxEsgQECkqEwlRG9BTUZk7Wtv7SMmERygQA2sqsCHRkeEz5ALqxqiVsic4pHH5poQTCeLDpwE1h0TSdBHlsPelhfZpVCE0caZOysggAHjj4jpUa2roG0zIgHEA

### Repro steps

Currently, the React compiler memoizes parameters passed to hooks if those parameters are non-primitives. This behavior appears to be applied universally, regardless of whether the hook is a built-in (native) React hook or a custom one.

However, for most native hooks, this memoization is unnecessary. It results in increased output code size and adds runtime overhead without any meaningful benefit.

## Examples

Input code using `useRef`:
```js
const ref = useRef({ value });
``` 
Compiled output:
```js
  let t1;
  if ($[0] !== value) {
    t1 = { value };
    $[0] = value;
    $[1] = t1;
  } else {
    t1 = $[1];
  }
  const ref = useRef(t1);
```

Input code using `useState`:
```js
const [state, setState] = useState({ value });
``` 
Compiled output:
```js
  let t2;
  if ($[2] !== value) {
    t2 = { value };
    $[2] = value;
    $[3] = t2;
  } else {
    t2 = $[3];
  }
  const [state, setState] = useState(t2);
```

In both examples, the memoization of the initial values passed to the native hooks is unnecessary.

This same pattern of memoization is also applied to other built-in hooks such as `useReducer` and `useEffect`

## Expected behavior
The compiler should treat native hooks differently and avoid memoizing parameters when it's not needed. This would reduce both the generated code size and runtime overhead.

### How often does this bug happen?

Every time

### What version of React are you using?

19.1.0

### What version of React Compiler are you using?

19.1.0-rc.1",['Component: React Compiler'],open,2025-04-26T05:58:24Z,,bug,['component: react compiler'],True,,
facebook/react,33025,[Compiler Bug]: Unexpected [ Server ] Error: {} causing ErrorBoundary crash in Next.js 15.1.6 with Turbopack,"### What kind of issue is this?

- [ ] React Compiler core (the JS output is incorrect, or your app works incorrectly after optimization)
- [x] babel-plugin-react-compiler (build issue installing or using the Babel plugin)
- [ ] eslint-plugin-react-compiler (build issue installing or using the eslint plugin)
- [ ] react-compiler-healthcheck (build issue installing or using the healthcheck script)

### Link to repro

https://github.com/Emmanuel-Xs/devlinks

### Repro steps

What is the issue?
I'm encountering a [ Server ] Error: {} that causes a full Error Boundary crash in my app.
This happens unexpectedly during normal navigation and rendering.
The error appears to originate from react-server-dom-turbopack inside next@15.1.6, and seems related to server components.

Error logs:

```bash
[ Server ] Error: {}

resolveErrorDev (react-server-dom-turbopack-client.browser.development.js:1061:61)
processFullStringRow (react-server-dom-turbopack-client.browser.development.js:1228:15)
processFullBinaryRow (react-server-dom-turbopack-client.browser.development.js:1216:5)
progress (react-server-dom-turbopack-client.browser.development.js:1334:92)

```
Also the console shows:

```bash
Error occurred in <PreviewLinksButton> component. Handled by <ErrorBoundaryHandler>.
````

Screenshots:
(Attached below)

![Image](https://github.com/user-attachments/assets/eccb3e4c-536d-4d31-af6a-5db901ba41c0)
![Image](https://github.com/user-attachments/assets/afe33b0b-7aa7-401f-92e4-35578d49436e)



### How often does this bug happen?

Sometimes

### What version of React are you using?

19.0.0

### What version of React Compiler are you using?

19.0.0-beta-714736e-20250131","['Type: Bug', 'Status: Unconfirmed', 'Component: React Compiler']",open,2025-04-25T17:16:40Z,,bug,"['type: bug', 'status: unconfirmed', 'component: react compiler']",True,,
facebook/react,33024,"Bug: Unit testing error message - ""The tag <search> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.""","<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version: 19

## Steps To Reproduce
If using my linked example:
1. Create component that uses the search component
2. Create a unit test that renders this
3. Run the test

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example: https://github.com/IsaacMcIntyre/search-tag-testing-bug

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior
Test runs with no errors

## The expected behavior
Test passes, but with console error:

 ```
 console.error
    The tag <search> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.

      4 | describe(""SearchComponent"", () => {
      5 |   it(""renders"", () => {
    > 6 |     render(<SearchComponent />)
        |           ^
      7 |   })
      8 | }) 

      at completeWork (node_modules/react-dom/cjs/react-dom-client.development.js:11360:37)
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:1522:13)
      at completeUnitOfWork (node_modules/react-dom/cjs/react-dom-client.development.js:15268:19)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom-client.development.js:15149:11)
      at workLoopSync (node_modules/react-dom/cjs/react-dom-client.development.js:14956:41)
      at renderRootSync (node_modules/react-dom/cjs/react-dom-client.development.js:14936:11)
      at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:14419:13)
      at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:16216:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:566:34)
      at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:859:10)
      at node_modules/@testing-library/react/dist/act-compat.js:47:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:190:26)
      at render (node_modules/@testing-library/react/dist/pure.js:292:10)
      at Object.<anonymous> (src/components/__tests__/SearchComponent.test.tsx:6:11)

 PASS  src/components/__tests__/SearchComponent.test.tsx
  SearchComponent
    ✓ renders (35 ms)

Test Suites: 1 passed, 1 total
Tests:       1 passed, 1 total
Snapshots:   0 total
```


## Other Context
I've seen similar issues written in the past for <g> and <text> where they are not inside an <svg> tag, but from my understanding there should not be any requirements of elements outside or inside the search tag. With this being a relatively new html element, I'm wondering if this is just something that needs updating? Or am I doing something wrong? 
- https://developer.mozilla.org/en-US/docs/Web/HTML/Reference/Elements/search
- https://github.com/facebook/react/issues/16135
- https://github.com/facebook/react/issues/16135#top

Apologies if this is the wrong place / I have misunderstood something.

Thanks!
",['Status: Unconfirmed'],closed,2025-04-25T16:31:27Z,2025-05-23T02:09:07Z,bug,['status: unconfirmed'],True,27.0,
facebook/react,33021,[react-refresh] no changelog found,"on npm we're pointed at this repo and i can only find a single mention of react refresh within the changelog even though there over 2k version of this dep.

can we please get a dedicated changelog for the different packages you publish from this repo.",['Status: Unconfirmed'],open,2025-04-25T15:51:40Z,,bug,['status: unconfirmed'],True,,
facebook/react,33020,Bug: <Suspense> with a lazy() Component loads forever,"### Version
""react"": ""19.1.0"",
""react-dom"": ""19.1.0""

OS: Ubuntu 24.04 and MacOS 15.3.2

## Overview

Our React-App uses Icons which are `lazy()` loaded and surrounded by a `<Suspense>`. We are now seeing issues for components using one of the Icons when also a state is updated within a `useEffect()`.
While updating from React 18.3.1 to React 19.1.0 a few of our tests are running forever (infinite loop?).
We were able to narrow it down to the React upgrade and created a minimal test case for this.

### Related Issues
#29930: [React 19] infinite loop when using React lazy & functional formAction together

## Steps To Reproduce

1. Open [CodeSandbox](https://codesandbox.io/p/devbox/great-visvesvaraya-fvk7sq?) (Or use the GitHub backup: https://github.com/Jens-n11/react-bug-suspense)
2. Download the code
3. Run `yarn install`
4. Run `yarn test:only-hanging`
5. Will load forever

![Image](https://github.com/user-attachments/assets/a7a32aea-f753-473e-8359-144ee5c85827)

Cases where the bug does **not** happen:
- Using React 18.3.1 instead of 19
- When rendering less than 3 Icons
- When running all tests (so having a working test-case right before) `yarn test:all`
- Doing **no** state update from the useEffect
",['Status: Unconfirmed'],open,2025-04-25T14:25:15Z,,bug,['status: unconfirmed'],True,,
facebook/react,33018,Bug:,"<!--
  Please provide a clear and concise description of what the bug is. Include
  screenshots if needed. Please test using the latest version of the relevant
  React packages to make sure your issue has not already been fixed.
-->

React version:

## Steps To Reproduce

1.
2.

<!--
  Your bug will get fixed much faster if we can run your code and it doesn't
  have dependencies other than React. Issues without reproduction steps or
  code examples may be immediately closed as not actionable.
-->

Link to code example:

<!--
  Please provide a CodeSandbox (https://codesandbox.io/s/new), a link to a
  repository on GitHub, or provide a minimal code example that reproduces the
  problem. You may provide a screenshot of the application if you think it is
  relevant to your bug report. Here are some tips for providing a minimal
  example: https://stackoverflow.com/help/mcve.
-->

## The current behavior


## The expected behavior",['Status: Unconfirmed'],closed,2025-04-25T11:54:25Z,2025-04-25T14:36:45Z,bug,['status: unconfirmed'],True,0.0,
facebook/react,33015,Bug: ViewTransition name prop does not support numerical prefixes,"`ViewTransition` does not animate if a `name` prop starting with a number is provided. Presumably this is because the name is being used as a CSS class, but that is not obvious from the documentation.

React version: experimental

## Steps To Reproduce

1. Create a ViewTransition with the name ""1name"" that wraps an element
2. Insert or remove the ViewTransition

Link to code example: https://codesandbox.io/p/sandbox/hopeful-dawn-cfgv64

## The current behavior
Animation does not fire and no errors or warnings present

## The expected behavior
One of the following:
1. The ViewTransition applies (e.g. by escaping the name)
2. An warning is logged for invalid ViewTransition name
3. The React docs are updated to call out that name must be a valid CSS name
",['Status: Unconfirmed'],open,2025-04-24T19:29:41Z,,bug,['status: unconfirmed'],True,,
marmelab/react-admin,10784,Input HelperText i18n translation,"**Is your feature request related to a problem? Please describe.**
I would like to add translated helper texts to inputs. 

For now i need to add manually a translation key to every input

I would like to fill in i18nProvider all the helper text which i need without touching the forms itself

**Describe the solution you'd like**
Create a similar solution to fields translations. If a translation exists than helper text will be displayed.

resources.[resource_name].fieldHelperTexts.[field name]

or 

resources.[resource_name].fields.[field name] = {label: ""Field Label"", helperText: ""hint""}
shorthand would be the original version. not an object but string.",['RFC'],open,2025-06-13T09:11:01Z,,bug,['rfc'],True,,
marmelab/react-admin,10764,Infinite Promise.reject() loop when localStorage does not contain username and authProvider.checkAuth rejects,"<!-- Please do not submit support requests or ""How to"" questions here. For that, 
- go to Stack Overflow: https://stackoverflow.com/questions/tagged/react-admin),  or
  go to the react-admin discord server https://discord.gg/GeZF9sqh3N for community support or
- use the Professional Support (https://react-admin-ee.marmelab.com/#support) if you're an Enterprise Edition subscriber. -->

**What you were expecting:**
The application should redirect to the login page when no valid credentials (e.g., username) exist in localStorage, and authProvider.checkAuth rejects. Quote from the docs: When checkAuth() throws an error, react-admin redirects to the /login page by default.

**What happened instead:**
The app enters an infinite redirect (Promise.reject) loop or remains stuck on a blank screen if the username field is not present in localStorage. Manually adding a username entry allows the app to load normally.

**Steps to reproduce:**

1. Use the examples/demo authProvider where checkAuth checks for a username in localStorage and rejects if missing.
2. Run the app without username in localStorage (fresh start).
3. Observe the redirect loop or blank screen.
4. Manually set localStorage.setItem(""username"", ""admin"") and refresh — the app loads correctly.

**Related code:**


* A link to a GitHub repo with the minimal codebase to reproduce the issue (copy paste from examples/demo)
  - https://github.com/Nem791/tian_fe.git
```
import { AuthProvider } from 'react-admin';

const authProvider: AuthProvider = {
    login: ({ username }) => {
        localStorage.setItem('username', username);
        // accept all username/password combinations
        return Promise.resolve();
    },
    logout: () => {
        localStorage.removeItem('username');
        return Promise.resolve();
    },
    checkError: () => Promise.resolve(),
    checkAuth: () =>
        localStorage.getItem('username') ? Promise.resolve() : Promise.reject(),
    getPermissions: () => Promise.resolve(),
    getIdentity: () =>
        Promise.resolve({
            id: 'user',
            fullName: 'Jane Doe',
            avatar: 'data:image/jpeg;base64,/9j/4AAQSkZJRgABAQEASABIAAD/4gKgSUNDX1BST0ZJTEUAAQEAAAKQbGNtcwQwAABtbnRyUkdCIFhZWiAH3wAIABMAEgAWADFhY3NwQVBQTAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA9tYAAQAAAADTLWxjbXMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAtkZXNjAAABCAAAADhjcHJ0AAABQAAAAE53dHB0AAABkAAAABRjaGFkAAABpAAAACxyWFlaAAAB0AAAABRiWFlaAAAB5AAAABRnWFlaAAAB+AAAABRyVFJDAAACDAAAACBnVFJDAAACLAAAACBiVFJDAAACTAAAACBjaHJtAAACbAAAACRtbHVjAAAAAAAAAAEAAAAMZW5VUwAAABwAAAAcAHMAUgBHAEIAIABiAHUAaQBsAHQALQBpAG4AAG1sdWMAAAAAAAAAAQAAAAxlblVTAAAAMgAAABwATgBvACAAYwBvAHAAeQByAGkAZwBoAHQALAAgAHUAcwBlACAAZgByAGUAZQBsAHkAAAAAWFlaIAAAAAAAAPbWAAEAAAAA0y1zZjMyAAAAAAABDEoAAAXj///zKgAAB5sAAP2H///7ov///aMAAAPYAADAlFhZWiAAAAAAAABvlAAAOO4AAAOQWFlaIAAAAAAAACSdAAAPgwAAtr5YWVogAAAAAAAAYqUAALeQAAAY3nBhcmEAAAAAAAMAAAACZmYAAPKnAAANWQAAE9AAAApbcGFyYQAAAAAAAwAAAAJmZgAA8qcAAA1ZAAAT0AAACltwYXJhAAAAAAADAAAAAmZmAADypwAADVkAABPQAAAKW2Nocm0AAAAAAAMAAAAAo9cAAFR7AABMzQAAmZoAACZmAAAPXP/bAEMACAYGBwYFCAcHBwkJCAoMFA0MCwsMGRITDxQdGh8eHRocHCAkLicgIiwjHBwoNyksMDE0NDQfJzk9ODI8LjM0Mv/bAEMBCQkJDAsMGA0NGDIhHCEyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMjIyMv/AABEIAIAAgAMBIgACEQEDEQH/xAAcAAABBAMBAAAAAAAAAAAAAAABAAUGBwIDBAj/xAA2EAABAwMBBgMHAwQDAQAAAAABAAIDBAUREgYTITFBUSJxgRQyYZGxwdEHQqEkUmLhFRYjkv/EABoBAAIDAQEAAAAAAAAAAAAAAAIDAAEEBQb/xAAkEQACAgIDAAEEAwAAAAAAAAAAAQIRAyEEEjETBSJRcTJBYf/aAAwDAQACEQMRAD8AuIIoIogAooIqygorB72xsc97g1rRkk9FFrlfnVD3Rwu0Qj5uQyko+hRi5eEjlr6aEkOlBI6N4rSbpCG6j4R0zzPoFEIpZpn+Ahv+TuJ9E9Qtipodc0haD15ud5BI+Vsb8aXoq/a6GgJ1UsrgBknTj6rgp/1JtEkgjnbNTk9Xxkt/+m5Cbrvbam9sc2XeU9G0jTFry6Q9M/hddk/T6kpId7UwNmqJCOBOGxjoD3KLvIroiX0VxprhCJaeVr2njlpyutR+k2dlttQZ4KwMZpwIGjwD5lbI785leaSppZWHmJG+JpHfKYppgOLQ9pIAhwBHIpIwBJFJBQhgiEAiFRYQkgmzaCuNDaZHsOJHeBvmVG6VkSt0Me0l93spoqY5Y0+N3Qn8JgjdrcA3xOPU9f8AS485Jy4c8ucep/CzirNBIh4D9zz1WGU7dmyMElRIIXspeBw+fGeJ4N8/wtsEstTUtHFzz1Pb7BNVHvJQA0EAnOo83fH/AGpBR7qniw14yfekz9+qFMNxHiljYwjhqc3kTxPxwnaIZA+6ZoJWDGhjnZ68gnaEvewftHw4BOixTVGc2GsOdI4c3KFXmSuq75Rw0kQ3EWZKieQaQG8g0D4n7KauaGgiNu8eeJJPBN89JLUN8btWg5HDAL++OwUZSMbTWxV9vZNFqxyIcMEELuTdTBtNUbiP3A0D5BOC0QdozzVMWUksoIwTBFBIKEMlFdtJSIKaMHHEuKlKg+3Ly6rgizhugl3wHVLyv7WMxK5Ih8k2+IAJEecNGeLvj5LvoossDsZHl9E2x6ZZNTvDGPp2WFde45P6WlqI4tPAZIGT6rAb0vwSiOox4RgA+84nn6ruiuAhLdA1n+5x5Kt6SsrYagtqqkyuJ8Jxj+FLpIql9qM0b9GW8Ceioaoa2TigrXStDsMb8SOKeYtUgGpxLe5+wVQ2eouftIabs52T7ugHPqrOtNNX7gb+r3zSPE1zNJPljknQaehGSFDo6piax5Em7iZ78h+gXJV1OId7lzIgzIYOePyue4QvxGGs8OsAN6D/ACPfH1QinirgZmODoi4Mb5BFYlqjfSsc58kjxgkN4dua61wWWqFbb2VGCDM4uAPMN6LsJ4p+LwRlM8pZWGUU0UBFYhFUWFV/t0S67xR8muhGT8MqwFDNvKJz4IqxgyWjQ49uyXl3EbidSKxrp31VWaKnJaxoySO6aX7INZG9swlcHuD3OyMkjlxKdLWA2uqJH/3NH8KRVNWz2XJ7LCm1tHSUIyWyL0NvdC6CnBeQHjRqOSB2VwVdnd/1YwRt/wDQx8Pkq4sX9XdoXubpZrGCeo7q7i3eW0OjbqLW8B3RRjdkm+tJHn6usdbV1JY6rnpmBww5jT4QPLn6q09jLdcKBsRgv0lZSFgaaaoYXBuBza4kuB7g5HwCa6y50tRWvi3ZjeHYc1wwQVMdm42NaC3lhXBu6JkikuzHS4QuNuqCPf3biPPCqj9OdonubHa6txLyXkPJ65JH1x6K27tKYrXVPAyRE/A7nBVE7OUEtJtDSs0k6JwHO8zghMemZ6bjZcdqjZT0jo2DAY4tC68rVBHuosY4klx81sWnGqiYcjuRkllAIhGCBFBFUWFc9dSR11FLTyDLXtI8l0BJUXZRt4tNRZ7hPFI3Trw5p6HHBcEk0jgwO93l6q3tsrJ/y1oL4WZqYTqZ8R1H0VRVEDKqikgkaQRkdiCsOWHWR0+Pk7RFRzVNHXQmNwc1pHAHBVq2m+19QIzTgMhaMFsjclx+ap2wW6gn3dNXvqIpA7G+DstcB9CrVtVqsVDa4Zpa2eUmPIDS4knIzgD4FUou9Dvtqpe/oZ9qrfUR1Elw3ZDy7UeGAVKtibgKi3skzwPDj0KiV7ornc6xk8EtdTW+QhraSZ+S49SW8cAeamWzlsFupBG39ztXkotSKl/CmO21N3pbLs7U3GtL/Z4tOsMGScuAwB6qK7JUrbs1t6ex+5kOuESBoceJ4uDeGfJP+1NpO0NLSWyRgNE6cS1Rzza3iGjzOPknKCnipadkEEbY4o2hrWtGAAFojj7O2YJ5eq6oyKCywlhaTIBEJJKEMQigEVRYUViioQJAIIPVVrtzYW0FY2507cQVLtMoH7X9/X6hWVlcl0pKWvtlRTVuPZ3sOs5xpxx1A9COaDJDtGhuKbhKyjW2uT2newSuZq544g+in2ytGYpGzTPMj28WgNAwofRV0cFU6F7w5oOGudw1DoVPbRdKCBrdU0eojg1pyT6BYbr+zsd5dKRIvZN6/ey4yPhyXRTx+PDeXfssaZz6wBzssj6N6nzTiyJrAABgI1vaMrdaZp06SQTniktkvv5WtbIO4o5+RVJgwkikjAAkigVCGsJZWuSaOGMySvaxg5uccAJiqtqqeNxbSxOmP9x8I/KCU4x9DjCUvESIJuvG0Fp2fp2zXWvhpWPzo3h4uxzwBxKi1XtTcJGnS5sDe7Bx+ZVD7WX+p2gvs1TNM+VkZ3cOp2fCD9+amOayPReTG4LZaF2/XVjKmRlotTZIG5DZal5Bce+kch5lcLNqL5erSJrhXPd7SNRiYA2No6AAKocHGOqs21NJs1K3HERgfwg5T6xSQzixTk2zAtEziCn6wwbmoa4DHHoE1tgO9BA9FJLfTua0ODeK5sjpw0WFaagua0Ek+akAcC3KiNnbI0AkKTsfiLJTsb0IyrZue3U3yULuW39stV+fbKlkmmMAPmZ4sPPTCeNoL9HZbPUVbiCWN8I7novPE9TLVVktTM4ukkLnuJ6kldPg4fkk2/DncyfSKr09C2zaizXZzI6SvidM/lE7wv8AkU7rznsdUvG1Nvbk5FWz6r0O2XuPkj5EYYpJJ+isPfIm6NqCQcDySSk0/A2mvStrpepLtWu0kimYcRt+5+K1sZlqa6LmMp13ga1cuUnJ2zrQioqkM21VULfs7VzA4foLWeZ4fdUnjAHmrI/Uiv8A6OmpQffeXkfAD8lVyBlkY75K6XDhWO/yc7ly++vwGMZljGM5I+qvWlpab2eMNiDQGjgAqNb4J2EftwR6cV6Et0Daihp5WjwyRtcPUIebGkhnCabZjTWykmOHsHDkU7U9BHF7ucLXFTljuSc4W8srnUb26OmmeI2Dgt7qzIw44C1BgwmLaq7w2a0S1Dj4sYYM8S7oEyKb0hcmvWRD9S9pI6qaCz0rsiM7ydw79B6c/kq/Mni7cM/RYmd9XUyVEpJe4l7s9StD3nWT105+y9NxsXw4lE8/nyfLkch32Lk07X21zjw3+r5L0HHUa25yvPWxzc7YW9nYk/wVdrKgsAHRcn6lKpx/R0+BG4N/6P8AFL4hxTg2IvZkc1HqSoy8EqUUUgfGFjxt3o0ZUq2f/9k=',
        }),
};

export default authProvider;

```

**Other information:**
<!-- List any other information that is relevant to your issue. Stack traces, related issues, suggestions on how to fix, Stack Overflow links, forum links, etc. For visual or layout problems, please include images or animated gifs.-->

**Environment**

* React-admin version: ^5.0.0
* Last version that did not exhibit the issue (if applicable): N/A
* React version: ^19.0.0
* Browser: Chrome
* Stack trace (in case of a JS error): No visible stack trace; redirect loop observed
",['needs more info'],open,2025-05-31T21:52:58Z,,security,['needs more info'],True,,
marmelab/react-admin,10757,"Make it possible to adjust transformedFile object shape in ImageInput, FileInput","**Is your feature request related to a problem? Please describe.**
My api uses a different attribute names for file url (src) and title.
I tried to use afterRead lifecyclecallback, but it did not worked all the time (after save it used the original object)
I introduced new attributes to my api, but i don't find it ideal
I create a local version of transformFiles which did the trick, but multiple is used as an inside variable, the code look and feel was not nice anymore

**Describe the solution you'd like**
It would be nice, if we could adjust the shape of the transformedFile with a callback function, than it could be lined up easily with api, and would be even easy to add more variables to it.

```tsx
const transform = (file, preview) =>{
    return {
      rawFile: file,
      contentUrl: preview,
      title: file.name,
    };
  }

  // turn a browser dropped file structure into expected structure
  const transformFile = file => {
    if (!(file instanceof File)) {
      return file;
    }

    const preview = URL.createObjectURL(file);
    const transformedFile = transform(file, preview);

    return transformedFile;
  };

  const transformFiles = (files: any[]) => {
    if (!files) {
      return multiple ? [] : null;
    }

    if (Array.isArray(files)) {
      return files.map(transformFile);
    }

    return transformFile(files);
  };
```

**Describe alternatives you've considered**
Maybe if afterRead would be fixed, that could give a nice solution as well.

**Additional context**
My solution now:

```tsx
const ConfigWatermarkForm = () => {

  const multiple = false;

  // turn a browser dropped file structure into expected structure
  const transformFile = file => {
    if (!(file instanceof File)) {
      return file;
    }

    const preview = URL.createObjectURL(file);
    const transformedFile = {
      rawFile: file,
      contentUrl: preview,
      title: file.name,
    };

    return transformedFile;
  };

  const transformFiles = (files: any[]) => {
    if (!files) {
      return multiple ? [] : null;
    }

    if (Array.isArray(files)) {
      return files.map(transformFile);
    }

    return transformFile(files);
  };

  return (
    <SimpleForm>
      <TextInput source=""name""/>
      <DateInput source=""activeFrom""/>
      <DateInput source=""activeTo""/>
      <ReferenceArrayInput
        reference={ResourceNameEnum.ConfigWatermarkAlloweds}
        source=""allowed""
      />
      <ImageInput source=""topConfigWatermarkMediaObject"" parse={transformFiles} format={transformFiles}>
        <ImageField source=""contentUrl"" title=""title""/>
      </ImageInput>
      <ImageInput source=""bottomConfigWatermarkMediaObject"" parse={transformFiles} format={transformFiles}>
        <ImageField source=""contentUrl"" title=""title""/>
      </ImageInput>
    </SimpleForm>
  );
};

export default ConfigWatermarkForm;
```

Preferred solution would be:
```tsx
const ConfigWatermarkForm = () => {

  const transform = (file, preview) =>{
    return {
      rawFile: file,
      contentUrl: preview,
      title: file.name,
    };
  }
  
  return (
    <SimpleForm>
      <TextInput source=""name""/>
      <DateInput source=""activeFrom""/>
      <DateInput source=""activeTo""/>
      <ReferenceArrayInput
        reference={ResourceNameEnum.ConfigWatermarkAlloweds}
        source=""allowed""
      />
      <ImageInput source=""topConfigWatermarkMediaObject"" transform={transform}>
        <ImageField source=""contentUrl"" title=""title""/>
      </ImageInput>
      <ImageInput source=""bottomConfigWatermarkMediaObject"" transform={transform}>
        <ImageField source=""contentUrl"" title=""title""/>
      </ImageInput>
    </SimpleForm>
  );
};

export default ConfigWatermarkForm;
```
",['RFC'],open,2025-05-27T05:33:03Z,,security,['rfc'],True,,
marmelab/react-admin,10755,Autocomplete in ReferenceInput with optionValue != id unselects value,"**What you were expecting:**
The issue happens during the autocomplete component usage. Specifically, when the autocomplete value is selected which is outside of the preview list, the selected value disappears from the field. Meanwhile, the selected value is passed further to filter the list of item. This leaves user with no visibility on the selected item.

**What happened instead:**
when i use this code:
```
<ReferenceInput
      key=""brand""
      source=""brand""
      reference={BrandResourcePath}
      sort={{ field: ""brand"", order: ""ASC"" }}
      perPage={25}
      label=""brand""
      alwaysOn
      resettable
    >
      <AutocompleteInput optionValue=""brand"" optionText=""brand"" label=""Brand"" />
    </ReferenceInput>,
``` 
in <List filters, and i selecting value that was searched (not in first 25 results), value is cleaned, and input stays as unselected. (see attached video)

**Steps to reproduce:**
1) use code from point above in <List filters
2) try to search value which is not in the dropdown list (Only the 25 values out of 1500 values are presented in the dropdown review)
3) select value
4) Outcome: The autocomplete input becomes empty
5) change optionValue prop to 'id'
6) Auto complete selected value stays on place


**Related code:**
```
const Filters = [
    <ReferenceInput
      key=""brand""
      source=""brand""
      reference={BrandResourcePath}
      sort={{ field: ""brand"", order: ""ASC"" }}
      perPage={25}
      label=""brand""
      alwaysOn
      resettable
    >
      <AutocompleteInput optionValue=""brand"" optionText=""brand"" label=""Brand"" />
    </ReferenceInput>,
];
...

<List filters={Filters}> <Datagrid.........
```


**Other information:**
Video: https://drive.google.com/file/d/1cXk9ulvk4qInw62pMazi7rZAwg6X6f36/view?usp=sharing

**Environment**

* React-admin version: 5.8.2
* Last version that did not exhibit the issue (if applicable): -
* React version: 19.1.0
* Browser: any (Chrome)
* Stack trace (in case of a JS error): -
",['documentation'],closed,2025-05-23T14:53:32Z,2025-05-28T10:51:25Z,bug,['documentation'],True,4.0,
marmelab/react-admin,10743,Feature Request: Support Routers other than react-router,"**Is your feature request related to a problem? Please describe.**
I’ve been using React-Admin since its early days, including the enterprise version for over three years, and have successfully integrated it with React Native for over a year. However, React-Admin’s tight coupling with react-router is a huge limitation — specifically, react-router-native is now deprecated, and I’m locked into an outdated version just to keep things working. This makes long-term maintenance and upgrades difficult.

**Describe the solution you'd like**
I’d like the router to be moved to a customizable context, similar to how data and auth providers are handled. This would decouple routing from a specific library and make it possible to use React-Admin with any routing solution, including custom ones tailored for native or other platforms.

**Describe alternatives you've considered**
Currently, I’m using react-router-native as a workaround, but it’s deprecated and not officially supported by either React-Admin or React Router. There’s no long-term path forward with this approach.

**Additional context**
Allowing routing to be handled via a routing context would greatly expand the flexibility of React-Admin. It would allow projects to integrate seamlessly with alternative routing systems, adapt to React Native and other environments, and reduce the tight coupling with a single router implementation.

","['enhancement', 'breaking change', 'v6']",open,2025-05-14T09:54:46Z,,bug,"['enhancement', 'breaking change', 'v6']",True,,
marmelab/react-admin,10733,onSuccess not called by useDelete/deleteOne in pessimistic mode,"[This is a v4 bug, which I hope is still supported, since it's mentioned in the issue template? I did not have time to check if the issue exists in v5 as well.]

**What you were expecting:**

I'm using the `deleteOne` function returned by `useDelete` with the (default) pessimistic mutation mode, and `onSuccess` and `onError` callbacks supplied in the options object. One of these callbacks should be invoked after the delete request responds, corresponding to the response code.

**What happened instead:**

When the DELETE request fails, `onError` is invoked as expected. When the request succeeds though, `onSuccess` is _not_ called. It is only called when I change the mutation mode to `optimistic`.

**Steps to reproduce:**

Repro: https://stackblitz.com/edit/github-718bhh69?file=src%2Fposts%2FPostList.tsx

Check the post list view; the delete button labeled ""ERROR"" will fail, logging ""ERROR!"" in the console. The button labeled ""SUCCESS"" however will _not_ log ""SUCCESS!"", even though it _does_ delete the post.

**Environment**

* React-admin version: 4.16.20
* Last version that did not exhibit the issue (if applicable): did not try v5
* Browser: Vivaldi 7.3.3635.11
* Stack trace (in case of a JS error): n/a
","['needs more info', 'v4']",open,2025-05-08T09:11:47Z,,bug,"['needs more info', 'v4']",True,,
marmelab/react-admin,10728,Theme Change Does Not Apply Instantly,"Description
When switching themes using the theme switcher (e.g., in the demo app), the new theme is not applied immediately. The UI only updates to the new theme after a manual page refresh. This is unexpected—theme changes should be reflected instantly.

Steps to Reproduce:
1.Start the demo app.
2.Use the theme switcher in the AppBar to select a different theme.
3.Observe that the UI does not update to the new theme.
4.Refresh the page.
5.The new theme is now applied.

Expected Behavior:
The theme should update immediately after the user changes it, without requiring a page refresh.

Actual Behavior:
The theme only updates after a manual page refresh.

This is a video representation:
https://streamable.com/xcy7zs",['bug'],closed,2025-05-05T18:21:21Z,2025-05-06T13:14:11Z,bug,['bug'],False,0.0,
marmelab/react-admin,10727,RA v4: List filters freeze with react-hook-form >= 7.55,"Using the List component filters property, when I click on the filter textbox input, my page freezes completely and is unresponsive, I have to close the web page.
I use the 4.16 React Admin version, and would like to use Next v14.2.
Is it compatible, is there a workaround?
",['v4'],open,2025-05-05T15:14:12Z,,bug,['v4'],True,,
marmelab/react-admin,10721,3.19 docs are mostly 404ing,"Similar to https://github.com/marmelab/react-admin/issues/8086, I'm finding that the 3.19 docs are largely inaccessible. Unfortunately the workaround in that issue doesn't seem to be working for me.","['bug', 'documentation']",closed,2025-05-02T11:41:34Z,2025-05-05T09:50:35Z,bug,"['bug', 'documentation']",False,2.0,
marmelab/react-admin,10708,Upgrade to react-router(-dom) 7.5.2 due to CVE-2025-43865 breaks custom routes,"Our current react admin app (version `5.7.4`) uses react-router and react-router-dom version `7.1.3`. 

Last week https://nvd.nist.gov/vuln/detail/CVE-2025-43865 has been reported and as a result, we are trying to upgrade to version 7.5.2.

This is our `<Admin>` structure:

```
<Admin
	layout={MainLayout}
	authProvider={authProvider}
	i18nProvider={i18nProvider}
	loginPage={false}
	dataProvider={dataProvider}
	darkTheme={defaultDarkTheme}
	dashboard={Dashboard}
>
	<Resource name=""customers"" {...customers} recordRepresentation=""name""/>
	<Resource name=""resources"" {...resources} recordRepresentation=""name""/>
	<Resource name=""orders"" {...orders} />
	<Resource name=""stock"" {...stock} />
	<Resource name=""persons"" {...persons} />
	<Resource name=""vehicles"" {...vehicles} />
	<Resource name=""management/users"" {...users} />
	<Resource name=""management/teams"" {...teams} />
	<Resource name=""settings"" {...settings}></Resource>
	<CustomRoutes>
		<Route path=""/planner"" element={<Planner/>}/>,
		<Route path=""/weekplanning"" element={<WeekPlanner/>}/>,
	</CustomRoutes>
</Admin>
```

After bumping the version of react-router and dom, the following error appears:

```
[Route] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>


    at Routes (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4734:3)
    at Suspense (<anonymous>)
    at ErrorBoundary (http://localhost:3000/node_modules/.vite/deps/chunk-W2MBOQYV.js?v=5f94f09d:5455:5)
    at div (<anonymous>)
    at main (<anonymous>)
    at div (<anonymous>)
    at div (<anonymous>)
    at RaLayout-root (http://localhost:3000/node_modules/.vite/deps/chunk-BLQV34CV.js?v=5f94f09d:1349:45)
    at Layout (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:71739:20)
    at MainLayout (http://localhost:3000/src/components/layout/MainLayout.tsx:26:40)
    at RenderedRoute (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4097:26)
    at Routes (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4734:3)
    at CoreAdminRoutes (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:18458:3)
    at RenderedRoute (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4097:26)
    at Routes (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4734:3)
    at ErrorBoundary (http://localhost:3000/node_modules/.vite/deps/chunk-W2MBOQYV.js?v=5f94f09d:5455:5)
    at CoreAdminUI (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:18553:43)
    at CssBaseline (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:41212:17)
    at AdminUI (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:84601:18)
    at DefaultPropsProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:24539:3)
    at RtlProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:24515:3)
    at ThemeProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:24471:5)
    at ThemeProvider2 (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:24622:5)
    at ThemeProviderNoVars (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:27708:10)
    at ThemeProvider3 (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:27770:3)
    at ThemeProvider4 (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:68765:23)
    at ResourceDefinitionContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6933:18)
    at UndoableMutationsContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:15594:23)
    at NotificationContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6283:23)
    at I18nContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6372:18)
    at RenderedRoute (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4097:26)
    at RenderErrorBoundary (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4056:5)
    at DataRoutes (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4629:3)
    at Router (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4677:13)
    at RouterProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:4459:3)
    at RouterProvider2 (<anonymous>)
    at InternalRouter (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6669:23)
    at BasenameContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6648:23)
    at AdminRouter (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6654:18)
    at QueryClientProvider (http://localhost:3000/node_modules/.vite/deps/chunk-TNDI3JRZ.js?v=5f94f09d:2804:3)
    at PreferencesEditorContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:17617:23)
    at StoreContextProvider (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:6169:20)
    at CoreAdminContext (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:17668:28)
    at AdminContext (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:84635:21)
    at Admin (http://localhost:3000/node_modules/.vite/deps/react-admin.js?v=fe271de9:84866:28)
    at APIProvider (http://localhost:3000/node_modules/.vite/deps/@vis__gl_react-google-maps.js?v=d47e5c0f:295:5)
    at App (http://localhost:3000/src/App.tsx?t=1745830040540:50:47)
```

When we remove `<CustomRoutes>`, the app works as expected (which a working custom route of course).


",['needs more info'],closed,2025-04-28T09:08:00Z,2025-04-28T16:28:49Z,bug,['needs more info'],True,0.0,
marmelab/react-admin,10707,Clear filter DateInput's value doesn't trigger filter while the focus is on the component,"<!-- Please do not submit support requests or ""How to"" questions here. For that, 
- go to Stack Overflow: https://stackoverflow.com/questions/tagged/react-admin),  or
  go to the react-admin discord server https://discord.gg/GeZF9sqh3N for community support or
- use the Professional Support (https://react-admin-ee.marmelab.com/#support) if you're an Enterprise Edition subscriber. -->

**What you were expecting:**
<!-- Describe what the behavior would be without the bug. -->

When I clear DateInput filter, it should trigger a new request.

**What happened instead:**
<!-- Describe how the bug manifests. -->

While the focus is on the component, the filter is not triggered.

**Steps to reproduce:**
<!--  Please explain the steps required to duplicate the issue, especially if you are able to provide a sample application. -->

- Use a DateInput component in filter
- Choose a date (trigger the filter)
- Clear the selection (untrigger the filter while the focus is on the component)

**Related code:**
<!-- If you are able to illustrate the bug or feature request with an example, please provide a sample application via one of the following means: -->

https://codesandbox.io/p/github/marmelab/react-admin-sandbox/csb-3zvkjq/demo-bug-filter-date-input

**Environment**

* React-admin version: 5.7.3
* Last version that did not exhibit the issue (if applicable):
* React version: 18.2
* Browser: Chrome
* Stack trace (in case of a JS error):
",['needs more info'],closed,2025-04-28T08:24:49Z,2025-04-30T12:53:35Z,bug,['needs more info'],True,2.0,
marmelab/react-admin,10701,📝 Documentation: Fix inconsistencies and incomplete examples in useGetList.md,"**What you were expecting:**
The `useGetList.md` documentation to be complete and properly formatted, with all code examples fully shown and consistent TypeScript examples.

**What happened instead:**
The documentation has several issues:
1. The TypeScript example uses `posts` variable which is not defined (should be `data`)
2. The TypeScript interface example is incomplete and inconsistent with the rest of the documentation
3. The ""See Also"" section is missing links to related hooks

**Steps to reproduce:**
1. Navigate to `docs/useGetList.md`
2. Scroll to the TypeScript section
3. Notice the undefined `posts` variable in the example
4. Notice the incomplete interface definition
5. Notice the missing ""See Also"" section

**Related code:**
```tsx
// Current problematic code
const { data, total, isPending, error } = useGetList<Post>(
    'posts',
    { 
        pagination: { page: 1, perPage: 10 },
        sort: { field: 'published_at', order: 'DESC' }
    }
);
// ... later in the code
{posts.map(post =>  // Error: posts is not defined
    <li key={post.id}>{post.title}</li>
)}
```

**Other information:**
The documentation should be updated to:
1. Use `data` instead of `posts` in the TypeScript example
2. Complete the TypeScript interface with all necessary fields
3. Add a ""See Also"" section with links to related hooks like `useGetListLive`, `useInfiniteGetList`, etc.

**Environment**
* React-admin version: Latest
* Documentation file: `docs/useGetList.md`",['needs more info'],closed,2025-04-25T15:36:25Z,2025-05-05T09:11:47Z,bug,['needs more info'],True,9.0,
marmelab/react-admin,10684,defaultProps recommended for label of custom field,"On https://marmelab.com/react-admin/Fields.html#writing-your-own-field-component, it is recommended to use `defaultProps` for having a default label for a custom field.

As `defaultProps` for function components do not exist anymore, another way should be recommended.

**Other information:**
Mention on `defaultProps` being removed: https://react.dev/blog/2024/04/25/react-19-upgrade-guide#removed-deprecated-react-apis
",['documentation'],open,2025-04-18T12:44:28Z,,bug,['documentation'],True,,
